"use strict";function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e4){throw _e4;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e5){didErr=true;err=_e5;},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]();}finally{if(didErr)throw err;}}};}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _get(){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get.bind();}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(arguments.length<3?target:receiver);}return desc.value;};}return _get.apply(this,arguments);}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}(function(){var _DefaultSkipMarkup;var __defProp=Object.defineProperty;var __export=function __export(target,all){for(var name2 in all){__defProp(target,name2,{get:all[name2],enumerable:true});}};// ../node_modules/@codemirror/state/dist/index.js
var Text=/*#__PURE__*/function(){function Text(){_classCallCheck(this,Text);}_createClass(Text,[{key:"lineAt",value:function lineAt(pos){if(pos<0||pos>this.length)throw new RangeError("Invalid position ".concat(pos," in document of length ").concat(this.length));return this.lineInner(pos,false,1,0);}},{key:"line",value:function line(n){if(n<1||n>this.lines)throw new RangeError("Invalid line number ".concat(n," in ").concat(this.lines,"-line document"));return this.lineInner(n,true,1,0);}},{key:"replace",value:function replace(from,to,text){var parts=[];this.decompose(0,from,parts,2);if(text.length)text.decompose(0,text.length,parts,1|2);this.decompose(to,this.length,parts,1);return TextNode.from(parts,this.length-(to-from)+text.length);}},{key:"append",value:function append(other){return this.replace(this.length,this.length,other);}},{key:"slice",value:function slice(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;var parts=[];this.decompose(from,to,parts,0);return TextNode.from(parts,to-from);}},{key:"eq",value:function eq(other){if(other==this)return true;if(other.length!=this.length||other.lines!=this.lines)return false;var start=this.scanIdentical(other,1),end=this.length-this.scanIdentical(other,-1);var a=new RawTextCursor(this),b=new RawTextCursor(other);for(var skip=start,pos=start;;){a.next(skip);b.next(skip);skip=0;if(a.lineBreak!=b.lineBreak||a.done!=b.done||a.value!=b.value)return false;pos+=a.value.length;if(a.done||pos>=end)return true;}}},{key:"iter",value:function iter(){var dir=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;return new RawTextCursor(this,dir);}},{key:"iterRange",value:function iterRange(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;return new PartialTextCursor(this,from,to);}},{key:"iterLines",value:function iterLines(from,to){var inner;if(from==null){inner=this.iter();}else{if(to==null)to=this.lines+1;var start=this.line(from).from;inner=this.iterRange(start,Math.max(start,to==this.lines+1?this.length:to<=1?0:this.line(to-1).to));}return new LineCursor(inner);}},{key:"toString",value:function toString(){return this.sliceString(0);}},{key:"toJSON",value:function toJSON(){var lines=[];this.flatten(lines);return lines;}}],[{key:"of",value:function of(text){if(text.length==0)throw new RangeError("A document must have at least one line");if(text.length==1&&!text[0])return Text.empty;return text.length<=32?new TextLeaf(text):TextNode.from(TextLeaf.split(text,[]));}}]);return Text;}();var TextLeaf=/*#__PURE__*/function(_Text){_inherits(TextLeaf,_Text);var _super=_createSuper(TextLeaf);function TextLeaf(text){var _this;var length=arguments.length>1&&arguments[1]!==undefined?arguments[1]:textLength(text);_classCallCheck(this,TextLeaf);_this=_super.call(this);_this.text=text;_this.length=length;return _this;}_createClass(TextLeaf,[{key:"lines",get:function get(){return this.text.length;}},{key:"children",get:function get(){return null;}},{key:"lineInner",value:function lineInner(target,isLine,line,offset){for(var _i=0;;_i++){var string2=this.text[_i],end=offset+string2.length;if((isLine?line:end)>=target)return new Line(offset,end,line,string2);offset=end+1;line++;}}},{key:"decompose",value:function decompose(from,to,target,open){var text=from<=0&&to>=this.length?this:new TextLeaf(sliceText(this.text,from,to),Math.min(to,this.length)-Math.max(0,from));if(open&1){var prev=target.pop();var joined=appendText(text.text,prev.text.slice(),0,text.length);if(joined.length<=32){target.push(new TextLeaf(joined,prev.length+text.length));}else{var mid=joined.length>>1;target.push(new TextLeaf(joined.slice(0,mid)),new TextLeaf(joined.slice(mid)));}}else{target.push(text);}}},{key:"replace",value:function replace(from,to,text){if(!(text instanceof TextLeaf))return _get(_getPrototypeOf(TextLeaf.prototype),"replace",this).call(this,from,to,text);var lines=appendText(this.text,appendText(text.text,sliceText(this.text,0,from)),to);var newLen=this.length+text.length-(to-from);if(lines.length<=32)return new TextLeaf(lines,newLen);return TextNode.from(TextLeaf.split(lines,[]),newLen);}},{key:"sliceString",value:function sliceString(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;var lineSep=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"\n";var result="";for(var pos=0,_i2=0;pos<=to&&_i2<this.text.length;_i2++){var line=this.text[_i2],end=pos+line.length;if(pos>from&&_i2)result+=lineSep;if(from<end&&to>pos)result+=line.slice(Math.max(0,from-pos),to-pos);pos=end+1;}return result;}},{key:"flatten",value:function flatten(target){var _iterator=_createForOfIteratorHelper(this.text),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var line=_step.value;target.push(line);}}catch(err){_iterator.e(err);}finally{_iterator.f();}}},{key:"scanIdentical",value:function scanIdentical(){return 0;}}],[{key:"split",value:function split(text,target){var part=[],len=-1;var _iterator2=_createForOfIteratorHelper(text),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var line=_step2.value;part.push(line);len+=line.length+1;if(part.length==32){target.push(new TextLeaf(part,len));part=[];len=-1;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}if(len>-1)target.push(new TextLeaf(part,len));return target;}}]);return TextLeaf;}(Text);var TextNode=/*#__PURE__*/function(_Text2){_inherits(TextNode,_Text2);var _super2=_createSuper(TextNode);function TextNode(children,length){var _this2;_classCallCheck(this,TextNode);_this2=_super2.call(this);_this2.children=children;_this2.length=length;_this2.lines=0;var _iterator3=_createForOfIteratorHelper(children),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var child=_step3.value;_this2.lines+=child.lines;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}return _this2;}_createClass(TextNode,[{key:"lineInner",value:function lineInner(target,isLine,line,offset){for(var _i3=0;;_i3++){var child=this.children[_i3],end=offset+child.length,endLine=line+child.lines-1;if((isLine?endLine:end)>=target)return child.lineInner(target,isLine,line,offset);offset=end+1;line=endLine+1;}}},{key:"decompose",value:function decompose(from,to,target,open){for(var _i4=0,pos=0;pos<=to&&_i4<this.children.length;_i4++){var child=this.children[_i4],end=pos+child.length;if(from<=end&&to>=pos){var childOpen=open&((pos<=from?1:0)|(end>=to?2:0));if(pos>=from&&end<=to&&!childOpen)target.push(child);else child.decompose(from-pos,to-pos,target,childOpen);}pos=end+1;}}},{key:"replace",value:function replace(from,to,text){if(text.lines<this.lines)for(var _i5=0,pos=0;_i5<this.children.length;_i5++){var child=this.children[_i5],end=pos+child.length;if(from>=pos&&to<=end){var updated=child.replace(from-pos,to-pos,text);var totalLines=this.lines-child.lines+updated.lines;if(updated.lines<totalLines>>5-1&&updated.lines>totalLines>>5+1){var copy=this.children.slice();copy[_i5]=updated;return new TextNode(copy,this.length-(to-from)+text.length);}return _get(_getPrototypeOf(TextNode.prototype),"replace",this).call(this,pos,end,updated);}pos=end+1;}return _get(_getPrototypeOf(TextNode.prototype),"replace",this).call(this,from,to,text);}},{key:"sliceString",value:function sliceString(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.length;var lineSep=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"\n";var result="";for(var _i6=0,pos=0;_i6<this.children.length&&pos<=to;_i6++){var child=this.children[_i6],end=pos+child.length;if(pos>from&&_i6)result+=lineSep;if(from<end&&to>pos)result+=child.sliceString(from-pos,to-pos,lineSep);pos=end+1;}return result;}},{key:"flatten",value:function flatten(target){var _iterator4=_createForOfIteratorHelper(this.children),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var child=_step4.value;child.flatten(target);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}},{key:"scanIdentical",value:function scanIdentical(other,dir){if(!(other instanceof TextNode))return 0;var length=0;var _ref=dir>0?[0,0,this.children.length,other.children.length]:[this.children.length-1,other.children.length-1,-1,-1],_ref2=_slicedToArray(_ref,4),iA=_ref2[0],iB=_ref2[1],eA=_ref2[2],eB=_ref2[3];for(;;iA+=dir,iB+=dir){if(iA==eA||iB==eB)return length;var chA=this.children[iA],chB=other.children[iB];if(chA!=chB)return length+chA.scanIdentical(chB,dir);length+=chA.length+1;}}}],[{key:"from",value:function from(children){var length=arguments.length>1&&arguments[1]!==undefined?arguments[1]:children.reduce(function(l,ch){return l+ch.length+1;},-1);var lines=0;var _iterator5=_createForOfIteratorHelper(children),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _ch=_step5.value;lines+=_ch.lines;}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}if(lines<32){var flat=[];var _iterator6=_createForOfIteratorHelper(children),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var ch=_step6.value;ch.flatten(flat);}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}return new TextLeaf(flat,length);}var chunk=Math.max(32,lines>>5),maxChunk=chunk<<1,minChunk=chunk>>1;var chunked=[],currentLines=0,currentLen=-1,currentChunk=[];function add2(child){var last;if(child.lines>maxChunk&&child instanceof TextNode){var _iterator7=_createForOfIteratorHelper(child.children),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var node=_step7.value;add2(node);}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}else if(child.lines>minChunk&&(currentLines>minChunk||!currentLines)){flush();chunked.push(child);}else if(child instanceof TextLeaf&&currentLines&&(last=currentChunk[currentChunk.length-1])instanceof TextLeaf&&child.lines+last.lines<=32){currentLines+=child.lines;currentLen+=child.length+1;currentChunk[currentChunk.length-1]=new TextLeaf(last.text.concat(child.text),last.length+1+child.length);}else{if(currentLines+child.lines>chunk)flush();currentLines+=child.lines;currentLen+=child.length+1;currentChunk.push(child);}}function flush(){if(currentLines==0)return;chunked.push(currentChunk.length==1?currentChunk[0]:TextNode.from(currentChunk,currentLen));currentLen=-1;currentLines=currentChunk.length=0;}var _iterator8=_createForOfIteratorHelper(children),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var child=_step8.value;add2(child);}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}flush();return chunked.length==1?chunked[0]:new TextNode(chunked,length);}}]);return TextNode;}(Text);Text.empty=/* @__PURE__ */new TextLeaf([""],0);function textLength(text){var length=-1;var _iterator9=_createForOfIteratorHelper(text),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var line=_step9.value;length+=line.length+1;}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}return length;}function appendText(text,target){var from=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var to=arguments.length>3&&arguments[3]!==undefined?arguments[3]:1e9;for(var pos=0,_i7=0,first=true;_i7<text.length&&pos<=to;_i7++){var line=text[_i7],end=pos+line.length;if(end>=from){if(end>to)line=line.slice(0,to-pos);if(pos<from)line=line.slice(from-pos);if(first){target[target.length-1]+=line;first=false;}else target.push(line);}pos=end+1;}return target;}function sliceText(text,from,to){return appendText(text,[""],from,to);}var RawTextCursor=/*#__PURE__*/function(){function RawTextCursor(text){var dir=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;_classCallCheck(this,RawTextCursor);this.dir=dir;this.done=false;this.lineBreak=false;this.value="";this.nodes=[text];this.offsets=[dir>0?1:(text instanceof TextLeaf?text.text.length:text.children.length)<<1];}_createClass(RawTextCursor,[{key:"nextInner",value:function nextInner(skip,dir){this.done=this.lineBreak=false;for(;;){var last=this.nodes.length-1;var top2=this.nodes[last],offsetValue=this.offsets[last],offset=offsetValue>>1;var size=top2 instanceof TextLeaf?top2.text.length:top2.children.length;if(offset==(dir>0?size:0)){if(last==0){this.done=true;this.value="";return this;}if(dir>0)this.offsets[last-1]++;this.nodes.pop();this.offsets.pop();}else if((offsetValue&1)==(dir>0?0:1)){this.offsets[last]+=dir;if(skip==0){this.lineBreak=true;this.value="\n";return this;}skip--;}else if(top2 instanceof TextLeaf){var next=top2.text[offset+(dir<0?-1:0)];this.offsets[last]+=dir;if(next.length>Math.max(0,skip)){this.value=skip==0?next:dir>0?next.slice(skip):next.slice(0,next.length-skip);return this;}skip-=next.length;}else{var _next=top2.children[offset+(dir<0?-1:0)];if(skip>_next.length){skip-=_next.length;this.offsets[last]+=dir;}else{if(dir<0)this.offsets[last]--;this.nodes.push(_next);this.offsets.push(dir>0?1:(_next instanceof TextLeaf?_next.text.length:_next.children.length)<<1);}}}}},{key:"next",value:function next(){var skip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(skip<0){this.nextInner(-skip,-this.dir);skip=this.value.length;}return this.nextInner(skip,this.dir);}}]);return RawTextCursor;}();var PartialTextCursor=/*#__PURE__*/function(){function PartialTextCursor(text,start,end){_classCallCheck(this,PartialTextCursor);this.value="";this.done=false;this.cursor=new RawTextCursor(text,start>end?-1:1);this.pos=start>end?text.length:0;this.from=Math.min(start,end);this.to=Math.max(start,end);}_createClass(PartialTextCursor,[{key:"nextInner",value:function nextInner(skip,dir){if(dir<0?this.pos<=this.from:this.pos>=this.to){this.value="";this.done=true;return this;}skip+=Math.max(0,dir<0?this.pos-this.to:this.from-this.pos);var limit=dir<0?this.pos-this.from:this.to-this.pos;if(skip>limit)skip=limit;limit-=skip;var _this$cursor$next=this.cursor.next(skip),value=_this$cursor$next.value;this.pos+=(value.length+skip)*dir;this.value=value.length<=limit?value:dir<0?value.slice(value.length-limit):value.slice(0,limit);this.done=!this.value;return this;}},{key:"next",value:function next(){var skip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(skip<0)skip=Math.max(skip,this.from-this.pos);else if(skip>0)skip=Math.min(skip,this.to-this.pos);return this.nextInner(skip,this.cursor.dir);}},{key:"lineBreak",get:function get(){return this.cursor.lineBreak&&this.value!="";}}]);return PartialTextCursor;}();var LineCursor=/*#__PURE__*/function(){function LineCursor(inner){_classCallCheck(this,LineCursor);this.inner=inner;this.afterBreak=true;this.value="";this.done=false;}_createClass(LineCursor,[{key:"next",value:function next(){var skip=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var _this$inner$next=this.inner.next(skip),done=_this$inner$next.done,lineBreak=_this$inner$next.lineBreak,value=_this$inner$next.value;if(done){this.done=true;this.value="";}else if(lineBreak){if(this.afterBreak){this.value="";}else{this.afterBreak=true;this.next();}}else{this.value=value;this.afterBreak=false;}return this;}},{key:"lineBreak",get:function get(){return false;}}]);return LineCursor;}();if(typeof Symbol!="undefined"){Text.prototype[Symbol.iterator]=function(){return this.iter();};RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this;};}var Line=/*#__PURE__*/function(){function Line(from,to,number2,text){_classCallCheck(this,Line);this.from=from;this.to=to;this.number=number2;this.text=text;}_createClass(Line,[{key:"length",get:function get(){return this.to-this.from;}}]);return Line;}();var extend=/* @__PURE__ */"lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(function(s){return s?parseInt(s,36):1;});for(var _i8=1;_i8<extend.length;_i8++){extend[_i8]+=extend[_i8-1];}function isExtendingChar(code){for(var _i9=1;_i9<extend.length;_i9+=2){if(extend[_i9]>code)return extend[_i9-1]<=code;}return false;}function isRegionalIndicator(code){return code>=127462&&code<=127487;}var ZWJ=8205;function findClusterBreak(str,pos){var forward=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var includeExtending=arguments.length>3&&arguments[3]!==undefined?arguments[3]:true;return(forward?nextClusterBreak:prevClusterBreak)(str,pos,includeExtending);}function nextClusterBreak(str,pos,includeExtending){if(pos==str.length)return pos;if(pos&&surrogateLow(str.charCodeAt(pos))&&surrogateHigh(str.charCodeAt(pos-1)))pos--;var prev=codePointAt(str,pos);pos+=codePointSize(prev);while(pos<str.length){var next=codePointAt(str,pos);if(prev==ZWJ||next==ZWJ||includeExtending&&isExtendingChar(next)){pos+=codePointSize(next);prev=next;}else if(isRegionalIndicator(next)){var countBefore=0,_i10=pos-2;while(_i10>=0&&isRegionalIndicator(codePointAt(str,_i10))){countBefore++;_i10-=2;}if(countBefore%2==0)break;else pos+=2;}else{break;}}return pos;}function prevClusterBreak(str,pos,includeExtending){while(pos>0){var found=nextClusterBreak(str,pos-2,includeExtending);if(found<pos)return found;pos--;}return 0;}function surrogateLow(ch){return ch>=56320&&ch<57344;}function surrogateHigh(ch){return ch>=55296&&ch<56320;}function codePointAt(str,pos){var code0=str.charCodeAt(pos);if(!surrogateHigh(code0)||pos+1==str.length)return code0;var code1=str.charCodeAt(pos+1);if(!surrogateLow(code1))return code0;return(code0-55296<<10)+(code1-56320)+65536;}function fromCodePoint(code){if(code<=65535)return String.fromCharCode(code);code-=65536;return String.fromCharCode((code>>10)+55296,(code&1023)+56320);}function codePointSize(code){return code<65536?1:2;}var DefaultSplit=/\r\n?|\n/;var MapMode=/* @__PURE__ */function(MapMode2){MapMode2[MapMode2["Simple"]=0]="Simple";MapMode2[MapMode2["TrackDel"]=1]="TrackDel";MapMode2[MapMode2["TrackBefore"]=2]="TrackBefore";MapMode2[MapMode2["TrackAfter"]=3]="TrackAfter";return MapMode2;}(MapMode||(MapMode={}));var ChangeDesc=/*#__PURE__*/function(){function ChangeDesc(sections){_classCallCheck(this,ChangeDesc);this.sections=sections;}_createClass(ChangeDesc,[{key:"length",get:function get(){var result=0;for(var _i11=0;_i11<this.sections.length;_i11+=2){result+=this.sections[_i11];}return result;}},{key:"newLength",get:function get(){var result=0;for(var _i12=0;_i12<this.sections.length;_i12+=2){var ins=this.sections[_i12+1];result+=ins<0?this.sections[_i12]:ins;}return result;}},{key:"empty",get:function get(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0;}},{key:"iterGaps",value:function iterGaps(f){for(var _i13=0,posA=0,posB=0;_i13<this.sections.length;){var len=this.sections[_i13++],ins=this.sections[_i13++];if(ins<0){f(posA,posB,len);posB+=len;}else{posB+=ins;}posA+=len;}}},{key:"iterChangedRanges",value:function iterChangedRanges(f){var individual=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;_iterChanges(this,f,individual);}},{key:"invertedDesc",get:function get(){var sections=[];for(var _i14=0;_i14<this.sections.length;){var len=this.sections[_i14++],ins=this.sections[_i14++];if(ins<0)sections.push(len,ins);else sections.push(ins,len);}return new ChangeDesc(sections);}},{key:"composeDesc",value:function composeDesc(other){return this.empty?other:other.empty?this:composeSets(this,other);}},{key:"mapDesc",value:function mapDesc(other){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return other.empty?this:mapSet(this,other,before);}},{key:"mapPos",value:function mapPos(pos){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:MapMode.Simple;var posA=0,posB=0;for(var _i15=0;_i15<this.sections.length;){var len=this.sections[_i15++],ins=this.sections[_i15++],endA=posA+len;if(ins<0){if(endA>pos)return posB+(pos-posA);posB+=len;}else{if(mode!=MapMode.Simple&&endA>=pos&&(mode==MapMode.TrackDel&&posA<pos&&endA>pos||mode==MapMode.TrackBefore&&posA<pos||mode==MapMode.TrackAfter&&endA>pos))return null;if(endA>pos||endA==pos&&assoc<0&&!len)return pos==posA||assoc<0?posB:posB+ins;posB+=ins;}posA=endA;}if(pos>posA)throw new RangeError("Position ".concat(pos," is out of range for changeset of length ").concat(posA));return posB;}},{key:"touchesRange",value:function touchesRange(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;for(var _i16=0,pos=0;_i16<this.sections.length&&pos<=to;){var len=this.sections[_i16++],ins=this.sections[_i16++],end=pos+len;if(ins>=0&&pos<=to&&end>=from)return pos<from&&end>to?"cover":true;pos=end;}return false;}},{key:"toString",value:function toString(){var result="";for(var _i17=0;_i17<this.sections.length;){var len=this.sections[_i17++],ins=this.sections[_i17++];result+=(result?" ":"")+len+(ins>=0?":"+ins:"");}return result;}},{key:"toJSON",value:function toJSON(){return this.sections;}}],[{key:"fromJSON",value:function fromJSON(json){if(!Array.isArray(json)||json.length%2||json.some(function(a){return typeof a!="number";}))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(json);}},{key:"create",value:function create(sections){return new ChangeDesc(sections);}}]);return ChangeDesc;}();var ChangeSet=/*#__PURE__*/function(_ChangeDesc){_inherits(ChangeSet,_ChangeDesc);var _super3=_createSuper(ChangeSet);function ChangeSet(sections,inserted){var _this3;_classCallCheck(this,ChangeSet);_this3=_super3.call(this,sections);_this3.inserted=inserted;return _this3;}_createClass(ChangeSet,[{key:"apply",value:function apply(doc2){if(this.length!=doc2.length)throw new RangeError("Applying change set to a document with the wrong length");_iterChanges(this,function(fromA,toA,fromB,_toB,text){return doc2=doc2.replace(fromB,fromB+(toA-fromA),text);},false);return doc2;}},{key:"mapDesc",value:function mapDesc(other){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return mapSet(this,other,before,true);}},{key:"invert",value:function invert(doc2){var sections=this.sections.slice(),inserted=[];for(var _i18=0,pos=0;_i18<sections.length;_i18+=2){var len=sections[_i18],ins=sections[_i18+1];if(ins>=0){sections[_i18]=ins;sections[_i18+1]=len;var index=_i18>>1;while(inserted.length<index){inserted.push(Text.empty);}inserted.push(len?doc2.slice(pos,pos+len):Text.empty);}pos+=len;}return new ChangeSet(sections,inserted);}},{key:"compose",value:function compose(other){return this.empty?other:other.empty?this:composeSets(this,other,true);}},{key:"map",value:function map(other){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return other.empty?this:mapSet(this,other,before,true);}},{key:"iterChanges",value:function iterChanges(f){var individual=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;_iterChanges(this,f,individual);}},{key:"desc",get:function get(){return ChangeDesc.create(this.sections);}},{key:"filter",value:function filter(ranges){var resultSections=[],resultInserted=[],filteredSections=[];var iter=new SectionIter(this);done:for(var _i19=0,pos=0;;){var next=_i19==ranges.length?1e9:ranges[_i19++];while(pos<next||pos==next&&iter.len==0){if(iter.done)break done;var len=Math.min(iter.len,next-pos);addSection(filteredSections,len,-1);var ins=iter.ins==-1?-1:iter.off==0?iter.ins:0;addSection(resultSections,len,ins);if(ins>0)addInsert(resultInserted,resultSections,iter.text);iter.forward(len);pos+=len;}var end=ranges[_i19++];while(pos<end){if(iter.done)break done;var _len=Math.min(iter.len,end-pos);addSection(resultSections,_len,-1);addSection(filteredSections,_len,iter.ins==-1?-1:iter.off==0?iter.ins:0);iter.forward(_len);pos+=_len;}}return{changes:new ChangeSet(resultSections,resultInserted),filtered:ChangeDesc.create(filteredSections)};}},{key:"toJSON",value:function toJSON(){var parts=[];for(var _i20=0;_i20<this.sections.length;_i20+=2){var len=this.sections[_i20],ins=this.sections[_i20+1];if(ins<0)parts.push(len);else if(ins==0)parts.push([len]);else parts.push([len].concat(this.inserted[_i20>>1].toJSON()));}return parts;}}],[{key:"of",value:function of(changes,length,lineSep){var sections=[],inserted=[],pos=0;var total=null;function flush(){var force=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!force&&!sections.length)return;if(pos<length)addSection(sections,length-pos,-1);var set=new ChangeSet(sections,inserted);total=total?total.compose(set.map(total)):set;sections=[];inserted=[];pos=0;}function process2(spec){if(Array.isArray(spec)){var _iterator10=_createForOfIteratorHelper(spec),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var sub=_step10.value;process2(sub);}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}}else if(spec instanceof ChangeSet){if(spec.length!=length)throw new RangeError("Mismatched change set length (got ".concat(spec.length,", expected ").concat(length,")"));flush();total=total?total.compose(spec.map(total)):spec;}else{var from=spec.from,_spec$to=spec.to,to=_spec$to===void 0?from:_spec$to,insert2=spec.insert;if(from>to||from<0||to>length)throw new RangeError("Invalid change range ".concat(from," to ").concat(to," (in doc of length ").concat(length,")"));var insText=!insert2?Text.empty:typeof insert2=="string"?Text.of(insert2.split(lineSep||DefaultSplit)):insert2;var insLen=insText.length;if(from==to&&insLen==0)return;if(from<pos)flush();if(from>pos)addSection(sections,from-pos,-1);addSection(sections,to-from,insLen);addInsert(inserted,sections,insText);pos=to;}}process2(changes);flush(!total);return total;}},{key:"empty",value:function empty(length){return new ChangeSet(length?[length,-1]:[],[]);}},{key:"fromJSON",value:function fromJSON(json){if(!Array.isArray(json))throw new RangeError("Invalid JSON representation of ChangeSet");var sections=[],inserted=[];for(var _i21=0;_i21<json.length;_i21++){var part=json[_i21];if(typeof part=="number"){sections.push(part,-1);}else if(!Array.isArray(part)||typeof part[0]!="number"||part.some(function(e,i2){return i2&&typeof e!="string";})){throw new RangeError("Invalid JSON representation of ChangeSet");}else if(part.length==1){sections.push(part[0],0);}else{while(inserted.length<_i21){inserted.push(Text.empty);}inserted[_i21]=Text.of(part.slice(1));sections.push(part[0],inserted[_i21].length);}}return new ChangeSet(sections,inserted);}},{key:"createSet",value:function createSet(sections,inserted){return new ChangeSet(sections,inserted);}}]);return ChangeSet;}(ChangeDesc);function addSection(sections,len,ins){var forceJoin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(len==0&&ins<=0)return;var last=sections.length-2;if(last>=0&&ins<=0&&ins==sections[last+1])sections[last]+=len;else if(len==0&&sections[last]==0)sections[last+1]+=ins;else if(forceJoin){sections[last]+=len;sections[last+1]+=ins;}else sections.push(len,ins);}function addInsert(values2,sections,value){if(value.length==0)return;var index=sections.length-2>>1;if(index<values2.length){values2[values2.length-1]=values2[values2.length-1].append(value);}else{while(values2.length<index){values2.push(Text.empty);}values2.push(value);}}function _iterChanges(desc,f,individual){var inserted=desc.inserted;for(var posA=0,posB=0,_i22=0;_i22<desc.sections.length;){var len=desc.sections[_i22++],ins=desc.sections[_i22++];if(ins<0){posA+=len;posB+=len;}else{var endA=posA,endB=posB,_text=Text.empty;for(;;){endA+=len;endB+=ins;if(ins&&inserted)_text=_text.append(inserted[_i22-2>>1]);if(individual||_i22==desc.sections.length||desc.sections[_i22+1]<0)break;len=desc.sections[_i22++];ins=desc.sections[_i22++];}f(posA,endA,posB,endB,_text);posA=endA;posB=endB;}}}function mapSet(setA,setB,before){var mkSet=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var sections=[],insert2=mkSet?[]:null;var a=new SectionIter(setA),b=new SectionIter(setB);for(var inserted=-1;;){if(a.ins==-1&&b.ins==-1){var len=Math.min(a.len,b.len);addSection(sections,len,-1);a.forward(len);b.forward(len);}else if(b.ins>=0&&(a.ins<0||inserted==a.i||a.off==0&&(b.len<a.len||b.len==a.len&&!before))){var _len2=b.len;addSection(sections,b.ins,-1);while(_len2){var piece=Math.min(a.len,_len2);if(a.ins>=0&&inserted<a.i&&a.len<=piece){addSection(sections,0,a.ins);if(insert2)addInsert(insert2,sections,a.text);inserted=a.i;}a.forward(piece);_len2-=piece;}b.next();}else if(a.ins>=0){var _len3=0,left=a.len;while(left){if(b.ins==-1){var _piece=Math.min(left,b.len);_len3+=_piece;left-=_piece;b.forward(_piece);}else if(b.ins==0&&b.len<left){left-=b.len;b.next();}else{break;}}addSection(sections,_len3,inserted<a.i?a.ins:0);if(insert2&&inserted<a.i)addInsert(insert2,sections,a.text);inserted=a.i;a.forward(a.len-left);}else if(a.done&&b.done){return insert2?ChangeSet.createSet(sections,insert2):ChangeDesc.create(sections);}else{throw new Error("Mismatched change set lengths");}}}function composeSets(setA,setB){var mkSet=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var sections=[];var insert2=mkSet?[]:null;var a=new SectionIter(setA),b=new SectionIter(setB);for(var open=false;;){if(a.done&&b.done){return insert2?ChangeSet.createSet(sections,insert2):ChangeDesc.create(sections);}else if(a.ins==0){addSection(sections,a.len,0,open);a.next();}else if(b.len==0&&!b.done){addSection(sections,0,b.ins,open);if(insert2)addInsert(insert2,sections,b.text);b.next();}else if(a.done||b.done){throw new Error("Mismatched change set lengths");}else{var len=Math.min(a.len2,b.len),sectionLen=sections.length;if(a.ins==-1){var insB=b.ins==-1?-1:b.off?0:b.ins;addSection(sections,len,insB,open);if(insert2&&insB)addInsert(insert2,sections,b.text);}else if(b.ins==-1){addSection(sections,a.off?0:a.len,len,open);if(insert2)addInsert(insert2,sections,a.textBit(len));}else{addSection(sections,a.off?0:a.len,b.off?0:b.ins,open);if(insert2&&!b.off)addInsert(insert2,sections,b.text);}open=(a.ins>len||b.ins>=0&&b.len>len)&&(open||sections.length>sectionLen);a.forward2(len);b.forward(len);}}}var SectionIter=/*#__PURE__*/function(){function SectionIter(set){_classCallCheck(this,SectionIter);this.set=set;this.i=0;this.next();}_createClass(SectionIter,[{key:"next",value:function next(){var sections=this.set.sections;if(this.i<sections.length){this.len=sections[this.i++];this.ins=sections[this.i++];}else{this.len=0;this.ins=-2;}this.off=0;}},{key:"done",get:function get(){return this.ins==-2;}},{key:"len2",get:function get(){return this.ins<0?this.len:this.ins;}},{key:"text",get:function get(){var inserted=this.set.inserted,index=this.i-2>>1;return index>=inserted.length?Text.empty:inserted[index];}},{key:"textBit",value:function textBit(len){var inserted=this.set.inserted,index=this.i-2>>1;return index>=inserted.length&&!len?Text.empty:inserted[index].slice(this.off,len==null?void 0:this.off+len);}},{key:"forward",value:function forward(len){if(len==this.len)this.next();else{this.len-=len;this.off+=len;}}},{key:"forward2",value:function forward2(len){if(this.ins==-1)this.forward(len);else if(len==this.ins)this.next();else{this.ins-=len;this.off+=len;}}}]);return SectionIter;}();var SelectionRange=/*#__PURE__*/function(){function SelectionRange(from,to,flags){_classCallCheck(this,SelectionRange);this.from=from;this.to=to;this.flags=flags;}_createClass(SelectionRange,[{key:"anchor",get:function get(){return this.flags&32?this.to:this.from;}},{key:"head",get:function get(){return this.flags&32?this.from:this.to;}},{key:"empty",get:function get(){return this.from==this.to;}},{key:"assoc",get:function get(){return this.flags&8?-1:this.flags&16?1:0;}},{key:"bidiLevel",get:function get(){var level=this.flags&7;return level==7?null:level;}},{key:"goalColumn",get:function get(){var value=this.flags>>6;return value==16777215?void 0:value;}},{key:"map",value:function map(change){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;var from,to;if(this.empty){from=to=change.mapPos(this.from,assoc);}else{from=change.mapPos(this.from,1);to=change.mapPos(this.to,-1);}return from==this.from&&to==this.to?this:new SelectionRange(from,to,this.flags);}},{key:"extend",value:function extend(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(from<=this.anchor&&to>=this.anchor)return EditorSelection.range(from,to);var head=Math.abs(from-this.anchor)>Math.abs(to-this.anchor)?from:to;return EditorSelection.range(this.anchor,head);}},{key:"eq",value:function eq(other){return this.anchor==other.anchor&&this.head==other.head;}},{key:"toJSON",value:function toJSON(){return{anchor:this.anchor,head:this.head};}}],[{key:"fromJSON",value:function fromJSON(json){if(!json||typeof json.anchor!="number"||typeof json.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(json.anchor,json.head);}},{key:"create",value:function create(from,to,flags){return new SelectionRange(from,to,flags);}}]);return SelectionRange;}();var EditorSelection=/*#__PURE__*/function(){function EditorSelection(ranges,mainIndex){_classCallCheck(this,EditorSelection);this.ranges=ranges;this.mainIndex=mainIndex;}_createClass(EditorSelection,[{key:"map",value:function map(change){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1;if(change.empty)return this;return EditorSelection.create(this.ranges.map(function(r){return r.map(change,assoc);}),this.mainIndex);}},{key:"eq",value:function eq(other){if(this.ranges.length!=other.ranges.length||this.mainIndex!=other.mainIndex)return false;for(var _i23=0;_i23<this.ranges.length;_i23++){if(!this.ranges[_i23].eq(other.ranges[_i23]))return false;}return true;}},{key:"main",get:function get(){return this.ranges[this.mainIndex];}},{key:"asSingle",value:function asSingle(){return this.ranges.length==1?this:new EditorSelection([this.main],0);}},{key:"addRange",value:function addRange(range){var main=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return EditorSelection.create([range].concat(this.ranges),main?0:this.mainIndex+1);}},{key:"replaceRange",value:function replaceRange(range){var which=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.mainIndex;var ranges=this.ranges.slice();ranges[which]=range;return EditorSelection.create(ranges,this.mainIndex);}},{key:"toJSON",value:function toJSON(){return{ranges:this.ranges.map(function(r){return r.toJSON();}),main:this.mainIndex};}}],[{key:"fromJSON",value:function fromJSON(json){if(!json||!Array.isArray(json.ranges)||typeof json.main!="number"||json.main>=json.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(json.ranges.map(function(r){return SelectionRange.fromJSON(r);}),json.main);}},{key:"single",value:function single(anchor){var head=arguments.length>1&&arguments[1]!==undefined?arguments[1]:anchor;return new EditorSelection([EditorSelection.range(anchor,head)],0);}},{key:"create",value:function create(ranges){var mainIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(ranges.length==0)throw new RangeError("A selection needs at least one range");for(var pos=0,_i24=0;_i24<ranges.length;_i24++){var range=ranges[_i24];if(range.empty?range.from<=pos:range.from<pos)return EditorSelection.normalized(ranges.slice(),mainIndex);pos=range.to;}return new EditorSelection(ranges,mainIndex);}},{key:"cursor",value:function cursor(pos){var assoc=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var bidiLevel=arguments.length>2?arguments[2]:undefined;var goalColumn=arguments.length>3?arguments[3]:undefined;return SelectionRange.create(pos,pos,(assoc==0?0:assoc<0?8:16)|(bidiLevel==null?7:Math.min(6,bidiLevel))|(goalColumn!==null&&goalColumn!==void 0?goalColumn:16777215)<<6);}},{key:"range",value:function range(anchor,head,goalColumn,bidiLevel){var flags=(goalColumn!==null&&goalColumn!==void 0?goalColumn:16777215)<<6|(bidiLevel==null?7:Math.min(6,bidiLevel));return head<anchor?SelectionRange.create(head,anchor,32|16|flags):SelectionRange.create(anchor,head,(head>anchor?8:0)|flags);}},{key:"normalized",value:function normalized(ranges){var mainIndex=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var main=ranges[mainIndex];ranges.sort(function(a,b){return a.from-b.from;});mainIndex=ranges.indexOf(main);for(var _i25=1;_i25<ranges.length;_i25++){var range=ranges[_i25],prev=ranges[_i25-1];if(range.empty?range.from<=prev.to:range.from<prev.to){var from=prev.from,to=Math.max(range.to,prev.to);if(_i25<=mainIndex)mainIndex--;ranges.splice(--_i25,2,range.anchor>range.head?EditorSelection.range(to,from):EditorSelection.range(from,to));}}return new EditorSelection(ranges,mainIndex);}}]);return EditorSelection;}();function checkSelection(selection2,docLength){var _iterator11=_createForOfIteratorHelper(selection2.ranges),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var range=_step11.value;if(range.to>docLength)throw new RangeError("Selection points outside of document");}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}}var nextID=0;var Facet=/*#__PURE__*/function(){function Facet(combine,compareInput,compare2,isStatic,enables){_classCallCheck(this,Facet);this.combine=combine;this.compareInput=compareInput;this.compare=compare2;this.isStatic=isStatic;this.id=nextID++;this["default"]=combine([]);this.extensions=typeof enables=="function"?enables(this):enables;}_createClass(Facet,[{key:"reader",get:function get(){return this;}},{key:"of",value:function of(value){return new FacetProvider([],this,0,value);}},{key:"compute",value:function compute(deps,get){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(deps,this,1,get);}},{key:"computeN",value:function computeN(deps,get){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(deps,this,2,get);}},{key:"from",value:function from(field,get){if(!get)get=function get(x){return x;};return this.compute([field],function(state){return get(state.field(field));});}}],[{key:"define",value:function define(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new Facet(config2.combine||function(a){return a;},config2.compareInput||function(a,b){return a===b;},config2.compare||(!config2.combine?sameArray:function(a,b){return a===b;}),!!config2["static"],config2.enables);}}]);return Facet;}();function sameArray(a,b){return a==b||a.length==b.length&&a.every(function(e,i){return e===b[i];});}var FacetProvider=/*#__PURE__*/function(){function FacetProvider(dependencies,facet,type,value){_classCallCheck(this,FacetProvider);this.dependencies=dependencies;this.facet=facet;this.type=type;this.value=value;this.id=nextID++;}_createClass(FacetProvider,[{key:"dynamicSlot",value:function dynamicSlot(addresses){var _this4=this;var _a2;var getter=this.value;var compare2=this.facet.compareInput;var id2=this.id,idx=addresses[id2]>>1,multi=this.type==2;var depDoc=false,depSel=false,depAddrs=[];var _iterator12=_createForOfIteratorHelper(this.dependencies),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var dep=_step12.value;if(dep=="doc")depDoc=true;else if(dep=="selection")depSel=true;else if((((_a2=addresses[dep.id])!==null&&_a2!==void 0?_a2:1)&1)==0)depAddrs.push(addresses[dep.id]);}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}return{create:function create(state){state.values[idx]=getter(state);return 1;},update:function update(state,tr){if(depDoc&&tr.docChanged||depSel&&(tr.docChanged||tr.selection)||ensureAll(state,depAddrs)){var newVal=getter(state);if(multi?!compareArray(newVal,state.values[idx],compare2):!compare2(newVal,state.values[idx])){state.values[idx]=newVal;return 1;}}return 0;},reconfigure:function reconfigure(state,oldState){var newVal,oldAddr=oldState.config.address[id2];if(oldAddr!=null){var oldVal=getAddr(oldState,oldAddr);if(_this4.dependencies.every(function(dep){return dep instanceof Facet?oldState.facet(dep)===state.facet(dep):dep instanceof StateField?oldState.field(dep,false)==state.field(dep,false):true;})||(multi?compareArray(newVal=getter(state),oldVal,compare2):compare2(newVal=getter(state),oldVal))){state.values[idx]=oldVal;return 0;}}else{newVal=getter(state);}state.values[idx]=newVal;return 1;}};}}]);return FacetProvider;}();function compareArray(a,b,compare2){if(a.length!=b.length)return false;for(var _i26=0;_i26<a.length;_i26++){if(!compare2(a[_i26],b[_i26]))return false;}return true;}function ensureAll(state,addrs){var changed=false;var _iterator13=_createForOfIteratorHelper(addrs),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var addr=_step13.value;if(ensureAddr(state,addr)&1)changed=true;}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}return changed;}function dynamicFacetSlot(addresses,facet,providers){var providerAddrs=providers.map(function(p){return addresses[p.id];});var providerTypes=providers.map(function(p){return p.type;});var dynamic=providerAddrs.filter(function(p){return!(p&1);});var idx=addresses[facet.id]>>1;function get(state){var values2=[];for(var _i27=0;_i27<providerAddrs.length;_i27++){var value=getAddr(state,providerAddrs[_i27]);if(providerTypes[_i27]==2){var _iterator14=_createForOfIteratorHelper(value),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var val=_step14.value;values2.push(val);}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}}else values2.push(value);}return facet.combine(values2);}return{create:function create(state){var _iterator15=_createForOfIteratorHelper(providerAddrs),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var addr=_step15.value;ensureAddr(state,addr);}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}state.values[idx]=get(state);return 1;},update:function update(state,tr){if(!ensureAll(state,dynamic))return 0;var value=get(state);if(facet.compare(value,state.values[idx]))return 0;state.values[idx]=value;return 1;},reconfigure:function reconfigure(state,oldState){var depChanged=ensureAll(state,providerAddrs);var oldProviders=oldState.config.facets[facet.id],oldValue=oldState.facet(facet);if(oldProviders&&!depChanged&&sameArray(providers,oldProviders)){state.values[idx]=oldValue;return 0;}var value=get(state);if(facet.compare(value,oldValue)){state.values[idx]=oldValue;return 0;}state.values[idx]=value;return 1;}};}var initField=/* @__PURE__ */Facet.define({"static":true});var StateField=/*#__PURE__*/function(){function StateField(id2,createF,updateF,compareF,spec){_classCallCheck(this,StateField);this.id=id2;this.createF=createF;this.updateF=updateF;this.compareF=compareF;this.spec=spec;this.provides=void 0;}_createClass(StateField,[{key:"create",value:function create(state){var _this5=this;var init=state.facet(initField).find(function(i){return i.field==_this5;});return((init===null||init===void 0?void 0:init.create)||this.createF)(state);}},{key:"slot",value:function slot(addresses){var _this6=this;var idx=addresses[this.id]>>1;return{create:function create(state){state.values[idx]=_this6.create(state);return 1;},update:function update(state,tr){var oldVal=state.values[idx];var value=_this6.updateF(oldVal,tr);if(_this6.compareF(oldVal,value))return 0;state.values[idx]=value;return 1;},reconfigure:function reconfigure(state,oldState){if(oldState.config.address[_this6.id]!=null){state.values[idx]=oldState.field(_this6);return 0;}state.values[idx]=_this6.create(state);return 1;}};}},{key:"init",value:function init(create){return[this,initField.of({field:this,create:create})];}},{key:"extension",get:function get(){return this;}}],[{key:"define",value:function define(config2){var field=new StateField(nextID++,config2.create,config2.update,config2.compare||function(a,b){return a===b;},config2);if(config2.provide)field.provides=config2.provide(field);return field;}}]);return StateField;}();var Prec_={lowest:4,low:3,"default":2,high:1,highest:0};function prec(value){return function(ext){return new PrecExtension(ext,value);};}var Prec={highest:/* @__PURE__ */prec(Prec_.highest),high:/* @__PURE__ */prec(Prec_.high),"default":/* @__PURE__ */prec(Prec_["default"]),low:/* @__PURE__ */prec(Prec_.low),lowest:/* @__PURE__ */prec(Prec_.lowest)};var PrecExtension=/*#__PURE__*/_createClass(function PrecExtension(inner,prec2){_classCallCheck(this,PrecExtension);this.inner=inner;this.prec=prec2;});var Compartment=/*#__PURE__*/function(){function Compartment(){_classCallCheck(this,Compartment);}_createClass(Compartment,[{key:"of",value:function of(ext){return new CompartmentInstance(this,ext);}},{key:"reconfigure",value:function reconfigure(content2){return Compartment.reconfigure.of({compartment:this,extension:content2});}},{key:"get",value:function get(state){return state.config.compartments.get(this);}}]);return Compartment;}();var CompartmentInstance=/*#__PURE__*/_createClass(function CompartmentInstance(compartment,inner){_classCallCheck(this,CompartmentInstance);this.compartment=compartment;this.inner=inner;});var Configuration=/*#__PURE__*/function(){function Configuration(base2,compartments,dynamicSlots,address,staticValues,facets){_classCallCheck(this,Configuration);this.base=base2;this.compartments=compartments;this.dynamicSlots=dynamicSlots;this.address=address;this.staticValues=staticValues;this.facets=facets;this.statusTemplate=[];while(this.statusTemplate.length<dynamicSlots.length){this.statusTemplate.push(0);}}_createClass(Configuration,[{key:"staticFacet",value:function staticFacet(facet){var addr=this.address[facet.id];return addr==null?facet["default"]:this.staticValues[addr>>1];}}],[{key:"resolve",value:function resolve(base2,compartments,oldState){var fields=[];var facets=/* @__PURE__ */Object.create(null);var newCompartments=/* @__PURE__ */new Map();var _iterator16=_createForOfIteratorHelper(flatten(base2,compartments,newCompartments)),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var ext=_step16.value;if(ext instanceof StateField)fields.push(ext);else(facets[ext.facet.id]||(facets[ext.facet.id]=[])).push(ext);}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}var address=/* @__PURE__ */Object.create(null);var staticValues=[];var dynamicSlots=[];var _loop=function _loop(){var field=_fields[_i28];address[field.id]=dynamicSlots.length<<1;dynamicSlots.push(function(a){return field.slot(a);});};for(var _i28=0,_fields=fields;_i28<_fields.length;_i28++){_loop();}var oldFacets=oldState===null||oldState===void 0?void 0:oldState.config.facets;var _loop2=function _loop2(id2){var providers=facets[id2],facet=providers[0].facet;var oldProviders=oldFacets&&oldFacets[id2]||[];if(providers.every(function(p){return p.type==0;})){address[facet.id]=staticValues.length<<1|1;if(sameArray(oldProviders,providers)){staticValues.push(oldState.facet(facet));}else{var value=facet.combine(providers.map(function(p){return p.value;}));staticValues.push(oldState&&facet.compare(value,oldState.facet(facet))?oldState.facet(facet):value);}}else{var _iterator17=_createForOfIteratorHelper(providers),_step17;try{var _loop3=function _loop3(){var p=_step17.value;if(p.type==0){address[p.id]=staticValues.length<<1|1;staticValues.push(p.value);}else{address[p.id]=dynamicSlots.length<<1;dynamicSlots.push(function(a){return p.dynamicSlot(a);});}};for(_iterator17.s();!(_step17=_iterator17.n()).done;){_loop3();}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}address[facet.id]=dynamicSlots.length<<1;dynamicSlots.push(function(a){return dynamicFacetSlot(a,facet,providers);});}};for(var id2 in facets){_loop2(id2);}var dynamic=dynamicSlots.map(function(f){return f(address);});return new Configuration(base2,newCompartments,dynamic,address,staticValues,facets);}}]);return Configuration;}();function flatten(extension,compartments,newCompartments){var result=[[],[],[],[],[]];var seen=/* @__PURE__ */new Map();function inner(ext,prec2){var known=seen.get(ext);if(known!=null){if(known<=prec2)return;var found=result[known].indexOf(ext);if(found>-1)result[known].splice(found,1);if(ext instanceof CompartmentInstance)newCompartments["delete"](ext.compartment);}seen.set(ext,prec2);if(Array.isArray(ext)){var _iterator18=_createForOfIteratorHelper(ext),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var e=_step18.value;inner(e,prec2);}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}else if(ext instanceof CompartmentInstance){if(newCompartments.has(ext.compartment))throw new RangeError("Duplicate use of compartment in extensions");var content2=compartments.get(ext.compartment)||ext.inner;newCompartments.set(ext.compartment,content2);inner(content2,prec2);}else if(ext instanceof PrecExtension){inner(ext.inner,ext.prec);}else if(ext instanceof StateField){result[prec2].push(ext);if(ext.provides)inner(ext.provides,prec2);}else if(ext instanceof FacetProvider){result[prec2].push(ext);if(ext.facet.extensions)inner(ext.facet.extensions,Prec_["default"]);}else{var _content2=ext.extension;if(!_content2)throw new Error("Unrecognized extension value in extension set (".concat(ext,"). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks."));inner(_content2,prec2);}}inner(extension,Prec_["default"]);return result.reduce(function(a,b){return a.concat(b);});}function ensureAddr(state,addr){if(addr&1)return 2;var idx=addr>>1;var status=state.status[idx];if(status==4)throw new Error("Cyclic dependency between fields and/or facets");if(status&2)return status;state.status[idx]=4;var changed=state.computeSlot(state,state.config.dynamicSlots[idx]);return state.status[idx]=2|changed;}function getAddr(state,addr){return addr&1?state.config.staticValues[addr>>1]:state.values[addr>>1];}var languageData=/* @__PURE__ */Facet.define();var allowMultipleSelections=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.some(function(v){return v;});},"static":true});var lineSeparator=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.length?values2[0]:void 0;},"static":true});var changeFilter=/* @__PURE__ */Facet.define();var transactionFilter=/* @__PURE__ */Facet.define();var transactionExtender=/* @__PURE__ */Facet.define();var readOnly=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.length?values2[0]:false;}});var Annotation=/*#__PURE__*/function(){function Annotation(type,value){_classCallCheck(this,Annotation);this.type=type;this.value=value;}_createClass(Annotation,null,[{key:"define",value:function define(){return new AnnotationType();}}]);return Annotation;}();var AnnotationType=/*#__PURE__*/function(){function AnnotationType(){_classCallCheck(this,AnnotationType);}_createClass(AnnotationType,[{key:"of",value:function of(value){return new Annotation(this,value);}}]);return AnnotationType;}();var StateEffectType=/*#__PURE__*/function(){function StateEffectType(map){_classCallCheck(this,StateEffectType);this.map=map;}_createClass(StateEffectType,[{key:"of",value:function of(value){return new StateEffect(this,value);}}]);return StateEffectType;}();var StateEffect=/*#__PURE__*/function(){function StateEffect(type,value){_classCallCheck(this,StateEffect);this.type=type;this.value=value;}_createClass(StateEffect,[{key:"map",value:function map(mapping){var mapped=this.type.map(this.value,mapping);return mapped===void 0?void 0:mapped==this.value?this:new StateEffect(this.type,mapped);}},{key:"is",value:function is(type){return this.type==type;}}],[{key:"define",value:function define(){var spec=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new StateEffectType(spec.map||function(v){return v;});}},{key:"mapEffects",value:function mapEffects(effects,mapping){if(!effects.length)return effects;var result=[];var _iterator19=_createForOfIteratorHelper(effects),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var effect=_step19.value;var mapped=effect.map(mapping);if(mapped)result.push(mapped);}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}return result;}}]);return StateEffect;}();StateEffect.reconfigure=/* @__PURE__ */StateEffect.define();StateEffect.appendConfig=/* @__PURE__ */StateEffect.define();var Transaction=/*#__PURE__*/function(){function Transaction(startState,changes,selection2,effects,annotations,scrollIntoView3){_classCallCheck(this,Transaction);this.startState=startState;this.changes=changes;this.selection=selection2;this.effects=effects;this.annotations=annotations;this.scrollIntoView=scrollIntoView3;this._doc=null;this._state=null;if(selection2)checkSelection(selection2,changes.newLength);if(!annotations.some(function(a){return a.type==Transaction.time;}))this.annotations=annotations.concat(Transaction.time.of(Date.now()));}_createClass(Transaction,[{key:"newDoc",get:function get(){return this._doc||(this._doc=this.changes.apply(this.startState.doc));}},{key:"newSelection",get:function get(){return this.selection||this.startState.selection.map(this.changes);}},{key:"state",get:function get(){if(!this._state)this.startState.applyTransaction(this);return this._state;}},{key:"annotation",value:function annotation(type){var _iterator20=_createForOfIteratorHelper(this.annotations),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var ann=_step20.value;if(ann.type==type)return ann.value;}}catch(err){_iterator20.e(err);}finally{_iterator20.f();}return void 0;}},{key:"docChanged",get:function get(){return!this.changes.empty;}},{key:"reconfigured",get:function get(){return this.startState.config!=this.state.config;}},{key:"isUserEvent",value:function isUserEvent(event){var e=this.annotation(Transaction.userEvent);return!!(e&&(e==event||e.length>event.length&&e.slice(0,event.length)==event&&e[event.length]=="."));}}],[{key:"create",value:function create(startState,changes,selection2,effects,annotations,scrollIntoView3){return new Transaction(startState,changes,selection2,effects,annotations,scrollIntoView3);}}]);return Transaction;}();Transaction.time=/* @__PURE__ */Annotation.define();Transaction.userEvent=/* @__PURE__ */Annotation.define();Transaction.addToHistory=/* @__PURE__ */Annotation.define();Transaction.remote=/* @__PURE__ */Annotation.define();function joinRanges(a,b){var result=[];for(var iA=0,iB=0;;){var from=void 0,to=void 0;if(iA<a.length&&(iB==b.length||b[iB]>=a[iA])){from=a[iA++];to=a[iA++];}else if(iB<b.length){from=b[iB++];to=b[iB++];}else return result;if(!result.length||result[result.length-1]<from)result.push(from,to);else if(result[result.length-1]<to)result[result.length-1]=to;}}function mergeTransaction(a,b,sequential){var _a2;var mapForA,mapForB,changes;if(sequential){mapForA=b.changes;mapForB=ChangeSet.empty(b.changes.length);changes=a.changes.compose(b.changes);}else{mapForA=b.changes.map(a.changes);mapForB=a.changes.mapDesc(b.changes,true);changes=a.changes.compose(mapForA);}return{changes:changes,selection:b.selection?b.selection.map(mapForB):(_a2=a.selection)===null||_a2===void 0?void 0:_a2.map(mapForA),effects:StateEffect.mapEffects(a.effects,mapForA).concat(StateEffect.mapEffects(b.effects,mapForB)),annotations:a.annotations.length?a.annotations.concat(b.annotations):b.annotations,scrollIntoView:a.scrollIntoView||b.scrollIntoView};}function resolveTransactionInner(state,spec,docSize){var sel=spec.selection,annotations=asArray(spec.annotations);if(spec.userEvent)annotations=annotations.concat(Transaction.userEvent.of(spec.userEvent));return{changes:spec.changes instanceof ChangeSet?spec.changes:ChangeSet.of(spec.changes||[],docSize,state.facet(lineSeparator)),selection:sel&&(sel instanceof EditorSelection?sel:EditorSelection.single(sel.anchor,sel.head)),effects:asArray(spec.effects),annotations:annotations,scrollIntoView:!!spec.scrollIntoView};}function resolveTransaction(state,specs,filter){var s=resolveTransactionInner(state,specs.length?specs[0]:{},state.doc.length);if(specs.length&&specs[0].filter===false)filter=false;for(var _i29=1;_i29<specs.length;_i29++){if(specs[_i29].filter===false)filter=false;var seq=!!specs[_i29].sequential;s=mergeTransaction(s,resolveTransactionInner(state,specs[_i29],seq?s.changes.newLength:state.doc.length),seq);}var tr=Transaction.create(state,s.changes,s.selection,s.effects,s.annotations,s.scrollIntoView);return extendTransaction(filter?filterTransaction(tr):tr);}function filterTransaction(tr){var state=tr.startState;var result=true;var _iterator21=_createForOfIteratorHelper(state.facet(changeFilter)),_step21;try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var filter=_step21.value;var value=filter(tr);if(value===false){result=false;break;}if(Array.isArray(value))result=result===true?value:joinRanges(result,value);}}catch(err){_iterator21.e(err);}finally{_iterator21.f();}if(result!==true){var changes,back;if(result===false){back=tr.changes.invertedDesc;changes=ChangeSet.empty(state.doc.length);}else{var filtered=tr.changes.filter(result);changes=filtered.changes;back=filtered.filtered.mapDesc(filtered.changes).invertedDesc;}tr=Transaction.create(state,changes,tr.selection&&tr.selection.map(back),StateEffect.mapEffects(tr.effects,back),tr.annotations,tr.scrollIntoView);}var filters=state.facet(transactionFilter);for(var _i30=filters.length-1;_i30>=0;_i30--){var _filtered=filters[_i30](tr);if(_filtered instanceof Transaction)tr=_filtered;else if(Array.isArray(_filtered)&&_filtered.length==1&&_filtered[0]instanceof Transaction)tr=_filtered[0];else tr=resolveTransaction(state,asArray(_filtered),false);}return tr;}function extendTransaction(tr){var state=tr.startState,extenders=state.facet(transactionExtender),spec=tr;for(var _i31=extenders.length-1;_i31>=0;_i31--){var extension=extenders[_i31](tr);if(extension&&Object.keys(extension).length)spec=mergeTransaction(spec,resolveTransactionInner(state,extension,tr.changes.newLength),true);}return spec==tr?tr:Transaction.create(state,tr.changes,tr.selection,spec.effects,spec.annotations,spec.scrollIntoView);}var none=[];function asArray(value){return value==null?none:Array.isArray(value)?value:[value];}var CharCategory=/* @__PURE__ */function(CharCategory2){CharCategory2[CharCategory2["Word"]=0]="Word";CharCategory2[CharCategory2["Space"]=1]="Space";CharCategory2[CharCategory2["Other"]=2]="Other";return CharCategory2;}(CharCategory||(CharCategory={}));var nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var wordChar;try{wordChar=/* @__PURE__ */new RegExp("[\\p{Alphabetic}\\p{Number}_]","u");}catch(_){}function hasWordChar(str){if(wordChar)return wordChar.test(str);for(var _i32=0;_i32<str.length;_i32++){var ch=str[_i32];if(/\w/.test(ch)||ch>"\x80"&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch)))return true;}return false;}function makeCategorizer(wordChars){return function(_char){if(!/\S/.test(_char))return CharCategory.Space;if(hasWordChar(_char))return CharCategory.Word;for(var _i33=0;_i33<wordChars.length;_i33++){if(_char.indexOf(wordChars[_i33])>-1)return CharCategory.Word;}return CharCategory.Other;};}var EditorState=/*#__PURE__*/function(){function EditorState(config2,doc2,selection2,values2,computeSlot,tr){_classCallCheck(this,EditorState);this.config=config2;this.doc=doc2;this.selection=selection2;this.values=values2;this.status=config2.statusTemplate.slice();this.computeSlot=computeSlot;if(tr)tr._state=this;for(var _i34=0;_i34<this.config.dynamicSlots.length;_i34++){ensureAddr(this,_i34<<1);}this.computeSlot=null;}_createClass(EditorState,[{key:"field",value:function field(_field){var require2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var addr=this.config.address[_field.id];if(addr==null){if(require2)throw new RangeError("Field is not present in this state");return void 0;}ensureAddr(this,addr);return getAddr(this,addr);}},{key:"update",value:function update(){for(var _len4=arguments.length,specs=new Array(_len4),_key=0;_key<_len4;_key++){specs[_key]=arguments[_key];}return resolveTransaction(this,specs,true);}},{key:"applyTransaction",value:function applyTransaction(tr){var _this7=this;var conf=this.config,_conf=conf,base2=_conf.base,compartments=_conf.compartments;var _iterator22=_createForOfIteratorHelper(tr.effects),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var effect=_step22.value;if(effect.is(Compartment.reconfigure)){if(conf){compartments=/* @__PURE__ */new Map();conf.compartments.forEach(function(val,key){return compartments.set(key,val);});conf=null;}compartments.set(effect.value.compartment,effect.value.extension);}else if(effect.is(StateEffect.reconfigure)){conf=null;base2=effect.value;}else if(effect.is(StateEffect.appendConfig)){conf=null;base2=asArray(base2).concat(effect.value);}}}catch(err){_iterator22.e(err);}finally{_iterator22.f();}var startValues;if(!conf){conf=Configuration.resolve(base2,compartments,this);var intermediateState=new EditorState(conf,this.doc,this.selection,conf.dynamicSlots.map(function(){return null;}),function(state,slot){return slot.reconfigure(state,_this7);},null);startValues=intermediateState.values;}else{startValues=tr.startState.values.slice();}new EditorState(conf,tr.newDoc,tr.newSelection,startValues,function(state,slot){return slot.update(state,tr);},tr);}},{key:"replaceSelection",value:function replaceSelection(text){if(typeof text=="string")text=this.toText(text);return this.changeByRange(function(range){return{changes:{from:range.from,to:range.to,insert:text},range:EditorSelection.cursor(range.from+text.length)};});}},{key:"changeByRange",value:function changeByRange(f){var sel=this.selection;var result1=f(sel.ranges[0]);var changes=this.changes(result1.changes),ranges=[result1.range];var effects=asArray(result1.effects);for(var _i35=1;_i35<sel.ranges.length;_i35++){var result=f(sel.ranges[_i35]);var newChanges=this.changes(result.changes),newMapped=newChanges.map(changes);for(var j=0;j<_i35;j++){ranges[j]=ranges[j].map(newMapped);}var mapBy=changes.mapDesc(newChanges,true);ranges.push(result.range.map(mapBy));changes=changes.compose(newMapped);effects=StateEffect.mapEffects(effects,newMapped).concat(StateEffect.mapEffects(asArray(result.effects),mapBy));}return{changes:changes,selection:EditorSelection.create(ranges,sel.mainIndex),effects:effects};}},{key:"changes",value:function changes(){var spec=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(spec instanceof ChangeSet)return spec;return ChangeSet.of(spec,this.doc.length,this.facet(EditorState.lineSeparator));}},{key:"toText",value:function toText(string2){return Text.of(string2.split(this.facet(EditorState.lineSeparator)||DefaultSplit));}},{key:"sliceDoc",value:function sliceDoc(){var from=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.doc.length;return this.doc.sliceString(from,to,this.lineBreak);}},{key:"facet",value:function facet(_facet){var addr=this.config.address[_facet.id];if(addr==null)return _facet["default"];ensureAddr(this,addr);return getAddr(this,addr);}},{key:"toJSON",value:function toJSON(fields){var result={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(fields)for(var prop in fields){var value=fields[prop];if(value instanceof StateField&&this.config.address[value.id]!=null)result[prop]=value.spec.toJSON(this.field(fields[prop]),this);}return result;}},{key:"tabSize",get:function get(){return this.facet(EditorState.tabSize);}},{key:"lineBreak",get:function get(){return this.facet(EditorState.lineSeparator)||"\n";}},{key:"readOnly",get:function get(){return this.facet(readOnly);}},{key:"phrase",value:function phrase(phrase2){for(var _len5=arguments.length,insert2=new Array(_len5>1?_len5-1:0),_key2=1;_key2<_len5;_key2++){insert2[_key2-1]=arguments[_key2];}var _iterator23=_createForOfIteratorHelper(this.facet(EditorState.phrases)),_step23;try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var map=_step23.value;if(Object.prototype.hasOwnProperty.call(map,phrase2)){phrase2=map[phrase2];break;}}}catch(err){_iterator23.e(err);}finally{_iterator23.f();}if(insert2.length)phrase2=phrase2.replace(/\$(\$|\d*)/g,function(m,i){if(i=="$")return"$";var n=+(i||1);return!n||n>insert2.length?m:insert2[n-1];});return phrase2;}},{key:"languageDataAt",value:function languageDataAt(name2,pos){var side=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;var values2=[];var _iterator24=_createForOfIteratorHelper(this.facet(languageData)),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var provider=_step24.value;var _iterator25=_createForOfIteratorHelper(provider(this,pos,side)),_step25;try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var result=_step25.value;if(Object.prototype.hasOwnProperty.call(result,name2))values2.push(result[name2]);}}catch(err){_iterator25.e(err);}finally{_iterator25.f();}}}catch(err){_iterator24.e(err);}finally{_iterator24.f();}return values2;}},{key:"charCategorizer",value:function charCategorizer(at){return makeCategorizer(this.languageDataAt("wordChars",at).join(""));}},{key:"wordAt",value:function wordAt(pos){var _this$doc$lineAt=this.doc.lineAt(pos),text=_this$doc$lineAt.text,from=_this$doc$lineAt.from,length=_this$doc$lineAt.length;var cat=this.charCategorizer(pos);var start=pos-from,end=pos-from;while(start>0){var prev=findClusterBreak(text,start,false);if(cat(text.slice(prev,start))!=CharCategory.Word)break;start=prev;}while(end<length){var next=findClusterBreak(text,end);if(cat(text.slice(end,next))!=CharCategory.Word)break;end=next;}return start==end?null:EditorSelection.range(start+from,end+from);}}],[{key:"fromJSON",value:function fromJSON(json){var config2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var fields=arguments.length>2?arguments[2]:undefined;if(!json||typeof json.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");var fieldInit=[];if(fields)for(var prop in fields){if(Object.prototype.hasOwnProperty.call(json,prop)){(function(){var field=fields[prop],value=json[prop];fieldInit.push(field.init(function(state){return field.spec.fromJSON(value,state);}));})();}}return EditorState.create({doc:json.doc,selection:EditorSelection.fromJSON(json.selection),extensions:config2.extensions?fieldInit.concat([config2.extensions]):fieldInit});}},{key:"create",value:function create(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var configuration=Configuration.resolve(config2.extensions||[],/* @__PURE__ */new Map());var doc2=config2.doc instanceof Text?config2.doc:Text.of((config2.doc||"").split(configuration.staticFacet(EditorState.lineSeparator)||DefaultSplit));var selection2=!config2.selection?EditorSelection.single(0):config2.selection instanceof EditorSelection?config2.selection:EditorSelection.single(config2.selection.anchor,config2.selection.head);checkSelection(selection2,doc2.length);if(!configuration.staticFacet(allowMultipleSelections))selection2=selection2.asSingle();return new EditorState(configuration,doc2,selection2,configuration.dynamicSlots.map(function(){return null;}),function(state,slot){return slot.create(state);},null);}}]);return EditorState;}();EditorState.allowMultipleSelections=allowMultipleSelections;EditorState.tabSize=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.length?values2[0]:4;}});EditorState.lineSeparator=lineSeparator;EditorState.readOnly=readOnly;EditorState.phrases=/* @__PURE__ */Facet.define({compare:function compare(a,b){var kA=Object.keys(a),kB=Object.keys(b);return kA.length==kB.length&&kA.every(function(k){return a[k]==b[k];});}});EditorState.languageData=languageData;EditorState.changeFilter=changeFilter;EditorState.transactionFilter=transactionFilter;EditorState.transactionExtender=transactionExtender;Compartment.reconfigure=/* @__PURE__ */StateEffect.define();function combineConfig(configs,defaults3){var combine=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var result={};var _iterator26=_createForOfIteratorHelper(configs),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var config2=_step26.value;for(var _i36=0,_Object$keys=Object.keys(config2);_i36<_Object$keys.length;_i36++){var _key3=_Object$keys[_i36];var value=config2[_key3],current=result[_key3];if(current===void 0)result[_key3]=value;else if(current===value||value===void 0);else if(Object.hasOwnProperty.call(combine,_key3))result[_key3]=combine[_key3](current,value);else throw new Error("Config merge conflict for field "+_key3);}}}catch(err){_iterator26.e(err);}finally{_iterator26.f();}for(var key in defaults3){if(result[key]===void 0)result[key]=defaults3[key];}return result;}var RangeValue=/*#__PURE__*/function(){function RangeValue(){_classCallCheck(this,RangeValue);}_createClass(RangeValue,[{key:"eq",value:function eq(other){return this==other;}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;return Range.create(from,to,this);}}]);return RangeValue;}();RangeValue.prototype.startSide=RangeValue.prototype.endSide=0;RangeValue.prototype.point=false;RangeValue.prototype.mapMode=MapMode.TrackDel;var Range=/*#__PURE__*/function(){function Range(from,to,value){_classCallCheck(this,Range);this.from=from;this.to=to;this.value=value;}_createClass(Range,null,[{key:"create",value:function create(from,to,value){return new Range(from,to,value);}}]);return Range;}();function cmpRange(a,b){return a.from-b.from||a.value.startSide-b.value.startSide;}var Chunk=/*#__PURE__*/function(){function Chunk(from,to,value,maxPoint){_classCallCheck(this,Chunk);this.from=from;this.to=to;this.value=value;this.maxPoint=maxPoint;}_createClass(Chunk,[{key:"length",get:function get(){return this.to[this.to.length-1];}},{key:"findIndex",value:function findIndex(pos,side,end){var startAt=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var arr=end?this.to:this.from;for(var lo=startAt,hi=arr.length;;){if(lo==hi)return lo;var mid=lo+hi>>1;var diff=arr[mid]-pos||(end?this.value[mid].endSide:this.value[mid].startSide)-side;if(mid==lo)return diff>=0?lo:hi;if(diff>=0)hi=mid;else lo=mid+1;}}},{key:"between",value:function between(offset,from,to,f){for(var _i37=this.findIndex(from,-1e9,true),e=this.findIndex(to,1e9,false,_i37);_i37<e;_i37++){if(f(this.from[_i37]+offset,this.to[_i37]+offset,this.value[_i37])===false)return false;}}},{key:"map",value:function map(offset,changes){var value=[],from=[],to=[],newPos=-1,maxPoint=-1;for(var _i38=0;_i38<this.value.length;_i38++){var val=this.value[_i38],curFrom=this.from[_i38]+offset,curTo=this.to[_i38]+offset,newFrom=void 0,newTo=void 0;if(curFrom==curTo){var mapped=changes.mapPos(curFrom,val.startSide,val.mapMode);if(mapped==null)continue;newFrom=newTo=mapped;if(val.startSide!=val.endSide){newTo=changes.mapPos(curFrom,val.endSide);if(newTo<newFrom)continue;}}else{newFrom=changes.mapPos(curFrom,val.startSide);newTo=changes.mapPos(curTo,val.endSide);if(newFrom>newTo||newFrom==newTo&&val.startSide>0&&val.endSide<=0)continue;}if((newTo-newFrom||val.endSide-val.startSide)<0)continue;if(newPos<0)newPos=newFrom;if(val.point)maxPoint=Math.max(maxPoint,newTo-newFrom);value.push(val);from.push(newFrom-newPos);to.push(newTo-newPos);}return{mapped:value.length?new Chunk(from,to,value,maxPoint):null,pos:newPos};}}]);return Chunk;}();var RangeSet=/*#__PURE__*/function(){function RangeSet(chunkPos,chunk,nextLayer,maxPoint){_classCallCheck(this,RangeSet);this.chunkPos=chunkPos;this.chunk=chunk;this.nextLayer=nextLayer;this.maxPoint=maxPoint;}_createClass(RangeSet,[{key:"length",get:function get(){var last=this.chunk.length-1;return last<0?0:Math.max(this.chunkEnd(last),this.nextLayer.length);}},{key:"size",get:function get(){if(this.isEmpty)return 0;var size=this.nextLayer.size;var _iterator27=_createForOfIteratorHelper(this.chunk),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var chunk=_step27.value;size+=chunk.value.length;}}catch(err){_iterator27.e(err);}finally{_iterator27.f();}return size;}},{key:"chunkEnd",value:function chunkEnd(index){return this.chunkPos[index]+this.chunk[index].length;}},{key:"update",value:function update(updateSpec){var _updateSpec$add=updateSpec.add,add2=_updateSpec$add===void 0?[]:_updateSpec$add,_updateSpec$sort=updateSpec.sort,sort=_updateSpec$sort===void 0?false:_updateSpec$sort,_updateSpec$filterFro=updateSpec.filterFrom,filterFrom=_updateSpec$filterFro===void 0?0:_updateSpec$filterFro,_updateSpec$filterTo=updateSpec.filterTo,filterTo=_updateSpec$filterTo===void 0?this.length:_updateSpec$filterTo;var filter=updateSpec.filter;if(add2.length==0&&!filter)return this;if(sort)add2=add2.slice().sort(cmpRange);if(this.isEmpty)return add2.length?RangeSet.of(add2):this;var cur2=new LayerCursor(this,null,-1)["goto"](0),i=0,spill=[];var builder=new RangeSetBuilder();while(cur2.value||i<add2.length){if(i<add2.length&&(cur2.from-add2[i].from||cur2.startSide-add2[i].value.startSide)>=0){var range=add2[i++];if(!builder.addInner(range.from,range.to,range.value))spill.push(range);}else if(cur2.rangeIndex==1&&cur2.chunkIndex<this.chunk.length&&(i==add2.length||this.chunkEnd(cur2.chunkIndex)<add2[i].from)&&(!filter||filterFrom>this.chunkEnd(cur2.chunkIndex)||filterTo<this.chunkPos[cur2.chunkIndex])&&builder.addChunk(this.chunkPos[cur2.chunkIndex],this.chunk[cur2.chunkIndex])){cur2.nextChunk();}else{if(!filter||filterFrom>cur2.to||filterTo<cur2.from||filter(cur2.from,cur2.to,cur2.value)){if(!builder.addInner(cur2.from,cur2.to,cur2.value))spill.push(Range.create(cur2.from,cur2.to,cur2.value));}cur2.next();}}return builder.finishInner(this.nextLayer.isEmpty&&!spill.length?RangeSet.empty:this.nextLayer.update({add:spill,filter:filter,filterFrom:filterFrom,filterTo:filterTo}));}},{key:"map",value:function map(changes){if(changes.empty||this.isEmpty)return this;var chunks=[],chunkPos=[],maxPoint=-1;for(var _i39=0;_i39<this.chunk.length;_i39++){var start=this.chunkPos[_i39],chunk=this.chunk[_i39];var touch=changes.touchesRange(start,start+chunk.length);if(touch===false){maxPoint=Math.max(maxPoint,chunk.maxPoint);chunks.push(chunk);chunkPos.push(changes.mapPos(start));}else if(touch===true){var _chunk$map=chunk.map(start,changes),mapped=_chunk$map.mapped,pos=_chunk$map.pos;if(mapped){maxPoint=Math.max(maxPoint,mapped.maxPoint);chunks.push(mapped);chunkPos.push(pos);}}}var next=this.nextLayer.map(changes);return chunks.length==0?next:new RangeSet(chunkPos,chunks,next||RangeSet.empty,maxPoint);}},{key:"between",value:function between(from,to,f){if(this.isEmpty)return;for(var _i40=0;_i40<this.chunk.length;_i40++){var start=this.chunkPos[_i40],chunk=this.chunk[_i40];if(to>=start&&from<=start+chunk.length&&chunk.between(start,from-start,to-start,f)===false)return;}this.nextLayer.between(from,to,f);}},{key:"iter",value:function iter(){var from=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return HeapCursor.from([this])["goto"](from);}},{key:"isEmpty",get:function get(){return this.nextLayer==this;}}],[{key:"create",value:function create(chunkPos,chunk,nextLayer,maxPoint){return new RangeSet(chunkPos,chunk,nextLayer,maxPoint);}},{key:"iter",value:function iter(sets){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return HeapCursor.from(sets)["goto"](from);}},{key:"compare",value:function compare(oldSets,newSets,textDiff,comparator){var minPointSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:-1;var a=oldSets.filter(function(set){return set.maxPoint>0||!set.isEmpty&&set.maxPoint>=minPointSize;});var b=newSets.filter(function(set){return set.maxPoint>0||!set.isEmpty&&set.maxPoint>=minPointSize;});var sharedChunks=findSharedChunks(a,b,textDiff);var sideA=new SpanCursor(a,sharedChunks,minPointSize);var sideB=new SpanCursor(b,sharedChunks,minPointSize);textDiff.iterGaps(function(fromA,fromB,length){return _compare(sideA,fromA,sideB,fromB,length,comparator);});if(textDiff.empty&&textDiff.length==0)_compare(sideA,0,sideB,0,0,comparator);}},{key:"eq",value:function eq(oldSets,newSets){var from=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var to=arguments.length>3?arguments[3]:undefined;if(to==null)to=1e9-1;var a=oldSets.filter(function(set){return!set.isEmpty&&newSets.indexOf(set)<0;});var b=newSets.filter(function(set){return!set.isEmpty&&oldSets.indexOf(set)<0;});if(a.length!=b.length)return false;if(!a.length)return true;var sharedChunks=findSharedChunks(a,b);var sideA=new SpanCursor(a,sharedChunks,0)["goto"](from),sideB=new SpanCursor(b,sharedChunks,0)["goto"](from);for(;;){if(sideA.to!=sideB.to||!sameValues(sideA.active,sideB.active)||sideA.point&&(!sideB.point||!sideA.point.eq(sideB.point)))return false;if(sideA.to>to)return true;sideA.next();sideB.next();}}},{key:"spans",value:function spans(sets,from,to,iterator){var minPointSize=arguments.length>4&&arguments[4]!==undefined?arguments[4]:-1;var cursor2=new SpanCursor(sets,null,minPointSize)["goto"](from),pos=from;var openRanges=cursor2.openStart;for(;;){var curTo=Math.min(cursor2.to,to);if(cursor2.point){var active=cursor2.activeForPoint(cursor2.to);var openCount=cursor2.pointFrom<from?active.length+1:Math.min(active.length,openRanges);iterator.point(pos,curTo,cursor2.point,active,openCount,cursor2.pointRank);openRanges=Math.min(cursor2.openEnd(curTo),active.length);}else if(curTo>pos){iterator.span(pos,curTo,cursor2.active,openRanges);openRanges=cursor2.openEnd(curTo);}if(cursor2.to>to)return openRanges+(cursor2.point&&cursor2.to>to?1:0);pos=cursor2.to;cursor2.next();}}},{key:"of",value:function of(ranges){var sort=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var build=new RangeSetBuilder();var _iterator28=_createForOfIteratorHelper(ranges instanceof Range?[ranges]:sort?lazySort(ranges):ranges),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var range=_step28.value;build.add(range.from,range.to,range.value);}}catch(err){_iterator28.e(err);}finally{_iterator28.f();}return build.finish();}}]);return RangeSet;}();RangeSet.empty=/* @__PURE__ */new RangeSet([],[],null,-1);function lazySort(ranges){if(ranges.length>1)for(var prev=ranges[0],_i41=1;_i41<ranges.length;_i41++){var cur2=ranges[_i41];if(cmpRange(prev,cur2)>0)return ranges.slice().sort(cmpRange);prev=cur2;}return ranges;}RangeSet.empty.nextLayer=RangeSet.empty;var RangeSetBuilder=/*#__PURE__*/function(){function RangeSetBuilder(){_classCallCheck(this,RangeSetBuilder);this.chunks=[];this.chunkPos=[];this.chunkStart=-1;this.last=null;this.lastFrom=-1e9;this.lastTo=-1e9;this.from=[];this.to=[];this.value=[];this.maxPoint=-1;this.setMaxPoint=-1;this.nextLayer=null;}_createClass(RangeSetBuilder,[{key:"finishChunk",value:function finishChunk(newArrays){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint));this.chunkPos.push(this.chunkStart);this.chunkStart=-1;this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint);this.maxPoint=-1;if(newArrays){this.from=[];this.to=[];this.value=[];}}},{key:"add",value:function add(from,to,value){if(!this.addInner(from,to,value))(this.nextLayer||(this.nextLayer=new RangeSetBuilder())).add(from,to,value);}},{key:"addInner",value:function addInner(from,to,value){var diff=from-this.lastTo||value.startSide-this.last.endSide;if(diff<=0&&(from-this.lastFrom||value.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");if(diff<0)return false;if(this.from.length==250)this.finishChunk(true);if(this.chunkStart<0)this.chunkStart=from;this.from.push(from-this.chunkStart);this.to.push(to-this.chunkStart);this.last=value;this.lastFrom=from;this.lastTo=to;this.value.push(value);if(value.point)this.maxPoint=Math.max(this.maxPoint,to-from);return true;}},{key:"addChunk",value:function addChunk(from,chunk){if((from-this.lastTo||chunk.value[0].startSide-this.last.endSide)<0)return false;if(this.from.length)this.finishChunk(true);this.setMaxPoint=Math.max(this.setMaxPoint,chunk.maxPoint);this.chunks.push(chunk);this.chunkPos.push(from);var last=chunk.value.length-1;this.last=chunk.value[last];this.lastFrom=chunk.from[last]+from;this.lastTo=chunk.to[last]+from;return true;}},{key:"finish",value:function finish(){return this.finishInner(RangeSet.empty);}},{key:"finishInner",value:function finishInner(next){if(this.from.length)this.finishChunk(false);if(this.chunks.length==0)return next;var result=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(next):next,this.setMaxPoint);this.from=null;return result;}}]);return RangeSetBuilder;}();function findSharedChunks(a,b,textDiff){var inA=/* @__PURE__ */new Map();var _iterator29=_createForOfIteratorHelper(a),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var set=_step29.value;for(var _i42=0;_i42<set.chunk.length;_i42++){if(set.chunk[_i42].maxPoint<=0)inA.set(set.chunk[_i42],set.chunkPos[_i42]);}}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}var shared=/* @__PURE__ */new Set();var _iterator30=_createForOfIteratorHelper(b),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var _set=_step30.value;for(var _i43=0;_i43<_set.chunk.length;_i43++){var known=inA.get(_set.chunk[_i43]);if(known!=null&&(textDiff?textDiff.mapPos(known):known)==_set.chunkPos[_i43]&&!(textDiff===null||textDiff===void 0?void 0:textDiff.touchesRange(known,known+_set.chunk[_i43].length)))shared.add(_set.chunk[_i43]);}}}catch(err){_iterator30.e(err);}finally{_iterator30.f();}return shared;}var LayerCursor=/*#__PURE__*/function(){function LayerCursor(layer2,skip,minPoint){var rank=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,LayerCursor);this.layer=layer2;this.skip=skip;this.minPoint=minPoint;this.rank=rank;}_createClass(LayerCursor,[{key:"startSide",get:function get(){return this.value?this.value.startSide:0;}},{key:"endSide",get:function get(){return this.value?this.value.endSide:0;}},{key:"goto",value:function goto(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1e9;this.chunkIndex=this.rangeIndex=0;this.gotoInner(pos,side,false);return this;}},{key:"gotoInner",value:function gotoInner(pos,side,forward){while(this.chunkIndex<this.layer.chunk.length){var next=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(next)||this.layer.chunkEnd(this.chunkIndex)<pos||next.maxPoint<this.minPoint))break;this.chunkIndex++;forward=false;}if(this.chunkIndex<this.layer.chunk.length){var rangeIndex=this.layer.chunk[this.chunkIndex].findIndex(pos-this.layer.chunkPos[this.chunkIndex],side,true);if(!forward||this.rangeIndex<rangeIndex)this.setRangeIndex(rangeIndex);}this.next();}},{key:"forward",value:function forward(pos,side){if((this.to-pos||this.endSide-side)<0)this.gotoInner(pos,side,true);}},{key:"next",value:function next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9;this.value=null;break;}else{var chunkPos=this.layer.chunkPos[this.chunkIndex],chunk=this.layer.chunk[this.chunkIndex];var from=chunkPos+chunk.from[this.rangeIndex];this.from=from;this.to=chunkPos+chunk.to[this.rangeIndex];this.value=chunk.value[this.rangeIndex];this.setRangeIndex(this.rangeIndex+1);if(this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break;}}}},{key:"setRangeIndex",value:function setRangeIndex(index){if(index==this.layer.chunk[this.chunkIndex].value.length){this.chunkIndex++;if(this.skip){while(this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex])){this.chunkIndex++;}}this.rangeIndex=0;}else{this.rangeIndex=index;}}},{key:"nextChunk",value:function nextChunk(){this.chunkIndex++;this.rangeIndex=0;this.next();}},{key:"compare",value:function compare(other){return this.from-other.from||this.startSide-other.startSide||this.rank-other.rank||this.to-other.to||this.endSide-other.endSide;}}]);return LayerCursor;}();var HeapCursor=/*#__PURE__*/function(){function HeapCursor(heap){_classCallCheck(this,HeapCursor);this.heap=heap;}_createClass(HeapCursor,[{key:"startSide",get:function get(){return this.value?this.value.startSide:0;}},{key:"goto",value:function goto(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1e9;var _iterator31=_createForOfIteratorHelper(this.heap),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var cur2=_step31.value;cur2["goto"](pos,side);}}catch(err){_iterator31.e(err);}finally{_iterator31.f();}for(var _i44=this.heap.length>>1;_i44>=0;_i44--){heapBubble(this.heap,_i44);}this.next();return this;}},{key:"forward",value:function forward(pos,side){var _iterator32=_createForOfIteratorHelper(this.heap),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var cur2=_step32.value;cur2.forward(pos,side);}}catch(err){_iterator32.e(err);}finally{_iterator32.f();}for(var _i45=this.heap.length>>1;_i45>=0;_i45--){heapBubble(this.heap,_i45);}if((this.to-pos||this.value.endSide-side)<0)this.next();}},{key:"next",value:function next(){if(this.heap.length==0){this.from=this.to=1e9;this.value=null;this.rank=-1;}else{var top2=this.heap[0];this.from=top2.from;this.to=top2.to;this.value=top2.value;this.rank=top2.rank;if(top2.value)top2.next();heapBubble(this.heap,0);}}}],[{key:"from",value:function from(sets){var skip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var minPoint=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;var heap=[];for(var _i46=0;_i46<sets.length;_i46++){for(var cur2=sets[_i46];!cur2.isEmpty;cur2=cur2.nextLayer){if(cur2.maxPoint>=minPoint)heap.push(new LayerCursor(cur2,skip,minPoint,_i46));}}return heap.length==1?heap[0]:new HeapCursor(heap);}}]);return HeapCursor;}();function heapBubble(heap,index){for(var cur2=heap[index];;){var childIndex=(index<<1)+1;if(childIndex>=heap.length)break;var child=heap[childIndex];if(childIndex+1<heap.length&&child.compare(heap[childIndex+1])>=0){child=heap[childIndex+1];childIndex++;}if(cur2.compare(child)<0)break;heap[childIndex]=cur2;heap[index]=child;index=childIndex;}}var SpanCursor=/*#__PURE__*/function(){function SpanCursor(sets,skip,minPoint){_classCallCheck(this,SpanCursor);this.minPoint=minPoint;this.active=[];this.activeTo=[];this.activeRank=[];this.minActive=-1;this.point=null;this.pointFrom=0;this.pointRank=0;this.to=-1e9;this.endSide=0;this.openStart=-1;this.cursor=HeapCursor.from(sets,skip,minPoint);}_createClass(SpanCursor,[{key:"goto",value:function goto(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:-1e9;this.cursor["goto"](pos,side);this.active.length=this.activeTo.length=this.activeRank.length=0;this.minActive=-1;this.to=pos;this.endSide=side;this.openStart=-1;this.next();return this;}},{key:"forward",value:function forward(pos,side){while(this.minActive>-1&&(this.activeTo[this.minActive]-pos||this.active[this.minActive].endSide-side)<0){this.removeActive(this.minActive);}this.cursor.forward(pos,side);}},{key:"removeActive",value:function removeActive(index){remove(this.active,index);remove(this.activeTo,index);remove(this.activeRank,index);this.minActive=findMinIndex(this.active,this.activeTo);}},{key:"addActive",value:function addActive(trackOpen){var i=0,_this$cursor=this.cursor,value=_this$cursor.value,to=_this$cursor.to,rank=_this$cursor.rank;while(i<this.activeRank.length&&this.activeRank[i]<=rank){i++;}insert(this.active,i,value);insert(this.activeTo,i,to);insert(this.activeRank,i,rank);if(trackOpen)insert(trackOpen,i,this.cursor.from);this.minActive=findMinIndex(this.active,this.activeTo);}},{key:"next",value:function next(){var from=this.to,wasPoint=this.point;this.point=null;var trackOpen=this.openStart<0?[]:null;for(;;){var a=this.minActive;if(a>-1&&(this.activeTo[a]-this.cursor.from||this.active[a].endSide-this.cursor.startSide)<0){if(this.activeTo[a]>from){this.to=this.activeTo[a];this.endSide=this.active[a].endSide;break;}this.removeActive(a);if(trackOpen)remove(trackOpen,a);}else if(!this.cursor.value){this.to=this.endSide=1e9;break;}else if(this.cursor.from>from){this.to=this.cursor.from;this.endSide=this.cursor.startSide;break;}else{var nextVal=this.cursor.value;if(!nextVal.point){this.addActive(trackOpen);this.cursor.next();}else if(wasPoint&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to){this.cursor.next();}else{this.point=nextVal;this.pointFrom=this.cursor.from;this.pointRank=this.cursor.rank;this.to=this.cursor.to;this.endSide=nextVal.endSide;this.cursor.next();this.forward(this.to,this.endSide);break;}}}if(trackOpen){this.openStart=0;for(var _i47=trackOpen.length-1;_i47>=0&&trackOpen[_i47]<from;_i47--){this.openStart++;}}}},{key:"activeForPoint",value:function activeForPoint(to){if(!this.active.length)return this.active;var active=[];for(var _i48=this.active.length-1;_i48>=0;_i48--){if(this.activeRank[_i48]<this.pointRank)break;if(this.activeTo[_i48]>to||this.activeTo[_i48]==to&&this.active[_i48].endSide>=this.point.endSide)active.push(this.active[_i48]);}return active.reverse();}},{key:"openEnd",value:function openEnd(to){var open=0;for(var _i49=this.activeTo.length-1;_i49>=0&&this.activeTo[_i49]>to;_i49--){open++;}return open;}}]);return SpanCursor;}();function _compare(a,startA,b,startB,length,comparator){a["goto"](startA);b["goto"](startB);var endB=startB+length;var pos=startB,dPos=startB-startA;for(;;){var diff=a.to+dPos-b.to||a.endSide-b.endSide;var end=diff<0?a.to+dPos:b.to,clipEnd=Math.min(end,endB);if(a.point||b.point){if(!(a.point&&b.point&&(a.point==b.point||a.point.eq(b.point))&&sameValues(a.activeForPoint(a.to),b.activeForPoint(b.to))))comparator.comparePoint(pos,clipEnd,a.point,b.point);}else{if(clipEnd>pos&&!sameValues(a.active,b.active))comparator.compareRange(pos,clipEnd,a.active,b.active);}if(end>endB)break;pos=end;if(diff<=0)a.next();if(diff>=0)b.next();}}function sameValues(a,b){if(a.length!=b.length)return false;for(var _i50=0;_i50<a.length;_i50++){if(a[_i50]!=b[_i50]&&!a[_i50].eq(b[_i50]))return false;}return true;}function remove(array,index){for(var _i51=index,e=array.length-1;_i51<e;_i51++){array[_i51]=array[_i51+1];}array.pop();}function insert(array,index,value){for(var _i52=array.length-1;_i52>=index;_i52--){array[_i52+1]=array[_i52];}array[index]=value;}function findMinIndex(value,array){var found=-1,foundPos=1e9;for(var _i53=0;_i53<array.length;_i53++){if((array[_i53]-foundPos||value[_i53].endSide-value[found].endSide)<0){found=_i53;foundPos=array[_i53];}}return found;}function _countColumn(string2,tabSize){var to=arguments.length>2&&arguments[2]!==undefined?arguments[2]:string2.length;var n=0;for(var _i54=0;_i54<to;){if(string2.charCodeAt(_i54)==9){n+=tabSize-n%tabSize;_i54++;}else{n++;_i54=findClusterBreak(string2,_i54);}}return n;}function findColumn(string2,col,tabSize,strict){for(var _i55=0,n=0;;){if(n>=col)return _i55;if(_i55==string2.length)break;n+=string2.charCodeAt(_i55)==9?tabSize-n%tabSize:1;_i55=findClusterBreak(string2,_i55);}return strict===true?-1:string2.length;}// ../node_modules/style-mod/src/style-mod.js
var C="\u037C";var COUNT=typeof Symbol=="undefined"?"__"+C:Symbol["for"](C);var SET=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet");var top=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};var StyleModule=/*#__PURE__*/function(){function StyleModule(spec,options){_classCallCheck(this,StyleModule);this.rules=[];var _ref3=options||{},finish=_ref3.finish;function splitSelector(selector){return /^@/.test(selector)?[selector]:selector.split(/,\s*/);}function render(selectors,spec2,target,isKeyframes){var local=[],isAt=/^@(\w+)\b/.exec(selectors[0]),keyframes=isAt&&isAt[1]=="keyframes";if(isAt&&spec2==null)return target.push(selectors[0]+";");for(var prop in spec2){var value=spec2[prop];if(/&/.test(prop)){render(prop.split(/,\s*/).map(function(part){return selectors.map(function(sel){return part.replace(/&/,sel);});}).reduce(function(a,b){return a.concat(b);}),value,target);}else if(value&&_typeof(value)=="object"){if(!isAt)throw new RangeError("The value of a property ("+prop+") should be a primitive value.");render(splitSelector(prop),value,local,keyframes);}else if(value!=null){local.push(prop.replace(/_.*/,"").replace(/[A-Z]/g,function(l){return"-"+l.toLowerCase();})+": "+value+";");}}if(local.length||keyframes){target.push((finish&&!isAt&&!isKeyframes?selectors.map(finish):selectors).join(", ")+" {"+local.join(" ")+"}");}}for(var prop in spec){render(splitSelector(prop),spec[prop],this.rules);}}_createClass(StyleModule,[{key:"getRules",value:function getRules(){return this.rules.join("\n");}}],[{key:"newName",value:function newName(){var id2=top[COUNT]||1;top[COUNT]=id2+1;return C+id2.toString(36);}},{key:"mount",value:function mount(root,modules,options){var set=root[SET],nonce=options&&options.nonce;if(!set)set=new StyleSet(root,nonce);else if(nonce)set.setNonce(nonce);set.mount(Array.isArray(modules)?modules:[modules]);}}]);return StyleModule;}();var adoptedSet=/* @__PURE__ */new Map();var StyleSet=/*#__PURE__*/function(){function StyleSet(root,nonce){_classCallCheck(this,StyleSet);var doc2=root.ownerDocument||root,win=doc2.defaultView;if(!root.head&&root.adoptedStyleSheets&&win.CSSStyleSheet){var adopted=adoptedSet.get(doc2);if(adopted){root.adoptedStyleSheets=[adopted.sheet].concat(_toConsumableArray(root.adoptedStyleSheets));return root[SET]=adopted;}this.sheet=new win.CSSStyleSheet();root.adoptedStyleSheets=[this.sheet].concat(_toConsumableArray(root.adoptedStyleSheets));adoptedSet.set(doc2,this);}else{this.styleTag=doc2.createElement("style");if(nonce)this.styleTag.setAttribute("nonce",nonce);var target=root.head||root;target.insertBefore(this.styleTag,target.firstChild);}this.modules=[];root[SET]=this;}_createClass(StyleSet,[{key:"mount",value:function mount(modules){var sheet=this.sheet;var pos=0,j=0;for(var _i56=0;_i56<modules.length;_i56++){var mod=modules[_i56],index=this.modules.indexOf(mod);if(index<j&&index>-1){this.modules.splice(index,1);j--;index=-1;}if(index==-1){this.modules.splice(j++,0,mod);if(sheet)for(var k=0;k<mod.rules.length;k++){sheet.insertRule(mod.rules[k],pos++);}}else{while(j<index){pos+=this.modules[j++].rules.length;}pos+=mod.rules.length;j++;}}if(!sheet){var _text2="";for(var _i57=0;_i57<this.modules.length;_i57++){_text2+=this.modules[_i57].getRules()+"\n";}this.styleTag.textContent=_text2;}}},{key:"setNonce",value:function setNonce(nonce){if(this.styleTag&&this.styleTag.getAttribute("nonce")!=nonce)this.styleTag.setAttribute("nonce",nonce);}}]);return StyleSet;}();// ../node_modules/w3c-keyname/index.es.js
var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"};var shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};var chrome=typeof navigator!="undefined"&&/Chrome\/(\d+)/.exec(navigator.userAgent);var safari=typeof navigator!="undefined"&&/Apple Computer/.test(navigator.vendor);var gecko=typeof navigator!="undefined"&&/Gecko\/\d+/.test(navigator.userAgent);var mac=typeof navigator!="undefined"&&/Mac/.test(navigator.platform);var ie=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var brokenModifierNames=chrome&&(mac||+chrome[1]<57)||gecko&&mac;for(i=0;i<10;i++){base[48+i]=base[96+i]=String(i);}var i;for(i=1;i<=24;i++){base[i+111]="F"+i;}var i;for(i=65;i<=90;i++){base[i]=String.fromCharCode(i+32);shift[i]=String.fromCharCode(i);}var i;for(code in base){if(!shift.hasOwnProperty(code))shift[code]=base[code];}var code;function keyName(event){var ignoreKey=brokenModifierNames&&(event.ctrlKey||event.altKey||event.metaKey)||(safari||ie)&&event.shiftKey&&event.key&&event.key.length==1||event.key=="Unidentified";var name2=!ignoreKey&&event.key||(event.shiftKey?shift:base)[event.keyCode]||event.key||"Unidentified";if(name2=="Esc")name2="Escape";if(name2=="Del")name2="Delete";if(name2=="Left")name2="ArrowLeft";if(name2=="Up")name2="ArrowUp";if(name2=="Right")name2="ArrowRight";if(name2=="Down")name2="ArrowDown";return name2;}// ../node_modules/@codemirror/view/dist/index.js
function getSelection(root){var target;if(root.nodeType==11){target=root.getSelection?root:root.ownerDocument;}else{target=root;}return target.getSelection();}function contains(dom,node){return node?dom==node||dom.contains(node.nodeType!=1?node.parentNode:node):false;}function deepActiveElement(doc2){var elt2=doc2.activeElement;while(elt2&&elt2.shadowRoot){elt2=elt2.shadowRoot.activeElement;}return elt2;}function hasSelection(dom,selection2){if(!selection2.anchorNode)return false;try{return contains(dom,selection2.anchorNode);}catch(_){return false;}}function clientRectsFor(dom){if(dom.nodeType==3)return textRange(dom,0,dom.nodeValue.length).getClientRects();else if(dom.nodeType==1)return dom.getClientRects();else return[];}function isEquivalentPosition(node,off,targetNode,targetOff){return targetNode?scanFor(node,off,targetNode,targetOff,-1)||scanFor(node,off,targetNode,targetOff,1):false;}function domIndex(node){for(var index=0;;index++){node=node.previousSibling;if(!node)return index;}}function scanFor(node,off,targetNode,targetOff,dir){for(;;){if(node==targetNode&&off==targetOff)return true;if(off==(dir<0?0:maxOffset(node))){if(node.nodeName=="DIV")return false;var parent=node.parentNode;if(!parent||parent.nodeType!=1)return false;off=domIndex(node)+(dir<0?0:1);node=parent;}else if(node.nodeType==1){node=node.childNodes[off+(dir<0?-1:0)];if(node.nodeType==1&&node.contentEditable=="false")return false;off=dir<0?maxOffset(node):0;}else{return false;}}}function maxOffset(node){return node.nodeType==3?node.nodeValue.length:node.childNodes.length;}function flattenRect(rect,left){var x=left?rect.left:rect.right;return{left:x,right:x,top:rect.top,bottom:rect.bottom};}function windowRect(win){return{left:0,right:win.innerWidth,top:0,bottom:win.innerHeight};}function scrollRectIntoView(dom,rect,side,x,y,xMargin,yMargin,ltr){var doc2=dom.ownerDocument,win=doc2.defaultView||window;for(var cur2=dom,stop=false;cur2&&!stop;){if(cur2.nodeType==1){var bounding=void 0,top2=cur2==doc2.body;var scaleX=1,scaleY=1;if(top2){bounding=windowRect(win);}else{if(/^(fixed|sticky)$/.test(getComputedStyle(cur2).position))stop=true;if(cur2.scrollHeight<=cur2.clientHeight&&cur2.scrollWidth<=cur2.clientWidth){cur2=cur2.assignedSlot||cur2.parentNode;continue;}var rect2=cur2.getBoundingClientRect();scaleX=rect2.width/cur2.offsetWidth;scaleY=rect2.height/cur2.offsetHeight;bounding={left:rect2.left,right:rect2.left+cur2.clientWidth*scaleX,top:rect2.top,bottom:rect2.top+cur2.clientHeight*scaleY};}var moveX=0,moveY=0;if(y=="nearest"){if(rect.top<bounding.top){moveY=-(bounding.top-rect.top+yMargin);if(side>0&&rect.bottom>bounding.bottom+moveY)moveY=rect.bottom-bounding.bottom+moveY+yMargin;}else if(rect.bottom>bounding.bottom){moveY=rect.bottom-bounding.bottom+yMargin;if(side<0&&rect.top-moveY<bounding.top)moveY=-(bounding.top+moveY-rect.top+yMargin);}}else{var rectHeight=rect.bottom-rect.top,boundingHeight=bounding.bottom-bounding.top;var targetTop=y=="center"&&rectHeight<=boundingHeight?rect.top+rectHeight/2-boundingHeight/2:y=="start"||y=="center"&&side<0?rect.top-yMargin:rect.bottom-boundingHeight+yMargin;moveY=targetTop-bounding.top;}if(x=="nearest"){if(rect.left<bounding.left){moveX=-(bounding.left-rect.left+xMargin);if(side>0&&rect.right>bounding.right+moveX)moveX=rect.right-bounding.right+moveX+xMargin;}else if(rect.right>bounding.right){moveX=rect.right-bounding.right+xMargin;if(side<0&&rect.left<bounding.left+moveX)moveX=-(bounding.left+moveX-rect.left+xMargin);}}else{var targetLeft=x=="center"?rect.left+(rect.right-rect.left)/2-(bounding.right-bounding.left)/2:x=="start"==ltr?rect.left-xMargin:rect.right-(bounding.right-bounding.left)+xMargin;moveX=targetLeft-bounding.left;}if(moveX||moveY){if(top2){win.scrollBy(moveX,moveY);}else{var movedX=0,movedY=0;if(moveY){var start=cur2.scrollTop;cur2.scrollTop+=moveY/scaleY;movedY=(cur2.scrollTop-start)*scaleY;}if(moveX){var _start2=cur2.scrollLeft;cur2.scrollLeft+=moveX/scaleX;movedX=(cur2.scrollLeft-_start2)*scaleX;}rect={left:rect.left-movedX,top:rect.top-movedY,right:rect.right-movedX,bottom:rect.bottom-movedY};if(movedX&&Math.abs(movedX-moveX)<1)x="nearest";if(movedY&&Math.abs(movedY-moveY)<1)y="nearest";}}if(top2)break;cur2=cur2.assignedSlot||cur2.parentNode;}else if(cur2.nodeType==11){cur2=cur2.host;}else{break;}}}function scrollableParent(dom){var doc2=dom.ownerDocument;for(var cur2=dom.parentNode;cur2;){if(cur2==doc2.body){break;}else if(cur2.nodeType==1){if(cur2.scrollHeight>cur2.clientHeight||cur2.scrollWidth>cur2.clientWidth)return cur2;cur2=cur2.assignedSlot||cur2.parentNode;}else if(cur2.nodeType==11){cur2=cur2.host;}else{break;}}return null;}var DOMSelectionState=/*#__PURE__*/function(){function DOMSelectionState(){_classCallCheck(this,DOMSelectionState);this.anchorNode=null;this.anchorOffset=0;this.focusNode=null;this.focusOffset=0;}_createClass(DOMSelectionState,[{key:"eq",value:function eq(domSel){return this.anchorNode==domSel.anchorNode&&this.anchorOffset==domSel.anchorOffset&&this.focusNode==domSel.focusNode&&this.focusOffset==domSel.focusOffset;}},{key:"setRange",value:function setRange(range){var anchorNode=range.anchorNode,focusNode=range.focusNode;this.set(anchorNode,Math.min(range.anchorOffset,anchorNode?maxOffset(anchorNode):0),focusNode,Math.min(range.focusOffset,focusNode?maxOffset(focusNode):0));}},{key:"set",value:function set(anchorNode,anchorOffset,focusNode,focusOffset){this.anchorNode=anchorNode;this.anchorOffset=anchorOffset;this.focusNode=focusNode;this.focusOffset=focusOffset;}}]);return DOMSelectionState;}();var preventScrollSupported=null;function focusPreventScroll(dom){if(dom.setActive)return dom.setActive();if(preventScrollSupported)return dom.focus(preventScrollSupported);var stack=[];for(var cur2=dom;cur2;cur2=cur2.parentNode){stack.push(cur2,cur2.scrollTop,cur2.scrollLeft);if(cur2==cur2.ownerDocument)break;}dom.focus(preventScrollSupported==null?Object.defineProperties({},{preventScroll:{get:function get(){preventScrollSupported={preventScroll:true};return true;},configurable:true,enumerable:true}}):void 0);if(!preventScrollSupported){preventScrollSupported=false;for(var _i58=0;_i58<stack.length;){var elt2=stack[_i58++],top2=stack[_i58++],left=stack[_i58++];if(elt2.scrollTop!=top2)elt2.scrollTop=top2;if(elt2.scrollLeft!=left)elt2.scrollLeft=left;}}}var scratchRange;function textRange(node,from){var to=arguments.length>2&&arguments[2]!==undefined?arguments[2]:from;var range=scratchRange||(scratchRange=document.createRange());range.setEnd(node,to);range.setStart(node,from);return range;}function dispatchKey(elt2,name2,code){var options={key:name2,code:name2,keyCode:code,which:code,cancelable:true};var down=new KeyboardEvent("keydown",options);down.synthetic=true;elt2.dispatchEvent(down);var up=new KeyboardEvent("keyup",options);up.synthetic=true;elt2.dispatchEvent(up);return down.defaultPrevented||up.defaultPrevented;}function getRoot(node){while(node){if(node&&(node.nodeType==9||node.nodeType==11&&node.host))return node;node=node.assignedSlot||node.parentNode;}return null;}function clearAttributes(node){while(node.attributes.length){node.removeAttributeNode(node.attributes[0]);}}function atElementStart(doc2,selection2){var node=selection2.focusNode,offset=selection2.focusOffset;if(!node||selection2.anchorNode!=node||selection2.anchorOffset!=offset)return false;offset=Math.min(offset,maxOffset(node));for(;;){if(offset){if(node.nodeType!=1)return false;var prev=node.childNodes[offset-1];if(prev.contentEditable=="false")offset--;else{node=prev;offset=maxOffset(node);}}else if(node==doc2){return true;}else{offset=domIndex(node);node=node.parentNode;}}}function isScrolledToBottom(elt2){return elt2.scrollTop>Math.max(1,elt2.scrollHeight-elt2.clientHeight-4);}var DOMPos=/*#__PURE__*/function(){function DOMPos(node,offset){var precise=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;_classCallCheck(this,DOMPos);this.node=node;this.offset=offset;this.precise=precise;}_createClass(DOMPos,null,[{key:"before",value:function before(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom),precise);}},{key:"after",value:function after(dom,precise){return new DOMPos(dom.parentNode,domIndex(dom)+1,precise);}}]);return DOMPos;}();var noChildren=[];var ContentView=/*#__PURE__*/function(){function ContentView(){_classCallCheck(this,ContentView);this.parent=null;this.dom=null;this.flags=2;}_createClass(ContentView,[{key:"overrideDOMText",get:function get(){return null;}},{key:"posAtStart",get:function get(){return this.parent?this.parent.posBefore(this):0;}},{key:"posAtEnd",get:function get(){return this.posAtStart+this.length;}},{key:"posBefore",value:function posBefore(view){var pos=this.posAtStart;var _iterator33=_createForOfIteratorHelper(this.children),_step33;try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var child=_step33.value;if(child==view)return pos;pos+=child.length+child.breakAfter;}}catch(err){_iterator33.e(err);}finally{_iterator33.f();}throw new RangeError("Invalid child in posBefore");}},{key:"posAfter",value:function posAfter(view){return this.posBefore(view)+view.length;}},{key:"sync",value:function sync(view,track){if(this.flags&2){var parent=this.dom;var prev=null,next;var _iterator34=_createForOfIteratorHelper(this.children),_step34;try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var child=_step34.value;if(child.flags&7){if(!child.dom&&(next=prev?prev.nextSibling:parent.firstChild)){var contentView=ContentView.get(next);if(!contentView||!contentView.parent&&contentView.canReuseDOM(child))child.reuseDOM(next);}child.sync(view,track);child.flags&=~7;}next=prev?prev.nextSibling:parent.firstChild;if(track&&!track.written&&track.node==parent&&next!=child.dom)track.written=true;if(child.dom.parentNode==parent){while(next&&next!=child.dom){next=rm$1(next);}}else{parent.insertBefore(child.dom,next);}prev=child.dom;}}catch(err){_iterator34.e(err);}finally{_iterator34.f();}next=prev?prev.nextSibling:parent.firstChild;if(next&&track&&track.node==parent)track.written=true;while(next){next=rm$1(next);}}else if(this.flags&1){var _iterator35=_createForOfIteratorHelper(this.children),_step35;try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){var _child=_step35.value;if(_child.flags&7){_child.sync(view,track);_child.flags&=~7;}}}catch(err){_iterator35.e(err);}finally{_iterator35.f();}}}},{key:"reuseDOM",value:function reuseDOM(_dom){}},{key:"localPosFromDOM",value:function localPosFromDOM(node,offset){var after;if(node==this.dom){after=this.dom.childNodes[offset];}else{var bias=maxOffset(node)==0?0:offset==0?-1:1;for(;;){var parent=node.parentNode;if(parent==this.dom)break;if(bias==0&&parent.firstChild!=parent.lastChild){if(node==parent.firstChild)bias=-1;else bias=1;}node=parent;}if(bias<0)after=node;else after=node.nextSibling;}if(after==this.dom.firstChild)return 0;while(after&&!ContentView.get(after)){after=after.nextSibling;}if(!after)return this.length;for(var _i59=0,pos=0;;_i59++){var child=this.children[_i59];if(child.dom==after)return pos;pos+=child.length+child.breakAfter;}}},{key:"domBoundsAround",value:function domBoundsAround(from,to){var offset=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var fromI=-1,fromStart=-1,toI=-1,toEnd=-1;for(var _i60=0,pos=offset,prevEnd=offset;_i60<this.children.length;_i60++){var child=this.children[_i60],end=pos+child.length;if(pos<from&&end>to)return child.domBoundsAround(from,to,pos);if(end>=from&&fromI==-1){fromI=_i60;fromStart=pos;}if(pos>to&&child.dom.parentNode==this.dom){toI=_i60;toEnd=prevEnd;break;}prevEnd=end;pos=end+child.breakAfter;}return{from:fromStart,to:toEnd<0?offset+this.length:toEnd,startDOM:(fromI?this.children[fromI-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:toI<this.children.length&&toI>=0?this.children[toI].dom:null};}},{key:"markDirty",value:function markDirty(){var andParent=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;this.flags|=2;this.markParentsDirty(andParent);}},{key:"markParentsDirty",value:function markParentsDirty(childList){for(var parent=this.parent;parent;parent=parent.parent){if(childList)parent.flags|=2;if(parent.flags&1)return;parent.flags|=1;childList=false;}}},{key:"setParent",value:function setParent(parent){if(this.parent!=parent){this.parent=parent;if(this.flags&7)this.markParentsDirty(true);}}},{key:"setDOM",value:function setDOM(dom){if(this.dom==dom)return;if(this.dom)this.dom.cmView=null;this.dom=dom;dom.cmView=this;}},{key:"rootView",get:function get(){for(var v=this;;){var parent=v.parent;if(!parent)return v;v=parent;}}},{key:"replaceChildren",value:function replaceChildren(from,to){var _this$children;var children=arguments.length>2&&arguments[2]!==undefined?arguments[2]:noChildren;this.markDirty();for(var _i61=from;_i61<to;_i61++){var child=this.children[_i61];if(child.parent==this)child.destroy();}(_this$children=this.children).splice.apply(_this$children,[from,to-from].concat(_toConsumableArray(children)));for(var _i62=0;_i62<children.length;_i62++){children[_i62].setParent(this);}}},{key:"ignoreMutation",value:function ignoreMutation(_rec){return false;}},{key:"ignoreEvent",value:function ignoreEvent(_event){return false;}},{key:"childCursor",value:function childCursor(){var pos=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.length;return new ChildCursor(this.children,pos,this.children.length);}},{key:"childPos",value:function childPos(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return this.childCursor().findPos(pos,bias);}},{key:"toString",value:function toString(){var name2=this.constructor.name.replace("View","");return name2+(this.children.length?"("+this.children.join()+")":this.length?"["+(name2=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"");}},{key:"isEditable",get:function get(){return true;}},{key:"isWidget",get:function get(){return false;}},{key:"isHidden",get:function get(){return false;}},{key:"merge",value:function merge(from,to,source,hasStart,openStart,openEnd){return false;}},{key:"become",value:function become(other){return false;}},{key:"canReuseDOM",value:function canReuseDOM(other){return other.constructor==this.constructor&&!((this.flags|other.flags)&8);}},{key:"getSide",value:function getSide(){return 0;}},{key:"destroy",value:function destroy(){this.parent=null;}}],[{key:"get",value:function get(node){return node.cmView;}}]);return ContentView;}();ContentView.prototype.breakAfter=0;function rm$1(dom){var next=dom.nextSibling;dom.parentNode.removeChild(dom);return next;}var ChildCursor=/*#__PURE__*/function(){function ChildCursor(children,pos,i){_classCallCheck(this,ChildCursor);this.children=children;this.pos=pos;this.i=i;this.off=0;}_createClass(ChildCursor,[{key:"findPos",value:function findPos(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;for(;;){if(pos>this.pos||pos==this.pos&&(bias>0||this.i==0||this.children[this.i-1].breakAfter)){this.off=pos-this.pos;return this;}var next=this.children[--this.i];this.pos-=next.length+next.breakAfter;}}}]);return ChildCursor;}();function replaceRange(parent,fromI,fromOff,toI,toOff,insert2,breakAtStart,openStart,openEnd){var children=parent.children;var before=children.length?children[fromI]:null;var last=insert2.length?insert2[insert2.length-1]:null;var breakAtEnd=last?last.breakAfter:breakAtStart;if(fromI==toI&&before&&!breakAtStart&&!breakAtEnd&&insert2.length<2&&before.merge(fromOff,toOff,insert2.length?last:null,fromOff==0,openStart,openEnd))return;if(toI<children.length){var after=children[toI];if(after&&(toOff<after.length||after.breakAfter&&(last===null||last===void 0?void 0:last.breakAfter))){if(fromI==toI){after=after.split(toOff);toOff=0;}if(!breakAtEnd&&last&&after.merge(0,toOff,last,true,0,openEnd)){insert2[insert2.length-1]=after;}else{if(toOff||after.children.length&&!after.children[0].length)after.merge(0,toOff,null,false,0,openEnd);insert2.push(after);}}else if(after===null||after===void 0?void 0:after.breakAfter){if(last)last.breakAfter=1;else breakAtStart=1;}toI++;}if(before){before.breakAfter=breakAtStart;if(fromOff>0){if(!breakAtStart&&insert2.length&&before.merge(fromOff,before.length,insert2[0],false,openStart,0)){before.breakAfter=insert2.shift().breakAfter;}else if(fromOff<before.length||before.children.length&&before.children[before.children.length-1].length==0){before.merge(fromOff,before.length,null,false,openStart,0);}fromI++;}}while(fromI<toI&&insert2.length){if(children[toI-1].become(insert2[insert2.length-1])){toI--;insert2.pop();openEnd=insert2.length?0:openStart;}else if(children[fromI].become(insert2[0])){fromI++;insert2.shift();openStart=insert2.length?0:openEnd;}else{break;}}if(!insert2.length&&fromI&&toI<children.length&&!children[fromI-1].breakAfter&&children[toI].merge(0,0,children[fromI-1],false,openStart,openEnd))fromI--;if(fromI<toI||insert2.length)parent.replaceChildren(fromI,toI,insert2);}function mergeChildrenInto(parent,from,to,insert2,openStart,openEnd){var cur2=parent.childCursor();var _cur2$findPos=cur2.findPos(to,1),toI=_cur2$findPos.i,toOff=_cur2$findPos.off;var _cur2$findPos2=cur2.findPos(from,-1),fromI=_cur2$findPos2.i,fromOff=_cur2$findPos2.off;var dLen=from-to;var _iterator36=_createForOfIteratorHelper(insert2),_step36;try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var view=_step36.value;dLen+=view.length;}}catch(err){_iterator36.e(err);}finally{_iterator36.f();}parent.length+=dLen;replaceRange(parent,fromI,fromOff,toI,toOff,insert2,0,openStart,openEnd);}var nav=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""};var doc=typeof document!="undefined"?document:{documentElement:{style:{}}};var ie_edge=/* @__PURE__ */ /Edge\/(\d+)/.exec(nav.userAgent);var ie_upto10=/* @__PURE__ */ /MSIE \d/.test(nav.userAgent);var ie_11up=/* @__PURE__ */ /Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent);var ie2=!!(ie_upto10||ie_11up||ie_edge);var gecko2=!ie2&&/* @__PURE__ */ /gecko\/(\d+)/i.test(nav.userAgent);var chrome2=!ie2&&/* @__PURE__ */ /Chrome\/(\d+)/.exec(nav.userAgent);var webkit=("webkitFontSmoothing"in doc.documentElement.style);var safari2=!ie2&&/* @__PURE__ */ /Apple Computer/.test(nav.vendor);var ios=safari2&&(/* @__PURE__ */ /Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/* @__PURE__ */ /Mac/.test(nav.platform),windows:/* @__PURE__ */ /Win/.test(nav.platform),linux:/* @__PURE__ */ /Linux|X11/.test(nav.platform),ie:ie2,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko:gecko2,gecko_version:gecko2?+(/* @__PURE__ */ /Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome2,chrome_version:chrome2?+chrome2[1]:0,ios:ios,android:/* @__PURE__ */ /Android\b/.test(nav.userAgent),webkit:webkit,safari:safari2,webkit_version:webkit?+(/* @__PURE__ */ /\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:doc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};var MaxJoinLen=256;var TextView=/*#__PURE__*/function(_ContentView){_inherits(TextView,_ContentView);var _super4=_createSuper(TextView);function TextView(text){var _this8;_classCallCheck(this,TextView);_this8=_super4.call(this);_this8.text=text;return _this8;}_createClass(TextView,[{key:"length",get:function get(){return this.text.length;}},{key:"createDOM",value:function createDOM(textDOM){this.setDOM(textDOM||document.createTextNode(this.text));}},{key:"sync",value:function sync(view,track){if(!this.dom)this.createDOM();if(this.dom.nodeValue!=this.text){if(track&&track.node==this.dom)track.written=true;this.dom.nodeValue=this.text;}}},{key:"reuseDOM",value:function reuseDOM(dom){if(dom.nodeType==3)this.createDOM(dom);}},{key:"merge",value:function merge(from,to,source){if(this.flags&8||source&&(!(source instanceof TextView)||this.length-(to-from)+source.length>MaxJoinLen||source.flags&8))return false;this.text=this.text.slice(0,from)+(source?source.text:"")+this.text.slice(to);this.markDirty();return true;}},{key:"split",value:function split(from){var result=new TextView(this.text.slice(from));this.text=this.text.slice(0,from);this.markDirty();result.flags|=this.flags&8;return result;}},{key:"localPosFromDOM",value:function localPosFromDOM(node,offset){return node==this.dom?offset:offset?this.text.length:0;}},{key:"domAtPos",value:function domAtPos(pos){return new DOMPos(this.dom,pos);}},{key:"domBoundsAround",value:function domBoundsAround(_from,_to,offset){return{from:offset,to:offset+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling};}},{key:"coordsAt",value:function coordsAt(pos,side){return textCoords(this.dom,pos,side);}}]);return TextView;}(ContentView);var MarkView=/*#__PURE__*/function(_ContentView2){_inherits(MarkView,_ContentView2);var _super5=_createSuper(MarkView);function MarkView(mark){var _this9;var children=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var length=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;_classCallCheck(this,MarkView);_this9=_super5.call(this);_this9.mark=mark;_this9.children=children;_this9.length=length;var _iterator37=_createForOfIteratorHelper(children),_step37;try{for(_iterator37.s();!(_step37=_iterator37.n()).done;){var ch=_step37.value;ch.setParent(_assertThisInitialized(_this9));}}catch(err){_iterator37.e(err);}finally{_iterator37.f();}return _this9;}_createClass(MarkView,[{key:"setAttrs",value:function setAttrs(dom){clearAttributes(dom);if(this.mark["class"])dom.className=this.mark["class"];if(this.mark.attrs)for(var name2 in this.mark.attrs){dom.setAttribute(name2,this.mark.attrs[name2]);}return dom;}},{key:"canReuseDOM",value:function canReuseDOM(other){return _get(_getPrototypeOf(MarkView.prototype),"canReuseDOM",this).call(this,other)&&!((this.flags|other.flags)&8);}},{key:"reuseDOM",value:function reuseDOM(node){if(node.nodeName==this.mark.tagName.toUpperCase()){this.setDOM(node);this.flags|=4|2;}}},{key:"sync",value:function sync(view,track){if(!this.dom)this.setDOM(this.setAttrs(document.createElement(this.mark.tagName)));else if(this.flags&4)this.setAttrs(this.dom);_get(_getPrototypeOf(MarkView.prototype),"sync",this).call(this,view,track);}},{key:"merge",value:function merge(from,to,source,_hasStart,openStart,openEnd){if(source&&(!(source instanceof MarkView&&source.mark.eq(this.mark))||from&&openStart<=0||to<this.length&&openEnd<=0))return false;mergeChildrenInto(this,from,to,source?source.children:[],openStart-1,openEnd-1);this.markDirty();return true;}},{key:"split",value:function split(from){var result=[],off=0,detachFrom=-1,i=0;var _iterator38=_createForOfIteratorHelper(this.children),_step38;try{for(_iterator38.s();!(_step38=_iterator38.n()).done;){var elt2=_step38.value;var end=off+elt2.length;if(end>from)result.push(off<from?elt2.split(from-off):elt2);if(detachFrom<0&&off>=from)detachFrom=i;off=end;i++;}}catch(err){_iterator38.e(err);}finally{_iterator38.f();}var length=this.length-from;this.length=from;if(detachFrom>-1){this.children.length=detachFrom;this.markDirty();}return new MarkView(this.mark,result,length);}},{key:"domAtPos",value:function domAtPos(pos){return inlineDOMAtPos(this,pos);}},{key:"coordsAt",value:function coordsAt(pos,side){return coordsInChildren(this,pos,side);}}]);return MarkView;}(ContentView);function textCoords(text,pos,side){var length=text.nodeValue.length;if(pos>length)pos=length;var from=pos,to=pos,flatten2=0;if(pos==0&&side<0||pos==length&&side>=0){if(!(browser.chrome||browser.gecko)){if(pos){from--;flatten2=1;}else if(to<length){to++;flatten2=-1;}}}else{if(side<0)from--;else if(to<length)to++;}var rects=textRange(text,from,to).getClientRects();if(!rects.length)return null;var rect=rects[(flatten2?flatten2<0:side>=0)?0:rects.length-1];if(browser.safari&&!flatten2&&rect.width==0)rect=Array.prototype.find.call(rects,function(r){return r.width;})||rect;return flatten2?flattenRect(rect,flatten2<0):rect||null;}var WidgetView=/*#__PURE__*/function(_ContentView3){_inherits(WidgetView,_ContentView3);var _super6=_createSuper(WidgetView);function WidgetView(widget,length,side){var _this10;_classCallCheck(this,WidgetView);_this10=_super6.call(this);_this10.widget=widget;_this10.length=length;_this10.side=side;_this10.prevWidget=null;return _this10;}_createClass(WidgetView,[{key:"split",value:function split(from){var result=WidgetView.create(this.widget,this.length-from,this.side);this.length-=from;return result;}},{key:"sync",value:function sync(view){if(!this.dom||!this.widget.updateDOM(this.dom,view)){if(this.dom&&this.prevWidget)this.prevWidget.destroy(this.dom);this.prevWidget=null;this.setDOM(this.widget.toDOM(view));this.dom.contentEditable="false";}}},{key:"getSide",value:function getSide(){return this.side;}},{key:"merge",value:function merge(from,to,source,hasStart,openStart,openEnd){if(source&&(!(source instanceof WidgetView)||!this.widget.compare(source.widget)||from>0&&openStart<=0||to<this.length&&openEnd<=0))return false;this.length=from+(source?source.length:0)+(this.length-to);return true;}},{key:"become",value:function become(other){if(other instanceof WidgetView&&other.side==this.side&&this.widget.constructor==other.widget.constructor){if(!this.widget.compare(other.widget))this.markDirty(true);if(this.dom&&!this.prevWidget)this.prevWidget=this.widget;this.widget=other.widget;this.length=other.length;return true;}return false;}},{key:"ignoreMutation",value:function ignoreMutation(){return true;}},{key:"ignoreEvent",value:function ignoreEvent(event){return this.widget.ignoreEvent(event);}},{key:"overrideDOMText",get:function get(){if(this.length==0)return Text.empty;var top2=this;while(top2.parent){top2=top2.parent;}var _top=top2,view=_top.view,text=view&&view.state.doc,start=this.posAtStart;return text?text.slice(start,start+this.length):Text.empty;}},{key:"domAtPos",value:function domAtPos(pos){return(this.length?pos==0:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length);}},{key:"domBoundsAround",value:function domBoundsAround(){return null;}},{key:"coordsAt",value:function coordsAt(pos,side){var custom=this.widget.coordsAt(this.dom,pos,side);if(custom)return custom;var rects=this.dom.getClientRects(),rect=null;if(!rects.length)return null;var fromBack=this.side?this.side<0:pos>0;for(var _i63=fromBack?rects.length-1:0;;_i63+=fromBack?-1:1){rect=rects[_i63];if(pos>0?_i63==0:_i63==rects.length-1||rect.top<rect.bottom)break;}return flattenRect(rect,!fromBack);}},{key:"isEditable",get:function get(){return false;}},{key:"isWidget",get:function get(){return true;}},{key:"isHidden",get:function get(){return this.widget.isHidden;}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(WidgetView.prototype),"destroy",this).call(this);if(this.dom)this.widget.destroy(this.dom);}}],[{key:"create",value:function create(widget,length,side){return new WidgetView(widget,length,side);}}]);return WidgetView;}(ContentView);var WidgetBufferView=/*#__PURE__*/function(_ContentView4){_inherits(WidgetBufferView,_ContentView4);var _super7=_createSuper(WidgetBufferView);function WidgetBufferView(side){var _this11;_classCallCheck(this,WidgetBufferView);_this11=_super7.call(this);_this11.side=side;return _this11;}_createClass(WidgetBufferView,[{key:"length",get:function get(){return 0;}},{key:"merge",value:function merge(){return false;}},{key:"become",value:function become(other){return other instanceof WidgetBufferView&&other.side==this.side;}},{key:"split",value:function split(){return new WidgetBufferView(this.side);}},{key:"sync",value:function sync(){if(!this.dom){var dom=document.createElement("img");dom.className="cm-widgetBuffer";dom.setAttribute("aria-hidden","true");this.setDOM(dom);}}},{key:"getSide",value:function getSide(){return this.side;}},{key:"domAtPos",value:function domAtPos(pos){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom);}},{key:"localPosFromDOM",value:function localPosFromDOM(){return 0;}},{key:"domBoundsAround",value:function domBoundsAround(){return null;}},{key:"coordsAt",value:function coordsAt(pos){return this.dom.getBoundingClientRect();}},{key:"overrideDOMText",get:function get(){return Text.empty;}},{key:"isHidden",get:function get(){return true;}}]);return WidgetBufferView;}(ContentView);TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;function inlineDOMAtPos(parent,pos){var dom=parent.dom,children=parent.children,i=0;for(var off=0;i<children.length;i++){var child=children[i],end=off+child.length;if(end==off&&child.getSide()<=0)continue;if(pos>off&&pos<end&&child.dom.parentNode==dom)return child.domAtPos(pos-off);if(pos<=off)break;off=end;}for(var j=i;j>0;j--){var prev=children[j-1];if(prev.dom.parentNode==dom)return prev.domAtPos(prev.length);}for(var _j=i;_j<children.length;_j++){var next=children[_j];if(next.dom.parentNode==dom)return next.domAtPos(0);}return new DOMPos(dom,0);}function joinInlineInto(parent,view,open){var last,children=parent.children;if(open>0&&view instanceof MarkView&&children.length&&(last=children[children.length-1])instanceof MarkView&&last.mark.eq(view.mark)){joinInlineInto(last,view.children[0],open-1);}else{children.push(view);view.setParent(parent);}parent.length+=view.length;}function coordsInChildren(view,pos,side){var before=null,beforePos=-1,after=null,afterPos=-1;function scan(view2,pos2){for(var _i64=0,off=0;_i64<view2.children.length&&off<=pos2;_i64++){var child=view2.children[_i64],end=off+child.length;if(end>=pos2){if(child.children.length){scan(child,pos2-off);}else if((!after||after.isHidden&&side>0)&&(end>pos2||off==end&&child.getSide()>0)){after=child;afterPos=pos2-off;}else if(off<pos2||off==end&&child.getSide()<0&&!child.isHidden){before=child;beforePos=pos2-off;}}off=end;}}scan(view,pos);var target=(side<0?before:after)||before||after;if(target)return target.coordsAt(Math.max(0,target==before?beforePos:afterPos),side);return fallbackRect(view);}function fallbackRect(view){var last=view.dom.lastChild;if(!last)return view.dom.getBoundingClientRect();var rects=clientRectsFor(last);return rects[rects.length-1]||null;}function combineAttrs(source,target){for(var name2 in source){if(name2=="class"&&target["class"])target["class"]+=" "+source["class"];else if(name2=="style"&&target.style)target.style+=";"+source.style;else target[name2]=source[name2];}return target;}var noAttrs=/* @__PURE__ */Object.create(null);function attrsEq(a,b,ignore){if(a==b)return true;if(!a)a=noAttrs;if(!b)b=noAttrs;var keysA=Object.keys(a),keysB=Object.keys(b);if(keysA.length-(ignore&&keysA.indexOf(ignore)>-1?1:0)!=keysB.length-(ignore&&keysB.indexOf(ignore)>-1?1:0))return false;for(var _i65=0,_keysA=keysA;_i65<_keysA.length;_i65++){var key=_keysA[_i65];if(key!=ignore&&(keysB.indexOf(key)==-1||a[key]!==b[key]))return false;}return true;}function _updateAttrs(dom,prev,attrs){var changed=false;if(prev){for(var name2 in prev){if(!(attrs&&name2 in attrs)){changed=true;if(name2=="style")dom.style.cssText="";else dom.removeAttribute(name2);}}}if(attrs){for(var _name in attrs){if(!(prev&&prev[_name]==attrs[_name])){changed=true;if(_name=="style")dom.style.cssText=attrs[_name];else dom.setAttribute(_name,attrs[_name]);}}}return changed;}function getAttrs(dom){var attrs=/* @__PURE__ */Object.create(null);for(var _i66=0;_i66<dom.attributes.length;_i66++){var attr=dom.attributes[_i66];attrs[attr.name]=attr.value;}return attrs;}var LineView=/*#__PURE__*/function(_ContentView5){_inherits(LineView,_ContentView5);var _super8=_createSuper(LineView);function LineView(){var _this12;_classCallCheck(this,LineView);_this12=_super8.apply(this,arguments);_this12.children=[];_this12.length=0;_this12.prevAttrs=void 0;_this12.attrs=null;_this12.breakAfter=0;return _this12;}_createClass(LineView,[{key:"merge",value:function merge(from,to,source,hasStart,openStart,openEnd){if(source){if(!(source instanceof LineView))return false;if(!this.dom)source.transferDOM(this);}if(hasStart)this.setDeco(source?source.attrs:null);mergeChildrenInto(this,from,to,source?source.children:[],openStart,openEnd);return true;}},{key:"split",value:function split(at){var end=new LineView();end.breakAfter=this.breakAfter;if(this.length==0)return end;var _this$childPos=this.childPos(at),i=_this$childPos.i,off=_this$childPos.off;if(off){end.append(this.children[i].split(off),0);this.children[i].merge(off,this.children[i].length,null,false,0,0);i++;}for(var j=i;j<this.children.length;j++){end.append(this.children[j],0);}while(i>0&&this.children[i-1].length==0){this.children[--i].destroy();}this.children.length=i;this.markDirty();this.length=at;return end;}},{key:"transferDOM",value:function transferDOM(other){if(!this.dom)return;this.markDirty();other.setDOM(this.dom);other.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs;this.prevAttrs=void 0;this.dom=null;}},{key:"setDeco",value:function setDeco(attrs){if(!attrsEq(this.attrs,attrs)){if(this.dom){this.prevAttrs=this.attrs;this.markDirty();}this.attrs=attrs;}}},{key:"append",value:function append(child,openStart){joinInlineInto(this,child,openStart);}},{key:"addLineDeco",value:function addLineDeco(deco){var attrs=deco.spec.attributes,cls=deco.spec["class"];if(attrs)this.attrs=combineAttrs(attrs,this.attrs||{});if(cls)this.attrs=combineAttrs({"class":cls},this.attrs||{});}},{key:"domAtPos",value:function domAtPos(pos){return inlineDOMAtPos(this,pos);}},{key:"reuseDOM",value:function reuseDOM(node){if(node.nodeName=="DIV"){this.setDOM(node);this.flags|=4|2;}}},{key:"sync",value:function sync(view,track){var _a2;if(!this.dom){this.setDOM(document.createElement("div"));this.dom.className="cm-line";this.prevAttrs=this.attrs?null:void 0;}else if(this.flags&4){clearAttributes(this.dom);this.dom.className="cm-line";this.prevAttrs=this.attrs?null:void 0;}if(this.prevAttrs!==void 0){_updateAttrs(this.dom,this.prevAttrs,this.attrs);this.dom.classList.add("cm-line");this.prevAttrs=void 0;}_get(_getPrototypeOf(LineView.prototype),"sync",this).call(this,view,track);var last=this.dom.lastChild;while(last&&ContentView.get(last)instanceof MarkView){last=last.lastChild;}if(!last||!this.length||last.nodeName!="BR"&&((_a2=ContentView.get(last))===null||_a2===void 0?void 0:_a2.isEditable)==false&&(!browser.ios||!this.children.some(function(ch){return ch instanceof TextView;}))){var hack=document.createElement("BR");hack.cmIgnore=true;this.dom.appendChild(hack);}}},{key:"measureTextSize",value:function measureTextSize(){if(this.children.length==0||this.length>20)return null;var totalWidth=0,textHeight;var _iterator39=_createForOfIteratorHelper(this.children),_step39;try{for(_iterator39.s();!(_step39=_iterator39.n()).done;){var child=_step39.value;if(!(child instanceof TextView)||/[^ -~]/.test(child.text))return null;var rects=clientRectsFor(child.dom);if(rects.length!=1)return null;totalWidth+=rects[0].width;textHeight=rects[0].height;}}catch(err){_iterator39.e(err);}finally{_iterator39.f();}return!totalWidth?null:{lineHeight:this.dom.getBoundingClientRect().height,charWidth:totalWidth/this.length,textHeight:textHeight};}},{key:"coordsAt",value:function coordsAt(pos,side){var rect=coordsInChildren(this,pos,side);if(!this.children.length&&rect&&this.parent){var heightOracle=this.parent.view.viewState.heightOracle,height=rect.bottom-rect.top;if(Math.abs(height-heightOracle.lineHeight)<2&&heightOracle.textHeight<height){var dist2=(height-heightOracle.textHeight)/2;return{top:rect.top+dist2,bottom:rect.bottom-dist2,left:rect.left,right:rect.left};}}return rect;}},{key:"become",value:function become(_other){return false;}},{key:"covers",value:function covers(){return true;}}],[{key:"find",value:function find(docView,pos){for(var _i67=0,off=0;_i67<docView.children.length;_i67++){var block=docView.children[_i67],end=off+block.length;if(end>=pos){if(block instanceof LineView)return block;if(end>pos)break;}off=end+block.breakAfter;}return null;}}]);return LineView;}(ContentView);var BlockWidgetView=/*#__PURE__*/function(_ContentView6){_inherits(BlockWidgetView,_ContentView6);var _super9=_createSuper(BlockWidgetView);function BlockWidgetView(widget,length,deco){var _this13;_classCallCheck(this,BlockWidgetView);_this13=_super9.call(this);_this13.widget=widget;_this13.length=length;_this13.deco=deco;_this13.breakAfter=0;_this13.prevWidget=null;return _this13;}_createClass(BlockWidgetView,[{key:"merge",value:function merge(from,to,source,_takeDeco,openStart,openEnd){if(source&&(!(source instanceof BlockWidgetView)||!this.widget.compare(source.widget)||from>0&&openStart<=0||to<this.length&&openEnd<=0))return false;this.length=from+(source?source.length:0)+(this.length-to);return true;}},{key:"domAtPos",value:function domAtPos(pos){return pos==0?DOMPos.before(this.dom):DOMPos.after(this.dom,pos==this.length);}},{key:"split",value:function split(at){var len=this.length-at;this.length=at;var end=new BlockWidgetView(this.widget,len,this.deco);end.breakAfter=this.breakAfter;return end;}},{key:"children",get:function get(){return noChildren;}},{key:"sync",value:function sync(view){if(!this.dom||!this.widget.updateDOM(this.dom,view)){if(this.dom&&this.prevWidget)this.prevWidget.destroy(this.dom);this.prevWidget=null;this.setDOM(this.widget.toDOM(view));this.dom.contentEditable="false";}}},{key:"overrideDOMText",get:function get(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty;}},{key:"domBoundsAround",value:function domBoundsAround(){return null;}},{key:"become",value:function become(other){if(other instanceof BlockWidgetView&&other.widget.constructor==this.widget.constructor){if(!other.widget.compare(this.widget))this.markDirty(true);if(this.dom&&!this.prevWidget)this.prevWidget=this.widget;this.widget=other.widget;this.length=other.length;this.deco=other.deco;this.breakAfter=other.breakAfter;return true;}return false;}},{key:"ignoreMutation",value:function ignoreMutation(){return true;}},{key:"ignoreEvent",value:function ignoreEvent(event){return this.widget.ignoreEvent(event);}},{key:"isEditable",get:function get(){return false;}},{key:"isWidget",get:function get(){return true;}},{key:"coordsAt",value:function coordsAt(pos,side){return this.widget.coordsAt(this.dom,pos,side);}},{key:"destroy",value:function destroy(){_get(_getPrototypeOf(BlockWidgetView.prototype),"destroy",this).call(this);if(this.dom)this.widget.destroy(this.dom);}},{key:"covers",value:function covers(side){var _this$deco=this.deco,startSide=_this$deco.startSide,endSide=_this$deco.endSide;return startSide==endSide?false:side<0?startSide<0:endSide>0;}}]);return BlockWidgetView;}(ContentView);var WidgetType=/*#__PURE__*/function(){function WidgetType(){_classCallCheck(this,WidgetType);}_createClass(WidgetType,[{key:"eq",value:function eq(widget){return false;}},{key:"updateDOM",value:function updateDOM(dom,view){return false;}},{key:"compare",value:function compare(other){return this==other||this.constructor==other.constructor&&this.eq(other);}},{key:"estimatedHeight",get:function get(){return-1;}},{key:"lineBreaks",get:function get(){return 0;}},{key:"ignoreEvent",value:function ignoreEvent(event){return true;}},{key:"coordsAt",value:function coordsAt(dom,pos,side){return null;}},{key:"isHidden",get:function get(){return false;}},{key:"destroy",value:function destroy(dom){}}]);return WidgetType;}();var BlockType=/* @__PURE__ */function(BlockType2){BlockType2[BlockType2["Text"]=0]="Text";BlockType2[BlockType2["WidgetBefore"]=1]="WidgetBefore";BlockType2[BlockType2["WidgetAfter"]=2]="WidgetAfter";BlockType2[BlockType2["WidgetRange"]=3]="WidgetRange";return BlockType2;}(BlockType||(BlockType={}));var Decoration=/*#__PURE__*/function(_RangeValue){_inherits(Decoration,_RangeValue);var _super10=_createSuper(Decoration);function Decoration(startSide,endSide,widget,spec){var _this14;_classCallCheck(this,Decoration);_this14=_super10.call(this);_this14.startSide=startSide;_this14.endSide=endSide;_this14.widget=widget;_this14.spec=spec;return _this14;}_createClass(Decoration,[{key:"heightRelevant",get:function get(){return false;}},{key:"hasHeight",value:function hasHeight(){return this.widget?this.widget.estimatedHeight>-1:false;}}],[{key:"mark",value:function mark(spec){return new MarkDecoration(spec);}},{key:"widget",value:function widget(spec){var side=Math.max(-1e4,Math.min(1e4,spec.side||0)),block=!!spec.block;side+=block&&!spec.inlineOrder?side>0?3e8:-4e8:side>0?1e8:-1e8;return new PointDecoration(spec,side,side,block,spec.widget||null,false);}},{key:"replace",value:function replace(spec){var block=!!spec.block,startSide,endSide;if(spec.isBlockGap){startSide=-5e8;endSide=4e8;}else{var _getInclusive=getInclusive(spec,block),start=_getInclusive.start,end=_getInclusive.end;startSide=(start?block?-3e8:-1:5e8)-1;endSide=(end?block?2e8:1:-6e8)+1;}return new PointDecoration(spec,startSide,endSide,block,spec.widget||null,true);}},{key:"line",value:function line(spec){return new LineDecoration(spec);}},{key:"set",value:function set(of){var sort=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;return RangeSet.of(of,sort);}}]);return Decoration;}(RangeValue);Decoration.none=RangeSet.empty;var MarkDecoration=/*#__PURE__*/function(_Decoration){_inherits(MarkDecoration,_Decoration);var _super11=_createSuper(MarkDecoration);function MarkDecoration(spec){var _this15;_classCallCheck(this,MarkDecoration);var _getInclusive2=getInclusive(spec),start=_getInclusive2.start,end=_getInclusive2.end;_this15=_super11.call(this,start?-1:5e8,end?1:-6e8,null,spec);_this15.tagName=spec.tagName||"span";_this15["class"]=spec["class"]||"";_this15.attrs=spec.attributes||null;return _this15;}_createClass(MarkDecoration,[{key:"eq",value:function eq(other){var _a2,_b;return this==other||other instanceof MarkDecoration&&this.tagName==other.tagName&&(this["class"]||((_a2=this.attrs)===null||_a2===void 0?void 0:_a2["class"]))==(other["class"]||((_b=other.attrs)===null||_b===void 0?void 0:_b["class"]))&&attrsEq(this.attrs,other.attrs,"class");}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(from>=to)throw new RangeError("Mark decorations may not be empty");return _get(_getPrototypeOf(MarkDecoration.prototype),"range",this).call(this,from,to);}}]);return MarkDecoration;}(Decoration);MarkDecoration.prototype.point=false;var LineDecoration=/*#__PURE__*/function(_Decoration2){_inherits(LineDecoration,_Decoration2);var _super12=_createSuper(LineDecoration);function LineDecoration(spec){_classCallCheck(this,LineDecoration);return _super12.call(this,-2e8,-2e8,null,spec);}_createClass(LineDecoration,[{key:"eq",value:function eq(other){return other instanceof LineDecoration&&this.spec["class"]==other.spec["class"]&&attrsEq(this.spec.attributes,other.spec.attributes);}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(to!=from)throw new RangeError("Line decoration ranges must be zero-length");return _get(_getPrototypeOf(LineDecoration.prototype),"range",this).call(this,from,to);}}]);return LineDecoration;}(Decoration);LineDecoration.prototype.mapMode=MapMode.TrackBefore;LineDecoration.prototype.point=true;var PointDecoration=/*#__PURE__*/function(_Decoration3){_inherits(PointDecoration,_Decoration3);var _super13=_createSuper(PointDecoration);function PointDecoration(spec,startSide,endSide,block,widget,isReplace){var _this16;_classCallCheck(this,PointDecoration);_this16=_super13.call(this,startSide,endSide,widget,spec);_this16.block=block;_this16.isReplace=isReplace;_this16.mapMode=!block?MapMode.TrackDel:startSide<=0?MapMode.TrackBefore:MapMode.TrackAfter;return _this16;}_createClass(PointDecoration,[{key:"type",get:function get(){return this.startSide!=this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter;}},{key:"heightRelevant",get:function get(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0);}},{key:"eq",value:function eq(other){return other instanceof PointDecoration&&widgetsEq(this.widget,other.widget)&&this.block==other.block&&this.startSide==other.startSide&&this.endSide==other.endSide;}},{key:"range",value:function range(from){var to=arguments.length>1&&arguments[1]!==undefined?arguments[1]:from;if(this.isReplace&&(from>to||from==to&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&to!=from)throw new RangeError("Widget decorations can only have zero-length ranges");return _get(_getPrototypeOf(PointDecoration.prototype),"range",this).call(this,from,to);}}]);return PointDecoration;}(Decoration);PointDecoration.prototype.point=true;function getInclusive(spec){var block=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var start=spec.inclusiveStart,end=spec.inclusiveEnd;if(start==null)start=spec.inclusive;if(end==null)end=spec.inclusive;return{start:start!==null&&start!==void 0?start:block,end:end!==null&&end!==void 0?end:block};}function widgetsEq(a,b){return a==b||!!(a&&b&&a.compare(b));}function addRange(from,to,ranges){var margin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var last=ranges.length-1;if(last>=0&&ranges[last]+margin>=from)ranges[last]=Math.max(ranges[last],to);else ranges.push(from,to);}var ContentBuilder=/*#__PURE__*/function(){function ContentBuilder(doc2,pos,end,disallowBlockEffectsFor){_classCallCheck(this,ContentBuilder);this.doc=doc2;this.pos=pos;this.end=end;this.disallowBlockEffectsFor=disallowBlockEffectsFor;this.content=[];this.curLine=null;this.breakAtStart=0;this.pendingBuffer=0;this.bufferMarks=[];this.atCursorPos=true;this.openStart=-1;this.openEnd=-1;this.text="";this.textOff=0;this.cursor=doc2.iter();this.skip=pos;}_createClass(ContentBuilder,[{key:"posCovered",value:function posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;var last=this.content[this.content.length-1];return!(last.breakAfter||last instanceof BlockWidgetView&&last.deco.endSide<0);}},{key:"getLine",value:function getLine(){if(!this.curLine){this.content.push(this.curLine=new LineView());this.atCursorPos=true;}return this.curLine;}},{key:"flushBuffer",value:function flushBuffer(){var active=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.bufferMarks;if(this.pendingBuffer){this.curLine.append(wrapMarks(new WidgetBufferView(-1),active),active.length);this.pendingBuffer=0;}}},{key:"addBlockWidget",value:function addBlockWidget(view){this.flushBuffer();this.curLine=null;this.content.push(view);}},{key:"finish",value:function finish(openEnd){if(this.pendingBuffer&&openEnd<=this.bufferMarks.length)this.flushBuffer();else this.pendingBuffer=0;if(!this.posCovered()&&!(openEnd&&this.content.length&&this.content[this.content.length-1]instanceof BlockWidgetView))this.getLine();}},{key:"buildText",value:function buildText(length,active,openStart){while(length>0){if(this.textOff==this.text.length){var _this$cursor$next2=this.cursor.next(this.skip),value=_this$cursor$next2.value,lineBreak=_this$cursor$next2.lineBreak,done=_this$cursor$next2.done;this.skip=0;if(done)throw new Error("Ran out of text content when drawing inline views");if(lineBreak){if(!this.posCovered())this.getLine();if(this.content.length)this.content[this.content.length-1].breakAfter=1;else this.breakAtStart=1;this.flushBuffer();this.curLine=null;this.atCursorPos=true;length--;continue;}else{this.text=value;this.textOff=0;}}var take=Math.min(this.text.length-this.textOff,length,512);this.flushBuffer(active.slice(active.length-openStart));this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+take)),active),openStart);this.atCursorPos=true;this.textOff+=take;length-=take;openStart=0;}}},{key:"span",value:function span(from,to,active,openStart){this.buildText(to-from,active,openStart);this.pos=to;if(this.openStart<0)this.openStart=openStart;}},{key:"point",value:function point(from,to,deco,active,openStart,index){if(this.disallowBlockEffectsFor[index]&&deco instanceof PointDecoration){if(deco.block)throw new RangeError("Block decorations may not be specified via plugins");if(to>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins");}var len=to-from;if(deco instanceof PointDecoration){if(deco.block){if(deco.startSide>0&&!this.posCovered())this.getLine();this.addBlockWidget(new BlockWidgetView(deco.widget||new NullWidget("div"),len,deco));}else{var view=WidgetView.create(deco.widget||new NullWidget("span"),len,len?0:deco.startSide);var cursorBefore=this.atCursorPos&&!view.isEditable&&openStart<=active.length&&(from<to||deco.startSide>0);var cursorAfter=!view.isEditable&&(from<to||openStart>active.length||deco.startSide<=0);var line=this.getLine();if(this.pendingBuffer==2&&!cursorBefore&&!view.isEditable)this.pendingBuffer=0;this.flushBuffer(active);if(cursorBefore){line.append(wrapMarks(new WidgetBufferView(1),active),openStart);openStart=active.length+Math.max(0,openStart-active.length);}line.append(wrapMarks(view,active),openStart);this.atCursorPos=cursorAfter;this.pendingBuffer=!cursorAfter?0:from<to||openStart>active.length?1:2;if(this.pendingBuffer)this.bufferMarks=active.slice();}}else if(this.doc.lineAt(this.pos).from==this.pos){this.getLine().addLineDeco(deco);}if(len){if(this.textOff+len<=this.text.length){this.textOff+=len;}else{this.skip+=len-(this.text.length-this.textOff);this.text="";this.textOff=0;}this.pos=to;}if(this.openStart<0)this.openStart=openStart;}}],[{key:"build",value:function build(text,from,to,decorations2,dynamicDecorationMap){var builder=new ContentBuilder(text,from,to,dynamicDecorationMap);builder.openEnd=RangeSet.spans(decorations2,from,to,builder);if(builder.openStart<0)builder.openStart=builder.openEnd;builder.finish(builder.openEnd);return builder;}}]);return ContentBuilder;}();function wrapMarks(view,active){var _iterator40=_createForOfIteratorHelper(active),_step40;try{for(_iterator40.s();!(_step40=_iterator40.n()).done;){var mark=_step40.value;view=new MarkView(mark,[view],view.length);}}catch(err){_iterator40.e(err);}finally{_iterator40.f();}return view;}var NullWidget=/*#__PURE__*/function(_WidgetType){_inherits(NullWidget,_WidgetType);var _super14=_createSuper(NullWidget);function NullWidget(tag){var _this17;_classCallCheck(this,NullWidget);_this17=_super14.call(this);_this17.tag=tag;return _this17;}_createClass(NullWidget,[{key:"eq",value:function eq(other){return other.tag==this.tag;}},{key:"toDOM",value:function toDOM(){return document.createElement(this.tag);}},{key:"updateDOM",value:function updateDOM(elt2){return elt2.nodeName.toLowerCase()==this.tag;}},{key:"isHidden",get:function get(){return true;}}]);return NullWidget;}(WidgetType);var clickAddsSelectionRange=/* @__PURE__ */Facet.define();var dragMovesSelection$1=/* @__PURE__ */Facet.define();var mouseSelectionStyle=/* @__PURE__ */Facet.define();var exceptionSink=/* @__PURE__ */Facet.define();var updateListener=/* @__PURE__ */Facet.define();var inputHandler=/* @__PURE__ */Facet.define();var focusChangeEffect=/* @__PURE__ */Facet.define();var perLineTextDirection=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.some(function(x){return x;});}});var nativeSelectionHidden=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.some(function(x){return x;});}});var ScrollTarget=/*#__PURE__*/function(){function ScrollTarget(range){var y=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"nearest";var x=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"nearest";var yMargin=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;var xMargin=arguments.length>4&&arguments[4]!==undefined?arguments[4]:5;var isSnapshot=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;_classCallCheck(this,ScrollTarget);this.range=range;this.y=y;this.x=x;this.yMargin=yMargin;this.xMargin=xMargin;this.isSnapshot=isSnapshot;}_createClass(ScrollTarget,[{key:"map",value:function map(changes){return changes.empty?this:new ScrollTarget(this.range.map(changes),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot);}},{key:"clip",value:function clip(state){return this.range.to<=state.doc.length?this:new ScrollTarget(EditorSelection.cursor(state.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot);}}]);return ScrollTarget;}();var _scrollIntoView=/* @__PURE__ */StateEffect.define({map:function map(t2,ch){return t2.map(ch);}});function logException(state,exception,context){var handler=state.facet(exceptionSink);if(handler.length)handler[0](exception);else if(window.onerror)window.onerror(String(exception),context,void 0,void 0,exception);else if(context)console.error(context+":",exception);else console.error(exception);}var editable=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.length?values2[0]:true;}});var nextPluginID=0;var viewPlugin=/* @__PURE__ */Facet.define();var ViewPlugin=/*#__PURE__*/function(){function ViewPlugin(id2,create,domEventHandlers,domEventObservers,buildExtensions){_classCallCheck(this,ViewPlugin);this.id=id2;this.create=create;this.domEventHandlers=domEventHandlers;this.domEventObservers=domEventObservers;this.extension=buildExtensions(this);}_createClass(ViewPlugin,null,[{key:"define",value:function define(create,spec){var _ref4=spec||{},eventHandlers=_ref4.eventHandlers,eventObservers=_ref4.eventObservers,provide=_ref4.provide,deco=_ref4.decorations;return new ViewPlugin(nextPluginID++,create,eventHandlers,eventObservers,function(plugin){var ext=[viewPlugin.of(plugin)];if(deco)ext.push(decorations.of(function(view){var pluginInst=view.plugin(plugin);return pluginInst?deco(pluginInst):Decoration.none;}));if(provide)ext.push(provide(plugin));return ext;});}},{key:"fromClass",value:function fromClass(cls,spec){return ViewPlugin.define(function(view){return new cls(view);},spec);}}]);return ViewPlugin;}();var PluginInstance=/*#__PURE__*/function(){function PluginInstance(spec){_classCallCheck(this,PluginInstance);this.spec=spec;this.mustUpdate=null;this.value=null;}_createClass(PluginInstance,[{key:"update",value:function update(view){if(!this.value){if(this.spec){try{this.value=this.spec.create(view);}catch(e){logException(view.state,e,"CodeMirror plugin crashed");this.deactivate();}}}else if(this.mustUpdate){var update=this.mustUpdate;this.mustUpdate=null;if(this.value.update){try{this.value.update(update);}catch(e){logException(update.state,e,"CodeMirror plugin crashed");if(this.value.destroy)try{this.value.destroy();}catch(_){}this.deactivate();}}}return this;}},{key:"destroy",value:function destroy(view){var _a2;if((_a2=this.value)===null||_a2===void 0?void 0:_a2.destroy){try{this.value.destroy();}catch(e){logException(view.state,e,"CodeMirror plugin crashed");}}}},{key:"deactivate",value:function deactivate(){this.spec=this.value=null;}}]);return PluginInstance;}();var editorAttributes=/* @__PURE__ */Facet.define();var contentAttributes=/* @__PURE__ */Facet.define();var decorations=/* @__PURE__ */Facet.define();var atomicRanges=/* @__PURE__ */Facet.define();var bidiIsolatedRanges=/* @__PURE__ */Facet.define();function getIsolatedRanges(view,from,to){var isolates=view.state.facet(bidiIsolatedRanges);if(!isolates.length)return isolates;var sets=isolates.map(function(i){return i instanceof Function?i(view):i;});var result=[];RangeSet.spans(sets,from,to,{point:function point(){},span:function span(from2,to2,active,open){var level=result;for(var _i68=active.length-1;_i68>=0;_i68--,open--){var iso=active[_i68].spec.bidiIsolate,update=void 0;if(iso==null)continue;if(open>0&&level.length&&(update=level[level.length-1]).to==from2&&update.direction==iso){update.to=to2;level=update.inner;}else{var add2={from:from2,to:to2,direction:iso,inner:[]};level.push(add2);level=add2.inner;}}}});return result;}var scrollMargins=/* @__PURE__ */Facet.define();function getScrollMargins(view){var left=0,right=0,top2=0,bottom=0;var _iterator41=_createForOfIteratorHelper(view.state.facet(scrollMargins)),_step41;try{for(_iterator41.s();!(_step41=_iterator41.n()).done;){var source=_step41.value;var m=source(view);if(m){if(m.left!=null)left=Math.max(left,m.left);if(m.right!=null)right=Math.max(right,m.right);if(m.top!=null)top2=Math.max(top2,m.top);if(m.bottom!=null)bottom=Math.max(bottom,m.bottom);}}}catch(err){_iterator41.e(err);}finally{_iterator41.f();}return{left:left,right:right,top:top2,bottom:bottom};}var styleModule=/* @__PURE__ */Facet.define();var ChangedRange=/*#__PURE__*/function(){function ChangedRange(fromA,toA,fromB,toB){_classCallCheck(this,ChangedRange);this.fromA=fromA;this.toA=toA;this.fromB=fromB;this.toB=toB;}_createClass(ChangedRange,[{key:"join",value:function join(other){return new ChangedRange(Math.min(this.fromA,other.fromA),Math.max(this.toA,other.toA),Math.min(this.fromB,other.fromB),Math.max(this.toB,other.toB));}},{key:"addToSet",value:function addToSet(set){var i=set.length,me=this;for(;i>0;i--){var range=set[i-1];if(range.fromA>me.toA)continue;if(range.toA<me.fromA)break;me=me.join(range);set.splice(i-1,1);}set.splice(i,0,me);return set;}}],[{key:"extendWithRanges",value:function extendWithRanges(diff,ranges){if(ranges.length==0)return diff;var result=[];for(var dI=0,rI=0,posA=0,posB=0;;dI++){var next=dI==diff.length?null:diff[dI],off=posA-posB;var end=next?next.fromB:1e9;while(rI<ranges.length&&ranges[rI]<end){var from=ranges[rI],to=ranges[rI+1];var fromB=Math.max(posB,from),toB=Math.min(end,to);if(fromB<=toB)new ChangedRange(fromB+off,toB+off,fromB,toB).addToSet(result);if(to>end)break;else rI+=2;}if(!next)return result;new ChangedRange(next.fromA,next.toA,next.fromB,next.toB).addToSet(result);posA=next.toA;posB=next.toB;}}}]);return ChangedRange;}();var ViewUpdate=/*#__PURE__*/function(){function ViewUpdate(view,state,transactions){_classCallCheck(this,ViewUpdate);this.view=view;this.state=state;this.transactions=transactions;this.flags=0;this.startState=view.state;this.changes=ChangeSet.empty(this.startState.doc.length);var _iterator42=_createForOfIteratorHelper(transactions),_step42;try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var tr=_step42.value;this.changes=this.changes.compose(tr.changes);}}catch(err){_iterator42.e(err);}finally{_iterator42.f();}var changedRanges=[];this.changes.iterChangedRanges(function(fromA,toA,fromB,toB){return changedRanges.push(new ChangedRange(fromA,toA,fromB,toB));});this.changedRanges=changedRanges;}_createClass(ViewUpdate,[{key:"viewportChanged",get:function get(){return(this.flags&4)>0;}},{key:"heightChanged",get:function get(){return(this.flags&2)>0;}},{key:"geometryChanged",get:function get(){return this.docChanged||(this.flags&(8|2))>0;}},{key:"focusChanged",get:function get(){return(this.flags&1)>0;}},{key:"docChanged",get:function get(){return!this.changes.empty;}},{key:"selectionSet",get:function get(){return this.transactions.some(function(tr){return tr.selection;});}},{key:"empty",get:function get(){return this.flags==0&&this.transactions.length==0;}}],[{key:"create",value:function create(view,state,transactions){return new ViewUpdate(view,state,transactions);}}]);return ViewUpdate;}();var Direction=/* @__PURE__ */function(Direction2){Direction2[Direction2["LTR"]=0]="LTR";Direction2[Direction2["RTL"]=1]="RTL";return Direction2;}(Direction||(Direction={}));var LTR=Direction.LTR;var RTL=Direction.RTL;function dec(str){var result=[];for(var _i69=0;_i69<str.length;_i69++){result.push(1<<+str[_i69]);}return result;}var LowTypes=/* @__PURE__ */dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008");var ArabicTypes=/* @__PURE__ */dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333");var Brackets=/* @__PURE__ */Object.create(null);var BracketStack=[];for(var _i70=0,_arr2=["()","[]","{}"];_i70<_arr2.length;_i70++){var p=_arr2[_i70];var l=/* @__PURE__ */p.charCodeAt(0),r=/* @__PURE__ */p.charCodeAt(1);Brackets[l]=r;Brackets[r]=-l;}function charType(ch){return ch<=247?LowTypes[ch]:1424<=ch&&ch<=1524?2:1536<=ch&&ch<=1785?ArabicTypes[ch-1536]:1774<=ch&&ch<=2220?4:8192<=ch&&ch<=8203?256:64336<=ch&&ch<=65023?4:ch==8204?256:1;}var BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;var BidiSpan=/*#__PURE__*/function(){function BidiSpan(from,to,level){_classCallCheck(this,BidiSpan);this.from=from;this.to=to;this.level=level;}_createClass(BidiSpan,[{key:"dir",get:function get(){return this.level%2?RTL:LTR;}},{key:"side",value:function side(end,dir){return this.dir==dir==end?this.to:this.from;}}],[{key:"find",value:function find(order,index,level,assoc){var maybe=-1;for(var _i71=0;_i71<order.length;_i71++){var span=order[_i71];if(span.from<=index&&span.to>=index){if(span.level==level)return _i71;if(maybe<0||(assoc!=0?assoc<0?span.from<index:span.to>index:order[maybe].level>span.level))maybe=_i71;}}if(maybe<0)throw new RangeError("Index out of range");return maybe;}}]);return BidiSpan;}();function isolatesEq(a,b){if(a.length!=b.length)return false;for(var _i72=0;_i72<a.length;_i72++){var iA=a[_i72],iB=b[_i72];if(iA.from!=iB.from||iA.to!=iB.to||iA.direction!=iB.direction||!isolatesEq(iA.inner,iB.inner))return false;}return true;}var types=[];function computeCharTypes(line,rFrom,rTo,isolates,outerType){for(var iI=0;iI<=isolates.length;iI++){var from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;var prevType=iI?256:outerType;for(var _i73=from,prev=prevType,prevStrong=prevType;_i73<to;_i73++){var type=charType(line.charCodeAt(_i73));if(type==512)type=prev;else if(type==8&&prevStrong==4)type=16;types[_i73]=type==4?2:type;if(type&7)prevStrong=type;prev=type;}for(var _i74=from,_prev=prevType,_prevStrong=prevType;_i74<to;_i74++){var _type2=types[_i74];if(_type2==128){if(_i74<to-1&&_prev==types[_i74+1]&&_prev&24)_type2=types[_i74]=_prev;else types[_i74]=256;}else if(_type2==64){var end=_i74+1;while(end<to&&types[end]==64){end++;}var replace=_i74&&_prev==8||end<rTo&&types[end]==8?_prevStrong==1?1:8:256;for(var j=_i74;j<end;j++){types[j]=replace;}_i74=end-1;}else if(_type2==8&&_prevStrong==1){types[_i74]=1;}_prev=_type2;if(_type2&7)_prevStrong=_type2;}}}function processBracketPairs(line,rFrom,rTo,isolates,outerType){var oppositeType=outerType==1?2:1;for(var iI=0,sI=0,context=0;iI<=isolates.length;iI++){var from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;for(var _i75=from,ch,br,type;_i75<to;_i75++){if(br=Brackets[ch=line.charCodeAt(_i75)]){if(br<0){for(var sJ=sI-3;sJ>=0;sJ-=3){if(BracketStack[sJ+1]==-br){var flags=BracketStack[sJ+2];var type2=flags&2?outerType:!(flags&4)?0:flags&1?oppositeType:outerType;if(type2)types[_i75]=types[BracketStack[sJ]]=type2;sI=sJ;break;}}}else if(BracketStack.length==189){break;}else{BracketStack[sI++]=_i75;BracketStack[sI++]=ch;BracketStack[sI++]=context;}}else if((type=types[_i75])==2||type==1){var embed=type==outerType;context=embed?0:1;for(var _sJ=sI-3;_sJ>=0;_sJ-=3){var cur2=BracketStack[_sJ+2];if(cur2&2)break;if(embed){BracketStack[_sJ+2]|=2;}else{if(cur2&4)break;BracketStack[_sJ+2]|=4;}}}}}}function processNeutrals(rFrom,rTo,isolates,outerType){for(var iI=0,prev=outerType;iI<=isolates.length;iI++){var from=iI?isolates[iI-1].to:rFrom,to=iI<isolates.length?isolates[iI].from:rTo;for(var _i76=from;_i76<to;){var type=types[_i76];if(type==256){var end=_i76+1;for(;;){if(end==to){if(iI==isolates.length)break;end=isolates[iI++].to;to=iI<isolates.length?isolates[iI].from:rTo;}else if(types[end]==256){end++;}else{break;}}var beforeL=prev==1;var afterL=(end<rTo?types[end]:outerType)==1;var replace=beforeL==afterL?beforeL?1:2:outerType;for(var j=end,jI=iI,fromJ=jI?isolates[jI-1].to:rFrom;j>_i76;){if(j==fromJ){j=isolates[--jI].from;fromJ=jI?isolates[jI-1].to:rFrom;}types[--j]=replace;}_i76=end;}else{prev=type;_i76++;}}}}function emitSpans(line,from,to,level,baseLevel,isolates,order){var ourType=level%2?2:1;if(level%2==baseLevel%2){for(var iCh=from,iI=0;iCh<to;){var sameDir=true,isNum=false;if(iI==isolates.length||iCh<isolates[iI].from){var next=types[iCh];if(next!=ourType){sameDir=false;isNum=next==16;}}var recurse=!sameDir&&ourType==1?[]:null;var localLevel=sameDir?level:level+1;var iScan=iCh;run:for(;;){if(iI<isolates.length&&iScan==isolates[iI].from){if(isNum)break run;var iso=isolates[iI];if(!sameDir)for(var upto=iso.to,jI=iI+1;;){if(upto==to)break run;if(jI<isolates.length&&isolates[jI].from==upto)upto=isolates[jI++].to;else if(types[upto]==ourType)break run;else break;}iI++;if(recurse){recurse.push(iso);}else{if(iso.from>iCh)order.push(new BidiSpan(iCh,iso.from,localLevel));var dirSwap=iso.direction==LTR!=!(localLevel%2);computeSectionOrder(line,dirSwap?level+1:level,baseLevel,iso.inner,iso.from,iso.to,order);iCh=iso.to;}iScan=iso.to;}else if(iScan==to||(sameDir?types[iScan]!=ourType:types[iScan]==ourType)){break;}else{iScan++;}}if(recurse)emitSpans(line,iCh,iScan,level+1,baseLevel,recurse,order);else if(iCh<iScan)order.push(new BidiSpan(iCh,iScan,localLevel));iCh=iScan;}}else{for(var _iCh=to,_iI=isolates.length;_iCh>from;){var _sameDir=true,_isNum=false;if(!_iI||_iCh>isolates[_iI-1].to){var _next2=types[_iCh-1];if(_next2!=ourType){_sameDir=false;_isNum=_next2==16;}}var _recurse=!_sameDir&&ourType==1?[]:null;var _localLevel=_sameDir?level:level+1;var _iScan=_iCh;run:for(;;){if(_iI&&_iScan==isolates[_iI-1].to){if(_isNum)break run;var _iso=isolates[--_iI];if(!_sameDir)for(var _upto=_iso.from,_jI=_iI;;){if(_upto==from)break run;if(_jI&&isolates[_jI-1].to==_upto)_upto=isolates[--_jI].from;else if(types[_upto-1]==ourType)break run;else break;}if(_recurse){_recurse.push(_iso);}else{if(_iso.to<_iCh)order.push(new BidiSpan(_iso.to,_iCh,_localLevel));var _dirSwap=_iso.direction==LTR!=!(_localLevel%2);computeSectionOrder(line,_dirSwap?level+1:level,baseLevel,_iso.inner,_iso.from,_iso.to,order);_iCh=_iso.from;}_iScan=_iso.from;}else if(_iScan==from||(_sameDir?types[_iScan-1]!=ourType:types[_iScan-1]==ourType)){break;}else{_iScan--;}}if(_recurse)emitSpans(line,_iScan,_iCh,level+1,baseLevel,_recurse,order);else if(_iScan<_iCh)order.push(new BidiSpan(_iScan,_iCh,_localLevel));_iCh=_iScan;}}}function computeSectionOrder(line,level,baseLevel,isolates,from,to,order){var outerType=level%2?2:1;computeCharTypes(line,from,to,isolates,outerType);processBracketPairs(line,from,to,isolates,outerType);processNeutrals(from,to,isolates,outerType);emitSpans(line,from,to,level,baseLevel,isolates,order);}function computeOrder(line,direction,isolates){if(!line)return[new BidiSpan(0,0,direction==RTL?1:0)];if(direction==LTR&&!isolates.length&&!BidiRE.test(line))return trivialOrder(line.length);if(isolates.length)while(line.length>types.length){types[types.length]=256;}var order=[],level=direction==LTR?0:1;computeSectionOrder(line,level,level,isolates,0,line.length,order);return order;}function trivialOrder(length){return[new BidiSpan(0,length,0)];}var movedOver="";function moveVisually(line,order,dir,start,forward){var _a2;var startIndex=start.head-line.from,spanI=-1;if(startIndex==0){if(!forward||!line.length)return null;if(order[0].level!=dir){startIndex=order[0].side(false,dir);spanI=0;}}else if(startIndex==line.length){if(forward)return null;var last=order[order.length-1];if(last.level!=dir){startIndex=last.side(true,dir);spanI=order.length-1;}}if(spanI<0)spanI=BidiSpan.find(order,startIndex,(_a2=start.bidiLevel)!==null&&_a2!==void 0?_a2:-1,start.assoc);var span=order[spanI];if(startIndex==span.side(forward,dir)){span=order[spanI+=forward?1:-1];startIndex=span.side(!forward,dir);}var indexForward=forward==(span.dir==dir);var nextIndex=findClusterBreak(line.text,startIndex,indexForward);movedOver=line.text.slice(Math.min(startIndex,nextIndex),Math.max(startIndex,nextIndex));if(nextIndex!=span.side(forward,dir))return EditorSelection.cursor(nextIndex+line.from,indexForward?-1:1,span.level);var nextSpan=spanI==(forward?order.length-1:0)?null:order[spanI+(forward?1:-1)];if(!nextSpan&&span.level!=dir)return EditorSelection.cursor(forward?line.to:line.from,forward?-1:1,dir);if(nextSpan&&nextSpan.level<span.level)return EditorSelection.cursor(nextSpan.side(!forward,dir)+line.from,forward?1:-1,nextSpan.level);return EditorSelection.cursor(nextIndex+line.from,forward?-1:1,span.level);}var DocView=/*#__PURE__*/function(_ContentView7){_inherits(DocView,_ContentView7);var _super15=_createSuper(DocView);function DocView(view){var _this18;_classCallCheck(this,DocView);_this18=_super15.call(this);_this18.view=view;_this18.decorations=[];_this18.dynamicDecorationMap=[];_this18.domChanged=null;_this18.hasComposition=null;_this18.markedForComposition=/* @__PURE__ */new Set();_this18.minWidth=0;_this18.minWidthFrom=0;_this18.minWidthTo=0;_this18.impreciseAnchor=null;_this18.impreciseHead=null;_this18.forceSelection=false;_this18.lastUpdate=Date.now();_this18.setDOM(view.contentDOM);_this18.children=[new LineView()];_this18.children[0].setParent(_assertThisInitialized(_this18));_this18.updateDeco();_this18.updateInner([new ChangedRange(0,0,0,view.state.doc.length)],0,null);return _this18;}_createClass(DocView,[{key:"length",get:function get(){return this.view.state.doc.length;}},{key:"update",value:function update(_update){var _this19=this;var _a2;var changedRanges=_update.changedRanges;if(this.minWidth>0&&changedRanges.length){if(!changedRanges.every(function(_ref5){var fromA=_ref5.fromA,toA=_ref5.toA;return toA<_this19.minWidthFrom||fromA>_this19.minWidthTo;})){this.minWidth=this.minWidthFrom=this.minWidthTo=0;}else{this.minWidthFrom=_update.changes.mapPos(this.minWidthFrom,1);this.minWidthTo=_update.changes.mapPos(this.minWidthTo,1);}}var readCompositionAt=-1;if(this.view.inputState.composing>=0){if((_a2=this.domChanged)===null||_a2===void 0?void 0:_a2.newSel)readCompositionAt=this.domChanged.newSel.head;else if(!touchesComposition(_update.changes,this.hasComposition)&&!_update.selectionSet)readCompositionAt=_update.state.selection.main.head;}var composition=readCompositionAt>-1?findCompositionRange(this.view,_update.changes,readCompositionAt):null;this.domChanged=null;if(this.hasComposition){this.markedForComposition.clear();var _this$hasComposition=this.hasComposition,from=_this$hasComposition.from,to=_this$hasComposition.to;changedRanges=new ChangedRange(from,to,_update.changes.mapPos(from,-1),_update.changes.mapPos(to,1)).addToSet(changedRanges.slice());}this.hasComposition=composition?{from:composition.range.fromB,to:composition.range.toB}:null;if((browser.ie||browser.chrome)&&!composition&&_update&&_update.state.doc.lines!=_update.startState.doc.lines)this.forceSelection=true;var prevDeco=this.decorations,deco=this.updateDeco();var decoDiff=findChangedDeco(prevDeco,deco,_update.changes);changedRanges=ChangedRange.extendWithRanges(changedRanges,decoDiff);if(!(this.flags&7)&&changedRanges.length==0){return false;}else{this.updateInner(changedRanges,_update.startState.doc.length,composition);if(_update.transactions.length)this.lastUpdate=Date.now();return true;}}},{key:"updateInner",value:function updateInner(changes,oldLength,composition){var _this20=this;this.view.viewState.mustMeasureContent=true;this.updateChildren(changes,oldLength,composition);var observer=this.view.observer;observer.ignore(function(){_this20.dom.style.height=_this20.view.viewState.contentHeight/_this20.view.scaleY+"px";_this20.dom.style.flexBasis=_this20.minWidth?_this20.minWidth+"px":"";var track=browser.chrome||browser.ios?{node:observer.selectionRange.focusNode,written:false}:void 0;_this20.sync(_this20.view,track);_this20.flags&=~7;if(track&&(track.written||observer.selectionRange.focusNode!=track.node))_this20.forceSelection=true;_this20.dom.style.height="";});this.markedForComposition.forEach(function(cView){return cView.flags&=~8;});var gaps=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length){var _iterator43=_createForOfIteratorHelper(this.children),_step43;try{for(_iterator43.s();!(_step43=_iterator43.n()).done;){var child=_step43.value;if(child instanceof BlockWidgetView&&child.widget instanceof BlockGapWidget)gaps.push(child.dom);}}catch(err){_iterator43.e(err);}finally{_iterator43.f();}}observer.updateGaps(gaps);}},{key:"updateChildren",value:function updateChildren(changes,oldLength,composition){var ranges=composition?composition.range.addToSet(changes.slice()):changes;var cursor2=this.childCursor(oldLength);for(var _i77=ranges.length-1;;_i77--){var next=_i77>=0?ranges[_i77]:null;if(!next)break;var fromA=next.fromA,toA=next.toA,fromB=next.fromB,toB=next.toB,content2=void 0,breakAtStart=void 0,openStart=void 0,openEnd=void 0;if(composition&&composition.range.fromB<toB&&composition.range.toB>fromB){var before=ContentBuilder.build(this.view.state.doc,fromB,composition.range.fromB,this.decorations,this.dynamicDecorationMap);var after=ContentBuilder.build(this.view.state.doc,composition.range.toB,toB,this.decorations,this.dynamicDecorationMap);breakAtStart=before.breakAtStart;openStart=before.openStart;openEnd=after.openEnd;var compLine=this.compositionView(composition);if(after.breakAtStart){compLine.breakAfter=1;}else if(after.content.length&&compLine.merge(compLine.length,compLine.length,after.content[0],false,after.openStart,0)){compLine.breakAfter=after.content[0].breakAfter;after.content.shift();}if(before.content.length&&compLine.merge(0,0,before.content[before.content.length-1],true,0,before.openEnd)){before.content.pop();}content2=before.content.concat(compLine).concat(after.content);}else{var _ContentBuilder$build=ContentBuilder.build(this.view.state.doc,fromB,toB,this.decorations,this.dynamicDecorationMap);content2=_ContentBuilder$build.content;breakAtStart=_ContentBuilder$build.breakAtStart;openStart=_ContentBuilder$build.openStart;openEnd=_ContentBuilder$build.openEnd;}var _cursor2$findPos=cursor2.findPos(toA,1),toI=_cursor2$findPos.i,toOff=_cursor2$findPos.off;var _cursor2$findPos2=cursor2.findPos(fromA,-1),fromI=_cursor2$findPos2.i,fromOff=_cursor2$findPos2.off;replaceRange(this,fromI,fromOff,toI,toOff,content2,breakAtStart,openStart,openEnd);}if(composition)this.fixCompositionDOM(composition);}},{key:"compositionView",value:function compositionView(composition){var cur2=new TextView(composition.text.nodeValue);cur2.flags|=8;var _iterator44=_createForOfIteratorHelper(composition.marks),_step44;try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var deco=_step44.value.deco;cur2=new MarkView(deco,[cur2],cur2.length);}}catch(err){_iterator44.e(err);}finally{_iterator44.f();}var line=new LineView();line.append(cur2,0);return line;}},{key:"fixCompositionDOM",value:function fixCompositionDOM(composition){var _this21=this;var fix=function fix(dom,cView2){cView2.flags|=8|(cView2.children.some(function(c){return c.flags&7;})?1:0);_this21.markedForComposition.add(cView2);var prev=ContentView.get(dom);if(prev&&prev!=cView2)prev.dom=null;cView2.setDOM(dom);};var pos=this.childPos(composition.range.fromB,1);var cView=this.children[pos.i];fix(composition.line,cView);for(var _i78=composition.marks.length-1;_i78>=-1;_i78--){pos=cView.childPos(pos.off,1);cView=cView.children[pos.i];fix(_i78>=0?composition.marks[_i78].node:composition.text,cView);}}},{key:"updateSelection",value:function updateSelection(){var _this22=this;var mustRead=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var fromPointer=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(mustRead||!this.view.observer.selectionRange.focusNode)this.view.observer.readSelectionRange();var activeElt=this.view.root.activeElement,focused=activeElt==this.dom;var selectionNotFocus=!focused&&hasSelection(this.dom,this.view.observer.selectionRange)&&!(activeElt&&this.dom.contains(activeElt));if(!(focused||fromPointer||selectionNotFocus))return;var force=this.forceSelection;this.forceSelection=false;var main=this.view.state.selection.main;var anchor=this.moveToLine(this.domAtPos(main.anchor));var head=main.empty?anchor:this.moveToLine(this.domAtPos(main.head));if(browser.gecko&&main.empty&&!this.hasComposition&&betweenUneditable(anchor)){var dummy=document.createTextNode("");this.view.observer.ignore(function(){return anchor.node.insertBefore(dummy,anchor.node.childNodes[anchor.offset]||null);});anchor=head=new DOMPos(dummy,0);force=true;}var domSel=this.view.observer.selectionRange;if(force||!domSel.focusNode||!isEquivalentPosition(anchor.node,anchor.offset,domSel.anchorNode,domSel.anchorOffset)||!isEquivalentPosition(head.node,head.offset,domSel.focusNode,domSel.focusOffset)){this.view.observer.ignore(function(){if(browser.android&&browser.chrome&&_this22.dom.contains(domSel.focusNode)&&inUneditable(domSel.focusNode,_this22.dom)){_this22.dom.blur();_this22.dom.focus({preventScroll:true});}var rawSel=getSelection(_this22.view.root);if(!rawSel);else if(main.empty){if(browser.gecko){var nextTo=nextToUneditable(anchor.node,anchor.offset);if(nextTo&&nextTo!=(1|2)){var _text3=nearbyTextNode(anchor.node,anchor.offset,nextTo==1?1:-1);if(_text3)anchor=new DOMPos(_text3.node,_text3.offset);}}rawSel.collapse(anchor.node,anchor.offset);if(main.bidiLevel!=null&&rawSel.caretBidiLevel!==void 0)rawSel.caretBidiLevel=main.bidiLevel;}else if(rawSel.extend){rawSel.collapse(anchor.node,anchor.offset);try{rawSel.extend(head.node,head.offset);}catch(_){}}else{var range=document.createRange();if(main.anchor>main.head){var _ref6=[head,anchor];anchor=_ref6[0];head=_ref6[1];}range.setEnd(head.node,head.offset);range.setStart(anchor.node,anchor.offset);rawSel.removeAllRanges();rawSel.addRange(range);}if(selectionNotFocus&&_this22.view.root.activeElement==_this22.dom){_this22.dom.blur();if(activeElt)activeElt.focus();}});this.view.observer.setSelectionRange(anchor,head);}this.impreciseAnchor=anchor.precise?null:new DOMPos(domSel.anchorNode,domSel.anchorOffset);this.impreciseHead=head.precise?null:new DOMPos(domSel.focusNode,domSel.focusOffset);}},{key:"enforceCursorAssoc",value:function enforceCursorAssoc(){if(this.hasComposition)return;var view=this.view,cursor2=view.state.selection.main;var sel=getSelection(view.root);var _view$observer$select=view.observer.selectionRange,anchorNode=_view$observer$select.anchorNode,anchorOffset=_view$observer$select.anchorOffset;if(!sel||!cursor2.empty||!cursor2.assoc||!sel.modify)return;var line=LineView.find(this,cursor2.head);if(!line)return;var lineStart=line.posAtStart;if(cursor2.head==lineStart||cursor2.head==lineStart+line.length)return;var before=this.coordsAt(cursor2.head,-1),after=this.coordsAt(cursor2.head,1);if(!before||!after||before.bottom>after.top)return;var dom=this.domAtPos(cursor2.head+cursor2.assoc);sel.collapse(dom.node,dom.offset);sel.modify("move",cursor2.assoc<0?"forward":"backward","lineboundary");view.observer.readSelectionRange();var newRange=view.observer.selectionRange;if(view.docView.posFromDOM(newRange.anchorNode,newRange.anchorOffset)!=cursor2.from)sel.collapse(anchorNode,anchorOffset);}},{key:"moveToLine",value:function moveToLine(pos){var dom=this.dom,newPos;if(pos.node!=dom)return pos;for(var _i79=pos.offset;!newPos&&_i79<dom.childNodes.length;_i79++){var view=ContentView.get(dom.childNodes[_i79]);if(view instanceof LineView)newPos=view.domAtPos(0);}for(var _i80=pos.offset-1;!newPos&&_i80>=0;_i80--){var _view2=ContentView.get(dom.childNodes[_i80]);if(_view2 instanceof LineView)newPos=_view2.domAtPos(_view2.length);}return newPos?new DOMPos(newPos.node,newPos.offset,true):pos;}},{key:"nearest",value:function nearest(dom){for(var cur2=dom;cur2;){var domView=ContentView.get(cur2);if(domView&&domView.rootView==this)return domView;cur2=cur2.parentNode;}return null;}},{key:"posFromDOM",value:function posFromDOM(node,offset){var view=this.nearest(node);if(!view)throw new RangeError("Trying to find position for a DOM position outside of the document");return view.localPosFromDOM(node,offset)+view.posAtStart;}},{key:"domAtPos",value:function domAtPos(pos){var _this$childCursor$fin=this.childCursor().findPos(pos,-1),i=_this$childCursor$fin.i,off=_this$childCursor$fin.off;for(;i<this.children.length-1;){var child=this.children[i];if(off<child.length||child instanceof LineView)break;i++;off=0;}return this.children[i].domAtPos(off);}},{key:"coordsAt",value:function coordsAt(pos,side){var best=null,bestPos=0;for(var off=this.length,_i81=this.children.length-1;_i81>=0;_i81--){var child=this.children[_i81],end=off-child.breakAfter,start=end-child.length;if(end<pos)break;if(start<=pos&&(start<pos||child.covers(-1))&&(end>pos||child.covers(1))&&(!best||child instanceof LineView&&!(best instanceof LineView&&side>=0))){best=child;bestPos=start;}off=start;}return best?best.coordsAt(pos-bestPos,side):null;}},{key:"coordsForChar",value:function coordsForChar(pos){var _this$childPos2=this.childPos(pos,1),i=_this$childPos2.i,off=_this$childPos2.off,child=this.children[i];if(!(child instanceof LineView))return null;while(child.children.length){var _child$childPos=child.childPos(off,1),i2=_child$childPos.i,childOff=_child$childPos.off;for(;;i2++){if(i2==child.children.length)return null;if((child=child.children[i2]).length)break;}off=childOff;}if(!(child instanceof TextView))return null;var end=findClusterBreak(child.text,off);if(end==off)return null;var rects=textRange(child.dom,off,end).getClientRects();for(var _i82=0;_i82<rects.length;_i82++){var rect=rects[_i82];if(_i82==rects.length-1||rect.top<rect.bottom&&rect.left<rect.right)return rect;}return null;}},{key:"measureVisibleLineHeights",value:function measureVisibleLineHeights(viewport){var result=[],from=viewport.from,to=viewport.to;var contentWidth=this.view.contentDOM.clientWidth;var isWider=contentWidth>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1;var widest=-1,ltr=this.view.textDirection==Direction.LTR;for(var pos=0,_i83=0;_i83<this.children.length;_i83++){var child=this.children[_i83],end=pos+child.length;if(end>to)break;if(pos>=from){var childRect=child.dom.getBoundingClientRect();result.push(childRect.height);if(isWider){var last=child.dom.lastChild;var rects=last?clientRectsFor(last):[];if(rects.length){var rect=rects[rects.length-1];var width=ltr?rect.right-childRect.left:childRect.right-rect.left;if(width>widest){widest=width;this.minWidth=contentWidth;this.minWidthFrom=pos;this.minWidthTo=end;}}}}pos=end+child.breakAfter;}return result;}},{key:"textDirectionAt",value:function textDirectionAt(pos){var _this$childPos3=this.childPos(pos,1),i=_this$childPos3.i;return getComputedStyle(this.children[i].dom).direction=="rtl"?Direction.RTL:Direction.LTR;}},{key:"measureTextSize",value:function measureTextSize(){var _this23=this;var _iterator45=_createForOfIteratorHelper(this.children),_step45;try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var child=_step45.value;if(child instanceof LineView){var measure=child.measureTextSize();if(measure)return measure;}}}catch(err){_iterator45.e(err);}finally{_iterator45.f();}var dummy=document.createElement("div"),lineHeight,charWidth,textHeight;dummy.className="cm-line";dummy.style.width="99999px";dummy.style.position="absolute";dummy.textContent="abc def ghi jkl mno pqr stu";this.view.observer.ignore(function(){_this23.dom.appendChild(dummy);var rect=clientRectsFor(dummy.firstChild)[0];lineHeight=dummy.getBoundingClientRect().height;charWidth=rect?rect.width/27:7;textHeight=rect?rect.height:lineHeight;dummy.remove();});return{lineHeight:lineHeight,charWidth:charWidth,textHeight:textHeight};}},{key:"childCursor",value:function childCursor(){var pos=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.length;var i=this.children.length;if(i)pos-=this.children[--i].length;return new ChildCursor(this.children,pos,i);}},{key:"computeBlockGapDeco",value:function computeBlockGapDeco(){var deco=[],vs=this.view.viewState;for(var pos=0,_i84=0;;_i84++){var next=_i84==vs.viewports.length?null:vs.viewports[_i84];var end=next?next.from-1:this.length;if(end>pos){var height=(vs.lineBlockAt(end).bottom-vs.lineBlockAt(pos).top)/this.view.scaleY;deco.push(Decoration.replace({widget:new BlockGapWidget(height),block:true,inclusive:true,isBlockGap:true}).range(pos,end));}if(!next)break;pos=next.to+1;}return Decoration.set(deco);}},{key:"updateDeco",value:function updateDeco(){var _this24=this;var allDeco=this.view.state.facet(decorations).map(function(d,i){var dynamic=_this24.dynamicDecorationMap[i]=typeof d=="function";return dynamic?d(_this24.view):d;});for(var _i85=allDeco.length;_i85<allDeco.length+3;_i85++){this.dynamicDecorationMap[_i85]=false;}return this.decorations=[].concat(_toConsumableArray(allDeco),[this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]);}},{key:"scrollIntoView",value:function scrollIntoView(target){if(target.isSnapshot){var ref=this.view.viewState.lineBlockAt(target.range.head);this.view.scrollDOM.scrollTop=ref.top-target.yMargin;this.view.scrollDOM.scrollLeft=target.xMargin;return;}var range=target.range;var rect=this.coordsAt(range.head,range.empty?range.assoc:range.head>range.anchor?-1:1),other;if(!rect)return;if(!range.empty&&(other=this.coordsAt(range.anchor,range.anchor>range.head?-1:1)))rect={left:Math.min(rect.left,other.left),top:Math.min(rect.top,other.top),right:Math.max(rect.right,other.right),bottom:Math.max(rect.bottom,other.bottom)};var margins=getScrollMargins(this.view);var targetRect={left:rect.left-margins.left,top:rect.top-margins.top,right:rect.right+margins.right,bottom:rect.bottom+margins.bottom};var _this$view$scrollDOM=this.view.scrollDOM,offsetWidth=_this$view$scrollDOM.offsetWidth,offsetHeight=_this$view$scrollDOM.offsetHeight;scrollRectIntoView(this.view.scrollDOM,targetRect,range.head<range.anchor?-1:1,target.x,target.y,Math.max(Math.min(target.xMargin,offsetWidth),-offsetWidth),Math.max(Math.min(target.yMargin,offsetHeight),-offsetHeight),this.view.textDirection==Direction.LTR);}}]);return DocView;}(ContentView);function betweenUneditable(pos){return pos.node.nodeType==1&&pos.node.firstChild&&(pos.offset==0||pos.node.childNodes[pos.offset-1].contentEditable=="false")&&(pos.offset==pos.node.childNodes.length||pos.node.childNodes[pos.offset].contentEditable=="false");}var BlockGapWidget=/*#__PURE__*/function(_WidgetType2){_inherits(BlockGapWidget,_WidgetType2);var _super16=_createSuper(BlockGapWidget);function BlockGapWidget(height){var _this25;_classCallCheck(this,BlockGapWidget);_this25=_super16.call(this);_this25.height=height;return _this25;}_createClass(BlockGapWidget,[{key:"toDOM",value:function toDOM(){var elt2=document.createElement("div");this.updateDOM(elt2);return elt2;}},{key:"eq",value:function eq(other){return other.height==this.height;}},{key:"updateDOM",value:function updateDOM(elt2){elt2.style.height=this.height+"px";return true;}},{key:"estimatedHeight",get:function get(){return this.height;}}]);return BlockGapWidget;}(WidgetType);function findCompositionNode(view,headPos){var sel=view.observer.selectionRange;var textNode=sel.focusNode&&nearbyTextNode(sel.focusNode,sel.focusOffset,0);if(!textNode)return null;var from=headPos-textNode.offset;return{from:from,to:from+textNode.node.nodeValue.length,node:textNode.node};}function findCompositionRange(view,changes,headPos){var found=findCompositionNode(view,headPos);if(!found)return null;var textNode=found.node,from=found.from,to=found.to,text=textNode.nodeValue;if(/[\n\r]/.test(text))return null;if(view.state.doc.sliceString(found.from,found.to)!=text)return null;var inv=changes.invertedDesc;var range=new ChangedRange(inv.mapPos(from),inv.mapPos(to),from,to);var marks=[];for(var parent=textNode.parentNode;;parent=parent.parentNode){var parentView=ContentView.get(parent);if(parentView instanceof MarkView)marks.push({node:parent,deco:parentView.mark});else if(parentView instanceof LineView||parent.nodeName=="DIV"&&parent.parentNode==view.contentDOM)return{range:range,text:textNode,marks:marks,line:parent};else if(parent!=view.contentDOM)marks.push({node:parent,deco:new MarkDecoration({inclusive:true,attributes:getAttrs(parent),tagName:parent.tagName.toLowerCase()})});else return null;}}function nearbyTextNode(startNode,startOffset,side){if(side<=0)for(var node=startNode,offset=startOffset;;){if(node.nodeType==3)return{node:node,offset:offset};if(node.nodeType==1&&offset>0){node=node.childNodes[offset-1];offset=maxOffset(node);}else{break;}}if(side>=0)for(var _node=startNode,_offset=startOffset;;){if(_node.nodeType==3)return{node:_node,offset:_offset};if(_node.nodeType==1&&_offset<_node.childNodes.length&&side>=0){_node=_node.childNodes[_offset];_offset=0;}else{break;}}return null;}function nextToUneditable(node,offset){if(node.nodeType!=1)return 0;return(offset&&node.childNodes[offset-1].contentEditable=="false"?1:0)|(offset<node.childNodes.length&&node.childNodes[offset].contentEditable=="false"?2:0);}var DecorationComparator$1=/*#__PURE__*/function(){function DecorationComparator(){_classCallCheck(this,DecorationComparator);this.changes=[];}_createClass(DecorationComparator,[{key:"compareRange",value:function compareRange(from,to){addRange(from,to,this.changes);}},{key:"comparePoint",value:function comparePoint(from,to){addRange(from,to,this.changes);}}]);return DecorationComparator;}();function findChangedDeco(a,b,diff){var comp=new DecorationComparator$1();RangeSet.compare(a,b,diff,comp);return comp.changes;}function inUneditable(node,inside2){for(var cur2=node;cur2&&cur2!=inside2;cur2=cur2.assignedSlot||cur2.parentNode){if(cur2.nodeType==1&&cur2.contentEditable=="false"){return true;}}return false;}function touchesComposition(changes,composition){var touched=false;if(composition)changes.iterChangedRanges(function(from,to){if(from<composition.to&&to>composition.from)touched=true;});return touched;}function groupAt(state,pos){var bias=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var categorize=state.charCategorizer(pos);var line=state.doc.lineAt(pos),linePos=pos-line.from;if(line.length==0)return EditorSelection.cursor(pos);if(linePos==0)bias=1;else if(linePos==line.length)bias=-1;var from=linePos,to=linePos;if(bias<0)from=findClusterBreak(line.text,linePos,false);else to=findClusterBreak(line.text,linePos);var cat=categorize(line.text.slice(from,to));while(from>0){var prev=findClusterBreak(line.text,from,false);if(categorize(line.text.slice(prev,from))!=cat)break;from=prev;}while(to<line.length){var next=findClusterBreak(line.text,to);if(categorize(line.text.slice(to,next))!=cat)break;to=next;}return EditorSelection.range(from+line.from,to+line.from);}function getdx(x,rect){return rect.left>x?rect.left-x:Math.max(0,x-rect.right);}function getdy(y,rect){return rect.top>y?rect.top-y:Math.max(0,y-rect.bottom);}function yOverlap(a,b){return a.top<b.bottom-1&&a.bottom>b.top+1;}function upTop(rect,top2){return top2<rect.top?{top:top2,left:rect.left,right:rect.right,bottom:rect.bottom}:rect;}function upBot(rect,bottom){return bottom>rect.bottom?{top:rect.top,left:rect.left,right:rect.right,bottom:bottom}:rect;}function domPosAtCoords(parent,x,y){var closest,closestRect,closestX,closestY,closestOverlap=false;var above,below,aboveRect,belowRect;for(var child=parent.firstChild;child;child=child.nextSibling){var rects=clientRectsFor(child);for(var _i86=0;_i86<rects.length;_i86++){var rect=rects[_i86];if(closestRect&&yOverlap(closestRect,rect))rect=upTop(upBot(rect,closestRect.bottom),closestRect.top);var dx=getdx(x,rect),dy=getdy(y,rect);if(dx==0&&dy==0)return child.nodeType==3?domPosInText(child,x,y):domPosAtCoords(child,x,y);if(!closest||closestY>dy||closestY==dy&&closestX>dx){closest=child;closestRect=rect;closestX=dx;closestY=dy;var side=dy?y<rect.top?-1:1:dx?x<rect.left?-1:1:0;closestOverlap=!side||(side>0?_i86<rects.length-1:_i86>0);}if(dx==0){if(y>rect.bottom&&(!aboveRect||aboveRect.bottom<rect.bottom)){above=child;aboveRect=rect;}else if(y<rect.top&&(!belowRect||belowRect.top>rect.top)){below=child;belowRect=rect;}}else if(aboveRect&&yOverlap(aboveRect,rect)){aboveRect=upBot(aboveRect,rect.bottom);}else if(belowRect&&yOverlap(belowRect,rect)){belowRect=upTop(belowRect,rect.top);}}}if(aboveRect&&aboveRect.bottom>=y){closest=above;closestRect=aboveRect;}else if(belowRect&&belowRect.top<=y){closest=below;closestRect=belowRect;}if(!closest)return{node:parent,offset:0};var clipX=Math.max(closestRect.left,Math.min(closestRect.right,x));if(closest.nodeType==3)return domPosInText(closest,clipX,y);if(closestOverlap&&closest.contentEditable!="false")return domPosAtCoords(closest,clipX,y);var offset=Array.prototype.indexOf.call(parent.childNodes,closest)+(x>=(closestRect.left+closestRect.right)/2?1:0);return{node:parent,offset:offset};}function domPosInText(node,x,y){var len=node.nodeValue.length;var closestOffset=-1,closestDY=1e9,generalSide=0;for(var _i87=0;_i87<len;_i87++){var rects=textRange(node,_i87,_i87+1).getClientRects();for(var j=0;j<rects.length;j++){var rect=rects[j];if(rect.top==rect.bottom)continue;if(!generalSide)generalSide=x-rect.left;var dy=(rect.top>y?rect.top-y:y-rect.bottom)-1;if(rect.left-1<=x&&rect.right+1>=x&&dy<closestDY){var right=x>=(rect.left+rect.right)/2,after=right;if(browser.chrome||browser.gecko){var rectBefore=textRange(node,_i87).getBoundingClientRect();if(rectBefore.left==rect.right)after=!right;}if(dy<=0)return{node:node,offset:_i87+(after?1:0)};closestOffset=_i87+(after?1:0);closestDY=dy;}}}return{node:node,offset:closestOffset>-1?closestOffset:generalSide>0?node.nodeValue.length:0};}function _posAtCoords(view,coords,precise){var bias=arguments.length>3&&arguments[3]!==undefined?arguments[3]:-1;var _a2,_b;var content2=view.contentDOM.getBoundingClientRect(),docTop=content2.top+view.viewState.paddingTop;var block,docHeight=view.viewState.docHeight;var x=coords.x,y=coords.y,yOffset=y-docTop;if(yOffset<0)return 0;if(yOffset>docHeight)return view.state.doc.length;for(var halfLine=view.viewState.heightOracle.textHeight/2,bounced=false;;){block=view.elementAtHeight(yOffset);if(block.type==BlockType.Text)break;for(;;){yOffset=bias>0?block.bottom+halfLine:block.top-halfLine;if(yOffset>=0&&yOffset<=docHeight)break;if(bounced)return precise?null:0;bounced=true;bias=-bias;}}y=docTop+yOffset;var lineStart=block.from;if(lineStart<view.viewport.from)return view.viewport.from==0?0:precise?null:posAtCoordsImprecise(view,content2,block,x,y);if(lineStart>view.viewport.to)return view.viewport.to==view.state.doc.length?view.state.doc.length:precise?null:posAtCoordsImprecise(view,content2,block,x,y);var doc2=view.dom.ownerDocument;var root=view.root.elementFromPoint?view.root:doc2;var element=root.elementFromPoint(x,y);if(element&&!view.contentDOM.contains(element))element=null;if(!element){x=Math.max(content2.left+1,Math.min(content2.right-1,x));element=root.elementFromPoint(x,y);if(element&&!view.contentDOM.contains(element))element=null;}var node,offset=-1;if(element&&((_a2=view.docView.nearest(element))===null||_a2===void 0?void 0:_a2.isEditable)!=false){if(doc2.caretPositionFromPoint){var pos=doc2.caretPositionFromPoint(x,y);if(pos){node=pos.offsetNode;offset=pos.offset;}}else if(doc2.caretRangeFromPoint){var range=doc2.caretRangeFromPoint(x,y);if(range){node=range.startContainer;offset=range.startOffset;if(!view.contentDOM.contains(node)||browser.safari&&isSuspiciousSafariCaretResult(node,offset,x)||browser.chrome&&isSuspiciousChromeCaretResult(node,offset,x))node=void 0;}}}if(!node||!view.docView.dom.contains(node)){var line=LineView.find(view.docView,lineStart);if(!line)return yOffset>block.top+block.height/2?block.to:block.from;var _domPosAtCoords=domPosAtCoords(line.dom,x,y);node=_domPosAtCoords.node;offset=_domPosAtCoords.offset;}var nearest=view.docView.nearest(node);if(!nearest)return null;if(nearest.isWidget&&((_b=nearest.dom)===null||_b===void 0?void 0:_b.nodeType)==1){var rect=nearest.dom.getBoundingClientRect();return coords.y<rect.top||coords.y<=rect.bottom&&coords.x<=(rect.left+rect.right)/2?nearest.posAtStart:nearest.posAtEnd;}else{return nearest.localPosFromDOM(node,offset)+nearest.posAtStart;}}function posAtCoordsImprecise(view,contentRect,block,x,y){var into=Math.round((x-contentRect.left)*view.defaultCharacterWidth);if(view.lineWrapping&&block.height>view.defaultLineHeight*1.5){var textHeight=view.viewState.heightOracle.textHeight;var line=Math.floor((y-block.top-(view.defaultLineHeight-textHeight)*0.5)/textHeight);into+=line*view.viewState.heightOracle.lineLength;}var content2=view.state.sliceDoc(block.from,block.to);return block.from+findColumn(content2,into,view.state.tabSize);}function isSuspiciousSafariCaretResult(node,offset,x){var len;if(node.nodeType!=3||offset!=(len=node.nodeValue.length))return false;for(var next=node.nextSibling;next;next=next.nextSibling){if(next.nodeType!=1||next.nodeName!="BR")return false;}return textRange(node,len-1,len).getBoundingClientRect().left>x;}function isSuspiciousChromeCaretResult(node,offset,x){if(offset!=0)return false;for(var cur2=node;;){var parent=cur2.parentNode;if(!parent||parent.nodeType!=1||parent.firstChild!=cur2)return false;if(parent.classList.contains("cm-line"))break;cur2=parent;}var rect=node.nodeType==1?node.getBoundingClientRect():textRange(node,0,Math.max(node.nodeValue.length,1)).getBoundingClientRect();return x-rect.left>5;}function blockAt(view,pos){var line=view.lineBlockAt(pos);if(Array.isArray(line.type)){var _iterator46=_createForOfIteratorHelper(line.type),_step46;try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var _l=_step46.value;if(_l.to>pos||_l.to==pos&&(_l.to==line.to||_l.type==BlockType.Text))return _l;}}catch(err){_iterator46.e(err);}finally{_iterator46.f();}}return line;}function _moveToLineBoundary(view,start,forward,includeWrap){var line=blockAt(view,start.head);var coords=!includeWrap||line.type!=BlockType.Text||!(view.lineWrapping||line.widgetLineBreaks)?null:view.coordsAtPos(start.assoc<0&&start.head>line.from?start.head-1:start.head);if(coords){var editorRect=view.dom.getBoundingClientRect();var direction=view.textDirectionAt(line.from);var pos=view.posAtCoords({x:forward==(direction==Direction.LTR)?editorRect.right-1:editorRect.left+1,y:(coords.top+coords.bottom)/2});if(pos!=null)return EditorSelection.cursor(pos,forward?-1:1);}return EditorSelection.cursor(forward?line.to:line.from,forward?-1:1);}function _moveByChar(view,start,forward,by){var line=view.state.doc.lineAt(start.head),spans=view.bidiSpans(line);var direction=view.textDirectionAt(line.from);for(var cur2=start,check=null;;){var next=moveVisually(line,spans,direction,cur2,forward),_char2=movedOver;if(!next){if(line.number==(forward?view.state.doc.lines:1))return cur2;_char2="\n";line=view.state.doc.line(line.number+(forward?1:-1));spans=view.bidiSpans(line);next=EditorSelection.cursor(forward?line.from:line.to);}if(!check){if(!by)return next;check=by(_char2);}else if(!check(_char2)){return cur2;}cur2=next;}}function byGroup(view,pos,start){var categorize=view.state.charCategorizer(pos);var cat=categorize(start);return function(next){var nextCat=categorize(next);if(cat==CharCategory.Space)cat=nextCat;return cat==nextCat;};}function _moveVertically(view,start,forward,distance){var startPos=start.head,dir=forward?1:-1;if(startPos==(forward?view.state.doc.length:0))return EditorSelection.cursor(startPos,start.assoc);var goal=start.goalColumn,startY;var rect=view.contentDOM.getBoundingClientRect();var startCoords=view.coordsAtPos(startPos,start.assoc||-1),docTop=view.documentTop;if(startCoords){if(goal==null)goal=startCoords.left-rect.left;startY=dir<0?startCoords.top:startCoords.bottom;}else{var line=view.viewState.lineBlockAt(startPos);if(goal==null)goal=Math.min(rect.right-rect.left,view.defaultCharacterWidth*(startPos-line.from));startY=(dir<0?line.top:line.bottom)+docTop;}var resolvedGoal=rect.left+goal;var dist2=distance!==null&&distance!==void 0?distance:view.viewState.heightOracle.textHeight>>1;for(var extra=0;;extra+=10){var curY=startY+(dist2+extra)*dir;var pos=_posAtCoords(view,{x:resolvedGoal,y:curY},false,dir);if(curY<rect.top||curY>rect.bottom||(dir<0?pos<startPos:pos>startPos)){var charRect=view.docView.coordsForChar(pos);var assoc=!charRect||curY<charRect.top?-1:1;return EditorSelection.cursor(pos,assoc,void 0,goal);}}}function skipAtomicRanges(atoms,pos,bias){var _loop4=function _loop4(){var moved=0;var _iterator47=_createForOfIteratorHelper(atoms),_step47;try{for(_iterator47.s();!(_step47=_iterator47.n()).done;){var set=_step47.value;set.between(pos-1,pos+1,function(from,to,value){if(pos>from&&pos<to){var side=moved||bias||(pos-from<to-pos?-1:1);pos=side<0?from:to;moved=side;}});}}catch(err){_iterator47.e(err);}finally{_iterator47.f();}if(!moved)return{v:pos};};for(;;){var _ret=_loop4();if(_typeof(_ret)==="object")return _ret.v;}}function skipAtoms(view,oldPos,pos){var newPos=skipAtomicRanges(view.state.facet(atomicRanges).map(function(f){return f(view);}),pos.from,oldPos.head>pos.from?-1:1);return newPos==pos.from?pos:EditorSelection.cursor(newPos,newPos<pos.from?1:-1);}var InputState=/*#__PURE__*/function(){function InputState(view){_classCallCheck(this,InputState);this.view=view;this.lastKeyCode=0;this.lastKeyTime=0;this.lastTouchTime=0;this.lastFocusTime=0;this.lastScrollTop=0;this.lastScrollLeft=0;this.pendingIOSKey=void 0;this.lastSelectionOrigin=null;this.lastSelectionTime=0;this.lastEscPress=0;this.lastContextMenu=0;this.scrollHandlers=[];this.handlers=/* @__PURE__ */Object.create(null);this.composing=-1;this.compositionFirstChange=null;this.compositionEndedAt=0;this.compositionPendingKey=false;this.compositionPendingChange=false;this.mouseSelection=null;this.draggedContent=null;this.handleEvent=this.handleEvent.bind(this);this.notifiedFocused=view.hasFocus;if(browser.safari)view.contentDOM.addEventListener("input",function(){return null;});if(browser.gecko)firefoxCopyCutHack(view.contentDOM.ownerDocument);}_createClass(InputState,[{key:"setSelectionOrigin",value:function setSelectionOrigin(origin){this.lastSelectionOrigin=origin;this.lastSelectionTime=Date.now();}},{key:"handleEvent",value:function handleEvent(event){if(!eventBelongsToEditor(this.view,event)||this.ignoreDuringComposition(event))return;if(event.type=="keydown"&&this.keydown(event))return;this.runHandlers(event.type,event);}},{key:"runHandlers",value:function runHandlers(type,event){var handlers2=this.handlers[type];if(handlers2){var _iterator48=_createForOfIteratorHelper(handlers2.observers),_step48;try{for(_iterator48.s();!(_step48=_iterator48.n()).done;){var observer=_step48.value;observer(this.view,event);}}catch(err){_iterator48.e(err);}finally{_iterator48.f();}var _iterator49=_createForOfIteratorHelper(handlers2.handlers),_step49;try{for(_iterator49.s();!(_step49=_iterator49.n()).done;){var handler=_step49.value;if(event.defaultPrevented)break;if(handler(this.view,event)){event.preventDefault();break;}}}catch(err){_iterator49.e(err);}finally{_iterator49.f();}}}},{key:"ensureHandlers",value:function ensureHandlers(plugins){var handlers2=computeHandlers(plugins),prev=this.handlers,dom=this.view.contentDOM;for(var type in handlers2){if(type!="scroll"){var passive=!handlers2[type].handlers.length;var exists=prev[type];if(exists&&passive!=!exists.handlers.length){dom.removeEventListener(type,this.handleEvent);exists=null;}if(!exists)dom.addEventListener(type,this.handleEvent,{passive:passive});}}for(var _type3 in prev){if(_type3!="scroll"&&!handlers2[_type3])dom.removeEventListener(_type3,this.handleEvent);}this.handlers=handlers2;}},{key:"keydown",value:function keydown(event){var _this26=this;this.lastKeyCode=event.keyCode;this.lastKeyTime=Date.now();if(event.keyCode==9&&Date.now()<this.lastEscPress+2e3)return true;if(event.keyCode!=27&&modifierCodes.indexOf(event.keyCode)<0)this.view.inputState.lastEscPress=0;if(browser.android&&browser.chrome&&!event.synthetic&&(event.keyCode==13||event.keyCode==8)){this.view.observer.delayAndroidKey(event.key,event.keyCode);return true;}var pending;if(browser.ios&&!event.synthetic&&!event.altKey&&!event.metaKey&&((pending=PendingKeys.find(function(key){return key.keyCode==event.keyCode;}))&&!event.ctrlKey||EmacsyPendingKeys.indexOf(event.key)>-1&&event.ctrlKey&&!event.shiftKey)){this.pendingIOSKey=pending||event;setTimeout(function(){return _this26.flushIOSKey();},250);return true;}if(event.keyCode!=229)this.view.observer.forceFlush();return false;}},{key:"flushIOSKey",value:function flushIOSKey(){var key=this.pendingIOSKey;if(!key)return false;this.pendingIOSKey=void 0;return dispatchKey(this.view.contentDOM,key.key,key.keyCode);}},{key:"ignoreDuringComposition",value:function ignoreDuringComposition(event){if(!/^key/.test(event.type))return false;if(this.composing>0)return true;if(browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100){this.compositionPendingKey=false;return true;}return false;}},{key:"startMouseSelection",value:function startMouseSelection(mouseSelection){if(this.mouseSelection)this.mouseSelection.destroy();this.mouseSelection=mouseSelection;}},{key:"update",value:function update(_update2){if(this.mouseSelection)this.mouseSelection.update(_update2);if(this.draggedContent&&_update2.docChanged)this.draggedContent=this.draggedContent.map(_update2.changes);if(_update2.transactions.length)this.lastKeyCode=this.lastSelectionTime=0;}},{key:"destroy",value:function destroy(){if(this.mouseSelection)this.mouseSelection.destroy();}}]);return InputState;}();function bindHandler(plugin,handler){return function(view,event){try{return handler.call(plugin,event,view);}catch(e){logException(view.state,e);}};}function computeHandlers(plugins){var result=/* @__PURE__ */Object.create(null);function record(type){return result[type]||(result[type]={observers:[],handlers:[]});}var _iterator50=_createForOfIteratorHelper(plugins),_step50;try{for(_iterator50.s();!(_step50=_iterator50.n()).done;){var plugin=_step50.value;var spec=plugin.spec;if(spec&&spec.domEventHandlers)for(var _type5 in spec.domEventHandlers){var f=spec.domEventHandlers[_type5];if(f)record(_type5).handlers.push(bindHandler(plugin.value,f));}if(spec&&spec.domEventObservers)for(var _type6 in spec.domEventObservers){var _f2=spec.domEventObservers[_type6];if(_f2)record(_type6).observers.push(bindHandler(plugin.value,_f2));}}}catch(err){_iterator50.e(err);}finally{_iterator50.f();}for(var type in handlers){record(type).handlers.push(handlers[type]);}for(var _type4 in observers){record(_type4).observers.push(observers[_type4]);}return result;}var PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}];var EmacsyPendingKeys="dthko";var modifierCodes=[16,17,18,20,91,92,224,225];var dragScrollMargin=6;function dragScrollSpeed(dist2){return Math.max(0,dist2)*0.7+8;}function dist(a,b){return Math.max(Math.abs(a.clientX-b.clientX),Math.abs(a.clientY-b.clientY));}var MouseSelection=/*#__PURE__*/function(){function MouseSelection(view,startEvent,style,mustSelect){_classCallCheck(this,MouseSelection);this.view=view;this.startEvent=startEvent;this.style=style;this.mustSelect=mustSelect;this.scrollSpeed={x:0,y:0};this.scrolling=-1;this.lastEvent=startEvent;this.scrollParent=scrollableParent(view.contentDOM);this.atoms=view.state.facet(atomicRanges).map(function(f){return f(view);});var doc2=view.contentDOM.ownerDocument;doc2.addEventListener("mousemove",this.move=this.move.bind(this));doc2.addEventListener("mouseup",this.up=this.up.bind(this));this.extend=startEvent.shiftKey;this.multiple=view.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(view,startEvent);this.dragging=isInPrimarySelection(view,startEvent)&&getClickType(startEvent)==1?null:false;}_createClass(MouseSelection,[{key:"start",value:function start(event){if(this.dragging===false)this.select(event);}},{key:"move",value:function move(event){var _a2;if(event.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&dist(this.startEvent,event)<10)return;this.select(this.lastEvent=event);var sx=0,sy=0;var rect=((_a2=this.scrollParent)===null||_a2===void 0?void 0:_a2.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight};var margins=getScrollMargins(this.view);if(event.clientX-margins.left<=rect.left+dragScrollMargin)sx=-dragScrollSpeed(rect.left-event.clientX);else if(event.clientX+margins.right>=rect.right-dragScrollMargin)sx=dragScrollSpeed(event.clientX-rect.right);if(event.clientY-margins.top<=rect.top+dragScrollMargin)sy=-dragScrollSpeed(rect.top-event.clientY);else if(event.clientY+margins.bottom>=rect.bottom-dragScrollMargin)sy=dragScrollSpeed(event.clientY-rect.bottom);this.setScrollSpeed(sx,sy);}},{key:"up",value:function up(event){if(this.dragging==null)this.select(this.lastEvent);if(!this.dragging)event.preventDefault();this.destroy();}},{key:"destroy",value:function destroy(){this.setScrollSpeed(0,0);var doc2=this.view.contentDOM.ownerDocument;doc2.removeEventListener("mousemove",this.move);doc2.removeEventListener("mouseup",this.up);this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null;}},{key:"setScrollSpeed",value:function setScrollSpeed(sx,sy){var _this27=this;this.scrollSpeed={x:sx,y:sy};if(sx||sy){if(this.scrolling<0)this.scrolling=setInterval(function(){return _this27.scroll();},50);}else if(this.scrolling>-1){clearInterval(this.scrolling);this.scrolling=-1;}}},{key:"scroll",value:function scroll(){if(this.scrollParent){this.scrollParent.scrollLeft+=this.scrollSpeed.x;this.scrollParent.scrollTop+=this.scrollSpeed.y;}else{this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y);}if(this.dragging===false)this.select(this.lastEvent);}},{key:"skipAtoms",value:function skipAtoms(sel){var ranges=null;for(var _i88=0;_i88<sel.ranges.length;_i88++){var range=sel.ranges[_i88],updated=null;if(range.empty){var pos=skipAtomicRanges(this.atoms,range.from,0);if(pos!=range.from)updated=EditorSelection.cursor(pos,-1);}else{var from=skipAtomicRanges(this.atoms,range.from,-1);var to=skipAtomicRanges(this.atoms,range.to,1);if(from!=range.from||to!=range.to)updated=EditorSelection.range(range.from==range.anchor?from:to,range.from==range.head?from:to);}if(updated){if(!ranges)ranges=sel.ranges.slice();ranges[_i88]=updated;}}return ranges?EditorSelection.create(ranges,sel.mainIndex):sel;}},{key:"select",value:function select(event){var view=this.view,selection2=this.skipAtoms(this.style.get(event,this.extend,this.multiple));if(this.mustSelect||!selection2.eq(view.state.selection)||selection2.main.assoc!=view.state.selection.main.assoc&&this.dragging===false)this.view.dispatch({selection:selection2,userEvent:"select.pointer"});this.mustSelect=false;}},{key:"update",value:function update(_update3){var _this28=this;if(this.style.update(_update3))setTimeout(function(){return _this28.select(_this28.lastEvent);},20);}}]);return MouseSelection;}();function addsSelectionRange(view,event){var facet=view.state.facet(clickAddsSelectionRange);return facet.length?facet[0](event):browser.mac?event.metaKey:event.ctrlKey;}function dragMovesSelection(view,event){var facet=view.state.facet(dragMovesSelection$1);return facet.length?facet[0](event):browser.mac?!event.altKey:!event.ctrlKey;}function isInPrimarySelection(view,event){var main=view.state.selection.main;if(main.empty)return false;var sel=getSelection(view.root);if(!sel||sel.rangeCount==0)return true;var rects=sel.getRangeAt(0).getClientRects();for(var _i89=0;_i89<rects.length;_i89++){var rect=rects[_i89];if(rect.left<=event.clientX&&rect.right>=event.clientX&&rect.top<=event.clientY&&rect.bottom>=event.clientY)return true;}return false;}function eventBelongsToEditor(view,event){if(!event.bubbles)return true;if(event.defaultPrevented)return false;for(var node=event.target,cView;node!=view.contentDOM;node=node.parentNode){if(!node||node.nodeType==11||(cView=ContentView.get(node))&&cView.ignoreEvent(event))return false;}return true;}var handlers=/* @__PURE__ */Object.create(null);var observers=/* @__PURE__ */Object.create(null);var brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(view){var parent=view.dom.parentNode;if(!parent)return;var target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px";target.focus();setTimeout(function(){view.focus();target.remove();doPaste(view,target.value);},50);}function doPaste(view,input){var state=view.state,changes,i=1,text=state.toText(input);var byLine=text.lines==state.selection.ranges.length;var linewise=lastLinewiseCopy!=null&&state.selection.ranges.every(function(r){return r.empty;})&&lastLinewiseCopy==text.toString();if(linewise){var lastLine=-1;changes=state.changeByRange(function(range){var line=state.doc.lineAt(range.from);if(line.from==lastLine)return{range:range};lastLine=line.from;var insert2=state.toText((byLine?text.line(i++).text:input)+state.lineBreak);return{changes:{from:line.from,insert:insert2},range:EditorSelection.cursor(range.from+insert2.length)};});}else if(byLine){changes=state.changeByRange(function(range){var line=text.line(i++);return{changes:{from:range.from,to:range.to,insert:line.text},range:EditorSelection.cursor(range.from+line.length)};});}else{changes=state.replaceSelection(text);}view.dispatch(changes,{userEvent:"input.paste",scrollIntoView:true});}observers.scroll=function(view){view.inputState.lastScrollTop=view.scrollDOM.scrollTop;view.inputState.lastScrollLeft=view.scrollDOM.scrollLeft;};handlers.keydown=function(view,event){view.inputState.setSelectionOrigin("select");if(event.keyCode==27)view.inputState.lastEscPress=Date.now();return false;};observers.touchstart=function(view,e){view.inputState.lastTouchTime=Date.now();view.inputState.setSelectionOrigin("select.pointer");};observers.touchmove=function(view){view.inputState.setSelectionOrigin("select.pointer");};handlers.mousedown=function(view,event){view.observer.flush();if(view.inputState.lastTouchTime>Date.now()-2e3)return false;var style=null;var _iterator51=_createForOfIteratorHelper(view.state.facet(mouseSelectionStyle)),_step51;try{for(_iterator51.s();!(_step51=_iterator51.n()).done;){var makeStyle=_step51.value;style=makeStyle(view,event);if(style)break;}}catch(err){_iterator51.e(err);}finally{_iterator51.f();}if(!style&&event.button==0)style=basicMouseSelection(view,event);if(style){var mustFocus=!view.hasFocus;view.inputState.startMouseSelection(new MouseSelection(view,event,style,mustFocus));if(mustFocus)view.observer.ignore(function(){return focusPreventScroll(view.contentDOM);});var mouseSel=view.inputState.mouseSelection;if(mouseSel){mouseSel.start(event);return mouseSel.dragging===false;}}return false;};function rangeForClick(view,pos,bias,type){if(type==1){return EditorSelection.cursor(pos,bias);}else if(type==2){return groupAt(view.state,pos,bias);}else{var visual=LineView.find(view.docView,pos),line=view.state.doc.lineAt(visual?visual.posAtEnd:pos);var from=visual?visual.posAtStart:line.from,to=visual?visual.posAtEnd:line.to;if(to<view.state.doc.length&&to==line.to)to++;return EditorSelection.range(from,to);}}var insideY=function insideY(y,rect){return y>=rect.top&&y<=rect.bottom;};var inside=function inside(x,y,rect){return insideY(y,rect)&&x>=rect.left&&x<=rect.right;};function findPositionSide(view,pos,x,y){var line=LineView.find(view.docView,pos);if(!line)return 1;var off=pos-line.posAtStart;if(off==0)return 1;if(off==line.length)return-1;var before=line.coordsAt(off,-1);if(before&&inside(x,y,before))return-1;var after=line.coordsAt(off,1);if(after&&inside(x,y,after))return 1;return before&&insideY(y,before)?-1:1;}function queryPos(view,event){var pos=view.posAtCoords({x:event.clientX,y:event.clientY},false);return{pos:pos,bias:findPositionSide(view,pos,event.clientX,event.clientY)};}var BadMouseDetail=browser.ie&&browser.ie_version<=11;var lastMouseDown=null;var lastMouseDownCount=0;var lastMouseDownTime=0;function getClickType(event){if(!BadMouseDetail)return event.detail;var last=lastMouseDown,lastTime=lastMouseDownTime;lastMouseDown=event;lastMouseDownTime=Date.now();return lastMouseDownCount=!last||lastTime>Date.now()-400&&Math.abs(last.clientX-event.clientX)<2&&Math.abs(last.clientY-event.clientY)<2?(lastMouseDownCount+1)%3:1;}function basicMouseSelection(view,event){var start=queryPos(view,event),type=getClickType(event);var startSel=view.state.selection;return{update:function update(_update4){if(_update4.docChanged){start.pos=_update4.changes.mapPos(start.pos);startSel=startSel.map(_update4.changes);}},get:function get(event2,extend2,multiple){var cur2=queryPos(view,event2),removed;var range=rangeForClick(view,cur2.pos,cur2.bias,type);if(start.pos!=cur2.pos&&!extend2){var startRange=rangeForClick(view,start.pos,start.bias,type);var from=Math.min(startRange.from,range.from),to=Math.max(startRange.to,range.to);range=from<range.from?EditorSelection.range(from,to):EditorSelection.range(to,from);}if(extend2)return startSel.replaceRange(startSel.main.extend(range.from,range.to));else if(multiple&&type==1&&startSel.ranges.length>1&&(removed=removeRangeAround(startSel,cur2.pos)))return removed;else if(multiple)return startSel.addRange(range);else return EditorSelection.create([range]);}};}function removeRangeAround(sel,pos){for(var _i90=0;_i90<sel.ranges.length;_i90++){var _sel$ranges$_i=sel.ranges[_i90],from=_sel$ranges$_i.from,to=_sel$ranges$_i.to;if(from<=pos&&to>=pos)return EditorSelection.create(sel.ranges.slice(0,_i90).concat(sel.ranges.slice(_i90+1)),sel.mainIndex==_i90?0:sel.mainIndex-(sel.mainIndex>_i90?1:0));}return null;}handlers.dragstart=function(view,event){var range=view.state.selection.main;if(event.target.draggable){var cView=view.docView.nearest(event.target);if(cView&&cView.isWidget){var from=cView.posAtStart,to=from+cView.length;if(from>=range.to||to<=range.from)range=EditorSelection.range(from,to);}}var inputState=view.inputState;if(inputState.mouseSelection)inputState.mouseSelection.dragging=true;inputState.draggedContent=range;if(event.dataTransfer){event.dataTransfer.setData("Text",view.state.sliceDoc(range.from,range.to));event.dataTransfer.effectAllowed="copyMove";}return false;};handlers.dragend=function(view){view.inputState.draggedContent=null;return false;};function dropText(view,event,text,direct){if(!text)return;var dropPos=view.posAtCoords({x:event.clientX,y:event.clientY},false);var draggedContent=view.inputState.draggedContent;var del=direct&&draggedContent&&dragMovesSelection(view,event)?{from:draggedContent.from,to:draggedContent.to}:null;var ins={from:dropPos,insert:text};var changes=view.state.changes(del?[del,ins]:ins);view.focus();view.dispatch({changes:changes,selection:{anchor:changes.mapPos(dropPos,-1),head:changes.mapPos(dropPos,1)},userEvent:del?"move.drop":"input.drop"});view.inputState.draggedContent=null;}handlers.drop=function(view,event){if(!event.dataTransfer)return false;if(view.state.readOnly)return true;var files=event.dataTransfer.files;if(files&&files.length){var _ret2=function(){var text=Array(files.length),read=0;var finishFile=function finishFile(){if(++read==files.length)dropText(view,event,text.filter(function(s){return s!=null;}).join(view.state.lineBreak),false);};var _loop5=function _loop5(_i91){var reader=new FileReader();reader.onerror=finishFile;reader.onload=function(){if(!/[\x00-\x08\x0e-\x1f]{2}/.test(reader.result))text[_i91]=reader.result;finishFile();};reader.readAsText(files[_i91]);};for(var _i91=0;_i91<files.length;_i91++){_loop5(_i91);}return{v:true};}();if(_typeof(_ret2)==="object")return _ret2.v;}else{var _text4=event.dataTransfer.getData("Text");if(_text4){dropText(view,event,_text4,true);return true;}}return false;};handlers.paste=function(view,event){if(view.state.readOnly)return true;view.observer.flush();var data2=brokenClipboardAPI?null:event.clipboardData;if(data2){doPaste(view,data2.getData("text/plain")||data2.getData("text/uri-text"));return true;}else{capturePaste(view);return false;}};function captureCopy(view,text){var parent=view.dom.parentNode;if(!parent)return;var target=parent.appendChild(document.createElement("textarea"));target.style.cssText="position: fixed; left: -10000px; top: 10px";target.value=text;target.focus();target.selectionEnd=text.length;target.selectionStart=0;setTimeout(function(){target.remove();view.focus();},50);}function copiedRange(state){var content2=[],ranges=[],linewise=false;var _iterator52=_createForOfIteratorHelper(state.selection.ranges),_step52;try{for(_iterator52.s();!(_step52=_iterator52.n()).done;){var range=_step52.value;if(!range.empty){content2.push(state.sliceDoc(range.from,range.to));ranges.push(range);}}}catch(err){_iterator52.e(err);}finally{_iterator52.f();}if(!content2.length){var upto=-1;var _iterator53=_createForOfIteratorHelper(state.selection.ranges),_step53;try{for(_iterator53.s();!(_step53=_iterator53.n()).done;){var from=_step53.value.from;var line=state.doc.lineAt(from);if(line.number>upto){content2.push(line.text);ranges.push({from:line.from,to:Math.min(state.doc.length,line.to+1)});}upto=line.number;}}catch(err){_iterator53.e(err);}finally{_iterator53.f();}linewise=true;}return{text:content2.join(state.lineBreak),ranges:ranges,linewise:linewise};}var lastLinewiseCopy=null;handlers.copy=handlers.cut=function(view,event){var _copiedRange=copiedRange(view.state),text=_copiedRange.text,ranges=_copiedRange.ranges,linewise=_copiedRange.linewise;if(!text&&!linewise)return false;lastLinewiseCopy=linewise?text:null;if(event.type=="cut"&&!view.state.readOnly)view.dispatch({changes:ranges,scrollIntoView:true,userEvent:"delete.cut"});var data2=brokenClipboardAPI?null:event.clipboardData;if(data2){data2.clearData();data2.setData("text/plain",text);return true;}else{captureCopy(view,text);return false;}};var isFocusChange=/* @__PURE__ */Annotation.define();function focusChangeTransaction(state,focus){var effects=[];var _iterator54=_createForOfIteratorHelper(state.facet(focusChangeEffect)),_step54;try{for(_iterator54.s();!(_step54=_iterator54.n()).done;){var getEffect=_step54.value;var effect=getEffect(state,focus);if(effect)effects.push(effect);}}catch(err){_iterator54.e(err);}finally{_iterator54.f();}return effects?state.update({effects:effects,annotations:isFocusChange.of(true)}):null;}function updateForFocusChange(view){setTimeout(function(){var focus=view.hasFocus;if(focus!=view.inputState.notifiedFocused){var tr=focusChangeTransaction(view.state,focus);if(tr)view.dispatch(tr);else view.update([]);}},10);}observers.focus=function(view){view.inputState.lastFocusTime=Date.now();if(!view.scrollDOM.scrollTop&&(view.inputState.lastScrollTop||view.inputState.lastScrollLeft)){view.scrollDOM.scrollTop=view.inputState.lastScrollTop;view.scrollDOM.scrollLeft=view.inputState.lastScrollLeft;}updateForFocusChange(view);};observers.blur=function(view){view.observer.clearSelectionRange();updateForFocusChange(view);};observers.compositionstart=observers.compositionupdate=function(view){if(view.inputState.compositionFirstChange==null)view.inputState.compositionFirstChange=true;if(view.inputState.composing<0){view.inputState.composing=0;}};observers.compositionend=function(view){view.inputState.composing=-1;view.inputState.compositionEndedAt=Date.now();view.inputState.compositionPendingKey=true;view.inputState.compositionPendingChange=view.observer.pendingRecords().length>0;view.inputState.compositionFirstChange=null;if(browser.chrome&&browser.android){view.observer.flushSoon();}else if(view.inputState.compositionPendingChange){Promise.resolve().then(function(){return view.observer.flush();});}else{setTimeout(function(){if(view.inputState.composing<0&&view.docView.hasComposition)view.update([]);},50);}};observers.contextmenu=function(view){view.inputState.lastContextMenu=Date.now();};handlers.beforeinput=function(view,event){var _a2;var pending;if(browser.chrome&&browser.android&&(pending=PendingKeys.find(function(key){return key.inputType==event.inputType;}))){view.observer.delayAndroidKey(pending.key,pending.keyCode);if(pending.key=="Backspace"||pending.key=="Delete"){var startViewHeight=((_a2=window.visualViewport)===null||_a2===void 0?void 0:_a2.height)||0;setTimeout(function(){var _a3;if((((_a3=window.visualViewport)===null||_a3===void 0?void 0:_a3.height)||0)>startViewHeight+10&&view.hasFocus){view.contentDOM.blur();view.focus();}},100);}}return false;};var appliedFirefoxHack=/* @__PURE__ */new Set();function firefoxCopyCutHack(doc2){if(!appliedFirefoxHack.has(doc2)){appliedFirefoxHack.add(doc2);doc2.addEventListener("copy",function(){});doc2.addEventListener("cut",function(){});}}var wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];var HeightOracle=/*#__PURE__*/function(){function HeightOracle(lineWrapping){_classCallCheck(this,HeightOracle);this.lineWrapping=lineWrapping;this.doc=Text.empty;this.heightSamples={};this.lineHeight=14;this.charWidth=7;this.textHeight=14;this.lineLength=30;this.heightChanged=false;}_createClass(HeightOracle,[{key:"heightForGap",value:function heightForGap(from,to){var lines=this.doc.lineAt(to).number-this.doc.lineAt(from).number+1;if(this.lineWrapping)lines+=Math.max(0,Math.ceil((to-from-lines*this.lineLength*0.5)/this.lineLength));return this.lineHeight*lines;}},{key:"heightForLine",value:function heightForLine(length){if(!this.lineWrapping)return this.lineHeight;var lines=1+Math.max(0,Math.ceil((length-this.lineLength)/(this.lineLength-5)));return lines*this.lineHeight;}},{key:"setDoc",value:function setDoc(doc2){this.doc=doc2;return this;}},{key:"mustRefreshForWrapping",value:function mustRefreshForWrapping(whiteSpace){return wrappingWhiteSpace.indexOf(whiteSpace)>-1!=this.lineWrapping;}},{key:"mustRefreshForHeights",value:function mustRefreshForHeights(lineHeights){var newHeight=false;for(var _i92=0;_i92<lineHeights.length;_i92++){var h=lineHeights[_i92];if(h<0){_i92++;}else if(!this.heightSamples[Math.floor(h*10)]){newHeight=true;this.heightSamples[Math.floor(h*10)]=true;}}return newHeight;}},{key:"refresh",value:function refresh(whiteSpace,lineHeight,charWidth,textHeight,lineLength,knownHeights){var lineWrapping=wrappingWhiteSpace.indexOf(whiteSpace)>-1;var changed=Math.round(lineHeight)!=Math.round(this.lineHeight)||this.lineWrapping!=lineWrapping;this.lineWrapping=lineWrapping;this.lineHeight=lineHeight;this.charWidth=charWidth;this.textHeight=textHeight;this.lineLength=lineLength;if(changed){this.heightSamples={};for(var _i93=0;_i93<knownHeights.length;_i93++){var h=knownHeights[_i93];if(h<0)_i93++;else this.heightSamples[Math.floor(h*10)]=true;}}return changed;}}]);return HeightOracle;}();var MeasuredHeights=/*#__PURE__*/function(){function MeasuredHeights(from,heights){_classCallCheck(this,MeasuredHeights);this.from=from;this.heights=heights;this.index=0;}_createClass(MeasuredHeights,[{key:"more",get:function get(){return this.index<this.heights.length;}}]);return MeasuredHeights;}();var BlockInfo=/*#__PURE__*/function(){function BlockInfo(from,length,top2,height,_content){_classCallCheck(this,BlockInfo);this.from=from;this.length=length;this.top=top2;this.height=height;this._content=_content;}_createClass(BlockInfo,[{key:"type",get:function get(){return typeof this._content=="number"?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type;}},{key:"to",get:function get(){return this.from+this.length;}},{key:"bottom",get:function get(){return this.top+this.height;}},{key:"widget",get:function get(){return this._content instanceof PointDecoration?this._content.widget:null;}},{key:"widgetLineBreaks",get:function get(){return typeof this._content=="number"?this._content:0;}},{key:"join",value:function join(other){var content2=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(other._content)?other._content:[other]);return new BlockInfo(this.from,this.length+other.length,this.top,this.height+other.height,content2);}}]);return BlockInfo;}();var QueryType=/* @__PURE__ */function(QueryType3){QueryType3[QueryType3["ByPos"]=0]="ByPos";QueryType3[QueryType3["ByHeight"]=1]="ByHeight";QueryType3[QueryType3["ByPosNoHeight"]=2]="ByPosNoHeight";return QueryType3;}(QueryType||(QueryType={}));var Epsilon=1e-3;var HeightMap=/*#__PURE__*/function(){function HeightMap(length,height){var flags=arguments.length>2&&arguments[2]!==undefined?arguments[2]:2;_classCallCheck(this,HeightMap);this.length=length;this.height=height;this.flags=flags;}_createClass(HeightMap,[{key:"outdated",get:function get(){return(this.flags&2)>0;},set:function set(value){this.flags=(value?2:0)|this.flags&~2;}},{key:"setHeight",value:function setHeight(oracle,height){if(this.height!=height){if(Math.abs(this.height-height)>Epsilon)oracle.heightChanged=true;this.height=height;}}},{key:"replace",value:function replace(_from,_to,nodes){return HeightMap.of(nodes);}},{key:"decomposeLeft",value:function decomposeLeft(_to,result){result.push(this);}},{key:"decomposeRight",value:function decomposeRight(_from,result){result.push(this);}},{key:"applyChanges",value:function applyChanges(decorations2,oldDoc,oracle,changes){var me=this,doc2=oracle.doc;for(var _i94=changes.length-1;_i94>=0;_i94--){var _changes$_i=changes[_i94],fromA=_changes$_i.fromA,toA=_changes$_i.toA,fromB=_changes$_i.fromB,toB=_changes$_i.toB;var start=me.lineAt(fromA,QueryType.ByPosNoHeight,oracle.setDoc(oldDoc),0,0);var end=start.to>=toA?start:me.lineAt(toA,QueryType.ByPosNoHeight,oracle,0,0);toB+=end.to-toA;toA=end.to;while(_i94>0&&start.from<=changes[_i94-1].toA){fromA=changes[_i94-1].fromA;fromB=changes[_i94-1].fromB;_i94--;if(fromA<start.from)start=me.lineAt(fromA,QueryType.ByPosNoHeight,oracle,0,0);}fromB+=start.from-fromA;fromA=start.from;var nodes=NodeBuilder.build(oracle.setDoc(doc2),decorations2,fromB,toB);me=me.replace(fromA,toA,nodes);}return me.updateHeight(oracle,0);}}],[{key:"empty",value:function empty(){return new HeightMapText(0,0);}},{key:"of",value:function of(nodes){if(nodes.length==1)return nodes[0];var i=0,j=nodes.length,before=0,after=0;for(;;){if(i==j){if(before>after*2){var split=nodes[i-1];if(split["break"])nodes.splice(--i,1,split.left,null,split.right);else nodes.splice(--i,1,split.left,split.right);j+=1+split["break"];before-=split.size;}else if(after>before*2){var _split=nodes[j];if(_split["break"])nodes.splice(j,1,_split.left,null,_split.right);else nodes.splice(j,1,_split.left,_split.right);j+=2+_split["break"];after-=_split.size;}else{break;}}else if(before<after){var next=nodes[i++];if(next)before+=next.size;}else{var _next3=nodes[--j];if(_next3)after+=_next3.size;}}var brk=0;if(nodes[i-1]==null){brk=1;i--;}else if(nodes[i]==null){brk=1;j++;}return new HeightMapBranch(HeightMap.of(nodes.slice(0,i)),brk,HeightMap.of(nodes.slice(j)));}}]);return HeightMap;}();HeightMap.prototype.size=1;var HeightMapBlock=/*#__PURE__*/function(_HeightMap){_inherits(HeightMapBlock,_HeightMap);var _super17=_createSuper(HeightMapBlock);function HeightMapBlock(length,height,deco){var _this29;_classCallCheck(this,HeightMapBlock);_this29=_super17.call(this,length,height);_this29.deco=deco;return _this29;}_createClass(HeightMapBlock,[{key:"blockAt",value:function blockAt(_height,_oracle,top2,offset){return new BlockInfo(offset,this.length,top2,this.height,this.deco||0);}},{key:"lineAt",value:function lineAt(_value,_type,oracle,top2,offset){return this.blockAt(0,oracle,top2,offset);}},{key:"forEachLine",value:function forEachLine(from,to,oracle,top2,offset,f){if(from<=offset+this.length&&to>=offset)f(this.blockAt(0,oracle,top2,offset));}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var _force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;if(measured&&measured.from<=offset&&measured.more)this.setHeight(oracle,measured.heights[measured.index++]);this.outdated=false;return this;}},{key:"toString",value:function toString(){return"block(".concat(this.length,")");}}]);return HeightMapBlock;}(HeightMap);var HeightMapText=/*#__PURE__*/function(_HeightMapBlock){_inherits(HeightMapText,_HeightMapBlock);var _super18=_createSuper(HeightMapText);function HeightMapText(length,height){var _this30;_classCallCheck(this,HeightMapText);_this30=_super18.call(this,length,height,null);_this30.collapsed=0;_this30.widgetHeight=0;_this30.breaks=0;return _this30;}_createClass(HeightMapText,[{key:"blockAt",value:function blockAt(_height,_oracle,top2,offset){return new BlockInfo(offset,this.length,top2,this.height,this.breaks);}},{key:"replace",value:function replace(_from,_to,nodes){var node=nodes[0];if(nodes.length==1&&(node instanceof HeightMapText||node instanceof HeightMapGap&&node.flags&4)&&Math.abs(this.length-node.length)<10){if(node instanceof HeightMapGap)node=new HeightMapText(node.length,this.height);else node.height=this.height;if(!this.outdated)node.outdated=false;return node;}else{return HeightMap.of(nodes);}}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;if(measured&&measured.from<=offset&&measured.more)this.setHeight(oracle,measured.heights[measured.index++]);else if(force||this.outdated)this.setHeight(oracle,Math.max(this.widgetHeight,oracle.heightForLine(this.length-this.collapsed))+this.breaks*oracle.lineHeight);this.outdated=false;return this;}},{key:"toString",value:function toString(){return"line(".concat(this.length).concat(this.collapsed?-this.collapsed:"").concat(this.widgetHeight?":"+this.widgetHeight:"",")");}}]);return HeightMapText;}(HeightMapBlock);var HeightMapGap=/*#__PURE__*/function(_HeightMap2){_inherits(HeightMapGap,_HeightMap2);var _super19=_createSuper(HeightMapGap);function HeightMapGap(length){_classCallCheck(this,HeightMapGap);return _super19.call(this,length,0);}_createClass(HeightMapGap,[{key:"heightMetrics",value:function heightMetrics(oracle,offset){var firstLine=oracle.doc.lineAt(offset).number,lastLine=oracle.doc.lineAt(offset+this.length).number;var lines=lastLine-firstLine+1;var perLine,perChar=0;if(oracle.lineWrapping){var totalPerLine=Math.min(this.height,oracle.lineHeight*lines);perLine=totalPerLine/lines;if(this.length>lines+1)perChar=(this.height-totalPerLine)/(this.length-lines-1);}else{perLine=this.height/lines;}return{firstLine:firstLine,lastLine:lastLine,perLine:perLine,perChar:perChar};}},{key:"blockAt",value:function blockAt(height,oracle,top2,offset){var _this$heightMetrics=this.heightMetrics(oracle,offset),firstLine=_this$heightMetrics.firstLine,lastLine=_this$heightMetrics.lastLine,perLine=_this$heightMetrics.perLine,perChar=_this$heightMetrics.perChar;if(oracle.lineWrapping){var guess=offset+Math.round(Math.max(0,Math.min(1,(height-top2)/this.height))*this.length);var line=oracle.doc.lineAt(guess),lineHeight=perLine+line.length*perChar;var lineTop=Math.max(top2,height-lineHeight/2);return new BlockInfo(line.from,line.length,lineTop,lineHeight,0);}else{var _line=Math.max(0,Math.min(lastLine-firstLine,Math.floor((height-top2)/perLine)));var _oracle$doc$line=oracle.doc.line(firstLine+_line),from=_oracle$doc$line.from,length=_oracle$doc$line.length;return new BlockInfo(from,length,top2+perLine*_line,perLine,0);}}},{key:"lineAt",value:function lineAt(value,type,oracle,top2,offset){if(type==QueryType.ByHeight)return this.blockAt(value,oracle,top2,offset);if(type==QueryType.ByPosNoHeight){var _oracle$doc$lineAt=oracle.doc.lineAt(value),from=_oracle$doc$lineAt.from,to=_oracle$doc$lineAt.to;return new BlockInfo(from,to-from,0,0,0);}var _this$heightMetrics2=this.heightMetrics(oracle,offset),firstLine=_this$heightMetrics2.firstLine,perLine=_this$heightMetrics2.perLine,perChar=_this$heightMetrics2.perChar;var line=oracle.doc.lineAt(value),lineHeight=perLine+line.length*perChar;var linesAbove=line.number-firstLine;var lineTop=top2+perLine*linesAbove+perChar*(line.from-offset-linesAbove);return new BlockInfo(line.from,line.length,Math.max(top2,Math.min(lineTop,top2+this.height-lineHeight)),lineHeight,0);}},{key:"forEachLine",value:function forEachLine(from,to,oracle,top2,offset,f){from=Math.max(from,offset);to=Math.min(to,offset+this.length);var _this$heightMetrics3=this.heightMetrics(oracle,offset),firstLine=_this$heightMetrics3.firstLine,perLine=_this$heightMetrics3.perLine,perChar=_this$heightMetrics3.perChar;for(var pos=from,lineTop=top2;pos<=to;){var line=oracle.doc.lineAt(pos);if(pos==from){var linesAbove=line.number-firstLine;lineTop+=perLine*linesAbove+perChar*(from-offset-linesAbove);}var lineHeight=perLine+perChar*line.length;f(new BlockInfo(line.from,line.length,lineTop,lineHeight,0));lineTop+=lineHeight;pos=line.to+1;}}},{key:"replace",value:function replace(from,to,nodes){var after=this.length-to;if(after>0){var last=nodes[nodes.length-1];if(last instanceof HeightMapGap)nodes[nodes.length-1]=new HeightMapGap(last.length+after);else nodes.push(null,new HeightMapGap(after-1));}if(from>0){var first=nodes[0];if(first instanceof HeightMapGap)nodes[0]=new HeightMapGap(from+first.length);else nodes.unshift(new HeightMapGap(from-1),null);}return HeightMap.of(nodes);}},{key:"decomposeLeft",value:function decomposeLeft(to,result){result.push(new HeightMapGap(to-1),null);}},{key:"decomposeRight",value:function decomposeRight(from,result){result.push(null,new HeightMapGap(this.length-from-1));}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;var end=offset+this.length;if(measured&&measured.from<=offset+this.length&&measured.more){var nodes=[],pos=Math.max(offset,measured.from),singleHeight=-1;if(measured.from>offset)nodes.push(new HeightMapGap(measured.from-offset-1).updateHeight(oracle,offset));while(pos<=end&&measured.more){var len=oracle.doc.lineAt(pos).length;if(nodes.length)nodes.push(null);var height=measured.heights[measured.index++];if(singleHeight==-1)singleHeight=height;else if(Math.abs(height-singleHeight)>=Epsilon)singleHeight=-2;var line=new HeightMapText(len,height);line.outdated=false;nodes.push(line);pos+=len+1;}if(pos<=end)nodes.push(null,new HeightMapGap(end-pos).updateHeight(oracle,pos));var result=HeightMap.of(nodes);if(singleHeight<0||Math.abs(result.height-this.height)>=Epsilon||Math.abs(singleHeight-this.heightMetrics(oracle,offset).perLine)>=Epsilon)oracle.heightChanged=true;return result;}else if(force||this.outdated){this.setHeight(oracle,oracle.heightForGap(offset,offset+this.length));this.outdated=false;}return this;}},{key:"toString",value:function toString(){return"gap(".concat(this.length,")");}}]);return HeightMapGap;}(HeightMap);var HeightMapBranch=/*#__PURE__*/function(_HeightMap3){_inherits(HeightMapBranch,_HeightMap3);var _super20=_createSuper(HeightMapBranch);function HeightMapBranch(left,brk,right){var _this31;_classCallCheck(this,HeightMapBranch);_this31=_super20.call(this,left.length+brk+right.length,left.height+right.height,brk|(left.outdated||right.outdated?2:0));_this31.left=left;_this31.right=right;_this31.size=left.size+right.size;return _this31;}_createClass(HeightMapBranch,[{key:"break",get:function get(){return this.flags&1;}},{key:"blockAt",value:function blockAt(height,oracle,top2,offset){var mid=top2+this.left.height;return height<mid?this.left.blockAt(height,oracle,top2,offset):this.right.blockAt(height,oracle,mid,offset+this.left.length+this["break"]);}},{key:"lineAt",value:function lineAt(value,type,oracle,top2,offset){var rightTop=top2+this.left.height,rightOffset=offset+this.left.length+this["break"];var left=type==QueryType.ByHeight?value<rightTop:value<rightOffset;var base2=left?this.left.lineAt(value,type,oracle,top2,offset):this.right.lineAt(value,type,oracle,rightTop,rightOffset);if(this["break"]||(left?base2.to<rightOffset:base2.from>rightOffset))return base2;var subQuery=type==QueryType.ByPosNoHeight?QueryType.ByPosNoHeight:QueryType.ByPos;if(left)return base2.join(this.right.lineAt(rightOffset,subQuery,oracle,rightTop,rightOffset));else return this.left.lineAt(rightOffset,subQuery,oracle,top2,offset).join(base2);}},{key:"forEachLine",value:function forEachLine(from,to,oracle,top2,offset,f){var rightTop=top2+this.left.height,rightOffset=offset+this.left.length+this["break"];if(this["break"]){if(from<rightOffset)this.left.forEachLine(from,to,oracle,top2,offset,f);if(to>=rightOffset)this.right.forEachLine(from,to,oracle,rightTop,rightOffset,f);}else{var mid=this.lineAt(rightOffset,QueryType.ByPos,oracle,top2,offset);if(from<mid.from)this.left.forEachLine(from,mid.from-1,oracle,top2,offset,f);if(mid.to>=from&&mid.from<=to)f(mid);if(to>mid.to)this.right.forEachLine(mid.to+1,to,oracle,rightTop,rightOffset,f);}}},{key:"replace",value:function replace(from,to,nodes){var rightStart=this.left.length+this["break"];if(to<rightStart)return this.balanced(this.left.replace(from,to,nodes),this.right);if(from>this.left.length)return this.balanced(this.left,this.right.replace(from-rightStart,to-rightStart,nodes));var result=[];if(from>0)this.decomposeLeft(from,result);var left=result.length;var _iterator55=_createForOfIteratorHelper(nodes),_step55;try{for(_iterator55.s();!(_step55=_iterator55.n()).done;){var node=_step55.value;result.push(node);}}catch(err){_iterator55.e(err);}finally{_iterator55.f();}if(from>0)mergeGaps(result,left-1);if(to<this.length){var right=result.length;this.decomposeRight(to,result);mergeGaps(result,right);}return HeightMap.of(result);}},{key:"decomposeLeft",value:function decomposeLeft(to,result){var left=this.left.length;if(to<=left)return this.left.decomposeLeft(to,result);result.push(this.left);if(this["break"]){left++;if(to>=left)result.push(null);}if(to>left)this.right.decomposeLeft(to-left,result);}},{key:"decomposeRight",value:function decomposeRight(from,result){var left=this.left.length,right=left+this["break"];if(from>=right)return this.right.decomposeRight(from-right,result);if(from<left)this.left.decomposeRight(from,result);if(this["break"]&&from<right)result.push(null);result.push(this.right);}},{key:"balanced",value:function balanced(left,right){if(left.size>2*right.size||right.size>2*left.size)return HeightMap.of(this["break"]?[left,null,right]:[left,right]);this.left=left;this.right=right;this.height=left.height+right.height;this.outdated=left.outdated||right.outdated;this.size=left.size+right.size;this.length=left.length+this["break"]+right.length;return this;}},{key:"updateHeight",value:function updateHeight(oracle){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var force=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var measured=arguments.length>3?arguments[3]:undefined;var left=this.left,right=this.right,rightStart=offset+left.length+this["break"],rebalance=null;if(measured&&measured.from<=offset+left.length&&measured.more)rebalance=left=left.updateHeight(oracle,offset,force,measured);else left.updateHeight(oracle,offset,force);if(measured&&measured.from<=rightStart+right.length&&measured.more)rebalance=right=right.updateHeight(oracle,rightStart,force,measured);else right.updateHeight(oracle,rightStart,force);if(rebalance)return this.balanced(left,right);this.height=this.left.height+this.right.height;this.outdated=false;return this;}},{key:"toString",value:function toString(){return this.left+(this["break"]?" ":"-")+this.right;}}]);return HeightMapBranch;}(HeightMap);function mergeGaps(nodes,around){var before,after;if(nodes[around]==null&&(before=nodes[around-1])instanceof HeightMapGap&&(after=nodes[around+1])instanceof HeightMapGap)nodes.splice(around-1,3,new HeightMapGap(before.length+1+after.length));}var relevantWidgetHeight=5;var NodeBuilder=/*#__PURE__*/function(){function NodeBuilder(pos,oracle){_classCallCheck(this,NodeBuilder);this.pos=pos;this.oracle=oracle;this.nodes=[];this.lineStart=-1;this.lineEnd=-1;this.covering=null;this.writtenTo=pos;}_createClass(NodeBuilder,[{key:"isCovered",get:function get(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering;}},{key:"span",value:function span(_from,to){if(this.lineStart>-1){var end=Math.min(to,this.lineEnd),last=this.nodes[this.nodes.length-1];if(last instanceof HeightMapText)last.length+=end-this.pos;else if(end>this.pos||!this.isCovered)this.nodes.push(new HeightMapText(end-this.pos,-1));this.writtenTo=end;if(to>end){this.nodes.push(null);this.writtenTo++;this.lineStart=-1;}}this.pos=to;}},{key:"point",value:function point(from,to,deco){if(from<to||deco.heightRelevant){var height=deco.widget?deco.widget.estimatedHeight:0;var breaks=deco.widget?deco.widget.lineBreaks:0;if(height<0)height=this.oracle.lineHeight;var len=to-from;if(deco.block){this.addBlock(new HeightMapBlock(len,height,deco));}else if(len||breaks||height>=relevantWidgetHeight){this.addLineDeco(height,breaks,len);}}else if(to>from){this.span(from,to);}if(this.lineEnd>-1&&this.lineEnd<this.pos)this.lineEnd=this.oracle.doc.lineAt(this.pos).to;}},{key:"enterLine",value:function enterLine(){if(this.lineStart>-1)return;var _this$oracle$doc$line=this.oracle.doc.lineAt(this.pos),from=_this$oracle$doc$line.from,to=_this$oracle$doc$line.to;this.lineStart=from;this.lineEnd=to;if(this.writtenTo<from){if(this.writtenTo<from-1||this.nodes[this.nodes.length-1]==null)this.nodes.push(this.blankContent(this.writtenTo,from-1));this.nodes.push(null);}if(this.pos>from)this.nodes.push(new HeightMapText(this.pos-from,-1));this.writtenTo=this.pos;}},{key:"blankContent",value:function blankContent(from,to){var gap=new HeightMapGap(to-from);if(this.oracle.doc.lineAt(from).to==to)gap.flags|=4;return gap;}},{key:"ensureLine",value:function ensureLine(){this.enterLine();var last=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(last instanceof HeightMapText)return last;var line=new HeightMapText(0,-1);this.nodes.push(line);return line;}},{key:"addBlock",value:function addBlock(block){this.enterLine();var deco=block.deco;if(deco&&deco.startSide>0&&!this.isCovered)this.ensureLine();this.nodes.push(block);this.writtenTo=this.pos=this.pos+block.length;if(deco&&deco.endSide>0)this.covering=block;}},{key:"addLineDeco",value:function addLineDeco(height,breaks,length){var line=this.ensureLine();line.length+=length;line.collapsed+=length;line.widgetHeight=Math.max(line.widgetHeight,height);line.breaks+=breaks;this.writtenTo=this.pos=this.pos+length;}},{key:"finish",value:function finish(from){var last=this.nodes.length==0?null:this.nodes[this.nodes.length-1];if(this.lineStart>-1&&!(last instanceof HeightMapText)&&!this.isCovered)this.nodes.push(new HeightMapText(0,-1));else if(this.writtenTo<this.pos||last==null)this.nodes.push(this.blankContent(this.writtenTo,this.pos));var pos=from;var _iterator56=_createForOfIteratorHelper(this.nodes),_step56;try{for(_iterator56.s();!(_step56=_iterator56.n()).done;){var node=_step56.value;if(node instanceof HeightMapText)node.updateHeight(this.oracle,pos);pos+=node?node.length:1;}}catch(err){_iterator56.e(err);}finally{_iterator56.f();}return this.nodes;}}],[{key:"build",value:function build(oracle,decorations2,from,to){var builder=new NodeBuilder(from,oracle);RangeSet.spans(decorations2,from,to,builder,0);return builder.finish(from);}}]);return NodeBuilder;}();function heightRelevantDecoChanges(a,b,diff){var comp=new DecorationComparator2();RangeSet.compare(a,b,diff,comp,0);return comp.changes;}var DecorationComparator2=/*#__PURE__*/function(){function DecorationComparator2(){_classCallCheck(this,DecorationComparator2);this.changes=[];}_createClass(DecorationComparator2,[{key:"compareRange",value:function compareRange(){}},{key:"comparePoint",value:function comparePoint(from,to,a,b){if(from<to||a&&a.heightRelevant||b&&b.heightRelevant)addRange(from,to,this.changes,5);}}]);return DecorationComparator2;}();function visiblePixelRange(dom,paddingTop){var rect=dom.getBoundingClientRect();var doc2=dom.ownerDocument,win=doc2.defaultView||window;var left=Math.max(0,rect.left),right=Math.min(win.innerWidth,rect.right);var top2=Math.max(0,rect.top),bottom=Math.min(win.innerHeight,rect.bottom);for(var parent=dom.parentNode;parent&&parent!=doc2.body;){if(parent.nodeType==1){var elt2=parent;var style=window.getComputedStyle(elt2);if((elt2.scrollHeight>elt2.clientHeight||elt2.scrollWidth>elt2.clientWidth)&&style.overflow!="visible"){var parentRect=elt2.getBoundingClientRect();left=Math.max(left,parentRect.left);right=Math.min(right,parentRect.right);top2=Math.max(top2,parentRect.top);bottom=parent==dom.parentNode?parentRect.bottom:Math.min(bottom,parentRect.bottom);}parent=style.position=="absolute"||style.position=="fixed"?elt2.offsetParent:elt2.parentNode;}else if(parent.nodeType==11){parent=parent.host;}else{break;}}return{left:left-rect.left,right:Math.max(left,right)-rect.left,top:top2-(rect.top+paddingTop),bottom:Math.max(top2,bottom)-(rect.top+paddingTop)};}function fullPixelRange(dom,paddingTop){var rect=dom.getBoundingClientRect();return{left:0,right:rect.right-rect.left,top:paddingTop,bottom:rect.bottom-(rect.top+paddingTop)};}var LineGap=/*#__PURE__*/function(){function LineGap(from,to,size){_classCallCheck(this,LineGap);this.from=from;this.to=to;this.size=size;}_createClass(LineGap,[{key:"draw",value:function draw(viewState,wrapping){return Decoration.replace({widget:new LineGapWidget(this.size*(wrapping?viewState.scaleY:viewState.scaleX),wrapping)}).range(this.from,this.to);}}],[{key:"same",value:function same(a,b){if(a.length!=b.length)return false;for(var _i95=0;_i95<a.length;_i95++){var gA=a[_i95],gB=b[_i95];if(gA.from!=gB.from||gA.to!=gB.to||gA.size!=gB.size)return false;}return true;}}]);return LineGap;}();var LineGapWidget=/*#__PURE__*/function(_WidgetType3){_inherits(LineGapWidget,_WidgetType3);var _super21=_createSuper(LineGapWidget);function LineGapWidget(size,vertical){var _this32;_classCallCheck(this,LineGapWidget);_this32=_super21.call(this);_this32.size=size;_this32.vertical=vertical;return _this32;}_createClass(LineGapWidget,[{key:"eq",value:function eq(other){return other.size==this.size&&other.vertical==this.vertical;}},{key:"toDOM",value:function toDOM(){var elt2=document.createElement("div");if(this.vertical){elt2.style.height=this.size+"px";}else{elt2.style.width=this.size+"px";elt2.style.height="2px";elt2.style.display="inline-block";}return elt2;}},{key:"estimatedHeight",get:function get(){return this.vertical?this.size:-1;}}]);return LineGapWidget;}(WidgetType);var ViewState=/*#__PURE__*/function(){function ViewState(state){var _this33=this;_classCallCheck(this,ViewState);this.state=state;this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0};this.inView=true;this.paddingTop=0;this.paddingBottom=0;this.contentDOMWidth=0;this.contentDOMHeight=0;this.editorHeight=0;this.editorWidth=0;this.scrollTop=0;this.scrolledToBottom=true;this.scaleX=1;this.scaleY=1;this.scrollAnchorPos=0;this.scrollAnchorHeight=-1;this.scaler=IdScaler;this.scrollTarget=null;this.printing=false;this.mustMeasureContent=true;this.defaultTextDirection=Direction.LTR;this.visibleRanges=[];this.mustEnforceCursorAssoc=false;var guessWrapping=state.facet(contentAttributes).some(function(v){return typeof v!="function"&&v["class"]=="cm-lineWrapping";});this.heightOracle=new HeightOracle(guessWrapping);this.stateDeco=state.facet(decorations).filter(function(d){return typeof d!="function";});this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(state.doc),[new ChangedRange(0,0,0,state.doc.length)]);this.viewport=this.getViewport(0,null);this.updateViewportLines();this.updateForViewport();this.lineGaps=this.ensureLineGaps([]);this.lineGapDeco=Decoration.set(this.lineGaps.map(function(gap){return gap.draw(_this33,false);}));this.computeVisibleRanges();}_createClass(ViewState,[{key:"updateForViewport",value:function updateForViewport(){var _this34=this;var viewports=[this.viewport],main=this.state.selection.main;var _loop6=function _loop6(_i96){var pos=_i96?main.head:main.anchor;if(!viewports.some(function(_ref7){var from=_ref7.from,to=_ref7.to;return pos>=from&&pos<=to;})){var _this34$lineBlockAt=_this34.lineBlockAt(pos),from=_this34$lineBlockAt.from,to=_this34$lineBlockAt.to;viewports.push(new Viewport(from,to));}};for(var _i96=0;_i96<=1;_i96++){_loop6(_i96);}this.viewports=viewports.sort(function(a,b){return a.from-b.from;});this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports);}},{key:"updateViewportLines",value:function updateViewportLines(){var _this35=this;this.viewportLines=[];this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,function(block){_this35.viewportLines.push(_this35.scaler.scale==1?block:scaleBlock(block,_this35.scaler));});}},{key:"update",value:function update(_update5){var scrollTarget=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;this.state=_update5.state;var prevDeco=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter(function(d){return typeof d!="function";});var contentChanges=_update5.changedRanges;var heightChanges=ChangedRange.extendWithRanges(contentChanges,heightRelevantDecoChanges(prevDeco,this.stateDeco,_update5?_update5.changes:ChangeSet.empty(this.state.doc.length)));var prevHeight=this.heightMap.height;var scrollAnchor=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,_update5.startState.doc,this.heightOracle.setDoc(this.state.doc),heightChanges);if(this.heightMap.height!=prevHeight)_update5.flags|=2;if(scrollAnchor){this.scrollAnchorPos=_update5.changes.mapPos(scrollAnchor.from,-1);this.scrollAnchorHeight=scrollAnchor.top;}else{this.scrollAnchorPos=-1;this.scrollAnchorHeight=this.heightMap.height;}var viewport=heightChanges.length?this.mapViewport(this.viewport,_update5.changes):this.viewport;if(scrollTarget&&(scrollTarget.range.head<viewport.from||scrollTarget.range.head>viewport.to)||!this.viewportIsAppropriate(viewport))viewport=this.getViewport(0,scrollTarget);var updateLines=!_update5.changes.empty||_update5.flags&2||viewport.from!=this.viewport.from||viewport.to!=this.viewport.to;this.viewport=viewport;this.updateForViewport();if(updateLines)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,_update5.changes)));_update5.flags|=this.computeVisibleRanges();if(scrollTarget)this.scrollTarget=scrollTarget;if(!this.mustEnforceCursorAssoc&&_update5.selectionSet&&_update5.view.lineWrapping&&_update5.state.selection.main.empty&&_update5.state.selection.main.assoc&&!_update5.state.facet(nativeSelectionHidden))this.mustEnforceCursorAssoc=true;}},{key:"measure",value:function measure(view){var dom=view.contentDOM,style=window.getComputedStyle(dom);var oracle=this.heightOracle;var whiteSpace=style.whiteSpace;this.defaultTextDirection=style.direction=="rtl"?Direction.RTL:Direction.LTR;var refresh=this.heightOracle.mustRefreshForWrapping(whiteSpace);var domRect=dom.getBoundingClientRect();var measureContent=refresh||this.mustMeasureContent||this.contentDOMHeight!=domRect.height;this.contentDOMHeight=domRect.height;this.mustMeasureContent=false;var result=0,bias=0;if(domRect.width&&domRect.height){var scaleX=domRect.width/dom.offsetWidth;var scaleY=domRect.height/dom.offsetHeight;if(scaleX>0.995&&scaleX<1.005||!isFinite(scaleX)||Math.abs(domRect.width-dom.offsetWidth)<1)scaleX=1;if(scaleY>0.995&&scaleY<1.005||!isFinite(scaleY)||Math.abs(domRect.height-dom.offsetHeight)<1)scaleY=1;if(this.scaleX!=scaleX||this.scaleY!=scaleY){this.scaleX=scaleX;this.scaleY=scaleY;result|=8;refresh=measureContent=true;}}var paddingTop=(parseInt(style.paddingTop)||0)*this.scaleY;var paddingBottom=(parseInt(style.paddingBottom)||0)*this.scaleY;if(this.paddingTop!=paddingTop||this.paddingBottom!=paddingBottom){this.paddingTop=paddingTop;this.paddingBottom=paddingBottom;result|=8|2;}if(this.editorWidth!=view.scrollDOM.clientWidth){if(oracle.lineWrapping)measureContent=true;this.editorWidth=view.scrollDOM.clientWidth;result|=8;}var scrollTop=view.scrollDOM.scrollTop*this.scaleY;if(this.scrollTop!=scrollTop){this.scrollAnchorHeight=-1;this.scrollTop=scrollTop;}this.scrolledToBottom=isScrolledToBottom(view.scrollDOM);var pixelViewport=(this.printing?fullPixelRange:visiblePixelRange)(dom,this.paddingTop);var dTop=pixelViewport.top-this.pixelViewport.top,dBottom=pixelViewport.bottom-this.pixelViewport.bottom;this.pixelViewport=pixelViewport;var inView=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(inView!=this.inView){this.inView=inView;if(inView)measureContent=true;}if(!this.inView&&!this.scrollTarget)return 0;var contentWidth=domRect.width;if(this.contentDOMWidth!=contentWidth||this.editorHeight!=view.scrollDOM.clientHeight){this.contentDOMWidth=domRect.width;this.editorHeight=view.scrollDOM.clientHeight;result|=8;}if(measureContent){var lineHeights=view.docView.measureVisibleLineHeights(this.viewport);if(oracle.mustRefreshForHeights(lineHeights))refresh=true;if(refresh||oracle.lineWrapping&&Math.abs(contentWidth-this.contentDOMWidth)>oracle.charWidth){var _view$docView$measure=view.docView.measureTextSize(),lineHeight=_view$docView$measure.lineHeight,charWidth=_view$docView$measure.charWidth,textHeight=_view$docView$measure.textHeight;refresh=lineHeight>0&&oracle.refresh(whiteSpace,lineHeight,charWidth,textHeight,contentWidth/charWidth,lineHeights);if(refresh){view.docView.minWidth=0;result|=8;}}if(dTop>0&&dBottom>0)bias=Math.max(dTop,dBottom);else if(dTop<0&&dBottom<0)bias=Math.min(dTop,dBottom);oracle.heightChanged=false;var _iterator57=_createForOfIteratorHelper(this.viewports),_step57;try{for(_iterator57.s();!(_step57=_iterator57.n()).done;){var vp=_step57.value;var heights=vp.from==this.viewport.from?lineHeights:view.docView.measureVisibleLineHeights(vp);this.heightMap=(refresh?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,view.state.doc.length)]):this.heightMap).updateHeight(oracle,0,refresh,new MeasuredHeights(vp.from,heights));}}catch(err){_iterator57.e(err);}finally{_iterator57.f();}if(oracle.heightChanged)result|=2;}var viewportChange=!this.viewportIsAppropriate(this.viewport,bias)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);if(viewportChange)this.viewport=this.getViewport(bias,this.scrollTarget);this.updateForViewport();if(result&2||viewportChange)this.updateViewportLines();if(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)this.updateLineGaps(this.ensureLineGaps(refresh?[]:this.lineGaps,view));result|=this.computeVisibleRanges();if(this.mustEnforceCursorAssoc){this.mustEnforceCursorAssoc=false;view.docView.enforceCursorAssoc();}return result;}},{key:"visibleTop",get:function get(){return this.scaler.fromDOM(this.pixelViewport.top);}},{key:"visibleBottom",get:function get(){return this.scaler.fromDOM(this.pixelViewport.bottom);}},{key:"getViewport",value:function getViewport(bias,scrollTarget){var marginTop=0.5-Math.max(-0.5,Math.min(0.5,bias/1e3/2));var map=this.heightMap,oracle=this.heightOracle;var visibleTop=this.visibleTop,visibleBottom=this.visibleBottom;var viewport=new Viewport(map.lineAt(visibleTop-marginTop*1e3,QueryType.ByHeight,oracle,0,0).from,map.lineAt(visibleBottom+(1-marginTop)*1e3,QueryType.ByHeight,oracle,0,0).to);if(scrollTarget){var head=scrollTarget.range.head;if(head<viewport.from||head>viewport.to){var viewHeight=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top);var block=map.lineAt(head,QueryType.ByPos,oracle,0,0),topPos;if(scrollTarget.y=="center")topPos=(block.top+block.bottom)/2-viewHeight/2;else if(scrollTarget.y=="start"||scrollTarget.y=="nearest"&&head<viewport.from)topPos=block.top;else topPos=block.bottom-viewHeight;viewport=new Viewport(map.lineAt(topPos-1e3/2,QueryType.ByHeight,oracle,0,0).from,map.lineAt(topPos+viewHeight+1e3/2,QueryType.ByHeight,oracle,0,0).to);}}return viewport;}},{key:"mapViewport",value:function mapViewport(viewport,changes){var from=changes.mapPos(viewport.from,-1),to=changes.mapPos(viewport.to,1);return new Viewport(this.heightMap.lineAt(from,QueryType.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(to,QueryType.ByPos,this.heightOracle,0,0).to);}},{key:"viewportIsAppropriate",value:function viewportIsAppropriate(_ref8){var from=_ref8.from,to=_ref8.to;var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(!this.inView)return true;var _this$heightMap$lineA=this.heightMap.lineAt(from,QueryType.ByPos,this.heightOracle,0,0),top2=_this$heightMap$lineA.top;var _this$heightMap$lineA2=this.heightMap.lineAt(to,QueryType.ByPos,this.heightOracle,0,0),bottom=_this$heightMap$lineA2.bottom;var visibleTop=this.visibleTop,visibleBottom=this.visibleBottom;return(from==0||top2<=visibleTop-Math.max(10,Math.min(-bias,250)))&&(to==this.state.doc.length||bottom>=visibleBottom+Math.max(10,Math.min(bias,250)))&&top2>visibleTop-2*1e3&&bottom<visibleBottom+2*1e3;}},{key:"mapLineGaps",value:function mapLineGaps(gaps,changes){if(!gaps.length||changes.empty)return gaps;var mapped=[];var _iterator58=_createForOfIteratorHelper(gaps),_step58;try{for(_iterator58.s();!(_step58=_iterator58.n()).done;){var gap=_step58.value;if(!changes.touchesRange(gap.from,gap.to))mapped.push(new LineGap(changes.mapPos(gap.from),changes.mapPos(gap.to),gap.size));}}catch(err){_iterator58.e(err);}finally{_iterator58.f();}return mapped;}},{key:"ensureLineGaps",value:function ensureLineGaps(current,mayMeasure){var _this36=this;var wrapping=this.heightOracle.lineWrapping;var margin=wrapping?1e4:2e3,halfMargin=margin>>1,doubleMargin=margin<<1;if(this.defaultTextDirection!=Direction.LTR&&!wrapping)return[];var gaps=[];var addGap=function addGap(from,to,line,structure){if(to-from<halfMargin)return;var sel=_this36.state.selection.main,avoid=[sel.from];if(!sel.empty)avoid.push(sel.to);for(var _i97=0,_avoid=avoid;_i97<_avoid.length;_i97++){var pos=_avoid[_i97];if(pos>from&&pos<to){addGap(from,pos-10,line,structure);addGap(pos+10,to,line,structure);return;}}var gap=find(current,function(gap2){return gap2.from>=line.from&&gap2.to<=line.to&&Math.abs(gap2.from-from)<halfMargin&&Math.abs(gap2.to-to)<halfMargin&&!avoid.some(function(pos){return gap2.from<pos&&gap2.to>pos;});});if(!gap){if(to<line.to&&mayMeasure&&wrapping&&mayMeasure.visibleRanges.some(function(r){return r.from<=to&&r.to>=to;})){var lineStart=mayMeasure.moveToLineBoundary(EditorSelection.cursor(to),false,true).head;if(lineStart>from)to=lineStart;}gap=new LineGap(from,to,_this36.gapSize(line,from,to,structure));}gaps.push(gap);};var _iterator59=_createForOfIteratorHelper(this.viewportLines),_step59;try{for(_iterator59.s();!(_step59=_iterator59.n()).done;){var line=_step59.value;if(line.length<doubleMargin)continue;var structure=lineStructure(line.from,line.to,this.stateDeco);if(structure.total<doubleMargin)continue;var target=this.scrollTarget?this.scrollTarget.range.head:null;var viewFrom=void 0,viewTo=void 0;if(wrapping){var marginHeight=margin/this.heightOracle.lineLength*this.heightOracle.lineHeight;var top2=void 0,bot=void 0;if(target!=null){var targetFrac=findFraction(structure,target);var spaceFrac=((this.visibleBottom-this.visibleTop)/2+marginHeight)/line.height;top2=targetFrac-spaceFrac;bot=targetFrac+spaceFrac;}else{top2=(this.visibleTop-line.top-marginHeight)/line.height;bot=(this.visibleBottom-line.top+marginHeight)/line.height;}viewFrom=findPosition(structure,top2);viewTo=findPosition(structure,bot);}else{var totalWidth=structure.total*this.heightOracle.charWidth;var marginWidth=margin*this.heightOracle.charWidth;var left=void 0,right=void 0;if(target!=null){var _targetFrac=findFraction(structure,target);var _spaceFrac=((this.pixelViewport.right-this.pixelViewport.left)/2+marginWidth)/totalWidth;left=_targetFrac-_spaceFrac;right=_targetFrac+_spaceFrac;}else{left=(this.pixelViewport.left-marginWidth)/totalWidth;right=(this.pixelViewport.right+marginWidth)/totalWidth;}viewFrom=findPosition(structure,left);viewTo=findPosition(structure,right);}if(viewFrom>line.from)addGap(line.from,viewFrom,line,structure);if(viewTo<line.to)addGap(viewTo,line.to,line,structure);}}catch(err){_iterator59.e(err);}finally{_iterator59.f();}return gaps;}},{key:"gapSize",value:function gapSize(line,from,to,structure){var fraction=findFraction(structure,to)-findFraction(structure,from);if(this.heightOracle.lineWrapping){return line.height*fraction;}else{return structure.total*this.heightOracle.charWidth*fraction;}}},{key:"updateLineGaps",value:function updateLineGaps(gaps){var _this37=this;if(!LineGap.same(gaps,this.lineGaps)){this.lineGaps=gaps;this.lineGapDeco=Decoration.set(gaps.map(function(gap){return gap.draw(_this37,_this37.heightOracle.lineWrapping);}));}}},{key:"computeVisibleRanges",value:function computeVisibleRanges(){var deco=this.stateDeco;if(this.lineGaps.length)deco=deco.concat(this.lineGapDeco);var ranges=[];RangeSet.spans(deco,this.viewport.from,this.viewport.to,{span:function span(from,to){ranges.push({from:from,to:to});},point:function point(){}},20);var changed=ranges.length!=this.visibleRanges.length||this.visibleRanges.some(function(r,i){return r.from!=ranges[i].from||r.to!=ranges[i].to;});this.visibleRanges=ranges;return changed?4:0;}},{key:"lineBlockAt",value:function lineBlockAt(pos){return pos>=this.viewport.from&&pos<=this.viewport.to&&this.viewportLines.find(function(b){return b.from<=pos&&b.to>=pos;})||scaleBlock(this.heightMap.lineAt(pos,QueryType.ByPos,this.heightOracle,0,0),this.scaler);}},{key:"lineBlockAtHeight",value:function lineBlockAtHeight(height){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(height),QueryType.ByHeight,this.heightOracle,0,0),this.scaler);}},{key:"scrollAnchorAt",value:function scrollAnchorAt(scrollTop){var block=this.lineBlockAtHeight(scrollTop+8);return block.from>=this.viewport.from||this.viewportLines[0].top-scrollTop>200?block:this.viewportLines[0];}},{key:"elementAtHeight",value:function elementAtHeight(height){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(height),this.heightOracle,0,0),this.scaler);}},{key:"docHeight",get:function get(){return this.scaler.toDOM(this.heightMap.height);}},{key:"contentHeight",get:function get(){return this.docHeight+this.paddingTop+this.paddingBottom;}}]);return ViewState;}();var Viewport=/*#__PURE__*/_createClass(function Viewport(from,to){_classCallCheck(this,Viewport);this.from=from;this.to=to;});function lineStructure(from,to,stateDeco){var ranges=[],pos=from,total=0;RangeSet.spans(stateDeco,from,to,{span:function span(){},point:function point(from2,to2){if(from2>pos){ranges.push({from:pos,to:from2});total+=from2-pos;}pos=to2;}},20);if(pos<to){ranges.push({from:pos,to:to});total+=to-pos;}return{total:total,ranges:ranges};}function findPosition(_ref9,ratio){var total=_ref9.total,ranges=_ref9.ranges;if(ratio<=0)return ranges[0].from;if(ratio>=1)return ranges[ranges.length-1].to;var dist2=Math.floor(total*ratio);for(var _i98=0;;_i98++){var _ranges$_i=ranges[_i98],from=_ranges$_i.from,to=_ranges$_i.to,size=to-from;if(dist2<=size)return from+dist2;dist2-=size;}}function findFraction(structure,pos){var counted=0;var _iterator60=_createForOfIteratorHelper(structure.ranges),_step60;try{for(_iterator60.s();!(_step60=_iterator60.n()).done;){var _step60$value=_step60.value,from=_step60$value.from,to=_step60$value.to;if(pos<=to){counted+=pos-from;break;}counted+=to-from;}}catch(err){_iterator60.e(err);}finally{_iterator60.f();}return counted/structure.total;}function find(array,f){var _iterator61=_createForOfIteratorHelper(array),_step61;try{for(_iterator61.s();!(_step61=_iterator61.n()).done;){var val=_step61.value;if(f(val))return val;}}catch(err){_iterator61.e(err);}finally{_iterator61.f();}return void 0;}var IdScaler={toDOM:function toDOM(n){return n;},fromDOM:function fromDOM(n){return n;},scale:1};var BigScaler=/*#__PURE__*/function(){function BigScaler(oracle,heightMap,viewports){_classCallCheck(this,BigScaler);var vpHeight=0,base2=0,domBase=0;this.viewports=viewports.map(function(_ref10){var from=_ref10.from,to=_ref10.to;var top2=heightMap.lineAt(from,QueryType.ByPos,oracle,0,0).top;var bottom=heightMap.lineAt(to,QueryType.ByPos,oracle,0,0).bottom;vpHeight+=bottom-top2;return{from:from,to:to,top:top2,bottom:bottom,domTop:0,domBottom:0};});this.scale=(7e6-vpHeight)/(heightMap.height-vpHeight);var _iterator62=_createForOfIteratorHelper(this.viewports),_step62;try{for(_iterator62.s();!(_step62=_iterator62.n()).done;){var obj=_step62.value;obj.domTop=domBase+(obj.top-base2)*this.scale;domBase=obj.domBottom=obj.domTop+(obj.bottom-obj.top);base2=obj.bottom;}}catch(err){_iterator62.e(err);}finally{_iterator62.f();}}_createClass(BigScaler,[{key:"toDOM",value:function toDOM(n){for(var _i99=0,base2=0,domBase=0;;_i99++){var vp=_i99<this.viewports.length?this.viewports[_i99]:null;if(!vp||n<vp.top)return domBase+(n-base2)*this.scale;if(n<=vp.bottom)return vp.domTop+(n-vp.top);base2=vp.bottom;domBase=vp.domBottom;}}},{key:"fromDOM",value:function fromDOM(n){for(var _i100=0,base2=0,domBase=0;;_i100++){var vp=_i100<this.viewports.length?this.viewports[_i100]:null;if(!vp||n<vp.domTop)return base2+(n-domBase)/this.scale;if(n<=vp.domBottom)return vp.top+(n-vp.domTop);base2=vp.bottom;domBase=vp.domBottom;}}}]);return BigScaler;}();function scaleBlock(block,scaler){if(scaler.scale==1)return block;var bTop=scaler.toDOM(block.top),bBottom=scaler.toDOM(block.bottom);return new BlockInfo(block.from,block.length,bTop,bBottom-bTop,Array.isArray(block._content)?block._content.map(function(b){return scaleBlock(b,scaler);}):block._content);}var _theme=/* @__PURE__ */Facet.define({combine:function combine(strs){return strs.join(" ");}});var darkTheme=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.indexOf(true)>-1;}});var baseThemeID=/* @__PURE__ */StyleModule.newName();var baseLightID=/* @__PURE__ */StyleModule.newName();var baseDarkID=/* @__PURE__ */StyleModule.newName();var lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(main,spec,scopes){return new StyleModule(spec,{finish:function finish(sel){return /&/.test(sel)?sel.replace(/&\w*/,function(m){if(m=="&")return main;if(!scopes||!scopes[m])throw new RangeError("Unsupported selector: ".concat(m));return scopes[m];}):main+" "+sel;}});}var baseTheme$1=/* @__PURE__ */buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:"url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"200\" height=\"20\"><path stroke=\"%23888\" stroke-width=\"1\" fill=\"none\" d=\"M1 10H196L190 5M190 15L196 10M197 4L197 16\"/></svg>')",backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs);var LineBreakPlaceholder="\uFFFF";var DOMReader=/*#__PURE__*/function(){function DOMReader(points,state){_classCallCheck(this,DOMReader);this.points=points;this.text="";this.lineSeparator=state.facet(EditorState.lineSeparator);}_createClass(DOMReader,[{key:"append",value:function append(text){this.text+=text;}},{key:"lineBreak",value:function lineBreak(){this.text+=LineBreakPlaceholder;}},{key:"readRange",value:function readRange(start,end){if(!start)return this;var parent=start.parentNode;for(var cur2=start;;){this.findPointBefore(parent,cur2);var oldLen=this.text.length;this.readNode(cur2);var next=cur2.nextSibling;if(next==end)break;var view=ContentView.get(cur2),nextView=ContentView.get(next);if(view&&nextView?view.breakAfter:(view?view.breakAfter:isBlockElement(cur2))||isBlockElement(next)&&(cur2.nodeName!="BR"||cur2.cmIgnore)&&this.text.length>oldLen)this.lineBreak();cur2=next;}this.findPointBefore(parent,end);return this;}},{key:"readTextNode",value:function readTextNode(node){var text=node.nodeValue;var _iterator63=_createForOfIteratorHelper(this.points),_step63;try{for(_iterator63.s();!(_step63=_iterator63.n()).done;){var _point=_step63.value;if(_point.node==node)_point.pos=this.text.length+Math.min(_point.offset,text.length);}}catch(err){_iterator63.e(err);}finally{_iterator63.f();}for(var off=0,re=this.lineSeparator?null:/\r\n?|\n/g;;){var nextBreak=-1,breakSize=1,m=void 0;if(this.lineSeparator){nextBreak=text.indexOf(this.lineSeparator,off);breakSize=this.lineSeparator.length;}else if(m=re.exec(text)){nextBreak=m.index;breakSize=m[0].length;}this.append(text.slice(off,nextBreak<0?text.length:nextBreak));if(nextBreak<0)break;this.lineBreak();if(breakSize>1){var _iterator64=_createForOfIteratorHelper(this.points),_step64;try{for(_iterator64.s();!(_step64=_iterator64.n()).done;){var point=_step64.value;if(point.node==node&&point.pos>this.text.length)point.pos-=breakSize-1;}}catch(err){_iterator64.e(err);}finally{_iterator64.f();}}off=nextBreak+breakSize;}}},{key:"readNode",value:function readNode(node){if(node.cmIgnore)return;var view=ContentView.get(node);var fromView=view&&view.overrideDOMText;if(fromView!=null){this.findPointInside(node,fromView.length);for(var _i101=fromView.iter();!_i101.next().done;){if(_i101.lineBreak)this.lineBreak();else this.append(_i101.value);}}else if(node.nodeType==3){this.readTextNode(node);}else if(node.nodeName=="BR"){if(node.nextSibling)this.lineBreak();}else if(node.nodeType==1){this.readRange(node.firstChild,null);}}},{key:"findPointBefore",value:function findPointBefore(node,next){var _iterator65=_createForOfIteratorHelper(this.points),_step65;try{for(_iterator65.s();!(_step65=_iterator65.n()).done;){var point=_step65.value;if(point.node==node&&node.childNodes[point.offset]==next)point.pos=this.text.length;}}catch(err){_iterator65.e(err);}finally{_iterator65.f();}}},{key:"findPointInside",value:function findPointInside(node,length){var _iterator66=_createForOfIteratorHelper(this.points),_step66;try{for(_iterator66.s();!(_step66=_iterator66.n()).done;){var point=_step66.value;if(node.nodeType==3?point.node==node:node.contains(point.node))point.pos=this.text.length+(isAtEnd(node,point.node,point.offset)?length:0);}}catch(err){_iterator66.e(err);}finally{_iterator66.f();}}}]);return DOMReader;}();function isAtEnd(parent,node,offset){for(;;){if(!node||offset<maxOffset(node))return false;if(node==parent)return true;offset=domIndex(node)+1;node=node.parentNode;}}function isBlockElement(node){return node.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(node.nodeName);}var DOMPoint=/*#__PURE__*/_createClass(function DOMPoint(node,offset){_classCallCheck(this,DOMPoint);this.node=node;this.offset=offset;this.pos=-1;});var DOMChange=/*#__PURE__*/_createClass(function DOMChange(view,start,end,typeOver){_classCallCheck(this,DOMChange);this.typeOver=typeOver;this.bounds=null;this.text="";var _view$docView=view.docView,iHead=_view$docView.impreciseHead,iAnchor=_view$docView.impreciseAnchor;if(view.state.readOnly&&start>-1){this.newSel=null;}else if(start>-1&&(this.bounds=view.docView.domBoundsAround(start,end,0))){var selPoints=iHead||iAnchor?[]:selectionPoints(view);var reader=new DOMReader(selPoints,view.state);reader.readRange(this.bounds.startDOM,this.bounds.endDOM);this.text=reader.text;this.newSel=selectionFromPoints(selPoints,this.bounds.from);}else{var domSel=view.observer.selectionRange;var head=iHead&&iHead.node==domSel.focusNode&&iHead.offset==domSel.focusOffset||!contains(view.contentDOM,domSel.focusNode)?view.state.selection.main.head:view.docView.posFromDOM(domSel.focusNode,domSel.focusOffset);var anchor=iAnchor&&iAnchor.node==domSel.anchorNode&&iAnchor.offset==domSel.anchorOffset||!contains(view.contentDOM,domSel.anchorNode)?view.state.selection.main.anchor:view.docView.posFromDOM(domSel.anchorNode,domSel.anchorOffset);this.newSel=EditorSelection.single(anchor,head);}});function applyDOMChange(view,domChange){var change;var newSel=domChange.newSel,sel=view.state.selection.main;var lastKey=view.inputState.lastKeyTime>Date.now()-100?view.inputState.lastKeyCode:-1;if(domChange.bounds){var _domChange$bounds=domChange.bounds,from=_domChange$bounds.from,to=_domChange$bounds.to;var preferredPos=sel.from,preferredSide=null;if(lastKey===8||browser.android&&domChange.text.length<to-from){preferredPos=sel.to;preferredSide="end";}var diff=findDiff(view.state.doc.sliceString(from,to,LineBreakPlaceholder),domChange.text,preferredPos-from,preferredSide);if(diff){if(browser.chrome&&lastKey==13&&diff.toB==diff.from+2&&domChange.text.slice(diff.from,diff.toB)==LineBreakPlaceholder+LineBreakPlaceholder)diff.toB--;change={from:from+diff.from,to:from+diff.toA,insert:Text.of(domChange.text.slice(diff.from,diff.toB).split(LineBreakPlaceholder))};}}else if(newSel&&(!view.hasFocus&&view.state.facet(editable)||newSel.main.eq(sel))){newSel=null;}if(!change&&!newSel)return false;if(!change&&domChange.typeOver&&!sel.empty&&newSel&&newSel.main.empty){change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,sel.to)};}else if(change&&change.from>=sel.from&&change.to<=sel.to&&(change.from!=sel.from||change.to!=sel.to)&&sel.to-sel.from-(change.to-change.from)<=4){change={from:sel.from,to:sel.to,insert:view.state.doc.slice(sel.from,change.from).append(change.insert).append(view.state.doc.slice(change.to,sel.to))};}else if((browser.mac||browser.android)&&change&&change.from==change.to&&change.from==sel.head-1&&/^\. ?$/.test(change.insert.toString())&&view.contentDOM.getAttribute("autocorrect")=="off"){if(newSel&&change.insert.length==2)newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1);change={from:sel.from,to:sel.to,insert:Text.of([" "])};}else if(browser.chrome&&change&&change.from==change.to&&change.from==sel.head&&change.insert.toString()=="\n "&&view.lineWrapping){if(newSel)newSel=EditorSelection.single(newSel.main.anchor-1,newSel.main.head-1);change={from:sel.from,to:sel.to,insert:Text.of([" "])};}if(change){if(browser.ios&&view.inputState.flushIOSKey())return true;if(browser.android&&(change.from==sel.from&&change.to==sel.to&&change.insert.length==1&&change.insert.lines==2&&dispatchKey(view.contentDOM,"Enter",13)||(change.from==sel.from-1&&change.to==sel.to&&change.insert.length==0||lastKey==8&&change.insert.length<change.to-change.from&&change.to>sel.head)&&dispatchKey(view.contentDOM,"Backspace",8)||change.from==sel.from&&change.to==sel.to+1&&change.insert.length==0&&dispatchKey(view.contentDOM,"Delete",46)))return true;var _text5=change.insert.toString();if(view.inputState.composing>=0)view.inputState.composing++;var defaultTr;var defaultInsert=function defaultInsert(){return defaultTr||(defaultTr=applyDefaultInsert(view,change,newSel));};if(!view.state.facet(inputHandler).some(function(h){return h(view,change.from,change.to,_text5,defaultInsert);}))view.dispatch(defaultInsert());return true;}else if(newSel&&!newSel.main.eq(sel)){var scrollIntoView3=false,userEvent="select";if(view.inputState.lastSelectionTime>Date.now()-50){if(view.inputState.lastSelectionOrigin=="select")scrollIntoView3=true;userEvent=view.inputState.lastSelectionOrigin;}view.dispatch({selection:newSel,scrollIntoView:scrollIntoView3,userEvent:userEvent});return true;}else{return false;}}function applyDefaultInsert(view,change,newSel){var tr,startState=view.state,sel=startState.selection.main;if(change.from>=sel.from&&change.to<=sel.to&&change.to-change.from>=(sel.to-sel.from)/3&&(!newSel||newSel.main.empty&&newSel.main.from==change.from+change.insert.length)&&view.inputState.composing<0){var before=sel.from<change.from?startState.sliceDoc(sel.from,change.from):"";var after=sel.to>change.to?startState.sliceDoc(change.to,sel.to):"";tr=startState.replaceSelection(view.state.toText(before+change.insert.sliceString(0,void 0,view.state.lineBreak)+after));}else{var changes=startState.changes(change);var mainSel=newSel&&newSel.main.to<=changes.newLength?newSel.main:void 0;if(startState.selection.ranges.length>1&&view.inputState.composing>=0&&change.to<=sel.to&&change.to>=sel.to-10){var replaced=view.state.sliceDoc(change.from,change.to);var compositionRange,composition=newSel&&findCompositionNode(view,newSel.main.head);if(composition){var dLen=change.insert.length-(change.to-change.from);compositionRange={from:composition.from,to:composition.to-dLen};}else{compositionRange=view.state.doc.lineAt(sel.head);}var offset=sel.to-change.to,size=sel.to-sel.from;tr=startState.changeByRange(function(range){if(range.from==sel.from&&range.to==sel.to)return{changes:changes,range:mainSel||range.map(changes)};var to=range.to-offset,from=to-replaced.length;if(range.to-range.from!=size||view.state.sliceDoc(from,to)!=replaced||range.to>=compositionRange.from&&range.from<=compositionRange.to)return{range:range};var rangeChanges=startState.changes({from:from,to:to,insert:change.insert}),selOff=range.to-sel.to;return{changes:rangeChanges,range:!mainSel?range.map(rangeChanges):EditorSelection.range(Math.max(0,mainSel.anchor+selOff),Math.max(0,mainSel.head+selOff))};});}else{tr={changes:changes,selection:mainSel&&startState.selection.replaceRange(mainSel)};}}var userEvent="input.type";if(view.composing||view.inputState.compositionPendingChange&&view.inputState.compositionEndedAt>Date.now()-50){view.inputState.compositionPendingChange=false;userEvent+=".compose";if(view.inputState.compositionFirstChange){userEvent+=".start";view.inputState.compositionFirstChange=false;}}return startState.update(tr,{userEvent:userEvent,scrollIntoView:true});}function findDiff(a,b,preferredPos,preferredSide){var minLen=Math.min(a.length,b.length);var from=0;while(from<minLen&&a.charCodeAt(from)==b.charCodeAt(from)){from++;}if(from==minLen&&a.length==b.length)return null;var toA=a.length,toB=b.length;while(toA>0&&toB>0&&a.charCodeAt(toA-1)==b.charCodeAt(toB-1)){toA--;toB--;}if(preferredSide=="end"){var adjust=Math.max(0,from-Math.min(toA,toB));preferredPos-=toA+adjust-from;}if(toA<from&&a.length<b.length){var move=preferredPos<=from&&preferredPos>=toA?from-preferredPos:0;from-=move;toB=from+(toB-toA);toA=from;}else if(toB<from){var _move=preferredPos<=from&&preferredPos>=toB?from-preferredPos:0;from-=_move;toA=from+(toA-toB);toB=from;}return{from:from,toA:toA,toB:toB};}function selectionPoints(view){var result=[];if(view.root.activeElement!=view.contentDOM)return result;var _view$observer$select2=view.observer.selectionRange,anchorNode=_view$observer$select2.anchorNode,anchorOffset=_view$observer$select2.anchorOffset,focusNode=_view$observer$select2.focusNode,focusOffset=_view$observer$select2.focusOffset;if(anchorNode){result.push(new DOMPoint(anchorNode,anchorOffset));if(focusNode!=anchorNode||focusOffset!=anchorOffset)result.push(new DOMPoint(focusNode,focusOffset));}return result;}function selectionFromPoints(points,base2){if(points.length==0)return null;var anchor=points[0].pos,head=points.length==2?points[1].pos:anchor;return anchor>-1&&head>-1?EditorSelection.single(anchor+base2,head+base2):null;}var observeOptions={childList:true,characterData:true,subtree:true,attributes:true,characterDataOldValue:true};var useCharData=browser.ie&&browser.ie_version<=11;var DOMObserver=/*#__PURE__*/function(){function DOMObserver(view){var _this38=this;_classCallCheck(this,DOMObserver);this.view=view;this.active=false;this.selectionRange=new DOMSelectionState();this.selectionChanged=false;this.delayedFlush=-1;this.resizeTimeout=-1;this.queue=[];this.delayedAndroidKey=null;this.flushingAndroidKey=-1;this.lastChange=0;this.scrollTargets=[];this.intersection=null;this.resizeScroll=null;this.intersecting=false;this.gapIntersection=null;this.gaps=[];this.parentCheck=-1;this.dom=view.contentDOM;this.observer=new MutationObserver(function(mutations){var _iterator67=_createForOfIteratorHelper(mutations),_step67;try{for(_iterator67.s();!(_step67=_iterator67.n()).done;){var mut=_step67.value;_this38.queue.push(mut);}}catch(err){_iterator67.e(err);}finally{_iterator67.f();}if((browser.ie&&browser.ie_version<=11||browser.ios&&view.composing)&&mutations.some(function(m){return m.type=="childList"&&m.removedNodes.length||m.type=="characterData"&&m.oldValue.length>m.target.nodeValue.length;}))_this38.flushSoon();else _this38.flush();});if(useCharData)this.onCharData=function(event){_this38.queue.push({target:event.target,type:"characterData",oldValue:event.prevValue});_this38.flushSoon();};this.onSelectionChange=this.onSelectionChange.bind(this);this.onResize=this.onResize.bind(this);this.onPrint=this.onPrint.bind(this);this.onScroll=this.onScroll.bind(this);if(typeof ResizeObserver=="function"){this.resizeScroll=new ResizeObserver(function(){var _a2;if(((_a2=_this38.view.docView)===null||_a2===void 0?void 0:_a2.lastUpdate)<Date.now()-75)_this38.onResize();});this.resizeScroll.observe(view.scrollDOM);}this.addWindowListeners(this.win=view.win);this.start();if(typeof IntersectionObserver=="function"){this.intersection=new IntersectionObserver(function(entries){if(_this38.parentCheck<0)_this38.parentCheck=setTimeout(_this38.listenForScroll.bind(_this38),1e3);if(entries.length>0&&entries[entries.length-1].intersectionRatio>0!=_this38.intersecting){_this38.intersecting=!_this38.intersecting;if(_this38.intersecting!=_this38.view.inView)_this38.onScrollChanged(document.createEvent("Event"));}},{threshold:[0,1e-3]});this.intersection.observe(this.dom);this.gapIntersection=new IntersectionObserver(function(entries){if(entries.length>0&&entries[entries.length-1].intersectionRatio>0)_this38.onScrollChanged(document.createEvent("Event"));},{});}this.listenForScroll();this.readSelectionRange();}_createClass(DOMObserver,[{key:"onScrollChanged",value:function onScrollChanged(e){this.view.inputState.runHandlers("scroll",e);if(this.intersecting)this.view.measure();}},{key:"onScroll",value:function onScroll(e){if(this.intersecting)this.flush(false);this.onScrollChanged(e);}},{key:"onResize",value:function onResize(){var _this39=this;if(this.resizeTimeout<0)this.resizeTimeout=setTimeout(function(){_this39.resizeTimeout=-1;_this39.view.requestMeasure();},50);}},{key:"onPrint",value:function onPrint(){var _this40=this;this.view.viewState.printing=true;this.view.measure();setTimeout(function(){_this40.view.viewState.printing=false;_this40.view.requestMeasure();},500);}},{key:"updateGaps",value:function updateGaps(gaps){if(this.gapIntersection&&(gaps.length!=this.gaps.length||this.gaps.some(function(g,i){return g!=gaps[i];}))){this.gapIntersection.disconnect();var _iterator68=_createForOfIteratorHelper(gaps),_step68;try{for(_iterator68.s();!(_step68=_iterator68.n()).done;){var gap=_step68.value;this.gapIntersection.observe(gap);}}catch(err){_iterator68.e(err);}finally{_iterator68.f();}this.gaps=gaps;}}},{key:"onSelectionChange",value:function onSelectionChange(event){var wasChanged=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;var view=this.view,sel=this.selectionRange;if(view.state.facet(editable)?view.root.activeElement!=this.dom:!hasSelection(view.dom,sel))return;var context=sel.anchorNode&&view.docView.nearest(sel.anchorNode);if(context&&context.ignoreEvent(event)){if(!wasChanged)this.selectionChanged=false;return;}if((browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!view.state.selection.main.empty&&sel.focusNode&&isEquivalentPosition(sel.focusNode,sel.focusOffset,sel.anchorNode,sel.anchorOffset))this.flushSoon();else this.flush(false);}},{key:"readSelectionRange",value:function readSelectionRange(){var view=this.view;var range=browser.safari&&view.root.nodeType==11&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view)||getSelection(view.root);if(!range||this.selectionRange.eq(range))return false;var local=hasSelection(this.dom,range);if(local&&!this.selectionChanged&&view.inputState.lastFocusTime>Date.now()-200&&view.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,range)){this.view.inputState.lastFocusTime=0;view.docView.updateSelection();return false;}this.selectionRange.setRange(range);if(local)this.selectionChanged=true;return true;}},{key:"setSelectionRange",value:function setSelectionRange(anchor,head){this.selectionRange.set(anchor.node,anchor.offset,head.node,head.offset);this.selectionChanged=false;}},{key:"clearSelectionRange",value:function clearSelectionRange(){this.selectionRange.set(null,0,null,0);}},{key:"listenForScroll",value:function listenForScroll(){this.parentCheck=-1;var i=0,changed=null;for(var dom=this.dom;dom;){if(dom.nodeType==1){if(!changed&&i<this.scrollTargets.length&&this.scrollTargets[i]==dom)i++;else if(!changed)changed=this.scrollTargets.slice(0,i);if(changed)changed.push(dom);dom=dom.assignedSlot||dom.parentNode;}else if(dom.nodeType==11){dom=dom.host;}else{break;}}if(i<this.scrollTargets.length&&!changed)changed=this.scrollTargets.slice(0,i);if(changed){var _iterator69=_createForOfIteratorHelper(this.scrollTargets),_step69;try{for(_iterator69.s();!(_step69=_iterator69.n()).done;){var _dom2=_step69.value;_dom2.removeEventListener("scroll",this.onScroll);}}catch(err){_iterator69.e(err);}finally{_iterator69.f();}var _iterator70=_createForOfIteratorHelper(this.scrollTargets=changed),_step70;try{for(_iterator70.s();!(_step70=_iterator70.n()).done;){var _dom3=_step70.value;_dom3.addEventListener("scroll",this.onScroll);}}catch(err){_iterator70.e(err);}finally{_iterator70.f();}}}},{key:"ignore",value:function ignore(f){if(!this.active)return f();try{this.stop();return f();}finally{this.start();this.clear();}}},{key:"start",value:function start(){if(this.active)return;this.observer.observe(this.dom,observeOptions);if(useCharData)this.dom.addEventListener("DOMCharacterDataModified",this.onCharData);this.active=true;}},{key:"stop",value:function stop(){if(!this.active)return;this.active=false;this.observer.disconnect();if(useCharData)this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData);}},{key:"clear",value:function clear(){this.processRecords();this.queue.length=0;this.selectionChanged=false;}},{key:"delayAndroidKey",value:function delayAndroidKey(key,keyCode){var _this41=this;var _a2;if(!this.delayedAndroidKey){var flush=function flush(){var key2=_this41.delayedAndroidKey;if(key2){_this41.clearDelayedAndroidKey();_this41.view.inputState.lastKeyCode=key2.keyCode;_this41.view.inputState.lastKeyTime=Date.now();var flushed=_this41.flush();if(!flushed&&key2.force)dispatchKey(_this41.dom,key2.key,key2.keyCode);}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(flush);}if(!this.delayedAndroidKey||key=="Enter")this.delayedAndroidKey={key:key,keyCode:keyCode,force:this.lastChange<Date.now()-50||!!((_a2=this.delayedAndroidKey)===null||_a2===void 0?void 0:_a2.force)};}},{key:"clearDelayedAndroidKey",value:function clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey);this.delayedAndroidKey=null;this.flushingAndroidKey=-1;}},{key:"flushSoon",value:function flushSoon(){var _this42=this;if(this.delayedFlush<0)this.delayedFlush=this.view.win.requestAnimationFrame(function(){_this42.delayedFlush=-1;_this42.flush();});}},{key:"forceFlush",value:function forceFlush(){if(this.delayedFlush>=0){this.view.win.cancelAnimationFrame(this.delayedFlush);this.delayedFlush=-1;}this.flush();}},{key:"pendingRecords",value:function pendingRecords(){var _iterator71=_createForOfIteratorHelper(this.observer.takeRecords()),_step71;try{for(_iterator71.s();!(_step71=_iterator71.n()).done;){var mut=_step71.value;this.queue.push(mut);}}catch(err){_iterator71.e(err);}finally{_iterator71.f();}return this.queue;}},{key:"processRecords",value:function processRecords(){var records=this.pendingRecords();if(records.length)this.queue=[];var from=-1,to=-1,typeOver=false;var _iterator72=_createForOfIteratorHelper(records),_step72;try{for(_iterator72.s();!(_step72=_iterator72.n()).done;){var record=_step72.value;var range=this.readMutation(record);if(!range)continue;if(range.typeOver)typeOver=true;if(from==-1){from=range.from;to=range.to;}else{from=Math.min(range.from,from);to=Math.max(range.to,to);}}}catch(err){_iterator72.e(err);}finally{_iterator72.f();}return{from:from,to:to,typeOver:typeOver};}},{key:"readChange",value:function readChange(){var _this$processRecords=this.processRecords(),from=_this$processRecords.from,to=_this$processRecords.to,typeOver=_this$processRecords.typeOver;var newSel=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(from<0&&!newSel)return null;if(from>-1)this.lastChange=Date.now();this.view.inputState.lastFocusTime=0;this.selectionChanged=false;var change=new DOMChange(this.view,from,to,typeOver);this.view.docView.domChanged={newSel:change.newSel?change.newSel.main:null};return change;}},{key:"flush",value:function flush(){var readSelection=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this.delayedFlush>=0||this.delayedAndroidKey)return false;if(readSelection)this.readSelectionRange();var domChange=this.readChange();if(!domChange){this.view.requestMeasure();return false;}var startState=this.view.state;var handled=applyDOMChange(this.view,domChange);if(this.view.state==startState)this.view.update([]);return handled;}},{key:"readMutation",value:function readMutation(rec){var cView=this.view.docView.nearest(rec.target);if(!cView||cView.ignoreMutation(rec))return null;cView.markDirty(rec.type=="attributes");if(rec.type=="attributes")cView.flags|=4;if(rec.type=="childList"){var childBefore=findChild(cView,rec.previousSibling||rec.target.previousSibling,-1);var childAfter=findChild(cView,rec.nextSibling||rec.target.nextSibling,1);return{from:childBefore?cView.posAfter(childBefore):cView.posAtStart,to:childAfter?cView.posBefore(childAfter):cView.posAtEnd,typeOver:false};}else if(rec.type=="characterData"){return{from:cView.posAtStart,to:cView.posAtEnd,typeOver:rec.target.nodeValue==rec.oldValue};}else{return null;}}},{key:"setWindow",value:function setWindow(win){if(win!=this.win){this.removeWindowListeners(this.win);this.win=win;this.addWindowListeners(this.win);}}},{key:"addWindowListeners",value:function addWindowListeners(win){win.addEventListener("resize",this.onResize);win.addEventListener("beforeprint",this.onPrint);win.addEventListener("scroll",this.onScroll);win.document.addEventListener("selectionchange",this.onSelectionChange);}},{key:"removeWindowListeners",value:function removeWindowListeners(win){win.removeEventListener("scroll",this.onScroll);win.removeEventListener("resize",this.onResize);win.removeEventListener("beforeprint",this.onPrint);win.document.removeEventListener("selectionchange",this.onSelectionChange);}},{key:"destroy",value:function destroy(){var _a2,_b,_c;this.stop();(_a2=this.intersection)===null||_a2===void 0?void 0:_a2.disconnect();(_b=this.gapIntersection)===null||_b===void 0?void 0:_b.disconnect();(_c=this.resizeScroll)===null||_c===void 0?void 0:_c.disconnect();var _iterator73=_createForOfIteratorHelper(this.scrollTargets),_step73;try{for(_iterator73.s();!(_step73=_iterator73.n()).done;){var dom=_step73.value;dom.removeEventListener("scroll",this.onScroll);}}catch(err){_iterator73.e(err);}finally{_iterator73.f();}this.removeWindowListeners(this.win);clearTimeout(this.parentCheck);clearTimeout(this.resizeTimeout);this.win.cancelAnimationFrame(this.delayedFlush);this.win.cancelAnimationFrame(this.flushingAndroidKey);}}]);return DOMObserver;}();function findChild(cView,dom,dir){while(dom){var curView=ContentView.get(dom);if(curView&&curView.parent==cView)return curView;var parent=dom.parentNode;dom=parent!=cView.dom?parent:dir>0?dom.nextSibling:dom.previousSibling;}return null;}function safariSelectionRangeHack(view){var found=null;function read(event){event.preventDefault();event.stopImmediatePropagation();found=event.getTargetRanges()[0];}view.contentDOM.addEventListener("beforeinput",read,true);view.dom.ownerDocument.execCommand("indent");view.contentDOM.removeEventListener("beforeinput",read,true);if(!found)return null;var anchorNode=found.startContainer,anchorOffset=found.startOffset;var focusNode=found.endContainer,focusOffset=found.endOffset;var curAnchor=view.docView.domAtPos(view.state.selection.main.anchor);if(isEquivalentPosition(curAnchor.node,curAnchor.offset,focusNode,focusOffset)){var _ref11=[focusNode,focusOffset,anchorNode,anchorOffset];anchorNode=_ref11[0];anchorOffset=_ref11[1];focusNode=_ref11[2];focusOffset=_ref11[3];}return{anchorNode:anchorNode,anchorOffset:anchorOffset,focusNode:focusNode,focusOffset:focusOffset};}var EditorView=/*#__PURE__*/function(){function EditorView(){var _this43=this;var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,EditorView);this.plugins=[];this.pluginMap=/* @__PURE__ */new Map();this.editorAttrs={};this.contentAttrs={};this.bidiCache=[];this.destroyed=false;this.updateState=2;this.measureScheduled=-1;this.measureRequests=[];this.contentDOM=document.createElement("div");this.scrollDOM=document.createElement("div");this.scrollDOM.tabIndex=-1;this.scrollDOM.className="cm-scroller";this.scrollDOM.appendChild(this.contentDOM);this.announceDOM=document.createElement("div");this.announceDOM.style.cssText="position: fixed; top: -10000px";this.announceDOM.setAttribute("aria-live","polite");this.dom=document.createElement("div");this.dom.appendChild(this.announceDOM);this.dom.appendChild(this.scrollDOM);var dispatch=config2.dispatch;this.dispatchTransactions=config2.dispatchTransactions||dispatch&&function(trs){return trs.forEach(function(tr){return dispatch(tr,_this43);});}||function(trs){return _this43.update(trs);};this.dispatch=this.dispatch.bind(this);this._root=config2.root||getRoot(config2.parent)||document;this.viewState=new ViewState(config2.state||EditorState.create(config2));if(config2.scrollTo&&config2.scrollTo.is(_scrollIntoView))this.viewState.scrollTarget=config2.scrollTo.value.clip(this.viewState.state);this.plugins=this.state.facet(viewPlugin).map(function(spec){return new PluginInstance(spec);});var _iterator74=_createForOfIteratorHelper(this.plugins),_step74;try{for(_iterator74.s();!(_step74=_iterator74.n()).done;){var plugin=_step74.value;plugin.update(this);}}catch(err){_iterator74.e(err);}finally{_iterator74.f();}this.observer=new DOMObserver(this);this.inputState=new InputState(this);this.inputState.ensureHandlers(this.plugins);this.docView=new DocView(this);this.mountStyles();this.updateAttrs();this.updateState=0;this.requestMeasure();if(config2.parent)config2.parent.appendChild(this.dom);}_createClass(EditorView,[{key:"state",get:function get(){return this.viewState.state;}},{key:"viewport",get:function get(){return this.viewState.viewport;}},{key:"visibleRanges",get:function get(){return this.viewState.visibleRanges;}},{key:"inView",get:function get(){return this.viewState.inView;}},{key:"composing",get:function get(){return this.inputState.composing>0;}},{key:"compositionStarted",get:function get(){return this.inputState.composing>=0;}},{key:"root",get:function get(){return this._root;}},{key:"win",get:function get(){return this.dom.ownerDocument.defaultView||window;}},{key:"dispatch",value:function dispatch(){var _this$state;for(var _len6=arguments.length,input=new Array(_len6),_key4=0;_key4<_len6;_key4++){input[_key4]=arguments[_key4];}var trs=input.length==1&&input[0]instanceof Transaction?input:input.length==1&&Array.isArray(input[0])?input[0]:[(_this$state=this.state).update.apply(_this$state,input)];this.dispatchTransactions(trs,this);}},{key:"update",value:function update(transactions){var _this44=this;if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");var redrawn=false,attrsChanged=false,update;var state=this.state;var _iterator75=_createForOfIteratorHelper(transactions),_step75;try{for(_iterator75.s();!(_step75=_iterator75.n()).done;){var _tr=_step75.value;if(_tr.startState!=state)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");state=_tr.state;}}catch(err){_iterator75.e(err);}finally{_iterator75.f();}if(this.destroyed){this.viewState.state=state;return;}var focus=this.hasFocus,focusFlag=0,dispatchFocus=null;if(transactions.some(function(tr){return tr.annotation(isFocusChange);})){this.inputState.notifiedFocused=focus;focusFlag=1;}else if(focus!=this.inputState.notifiedFocused){this.inputState.notifiedFocused=focus;dispatchFocus=focusChangeTransaction(state,focus);if(!dispatchFocus)focusFlag=1;}var pendingKey=this.observer.delayedAndroidKey,domChange=null;if(pendingKey){this.observer.clearDelayedAndroidKey();domChange=this.observer.readChange();if(domChange&&!this.state.doc.eq(state.doc)||!this.state.selection.eq(state.selection))domChange=null;}else{this.observer.clear();}if(state.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(state);update=ViewUpdate.create(this,state,transactions);update.flags|=focusFlag;var scrollTarget=this.viewState.scrollTarget;try{this.updateState=2;var _iterator76=_createForOfIteratorHelper(transactions),_step76;try{for(_iterator76.s();!(_step76=_iterator76.n()).done;){var tr=_step76.value;if(scrollTarget)scrollTarget=scrollTarget.map(tr.changes);if(tr.scrollIntoView){var main=tr.state.selection.main;scrollTarget=new ScrollTarget(main.empty?main:EditorSelection.cursor(main.head,main.head>main.anchor?-1:1));}var _iterator77=_createForOfIteratorHelper(tr.effects),_step77;try{for(_iterator77.s();!(_step77=_iterator77.n()).done;){var e=_step77.value;if(e.is(_scrollIntoView))scrollTarget=e.value.clip(this.state);}}catch(err){_iterator77.e(err);}finally{_iterator77.f();}}}catch(err){_iterator76.e(err);}finally{_iterator76.f();}this.viewState.update(update,scrollTarget);this.bidiCache=CachedOrder.update(this.bidiCache,update.changes);if(!update.empty){this.updatePlugins(update);this.inputState.update(update);}redrawn=this.docView.update(update);if(this.state.facet(styleModule)!=this.styleModules)this.mountStyles();attrsChanged=this.updateAttrs();this.showAnnouncements(transactions);this.docView.updateSelection(redrawn,transactions.some(function(tr){return tr.isUserEvent("select.pointer");}));}finally{this.updateState=0;}if(update.startState.facet(_theme)!=update.state.facet(_theme))this.viewState.mustMeasureContent=true;if(redrawn||attrsChanged||scrollTarget||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)this.requestMeasure();if(!update.empty){var _iterator78=_createForOfIteratorHelper(this.state.facet(updateListener)),_step78;try{for(_iterator78.s();!(_step78=_iterator78.n()).done;){var listener=_step78.value;try{listener(update);}catch(e){logException(this.state,e,"update listener");}}}catch(err){_iterator78.e(err);}finally{_iterator78.f();}}if(dispatchFocus||domChange)Promise.resolve().then(function(){if(dispatchFocus&&_this44.state==dispatchFocus.startState)_this44.dispatch(dispatchFocus);if(domChange){if(!applyDOMChange(_this44,domChange)&&pendingKey.force)dispatchKey(_this44.contentDOM,pendingKey.key,pendingKey.keyCode);}});}},{key:"setState",value:function setState(newState){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=newState;return;}this.updateState=2;var hadFocus=this.hasFocus;try{var _iterator79=_createForOfIteratorHelper(this.plugins),_step79;try{for(_iterator79.s();!(_step79=_iterator79.n()).done;){var plugin=_step79.value;plugin.destroy(this);}}catch(err){_iterator79.e(err);}finally{_iterator79.f();}this.viewState=new ViewState(newState);this.plugins=newState.facet(viewPlugin).map(function(spec){return new PluginInstance(spec);});this.pluginMap.clear();var _iterator80=_createForOfIteratorHelper(this.plugins),_step80;try{for(_iterator80.s();!(_step80=_iterator80.n()).done;){var _plugin3=_step80.value;_plugin3.update(this);}}catch(err){_iterator80.e(err);}finally{_iterator80.f();}this.docView=new DocView(this);this.inputState.ensureHandlers(this.plugins);this.mountStyles();this.updateAttrs();this.bidiCache=[];}finally{this.updateState=0;}if(hadFocus)this.focus();this.requestMeasure();}},{key:"updatePlugins",value:function updatePlugins(update){var prevSpecs=update.startState.facet(viewPlugin),specs=update.state.facet(viewPlugin);if(prevSpecs!=specs){var newPlugins=[];var _iterator81=_createForOfIteratorHelper(specs),_step81;try{for(_iterator81.s();!(_step81=_iterator81.n()).done;){var spec=_step81.value;var found=prevSpecs.indexOf(spec);if(found<0){newPlugins.push(new PluginInstance(spec));}else{var plugin=this.plugins[found];plugin.mustUpdate=update;newPlugins.push(plugin);}}}catch(err){_iterator81.e(err);}finally{_iterator81.f();}var _iterator82=_createForOfIteratorHelper(this.plugins),_step82;try{for(_iterator82.s();!(_step82=_iterator82.n()).done;){var _plugin4=_step82.value;if(_plugin4.mustUpdate!=update)_plugin4.destroy(this);}}catch(err){_iterator82.e(err);}finally{_iterator82.f();}this.plugins=newPlugins;this.pluginMap.clear();}else{var _iterator83=_createForOfIteratorHelper(this.plugins),_step83;try{for(_iterator83.s();!(_step83=_iterator83.n()).done;){var _p=_step83.value;_p.mustUpdate=update;}}catch(err){_iterator83.e(err);}finally{_iterator83.f();}}for(var _i102=0;_i102<this.plugins.length;_i102++){this.plugins[_i102].update(this);}if(prevSpecs!=specs)this.inputState.ensureHandlers(this.plugins);}},{key:"measure",value:function measure(){var _this45=this;var flush=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;if(this.destroyed)return;if(this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);if(this.observer.delayedAndroidKey){this.measureScheduled=-1;this.requestMeasure();return;}this.measureScheduled=0;if(flush)this.observer.forceFlush();var updated=null;var sDOM=this.scrollDOM,scrollTop=sDOM.scrollTop*this.scaleY;var _this$viewState=this.viewState,scrollAnchorPos=_this$viewState.scrollAnchorPos,scrollAnchorHeight=_this$viewState.scrollAnchorHeight;if(Math.abs(scrollTop-this.viewState.scrollTop)>1)scrollAnchorHeight=-1;this.viewState.scrollAnchorHeight=-1;try{for(var _i103=0;;_i103++){if(scrollAnchorHeight<0){if(isScrolledToBottom(sDOM)){scrollAnchorPos=-1;scrollAnchorHeight=this.viewState.heightMap.height;}else{var block=this.viewState.scrollAnchorAt(scrollTop);scrollAnchorPos=block.from;scrollAnchorHeight=block.top;}}this.updateState=1;var changed=this.viewState.measure(this);if(!changed&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(_i103>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break;}var measuring=[];if(!(changed&4)){var _ref12=[measuring,this.measureRequests];this.measureRequests=_ref12[0];measuring=_ref12[1];}var measured=measuring.map(function(m){try{return m.read(_this45);}catch(e){logException(_this45.state,e);return BadMeasure;}});var update=ViewUpdate.create(this,this.state,[]),redrawn=false;update.flags|=changed;if(!updated)updated=update;else updated.flags|=changed;this.updateState=2;if(!update.empty){this.updatePlugins(update);this.inputState.update(update);this.updateAttrs();redrawn=this.docView.update(update);}for(var i2=0;i2<measuring.length;i2++){if(measured[i2]!=BadMeasure){try{var m=measuring[i2];if(m.write)m.write(measured[i2],this);}catch(e){logException(this.state,e);}}}if(redrawn)this.docView.updateSelection(true);if(!update.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget);this.viewState.scrollTarget=null;continue;}else{var newAnchorHeight=scrollAnchorPos<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(scrollAnchorPos).top;var diff=newAnchorHeight-scrollAnchorHeight;if(diff>1||diff<-1){scrollTop=scrollTop+diff;sDOM.scrollTop=scrollTop/this.scaleY;scrollAnchorHeight=-1;continue;}}}break;}}}finally{this.updateState=0;this.measureScheduled=-1;}if(updated&&!updated.empty){var _iterator84=_createForOfIteratorHelper(this.state.facet(updateListener)),_step84;try{for(_iterator84.s();!(_step84=_iterator84.n()).done;){var listener=_step84.value;listener(updated);}}catch(err){_iterator84.e(err);}finally{_iterator84.f();}}}},{key:"themeClasses",get:function get(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(_theme);}},{key:"updateAttrs",value:function updateAttrs(){var _this46=this;var editorAttrs=attrsFromFacet(this,editorAttributes,{"class":"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses});var contentAttrs={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:!this.state.facet(editable)?"false":"true","class":"cm-content",style:"".concat(browser.tabSize,": ").concat(this.state.tabSize),role:"textbox","aria-multiline":"true"};if(this.state.readOnly)contentAttrs["aria-readonly"]="true";attrsFromFacet(this,contentAttributes,contentAttrs);var changed=this.observer.ignore(function(){var changedContent=_updateAttrs(_this46.contentDOM,_this46.contentAttrs,contentAttrs);var changedEditor=_updateAttrs(_this46.dom,_this46.editorAttrs,editorAttrs);return changedContent||changedEditor;});this.editorAttrs=editorAttrs;this.contentAttrs=contentAttrs;return changed;}},{key:"showAnnouncements",value:function showAnnouncements(trs){var first=true;var _iterator85=_createForOfIteratorHelper(trs),_step85;try{for(_iterator85.s();!(_step85=_iterator85.n()).done;){var tr=_step85.value;var _iterator86=_createForOfIteratorHelper(tr.effects),_step86;try{for(_iterator86.s();!(_step86=_iterator86.n()).done;){var effect=_step86.value;if(effect.is(EditorView.announce)){if(first)this.announceDOM.textContent="";first=false;var div=this.announceDOM.appendChild(document.createElement("div"));div.textContent=effect.value;}}}catch(err){_iterator86.e(err);}finally{_iterator86.f();}}}catch(err){_iterator85.e(err);}finally{_iterator85.f();}}},{key:"mountStyles",value:function mountStyles(){this.styleModules=this.state.facet(styleModule);var nonce=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1).reverse(),nonce?{nonce:nonce}:void 0);}},{key:"readMeasured",value:function readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");if(this.updateState==0&&this.measureScheduled>-1)this.measure(false);}},{key:"requestMeasure",value:function requestMeasure(request){var _this47=this;if(this.measureScheduled<0)this.measureScheduled=this.win.requestAnimationFrame(function(){return _this47.measure();});if(request){if(this.measureRequests.indexOf(request)>-1)return;if(request.key!=null)for(var _i104=0;_i104<this.measureRequests.length;_i104++){if(this.measureRequests[_i104].key===request.key){this.measureRequests[_i104]=request;return;}}this.measureRequests.push(request);}}},{key:"plugin",value:function plugin(_plugin2){var known=this.pluginMap.get(_plugin2);if(known===void 0||known&&known.spec!=_plugin2)this.pluginMap.set(_plugin2,known=this.plugins.find(function(p){return p.spec==_plugin2;})||null);return known&&known.update(this).value;}},{key:"documentTop",get:function get(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop;}},{key:"documentPadding",get:function get(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom};}},{key:"scaleX",get:function get(){return this.viewState.scaleX;}},{key:"scaleY",get:function get(){return this.viewState.scaleY;}},{key:"elementAtHeight",value:function elementAtHeight(height){this.readMeasured();return this.viewState.elementAtHeight(height);}},{key:"lineBlockAtHeight",value:function lineBlockAtHeight(height){this.readMeasured();return this.viewState.lineBlockAtHeight(height);}},{key:"viewportLineBlocks",get:function get(){return this.viewState.viewportLines;}},{key:"lineBlockAt",value:function lineBlockAt(pos){return this.viewState.lineBlockAt(pos);}},{key:"contentHeight",get:function get(){return this.viewState.contentHeight;}},{key:"moveByChar",value:function moveByChar(start,forward,by){return skipAtoms(this,start,_moveByChar(this,start,forward,by));}},{key:"moveByGroup",value:function moveByGroup(start,forward){var _this48=this;return skipAtoms(this,start,_moveByChar(this,start,forward,function(initial){return byGroup(_this48,start.head,initial);}));}},{key:"moveToLineBoundary",value:function moveToLineBoundary(start,forward){var includeWrap=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;return _moveToLineBoundary(this,start,forward,includeWrap);}},{key:"moveVertically",value:function moveVertically(start,forward,distance){return skipAtoms(this,start,_moveVertically(this,start,forward,distance));}},{key:"domAtPos",value:function domAtPos(pos){return this.docView.domAtPos(pos);}},{key:"posAtDOM",value:function posAtDOM(node){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this.docView.posFromDOM(node,offset);}},{key:"posAtCoords",value:function posAtCoords(coords){var precise=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;this.readMeasured();return _posAtCoords(this,coords,precise);}},{key:"coordsAtPos",value:function coordsAtPos(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this.readMeasured();var rect=this.docView.coordsAt(pos,side);if(!rect||rect.left==rect.right)return rect;var line=this.state.doc.lineAt(pos),order=this.bidiSpans(line);var span=order[BidiSpan.find(order,pos-line.from,-1,side)];return flattenRect(rect,span.dir==Direction.LTR==side>0);}},{key:"coordsForChar",value:function coordsForChar(pos){this.readMeasured();return this.docView.coordsForChar(pos);}},{key:"defaultCharacterWidth",get:function get(){return this.viewState.heightOracle.charWidth;}},{key:"defaultLineHeight",get:function get(){return this.viewState.heightOracle.lineHeight;}},{key:"textDirection",get:function get(){return this.viewState.defaultTextDirection;}},{key:"textDirectionAt",value:function textDirectionAt(pos){var perLine=this.state.facet(perLineTextDirection);if(!perLine||pos<this.viewport.from||pos>this.viewport.to)return this.textDirection;this.readMeasured();return this.docView.textDirectionAt(pos);}},{key:"lineWrapping",get:function get(){return this.viewState.heightOracle.lineWrapping;}},{key:"bidiSpans",value:function bidiSpans(line){if(line.length>MaxBidiLine)return trivialOrder(line.length);var dir=this.textDirectionAt(line.from),isolates;var _iterator87=_createForOfIteratorHelper(this.bidiCache),_step87;try{for(_iterator87.s();!(_step87=_iterator87.n()).done;){var entry=_step87.value;if(entry.from==line.from&&entry.dir==dir&&(entry.fresh||isolatesEq(entry.isolates,isolates=getIsolatedRanges(this,line.from,line.to))))return entry.order;}}catch(err){_iterator87.e(err);}finally{_iterator87.f();}if(!isolates)isolates=getIsolatedRanges(this,line.from,line.to);var order=computeOrder(line.text,dir,isolates);this.bidiCache.push(new CachedOrder(line.from,line.to,dir,isolates,true,order));return order;}},{key:"hasFocus",get:function get(){var _a2;return(this.dom.ownerDocument.hasFocus()||browser.safari&&((_a2=this.inputState)===null||_a2===void 0?void 0:_a2.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM;}},{key:"focus",value:function focus(){var _this49=this;this.observer.ignore(function(){focusPreventScroll(_this49.contentDOM);_this49.docView.updateSelection();});}},{key:"setRoot",value:function setRoot(root){if(this._root!=root){this._root=root;this.observer.setWindow((root.nodeType==9?root:root.ownerDocument).defaultView||window);this.mountStyles();}}},{key:"destroy",value:function destroy(){var _iterator88=_createForOfIteratorHelper(this.plugins),_step88;try{for(_iterator88.s();!(_step88=_iterator88.n()).done;){var plugin=_step88.value;plugin.destroy(this);}}catch(err){_iterator88.e(err);}finally{_iterator88.f();}this.plugins=[];this.inputState.destroy();this.dom.remove();this.observer.destroy();if(this.measureScheduled>-1)this.win.cancelAnimationFrame(this.measureScheduled);this.destroyed=true;}},{key:"scrollSnapshot",value:function scrollSnapshot(){var _this$scrollDOM=this.scrollDOM,scrollTop=_this$scrollDOM.scrollTop,scrollLeft=_this$scrollDOM.scrollLeft;var ref=this.viewState.scrollAnchorAt(scrollTop);return _scrollIntoView.of(new ScrollTarget(EditorSelection.cursor(ref.from),"start","start",ref.top-scrollTop,scrollLeft,true));}}],[{key:"scrollIntoView",value:function scrollIntoView(pos){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return _scrollIntoView.of(new ScrollTarget(typeof pos=="number"?EditorSelection.cursor(pos):pos,options.y,options.x,options.yMargin,options.xMargin));}},{key:"domEventHandlers",value:function domEventHandlers(handlers2){return ViewPlugin.define(function(){return{};},{eventHandlers:handlers2});}},{key:"domEventObservers",value:function domEventObservers(observers2){return ViewPlugin.define(function(){return{};},{eventObservers:observers2});}},{key:"theme",value:function theme(spec,options){var prefix=StyleModule.newName();var result=[_theme.of(prefix),styleModule.of(buildTheme(".".concat(prefix),spec))];if(options&&options.dark)result.push(darkTheme.of(true));return result;}},{key:"baseTheme",value:function baseTheme(spec){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,spec,lightDarkIDs)));}},{key:"findFromDOM",value:function findFromDOM(dom){var _a2;var content2=dom.querySelector(".cm-content");var cView=content2&&ContentView.get(content2)||ContentView.get(dom);return((_a2=cView===null||cView===void 0?void 0:cView.rootView)===null||_a2===void 0?void 0:_a2.view)||null;}}]);return EditorView;}();EditorView.styleModule=styleModule;EditorView.inputHandler=inputHandler;EditorView.focusChangeEffect=focusChangeEffect;EditorView.perLineTextDirection=perLineTextDirection;EditorView.exceptionSink=exceptionSink;EditorView.updateListener=updateListener;EditorView.editable=editable;EditorView.mouseSelectionStyle=mouseSelectionStyle;EditorView.dragMovesSelection=dragMovesSelection$1;EditorView.clickAddsSelectionRange=clickAddsSelectionRange;EditorView.decorations=decorations;EditorView.atomicRanges=atomicRanges;EditorView.bidiIsolatedRanges=bidiIsolatedRanges;EditorView.scrollMargins=scrollMargins;EditorView.darkTheme=darkTheme;EditorView.cspNonce=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.length?values2[0]:"";}});EditorView.contentAttributes=contentAttributes;EditorView.editorAttributes=editorAttributes;EditorView.lineWrapping=/* @__PURE__ */EditorView.contentAttributes.of({"class":"cm-lineWrapping"});EditorView.announce=/* @__PURE__ */StateEffect.define();var MaxBidiLine=4096;var BadMeasure={};var CachedOrder=/*#__PURE__*/function(){function CachedOrder(from,to,dir,isolates,fresh,order){_classCallCheck(this,CachedOrder);this.from=from;this.to=to;this.dir=dir;this.isolates=isolates;this.fresh=fresh;this.order=order;}_createClass(CachedOrder,null,[{key:"update",value:function update(cache2,changes){if(changes.empty&&!cache2.some(function(c){return c.fresh;}))return cache2;var result=[],lastDir=cache2.length?cache2[cache2.length-1].dir:Direction.LTR;for(var _i105=Math.max(0,cache2.length-10);_i105<cache2.length;_i105++){var entry=cache2[_i105];if(entry.dir==lastDir&&!changes.touchesRange(entry.from,entry.to))result.push(new CachedOrder(changes.mapPos(entry.from,1),changes.mapPos(entry.to,-1),entry.dir,entry.isolates,false,entry.order));}return result;}}]);return CachedOrder;}();function attrsFromFacet(view,facet,base2){for(var sources=view.state.facet(facet),_i106=sources.length-1;_i106>=0;_i106--){var source=sources[_i106],value=typeof source=="function"?source(view):source;if(value)combineAttrs(value,base2);}return base2;}var currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(name2,platform){var parts=name2.split(/-(?!$)/);var result=parts[parts.length-1];if(result=="Space")result=" ";var alt,ctrl,shift2,meta2;for(var _i107=0;_i107<parts.length-1;++_i107){var mod=parts[_i107];if(/^(cmd|meta|m)$/i.test(mod))meta2=true;else if(/^a(lt)?$/i.test(mod))alt=true;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=true;else if(/^s(hift)?$/i.test(mod))shift2=true;else if(/^mod$/i.test(mod)){if(platform=="mac")meta2=true;else ctrl=true;}else throw new Error("Unrecognized modifier name: "+mod);}if(alt)result="Alt-"+result;if(ctrl)result="Ctrl-"+result;if(meta2)result="Meta-"+result;if(shift2)result="Shift-"+result;return result;}function modifiers(name2,event,shift2){if(event.altKey)name2="Alt-"+name2;if(event.ctrlKey)name2="Ctrl-"+name2;if(event.metaKey)name2="Meta-"+name2;if(shift2!==false&&event.shiftKey)name2="Shift-"+name2;return name2;}var handleKeyEvents=/* @__PURE__ */Prec["default"](/* @__PURE__ */EditorView.domEventHandlers({keydown:function keydown(event,view){return runHandlers(getKeymap(view.state),event,view,"editor");}}));var keymap=/* @__PURE__ */Facet.define({enables:handleKeyEvents});var Keymaps=/* @__PURE__ */new WeakMap();function getKeymap(state){var bindings=state.facet(keymap);var map=Keymaps.get(bindings);if(!map)Keymaps.set(bindings,map=buildKeymap(bindings.reduce(function(a,b){return a.concat(b);},[])));return map;}function runScopeHandlers(view,event,scope){return runHandlers(getKeymap(view.state),event,view,scope);}var storedPrefix=null;var PrefixTimeout=4e3;function buildKeymap(bindings){var platform=arguments.length>1&&arguments[1]!==undefined?arguments[1]:currentPlatform;var bound=/* @__PURE__ */Object.create(null);var isPrefix=/* @__PURE__ */Object.create(null);var checkPrefix=function checkPrefix(name2,is){var current=isPrefix[name2];if(current==null)isPrefix[name2]=is;else if(current!=is)throw new Error("Key binding "+name2+" is used both as a regular binding and as a multi-stroke prefix");};var add2=function add2(scope,key,command2,preventDefault,stopPropagation){var _a2,_b;var scopeObj=bound[scope]||(bound[scope]=/* @__PURE__ */Object.create(null));var parts=key.split(/ (?!$)/).map(function(k){return normalizeKeyName(k,platform);});var _loop7=function _loop7(_i108){var prefix=parts.slice(0,_i108).join(" ");checkPrefix(prefix,true);if(!scopeObj[prefix])scopeObj[prefix]={preventDefault:true,stopPropagation:false,run:[function(view){var ourObj=storedPrefix={view:view,prefix:prefix,scope:scope};setTimeout(function(){if(storedPrefix==ourObj)storedPrefix=null;},PrefixTimeout);return true;}]};};for(var _i108=1;_i108<parts.length;_i108++){_loop7(_i108);}var full=parts.join(" ");checkPrefix(full,false);var binding=scopeObj[full]||(scopeObj[full]={preventDefault:false,stopPropagation:false,run:((_b=(_a2=scopeObj._any)===null||_a2===void 0?void 0:_a2.run)===null||_b===void 0?void 0:_b.slice())||[]});if(command2)binding.run.push(command2);if(preventDefault)binding.preventDefault=true;if(stopPropagation)binding.stopPropagation=true;};var _iterator89=_createForOfIteratorHelper(bindings),_step89;try{for(_iterator89.s();!(_step89=_iterator89.n()).done;){var b=_step89.value;var scopes=b.scope?b.scope.split(" "):["editor"];if(b.any){var _iterator90=_createForOfIteratorHelper(scopes),_step90;try{for(_iterator90.s();!(_step90=_iterator90.n()).done;){var scope=_step90.value;var scopeObj=bound[scope]||(bound[scope]=/* @__PURE__ */Object.create(null));if(!scopeObj._any)scopeObj._any={preventDefault:false,stopPropagation:false,run:[]};for(var key in scopeObj){scopeObj[key].run.push(b.any);}}}catch(err){_iterator90.e(err);}finally{_iterator90.f();}}var name2=b[platform]||b.key;if(!name2)continue;var _iterator91=_createForOfIteratorHelper(scopes),_step91;try{for(_iterator91.s();!(_step91=_iterator91.n()).done;){var _scope=_step91.value;add2(_scope,name2,b.run,b.preventDefault,b.stopPropagation);if(b.shift)add2(_scope,"Shift-"+name2,b.shift,b.preventDefault,b.stopPropagation);}}catch(err){_iterator91.e(err);}finally{_iterator91.f();}}}catch(err){_iterator89.e(err);}finally{_iterator89.f();}return bound;}function runHandlers(map,event,view,scope){var name2=keyName(event);var charCode=codePointAt(name2,0),isChar=codePointSize(charCode)==name2.length&&name2!=" ";var prefix="",handled=false,prevented=false,stopPropagation=false;if(storedPrefix&&storedPrefix.view==view&&storedPrefix.scope==scope){prefix=storedPrefix.prefix+" ";if(modifierCodes.indexOf(event.keyCode)<0){prevented=true;storedPrefix=null;}}var ran=/* @__PURE__ */new Set();var runFor=function runFor(binding){if(binding){var _iterator92=_createForOfIteratorHelper(binding.run),_step92;try{for(_iterator92.s();!(_step92=_iterator92.n()).done;){var cmd2=_step92.value;if(!ran.has(cmd2)){ran.add(cmd2);if(cmd2(view,event)){if(binding.stopPropagation)stopPropagation=true;return true;}}}}catch(err){_iterator92.e(err);}finally{_iterator92.f();}if(binding.preventDefault){if(binding.stopPropagation)stopPropagation=true;prevented=true;}}return false;};var scopeObj=map[scope],baseName,shiftName;if(scopeObj){if(runFor(scopeObj[prefix+modifiers(name2,event,!isChar)])){handled=true;}else if(isChar&&(event.altKey||event.metaKey||event.ctrlKey)&&!(browser.windows&&event.ctrlKey&&event.altKey)&&(baseName=base[event.keyCode])&&baseName!=name2){if(runFor(scopeObj[prefix+modifiers(baseName,event,true)])){handled=true;}else if(event.shiftKey&&(shiftName=shift[event.keyCode])!=name2&&shiftName!=baseName&&runFor(scopeObj[prefix+modifiers(shiftName,event,false)])){handled=true;}}else if(isChar&&event.shiftKey&&runFor(scopeObj[prefix+modifiers(name2,event,true)])){handled=true;}if(!handled&&runFor(scopeObj._any))handled=true;}if(prevented)handled=true;if(handled&&stopPropagation)event.stopPropagation();return handled;}var RectangleMarker=/*#__PURE__*/function(){function RectangleMarker(className,left,top2,width,height){_classCallCheck(this,RectangleMarker);this.className=className;this.left=left;this.top=top2;this.width=width;this.height=height;}_createClass(RectangleMarker,[{key:"draw",value:function draw(){var elt2=document.createElement("div");elt2.className=this.className;this.adjust(elt2);return elt2;}},{key:"update",value:function update(elt2,prev){if(prev.className!=this.className)return false;this.adjust(elt2);return true;}},{key:"adjust",value:function adjust(elt2){elt2.style.left=this.left+"px";elt2.style.top=this.top+"px";if(this.width!=null)elt2.style.width=this.width+"px";elt2.style.height=this.height+"px";}},{key:"eq",value:function eq(p){return this.left==p.left&&this.top==p.top&&this.width==p.width&&this.height==p.height&&this.className==p.className;}}],[{key:"forRange",value:function forRange(view,className,range){if(range.empty){var pos=view.coordsAtPos(range.head,range.assoc||1);if(!pos)return[];var base2=getBase(view);return[new RectangleMarker(className,pos.left-base2.left,pos.top-base2.top,null,pos.bottom-pos.top)];}else{return rectanglesForRange(view,className,range);}}}]);return RectangleMarker;}();function getBase(view){var rect=view.scrollDOM.getBoundingClientRect();var left=view.textDirection==Direction.LTR?rect.left:rect.right-view.scrollDOM.clientWidth*view.scaleX;return{left:left-view.scrollDOM.scrollLeft*view.scaleX,top:rect.top-view.scrollDOM.scrollTop*view.scaleY};}function wrappedLine(view,pos,inside2){var range=EditorSelection.cursor(pos);return{from:Math.max(inside2.from,view.moveToLineBoundary(range,false,true).from),to:Math.min(inside2.to,view.moveToLineBoundary(range,true,true).from),type:BlockType.Text};}function rectanglesForRange(view,className,range){if(range.to<=view.viewport.from||range.from>=view.viewport.to)return[];var from=Math.max(range.from,view.viewport.from),to=Math.min(range.to,view.viewport.to);var ltr=view.textDirection==Direction.LTR;var content2=view.contentDOM,contentRect=content2.getBoundingClientRect(),base2=getBase(view);var lineElt=content2.querySelector(".cm-line"),lineStyle=lineElt&&window.getComputedStyle(lineElt);var leftSide=contentRect.left+(lineStyle?parseInt(lineStyle.paddingLeft)+Math.min(0,parseInt(lineStyle.textIndent)):0);var rightSide=contentRect.right-(lineStyle?parseInt(lineStyle.paddingRight):0);var startBlock=blockAt(view,from),endBlock=blockAt(view,to);var visualStart=startBlock.type==BlockType.Text?startBlock:null;var visualEnd=endBlock.type==BlockType.Text?endBlock:null;if(visualStart&&(view.lineWrapping||startBlock.widgetLineBreaks))visualStart=wrappedLine(view,from,visualStart);if(visualEnd&&(view.lineWrapping||endBlock.widgetLineBreaks))visualEnd=wrappedLine(view,to,visualEnd);if(visualStart&&visualEnd&&visualStart.from==visualEnd.from){return pieces(drawForLine(range.from,range.to,visualStart));}else{var top2=visualStart?drawForLine(range.from,null,visualStart):drawForWidget(startBlock,false);var bottom=visualEnd?drawForLine(null,range.to,visualEnd):drawForWidget(endBlock,true);var between=[];if((visualStart||startBlock).to<(visualEnd||endBlock).from-(visualStart&&visualEnd?1:0)||startBlock.widgetLineBreaks>1&&top2.bottom+view.defaultLineHeight/2<bottom.top)between.push(piece(leftSide,top2.bottom,rightSide,bottom.top));else if(top2.bottom<bottom.top&&view.elementAtHeight((top2.bottom+bottom.top)/2).type==BlockType.Text)top2.bottom=bottom.top=(top2.bottom+bottom.top)/2;return pieces(top2).concat(between).concat(pieces(bottom));}function piece(left,top2,right,bottom){return new RectangleMarker(className,left-base2.left,top2-base2.top-0.01,right-left,bottom-top2+0.01);}function pieces(_ref13){var top2=_ref13.top,bottom=_ref13.bottom,horizontal=_ref13.horizontal;var pieces2=[];for(var _i109=0;_i109<horizontal.length;_i109+=2){pieces2.push(piece(horizontal[_i109],top2,horizontal[_i109+1],bottom));}return pieces2;}function drawForLine(from2,to2,line){var top2=1e9,bottom=-1e9,horizontal=[];function addSpan(from3,fromOpen,to3,toOpen,dir){var fromCoords=view.coordsAtPos(from3,from3==line.to?-2:2);var toCoords=view.coordsAtPos(to3,to3==line.from?2:-2);if(!fromCoords||!toCoords)return;top2=Math.min(fromCoords.top,toCoords.top,top2);bottom=Math.max(fromCoords.bottom,toCoords.bottom,bottom);if(dir==Direction.LTR)horizontal.push(ltr&&fromOpen?leftSide:fromCoords.left,ltr&&toOpen?rightSide:toCoords.right);else horizontal.push(!ltr&&toOpen?leftSide:toCoords.left,!ltr&&fromOpen?rightSide:fromCoords.right);}var start=from2!==null&&from2!==void 0?from2:line.from,end=to2!==null&&to2!==void 0?to2:line.to;var _iterator93=_createForOfIteratorHelper(view.visibleRanges),_step93;try{for(_iterator93.s();!(_step93=_iterator93.n()).done;){var _r=_step93.value;if(_r.to>start&&_r.from<end){for(var pos=Math.max(_r.from,start),endPos=Math.min(_r.to,end);;){var docLine=view.state.doc.lineAt(pos);var _iterator94=_createForOfIteratorHelper(view.bidiSpans(docLine)),_step94;try{for(_iterator94.s();!(_step94=_iterator94.n()).done;){var span=_step94.value;var spanFrom=span.from+docLine.from,spanTo=span.to+docLine.from;if(spanFrom>=endPos)break;if(spanTo>pos)addSpan(Math.max(spanFrom,pos),from2==null&&spanFrom<=start,Math.min(spanTo,endPos),to2==null&&spanTo>=end,span.dir);}}catch(err){_iterator94.e(err);}finally{_iterator94.f();}pos=docLine.to+1;if(pos>=endPos)break;}}}}catch(err){_iterator93.e(err);}finally{_iterator93.f();}if(horizontal.length==0)addSpan(start,from2==null,end,to2==null,view.textDirection);return{top:top2,bottom:bottom,horizontal:horizontal};}function drawForWidget(block,top2){var y=contentRect.top+(top2?block.top:block.bottom);return{top:y,bottom:y,horizontal:[]};}}function sameMarker(a,b){return a.constructor==b.constructor&&a.eq(b);}var LayerView=/*#__PURE__*/function(){function LayerView(view,layer2){_classCallCheck(this,LayerView);this.view=view;this.layer=layer2;this.drawn=[];this.scaleX=1;this.scaleY=1;this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)};this.dom=view.scrollDOM.appendChild(document.createElement("div"));this.dom.classList.add("cm-layer");if(layer2.above)this.dom.classList.add("cm-layer-above");if(layer2["class"])this.dom.classList.add(layer2["class"]);this.scale();this.dom.setAttribute("aria-hidden","true");this.setOrder(view.state);view.requestMeasure(this.measureReq);if(layer2.mount)layer2.mount(this.dom,view);}_createClass(LayerView,[{key:"update",value:function update(_update6){if(_update6.startState.facet(layerOrder)!=_update6.state.facet(layerOrder))this.setOrder(_update6.state);if(this.layer.update(_update6,this.dom)||_update6.geometryChanged){this.scale();_update6.view.requestMeasure(this.measureReq);}}},{key:"setOrder",value:function setOrder(state){var pos=0,order=state.facet(layerOrder);while(pos<order.length&&order[pos]!=this.layer){pos++;}this.dom.style.zIndex=String((this.layer.above?150:-1)-pos);}},{key:"measure",value:function measure(){return this.layer.markers(this.view);}},{key:"scale",value:function scale(){var _this$view=this.view,scaleX=_this$view.scaleX,scaleY=_this$view.scaleY;if(scaleX!=this.scaleX||scaleY!=this.scaleY){this.scaleX=scaleX;this.scaleY=scaleY;this.dom.style.transform="scale(".concat(1/scaleX,", ").concat(1/scaleY,")");}}},{key:"draw",value:function draw(markers){var _this50=this;if(markers.length!=this.drawn.length||markers.some(function(p,i){return!sameMarker(p,_this50.drawn[i]);})){var old=this.dom.firstChild,oldI=0;var _iterator95=_createForOfIteratorHelper(markers),_step95;try{for(_iterator95.s();!(_step95=_iterator95.n()).done;){var marker=_step95.value;if(marker.update&&old&&marker.constructor&&this.drawn[oldI].constructor&&marker.update(old,this.drawn[oldI])){old=old.nextSibling;oldI++;}else{this.dom.insertBefore(marker.draw(),old);}}}catch(err){_iterator95.e(err);}finally{_iterator95.f();}while(old){var next=old.nextSibling;old.remove();old=next;}this.drawn=markers;}}},{key:"destroy",value:function destroy(){if(this.layer.destroy)this.layer.destroy(this.dom,this.view);this.dom.remove();}}]);return LayerView;}();var layerOrder=/* @__PURE__ */Facet.define();function layer(config2){return[ViewPlugin.define(function(v){return new LayerView(v,config2);}),layerOrder.of(config2)];}var CanHidePrimary=!browser.ios;var selectionConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){return combineConfig(configs,{cursorBlinkRate:1200,drawRangeCursor:true},{cursorBlinkRate:function cursorBlinkRate(a,b){return Math.min(a,b);},drawRangeCursor:function drawRangeCursor(a,b){return a||b;}});}});function drawSelection(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[selectionConfig.of(config2),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(true)];}function configChanged(update){return update.startState.facet(selectionConfig)!=update.state.facet(selectionConfig);}var cursorLayer=/* @__PURE__ */layer({above:true,markers:function markers(view){var state=view.state,conf=state.facet(selectionConfig);var cursors=[];var _iterator96=_createForOfIteratorHelper(state.selection.ranges),_step96;try{for(_iterator96.s();!(_step96=_iterator96.n()).done;){var _r2=_step96.value;var prim=_r2==state.selection.main;if(_r2.empty?!prim||CanHidePrimary:conf.drawRangeCursor){var className=prim?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary";var cursor2=_r2.empty?_r2:EditorSelection.cursor(_r2.head,_r2.head>_r2.anchor?-1:1);var _iterator97=_createForOfIteratorHelper(RectangleMarker.forRange(view,className,cursor2)),_step97;try{for(_iterator97.s();!(_step97=_iterator97.n()).done;){var piece=_step97.value;cursors.push(piece);}}catch(err){_iterator97.e(err);}finally{_iterator97.f();}}}}catch(err){_iterator96.e(err);}finally{_iterator96.f();}return cursors;},update:function update(_update7,dom){if(_update7.transactions.some(function(tr){return tr.selection;}))dom.style.animationName=dom.style.animationName=="cm-blink"?"cm-blink2":"cm-blink";var confChange=configChanged(_update7);if(confChange)setBlinkRate(_update7.state,dom);return _update7.docChanged||_update7.selectionSet||confChange;},mount:function mount(dom,view){setBlinkRate(view.state,dom);},"class":"cm-cursorLayer"});function setBlinkRate(state,dom){dom.style.animationDuration=state.facet(selectionConfig).cursorBlinkRate+"ms";}var selectionLayer=/* @__PURE__ */layer({above:false,markers:function markers(view){return view.state.selection.ranges.map(function(r){return r.empty?[]:RectangleMarker.forRange(view,"cm-selectionBackground",r);}).reduce(function(a,b){return a.concat(b);});},update:function update(_update8,dom){return _update8.docChanged||_update8.selectionSet||_update8.viewportChanged||configChanged(_update8);},"class":"cm-selectionLayer"});var themeSpec={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};if(CanHidePrimary)themeSpec[".cm-line"].caretColor="transparent !important";var hideNativeSelection=/* @__PURE__ */Prec.highest(/* @__PURE__ */EditorView.theme(themeSpec));var setDropCursorPos=/* @__PURE__ */StateEffect.define({map:function map(pos,mapping){return pos==null?null:mapping.mapPos(pos);}});var dropCursorPos=/* @__PURE__ */StateField.define({create:function create(){return null;},update:function update(pos,tr){if(pos!=null)pos=tr.changes.mapPos(pos);return tr.effects.reduce(function(pos2,e){return e.is(setDropCursorPos)?e.value:pos2;},pos);}});var drawDropCursor=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class(view){_classCallCheck(this,_class);this.view=view;this.cursor=null;this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)};}_createClass(_class,[{key:"update",value:function update(_update9){var _a2;var cursorPos=_update9.state.field(dropCursorPos);if(cursorPos==null){if(this.cursor!=null){(_a2=this.cursor)===null||_a2===void 0?void 0:_a2.remove();this.cursor=null;}}else{if(!this.cursor){this.cursor=this.view.scrollDOM.appendChild(document.createElement("div"));this.cursor.className="cm-dropCursor";}if(_update9.startState.field(dropCursorPos)!=cursorPos||_update9.docChanged||_update9.geometryChanged)this.view.requestMeasure(this.measureReq);}}},{key:"readPos",value:function readPos(){var view=this.view;var pos=view.state.field(dropCursorPos);var rect=pos!=null&&view.coordsAtPos(pos);if(!rect)return null;var outer=view.scrollDOM.getBoundingClientRect();return{left:rect.left-outer.left+view.scrollDOM.scrollLeft*view.scaleX,top:rect.top-outer.top+view.scrollDOM.scrollTop*view.scaleY,height:rect.bottom-rect.top};}},{key:"drawCursor",value:function drawCursor(pos){if(this.cursor){var _this$view2=this.view,scaleX=_this$view2.scaleX,scaleY=_this$view2.scaleY;if(pos){this.cursor.style.left=pos.left/scaleX+"px";this.cursor.style.top=pos.top/scaleY+"px";this.cursor.style.height=pos.height/scaleY+"px";}else{this.cursor.style.left="-100000px";}}}},{key:"destroy",value:function destroy(){if(this.cursor)this.cursor.remove();}},{key:"setDropPos",value:function setDropPos(pos){if(this.view.state.field(dropCursorPos)!=pos)this.view.dispatch({effects:setDropCursorPos.of(pos)});}}]);return _class;}(),{eventObservers:{dragover:function dragover(event){this.setDropPos(this.view.posAtCoords({x:event.clientX,y:event.clientY}));},dragleave:function dragleave(event){if(event.target==this.view.contentDOM||!this.view.contentDOM.contains(event.relatedTarget))this.setDropPos(null);},dragend:function dragend(){this.setDropPos(null);},drop:function drop(){this.setDropPos(null);}}});function dropCursor(){return[dropCursorPos,drawDropCursor];}function iterMatches(doc2,re,from,to,f){re.lastIndex=0;for(var cursor2=doc2.iterRange(from,to),pos=from,m;!cursor2.next().done;pos+=cursor2.value.length){if(!cursor2.lineBreak)while(m=re.exec(cursor2.value)){f(pos+m.index,m);}}}function matchRanges(view,maxLength){var visible=view.visibleRanges;if(visible.length==1&&visible[0].from==view.viewport.from&&visible[0].to==view.viewport.to)return visible;var result=[];var _iterator98=_createForOfIteratorHelper(visible),_step98;try{for(_iterator98.s();!(_step98=_iterator98.n()).done;){var _step98$value=_step98.value,from=_step98$value.from,to=_step98$value.to;from=Math.max(view.state.doc.lineAt(from).from,from-maxLength);to=Math.min(view.state.doc.lineAt(to).to,to+maxLength);if(result.length&&result[result.length-1].to>=from)result[result.length-1].to=to;else result.push({from:from,to:to});}}catch(err){_iterator98.e(err);}finally{_iterator98.f();}return result;}var MatchDecorator=/*#__PURE__*/function(){function MatchDecorator(config2){_classCallCheck(this,MatchDecorator);var regexp=config2.regexp,decoration=config2.decoration,decorate=config2.decorate,boundary=config2.boundary,_config2$maxLength=config2.maxLength,maxLength=_config2$maxLength===void 0?1e3:_config2$maxLength;if(!regexp.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");this.regexp=regexp;if(decorate){this.addMatch=function(match,view,from,add2){return decorate(add2,from,from+match[0].length,match,view);};}else if(typeof decoration=="function"){this.addMatch=function(match,view,from,add2){var deco=decoration(match,view,from);if(deco)add2(from,from+match[0].length,deco);};}else if(decoration){this.addMatch=function(match,_view,from,add2){return add2(from,from+match[0].length,decoration);};}else{throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");}this.boundary=boundary;this.maxLength=maxLength;}_createClass(MatchDecorator,[{key:"createDeco",value:function createDeco(view){var _this51=this;var build=new RangeSetBuilder(),add2=build.add.bind(build);var _iterator99=_createForOfIteratorHelper(matchRanges(view,this.maxLength)),_step99;try{for(_iterator99.s();!(_step99=_iterator99.n()).done;){var _step99$value=_step99.value,from=_step99$value.from,to=_step99$value.to;iterMatches(view.state.doc,this.regexp,from,to,function(from2,m){return _this51.addMatch(m,view,from2,add2);});}}catch(err){_iterator99.e(err);}finally{_iterator99.f();}return build.finish();}},{key:"updateDeco",value:function updateDeco(update,deco){var changeFrom=1e9,changeTo=-1;if(update.docChanged)update.changes.iterChanges(function(_f,_t,from,to){if(to>update.view.viewport.from&&from<update.view.viewport.to){changeFrom=Math.min(from,changeFrom);changeTo=Math.max(to,changeTo);}});if(update.viewportChanged||changeTo-changeFrom>1e3)return this.createDeco(update.view);if(changeTo>-1)return this.updateRange(update.view,deco.map(update.changes),changeFrom,changeTo);return deco;}},{key:"updateRange",value:function updateRange(view,deco,updateFrom,updateTo){var _this52=this;var _iterator100=_createForOfIteratorHelper(view.visibleRanges),_step100;try{for(_iterator100.s();!(_step100=_iterator100.n()).done;){var _r3=_step100.value;var from=Math.max(_r3.from,updateFrom),to=Math.min(_r3.to,updateTo);if(to>from){(function(){var fromLine=view.state.doc.lineAt(from),toLine=fromLine.to<to?view.state.doc.lineAt(to):fromLine;var start=Math.max(_r3.from,fromLine.from),end=Math.min(_r3.to,toLine.to);if(_this52.boundary){for(;from>fromLine.from;from--){if(_this52.boundary.test(fromLine.text[from-1-fromLine.from])){start=from;break;}}for(;to<toLine.to;to++){if(_this52.boundary.test(toLine.text[to-toLine.from])){end=to;break;}}}var ranges=[],m=void 0;var add2=function add2(from2,to2,deco2){return ranges.push(deco2.range(from2,to2));};if(fromLine==toLine){_this52.regexp.lastIndex=start-fromLine.from;while((m=_this52.regexp.exec(fromLine.text))&&m.index<end-fromLine.from){_this52.addMatch(m,view,m.index+fromLine.from,add2);}}else{iterMatches(view.state.doc,_this52.regexp,start,end,function(from2,m2){return _this52.addMatch(m2,view,from2,add2);});}deco=deco.update({filterFrom:start,filterTo:end,filter:function filter(from2,to2){return from2<start||to2>end;},add:ranges});})();}}}catch(err){_iterator100.e(err);}finally{_iterator100.f();}return deco;}}]);return MatchDecorator;}();var UnicodeRegexpSupport=/x/.unicode!=null?"gu":"g";var Specials=/* @__PURE__ */new RegExp("[\0-\b\n-\x1F\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]",UnicodeRegexpSupport);var Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};var _supportsTabSize=null;function supportsTabSize(){var _a2;if(_supportsTabSize==null&&typeof document!="undefined"&&document.body){var styles=document.body.style;_supportsTabSize=((_a2=styles.tabSize)!==null&&_a2!==void 0?_a2:styles.MozTabSize)!=null;}return _supportsTabSize||false;}var specialCharConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){var config2=combineConfig(configs,{render:null,specialChars:Specials,addSpecialChars:null});if(config2.replaceTabs=!supportsTabSize())config2.specialChars=new RegExp("	|"+config2.specialChars.source,UnicodeRegexpSupport);if(config2.addSpecialChars)config2.specialChars=new RegExp(config2.specialChars.source+"|"+config2.addSpecialChars.source,UnicodeRegexpSupport);return config2;}});function highlightSpecialChars(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[specialCharConfig.of(config2),specialCharPlugin()];}var _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(/*#__PURE__*/function(){function _class2(view){_classCallCheck(this,_class2);this.view=view;this.decorations=Decoration.none;this.decorationCache=/* @__PURE__ */Object.create(null);this.decorator=this.makeDecorator(view.state.facet(specialCharConfig));this.decorations=this.decorator.createDeco(view);}_createClass(_class2,[{key:"makeDecorator",value:function makeDecorator(conf){var _this53=this;return new MatchDecorator({regexp:conf.specialChars,decoration:function decoration(m,view,pos){var doc2=view.state.doc;var code=codePointAt(m[0],0);if(code==9){var line=doc2.lineAt(pos);var size=view.state.tabSize,col=_countColumn(line.text,size,pos-line.from);return Decoration.replace({widget:new TabWidget((size-col%size)*_this53.view.defaultCharacterWidth/_this53.view.scaleX)});}return _this53.decorationCache[code]||(_this53.decorationCache[code]=Decoration.replace({widget:new SpecialCharWidget(conf,code)}));},boundary:conf.replaceTabs?void 0:/[^]/});}},{key:"update",value:function update(_update10){var conf=_update10.state.facet(specialCharConfig);if(_update10.startState.facet(specialCharConfig)!=conf){this.decorator=this.makeDecorator(conf);this.decorations=this.decorator.createDeco(_update10.view);}else{this.decorations=this.decorator.updateDeco(_update10,this.decorations);}}}]);return _class2;}(),{decorations:function decorations(v){return v.decorations;}}));}var DefaultPlaceholder="\u2022";function placeholder$1(code){if(code>=32)return DefaultPlaceholder;if(code==10)return"\u2424";return String.fromCharCode(9216+code);}var SpecialCharWidget=/*#__PURE__*/function(_WidgetType4){_inherits(SpecialCharWidget,_WidgetType4);var _super22=_createSuper(SpecialCharWidget);function SpecialCharWidget(options,code){var _this54;_classCallCheck(this,SpecialCharWidget);_this54=_super22.call(this);_this54.options=options;_this54.code=code;return _this54;}_createClass(SpecialCharWidget,[{key:"eq",value:function eq(other){return other.code==this.code;}},{key:"toDOM",value:function toDOM(view){var ph=placeholder$1(this.code);var desc=view.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16));var custom=this.options.render&&this.options.render(this.code,desc,ph);if(custom)return custom;var span=document.createElement("span");span.textContent=ph;span.title=desc;span.setAttribute("aria-label",desc);span.className="cm-specialChar";return span;}},{key:"ignoreEvent",value:function ignoreEvent(){return false;}}]);return SpecialCharWidget;}(WidgetType);var TabWidget=/*#__PURE__*/function(_WidgetType5){_inherits(TabWidget,_WidgetType5);var _super23=_createSuper(TabWidget);function TabWidget(width){var _this55;_classCallCheck(this,TabWidget);_this55=_super23.call(this);_this55.width=width;return _this55;}_createClass(TabWidget,[{key:"eq",value:function eq(other){return other.width==this.width;}},{key:"toDOM",value:function toDOM(){var span=document.createElement("span");span.textContent="	";span.className="cm-tab";span.style.width=this.width+"px";return span;}},{key:"ignoreEvent",value:function ignoreEvent(){return false;}}]);return TabWidget;}(WidgetType);function highlightActiveLine(){return activeLineHighlighter;}var lineDeco=/* @__PURE__ */Decoration.line({"class":"cm-activeLine"});var activeLineHighlighter=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class3(view){_classCallCheck(this,_class3);this.decorations=this.getDeco(view);}_createClass(_class3,[{key:"update",value:function update(_update11){if(_update11.docChanged||_update11.selectionSet)this.decorations=this.getDeco(_update11.view);}},{key:"getDeco",value:function getDeco(view){var lastLineStart=-1,deco=[];var _iterator101=_createForOfIteratorHelper(view.state.selection.ranges),_step101;try{for(_iterator101.s();!(_step101=_iterator101.n()).done;){var _r4=_step101.value;var line=view.lineBlockAt(_r4.head);if(line.from>lastLineStart){deco.push(lineDeco.range(line.from));lastLineStart=line.from;}}}catch(err){_iterator101.e(err);}finally{_iterator101.f();}return Decoration.set(deco);}}]);return _class3;}(),{decorations:function decorations(v){return v.decorations;}});var MaxOff=2e3;function rectangleFor(state,a,b){var startLine=Math.min(a.line,b.line),endLine=Math.max(a.line,b.line);var ranges=[];if(a.off>MaxOff||b.off>MaxOff||a.col<0||b.col<0){var startOff=Math.min(a.off,b.off),endOff=Math.max(a.off,b.off);for(var _i110=startLine;_i110<=endLine;_i110++){var line=state.doc.line(_i110);if(line.length<=endOff)ranges.push(EditorSelection.range(line.from+startOff,line.to+endOff));}}else{var startCol=Math.min(a.col,b.col),endCol=Math.max(a.col,b.col);for(var _i111=startLine;_i111<=endLine;_i111++){var _line2=state.doc.line(_i111);var start=findColumn(_line2.text,startCol,state.tabSize,true);if(start<0){ranges.push(EditorSelection.cursor(_line2.to));}else{var end=findColumn(_line2.text,endCol,state.tabSize);ranges.push(EditorSelection.range(_line2.from+start,_line2.from+end));}}}return ranges;}function absoluteColumn(view,x){var ref=view.coordsAtPos(view.viewport.from);return ref?Math.round(Math.abs((ref.left-x)/view.defaultCharacterWidth)):-1;}function getPos(view,event){var offset=view.posAtCoords({x:event.clientX,y:event.clientY},false);var line=view.state.doc.lineAt(offset),off=offset-line.from;var col=off>MaxOff?-1:off==line.length?absoluteColumn(view,event.clientX):_countColumn(line.text,view.state.tabSize,offset-line.from);return{line:line.number,col:col,off:off};}function rectangleSelectionStyle(view,event){var start=getPos(view,event),startSel=view.state.selection;if(!start)return null;return{update:function update(_update12){if(_update12.docChanged){var newStart=_update12.changes.mapPos(_update12.startState.doc.line(start.line).from);var newLine=_update12.state.doc.lineAt(newStart);start={line:newLine.number,col:start.col,off:Math.min(start.off,newLine.length)};startSel=startSel.map(_update12.changes);}},get:function get(event2,_extend,multiple){var cur2=getPos(view,event2);if(!cur2)return startSel;var ranges=rectangleFor(view.state,start,cur2);if(!ranges.length)return startSel;if(multiple)return EditorSelection.create(ranges.concat(startSel.ranges));else return EditorSelection.create(ranges);}};}function rectangularSelection(options){var filter=(options===null||options===void 0?void 0:options.eventFilter)||function(e){return e.altKey&&e.button==0;};return EditorView.mouseSelectionStyle.of(function(view,event){return filter(event)?rectangleSelectionStyle(view,event):null;});}var keys={Alt:[18,function(e){return!!e.altKey;}],Control:[17,function(e){return!!e.ctrlKey;}],Shift:[16,function(e){return!!e.shiftKey;}],Meta:[91,function(e){return!!e.metaKey;}]};var showCrosshair={style:"cursor: crosshair"};function crosshairCursor(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _keys=_slicedToArray(keys[options.key||"Alt"],2),code=_keys[0],getter=_keys[1];var plugin=ViewPlugin.fromClass(/*#__PURE__*/function(){function _class4(view){_classCallCheck(this,_class4);this.view=view;this.isDown=false;}_createClass(_class4,[{key:"set",value:function set(isDown){if(this.isDown!=isDown){this.isDown=isDown;this.view.update([]);}}}]);return _class4;}(),{eventObservers:{keydown:function keydown(e){this.set(e.keyCode==code||getter(e));},keyup:function keyup(e){if(e.keyCode==code||!getter(e))this.set(false);},mousemove:function mousemove(e){this.set(getter(e));}}});return[plugin,EditorView.contentAttributes.of(function(view){var _a2;return((_a2=view.plugin(plugin))===null||_a2===void 0?void 0:_a2.isDown)?showCrosshair:null;})];}var Outside="-10000px";var TooltipViewManager=/*#__PURE__*/function(){function TooltipViewManager(view,facet,createTooltipView){_classCallCheck(this,TooltipViewManager);this.facet=facet;this.createTooltipView=createTooltipView;this.input=view.state.facet(facet);this.tooltips=this.input.filter(function(t2){return t2;});this.tooltipViews=this.tooltips.map(createTooltipView);}_createClass(TooltipViewManager,[{key:"update",value:function update(_update13,above){var _a2;var input=_update13.state.facet(this.facet);var tooltips=input.filter(function(x){return x;});if(input===this.input){var _iterator102=_createForOfIteratorHelper(this.tooltipViews),_step102;try{for(_iterator102.s();!(_step102=_iterator102.n()).done;){var t2=_step102.value;if(t2.update)t2.update(_update13);}}catch(err){_iterator102.e(err);}finally{_iterator102.f();}return false;}var tooltipViews=[],newAbove=above?[]:null;for(var _i112=0;_i112<tooltips.length;_i112++){var tip=tooltips[_i112],known=-1;if(!tip)continue;for(var i2=0;i2<this.tooltips.length;i2++){var other=this.tooltips[i2];if(other&&other.create==tip.create)known=i2;}if(known<0){tooltipViews[_i112]=this.createTooltipView(tip);if(newAbove)newAbove[_i112]=!!tip.above;}else{var tooltipView=tooltipViews[_i112]=this.tooltipViews[known];if(newAbove)newAbove[_i112]=above[known];if(tooltipView.update)tooltipView.update(_update13);}}var _iterator103=_createForOfIteratorHelper(this.tooltipViews),_step103;try{for(_iterator103.s();!(_step103=_iterator103.n()).done;){var _t2=_step103.value;if(tooltipViews.indexOf(_t2)<0){_t2.dom.remove();(_a2=_t2.destroy)===null||_a2===void 0?void 0:_a2.call(_t2);}}}catch(err){_iterator103.e(err);}finally{_iterator103.f();}if(above){newAbove.forEach(function(val,i){return above[i]=val;});above.length=newAbove.length;}this.input=input;this.tooltips=tooltips;this.tooltipViews=tooltipViews;return true;}}]);return TooltipViewManager;}();function windowSpace(view){var win=view.win;return{top:0,left:0,bottom:win.innerHeight,right:win.innerWidth};}var tooltipConfig=/* @__PURE__ */Facet.define({combine:function combine(values2){var _a2,_b,_c;return{position:browser.ios?"absolute":((_a2=values2.find(function(conf){return conf.position;}))===null||_a2===void 0?void 0:_a2.position)||"fixed",parent:((_b=values2.find(function(conf){return conf.parent;}))===null||_b===void 0?void 0:_b.parent)||null,tooltipSpace:((_c=values2.find(function(conf){return conf.tooltipSpace;}))===null||_c===void 0?void 0:_c.tooltipSpace)||windowSpace};}});var knownHeight=/* @__PURE__ */new WeakMap();var tooltipPlugin=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class5(view){var _this56=this;_classCallCheck(this,_class5);this.view=view;this.above=[];this.inView=true;this.madeAbsolute=false;this.lastTransaction=0;this.measureTimeout=-1;var config2=view.state.facet(tooltipConfig);this.position=config2.position;this.parent=config2.parent;this.classes=view.themeClasses;this.createContainer();this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this};this.manager=new TooltipViewManager(view,showTooltip,function(t2){return _this56.createTooltip(t2);});this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(function(entries){if(Date.now()>_this56.lastTransaction-50&&entries.length>0&&entries[entries.length-1].intersectionRatio<1)_this56.measureSoon();},{threshold:[1]}):null;this.observeIntersection();view.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this));this.maybeMeasure();}_createClass(_class5,[{key:"createContainer",value:function createContainer(){if(this.parent){this.container=document.createElement("div");this.container.style.position="relative";this.container.className=this.view.themeClasses;this.parent.appendChild(this.container);}else{this.container=this.view.dom;}}},{key:"observeIntersection",value:function observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();var _iterator104=_createForOfIteratorHelper(this.manager.tooltipViews),_step104;try{for(_iterator104.s();!(_step104=_iterator104.n()).done;){var tooltip=_step104.value;this.intersectionObserver.observe(tooltip.dom);}}catch(err){_iterator104.e(err);}finally{_iterator104.f();}}}},{key:"measureSoon",value:function measureSoon(){var _this57=this;if(this.measureTimeout<0)this.measureTimeout=setTimeout(function(){_this57.measureTimeout=-1;_this57.maybeMeasure();},50);}},{key:"update",value:function update(_update14){if(_update14.transactions.length)this.lastTransaction=Date.now();var updated=this.manager.update(_update14,this.above);if(updated)this.observeIntersection();var shouldMeasure=updated||_update14.geometryChanged;var newConfig=_update14.state.facet(tooltipConfig);if(newConfig.position!=this.position&&!this.madeAbsolute){this.position=newConfig.position;var _iterator105=_createForOfIteratorHelper(this.manager.tooltipViews),_step105;try{for(_iterator105.s();!(_step105=_iterator105.n()).done;){var t2=_step105.value;t2.dom.style.position=this.position;}}catch(err){_iterator105.e(err);}finally{_iterator105.f();}shouldMeasure=true;}if(newConfig.parent!=this.parent){if(this.parent)this.container.remove();this.parent=newConfig.parent;this.createContainer();var _iterator106=_createForOfIteratorHelper(this.manager.tooltipViews),_step106;try{for(_iterator106.s();!(_step106=_iterator106.n()).done;){var _t3=_step106.value;this.container.appendChild(_t3.dom);}}catch(err){_iterator106.e(err);}finally{_iterator106.f();}shouldMeasure=true;}else if(this.parent&&this.view.themeClasses!=this.classes){this.classes=this.container.className=this.view.themeClasses;}if(shouldMeasure)this.maybeMeasure();}},{key:"createTooltip",value:function createTooltip(tooltip){var tooltipView=tooltip.create(this.view);tooltipView.dom.classList.add("cm-tooltip");if(tooltip.arrow&&!tooltipView.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){var arrow=document.createElement("div");arrow.className="cm-tooltip-arrow";tooltipView.dom.appendChild(arrow);}tooltipView.dom.style.position=this.position;tooltipView.dom.style.top=Outside;tooltipView.dom.style.left="0px";this.container.appendChild(tooltipView.dom);if(tooltipView.mount)tooltipView.mount(this.view);return tooltipView;}},{key:"destroy",value:function destroy(){var _a2,_b;this.view.win.removeEventListener("resize",this.measureSoon);var _iterator107=_createForOfIteratorHelper(this.manager.tooltipViews),_step107;try{for(_iterator107.s();!(_step107=_iterator107.n()).done;){var tooltipView=_step107.value;tooltipView.dom.remove();(_a2=tooltipView.destroy)===null||_a2===void 0?void 0:_a2.call(tooltipView);}}catch(err){_iterator107.e(err);}finally{_iterator107.f();}if(this.parent)this.container.remove();(_b=this.intersectionObserver)===null||_b===void 0?void 0:_b.disconnect();clearTimeout(this.measureTimeout);}},{key:"readMeasure",value:function readMeasure(){var _this58=this;var editor=this.view.dom.getBoundingClientRect();var scaleX=1,scaleY=1,makeAbsolute=false;if(this.position=="fixed"&&this.manager.tooltipViews.length){var dom=this.manager.tooltipViews[0].dom;if(browser.gecko){makeAbsolute=dom.offsetParent!=this.container.ownerDocument.body;}else{if(this.view.scaleX!=1||this.view.scaleY!=1){makeAbsolute=true;}else if(dom.style.top==Outside&&dom.style.left=="0px"){var rect=dom.getBoundingClientRect();makeAbsolute=Math.abs(rect.top+1e4)>1||Math.abs(rect.left)>1;}}}if(makeAbsolute||this.position=="absolute"){if(this.parent){var _rect=this.parent.getBoundingClientRect();if(_rect.width&&_rect.height){scaleX=_rect.width/this.parent.offsetWidth;scaleY=_rect.height/this.parent.offsetHeight;}}else{var _this$view$viewState=this.view.viewState;scaleX=_this$view$viewState.scaleX;scaleY=_this$view$viewState.scaleY;}}return{editor:editor,parent:this.parent?this.container.getBoundingClientRect():editor,pos:this.manager.tooltips.map(function(t2,i){var tv=_this58.manager.tooltipViews[i];return tv.getCoords?tv.getCoords(t2.pos):_this58.view.coordsAtPos(t2.pos);}),size:this.manager.tooltipViews.map(function(_ref14){var dom=_ref14.dom;return dom.getBoundingClientRect();}),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view),scaleX:scaleX,scaleY:scaleY,makeAbsolute:makeAbsolute};}},{key:"writeMeasure",value:function writeMeasure(measured){var _a2;if(measured.makeAbsolute){this.madeAbsolute=true;this.position="absolute";var _iterator108=_createForOfIteratorHelper(this.manager.tooltipViews),_step108;try{for(_iterator108.s();!(_step108=_iterator108.n()).done;){var t2=_step108.value;t2.dom.style.position="absolute";}}catch(err){_iterator108.e(err);}finally{_iterator108.f();}}var editor=measured.editor,space4=measured.space,scaleX=measured.scaleX,scaleY=measured.scaleY;var others=[];for(var _i113=0;_i113<this.manager.tooltips.length;_i113++){var tooltip=this.manager.tooltips[_i113],tView=this.manager.tooltipViews[_i113],dom=tView.dom;var pos=measured.pos[_i113],size=measured.size[_i113];if(!pos||pos.bottom<=Math.max(editor.top,space4.top)||pos.top>=Math.min(editor.bottom,space4.bottom)||pos.right<Math.max(editor.left,space4.left)-0.1||pos.left>Math.min(editor.right,space4.right)+0.1){dom.style.top=Outside;continue;}var arrow=tooltip.arrow?tView.dom.querySelector(".cm-tooltip-arrow"):null;var arrowHeight=arrow?7:0;var width=size.right-size.left,height=(_a2=knownHeight.get(tView))!==null&&_a2!==void 0?_a2:size.bottom-size.top;var offset=tView.offset||noOffset,ltr=this.view.textDirection==Direction.LTR;var left=size.width>space4.right-space4.left?ltr?space4.left:space4.right-size.width:ltr?Math.min(pos.left-(arrow?14:0)+offset.x,space4.right-width):Math.max(space4.left,pos.left-width+(arrow?14:0)-offset.x);var above=this.above[_i113];if(!tooltip.strictSide&&(above?pos.top-(size.bottom-size.top)-offset.y<space4.top:pos.bottom+(size.bottom-size.top)+offset.y>space4.bottom)&&above==space4.bottom-pos.bottom>pos.top-space4.top)above=this.above[_i113]=!above;var spaceVert=(above?pos.top-space4.top:space4.bottom-pos.bottom)-arrowHeight;if(spaceVert<height&&tView.resize!==false){if(spaceVert<this.view.defaultLineHeight){dom.style.top=Outside;continue;}knownHeight.set(tView,height);dom.style.height=(height=spaceVert)/scaleY+"px";}else if(dom.style.height){dom.style.height="";}var top2=above?pos.top-height-arrowHeight-offset.y:pos.bottom+arrowHeight+offset.y;var right=left+width;if(tView.overlap!==true){var _iterator109=_createForOfIteratorHelper(others),_step109;try{for(_iterator109.s();!(_step109=_iterator109.n()).done;){var _r5=_step109.value;if(_r5.left<right&&_r5.right>left&&_r5.top<top2+height&&_r5.bottom>top2)top2=above?_r5.top-height-2-arrowHeight:_r5.bottom+arrowHeight+2;}}catch(err){_iterator109.e(err);}finally{_iterator109.f();}}if(this.position=="absolute"){dom.style.top=(top2-measured.parent.top)/scaleY+"px";dom.style.left=(left-measured.parent.left)/scaleX+"px";}else{dom.style.top=top2/scaleY+"px";dom.style.left=left/scaleX+"px";}if(arrow){var arrowLeft=pos.left+(ltr?offset.x:-offset.x)-(left+14-7);arrow.style.left=arrowLeft/scaleX+"px";}if(tView.overlap!==true)others.push({left:left,top:top2,right:right,bottom:top2+height});dom.classList.toggle("cm-tooltip-above",above);dom.classList.toggle("cm-tooltip-below",!above);if(tView.positioned)tView.positioned(measured.space);}}},{key:"maybeMeasure",value:function maybeMeasure(){if(this.manager.tooltips.length){if(this.view.inView)this.view.requestMeasure(this.measureReq);if(this.inView!=this.view.inView){this.inView=this.view.inView;if(!this.inView){var _iterator110=_createForOfIteratorHelper(this.manager.tooltipViews),_step110;try{for(_iterator110.s();!(_step110=_iterator110.n()).done;){var tv=_step110.value;tv.dom.style.top=Outside;}}catch(err){_iterator110.e(err);}finally{_iterator110.f();}}}}}}]);return _class5;}(),{eventObservers:{scroll:function scroll(){this.maybeMeasure();}}});var baseTheme=/* @__PURE__ */EditorView.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"".concat(7,"px"),width:"".concat(7*2,"px"),position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"".concat(7,"px solid transparent"),borderRight:"".concat(7,"px solid transparent")},".cm-tooltip-above &":{bottom:"-".concat(7,"px"),"&:before":{borderTop:"".concat(7,"px solid #bbb")},"&:after":{borderTop:"".concat(7,"px solid #f5f5f5"),bottom:"1px"}},".cm-tooltip-below &":{top:"-".concat(7,"px"),"&:before":{borderBottom:"".concat(7,"px solid #bbb")},"&:after":{borderBottom:"".concat(7,"px solid #f5f5f5"),top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}});var noOffset={x:0,y:0};var showTooltip=/* @__PURE__ */Facet.define({enables:[tooltipPlugin,baseTheme]});var showHoverTooltip=/* @__PURE__ */Facet.define();var HoverTooltipHost=/*#__PURE__*/function(){function HoverTooltipHost(view){var _this59=this;_classCallCheck(this,HoverTooltipHost);this.view=view;this.mounted=false;this.dom=document.createElement("div");this.dom.classList.add("cm-tooltip-hover");this.manager=new TooltipViewManager(view,showHoverTooltip,function(t2){return _this59.createHostedView(t2);});}_createClass(HoverTooltipHost,[{key:"createHostedView",value:function createHostedView(tooltip){var hostedView=tooltip.create(this.view);hostedView.dom.classList.add("cm-tooltip-section");this.dom.appendChild(hostedView.dom);if(this.mounted&&hostedView.mount)hostedView.mount(this.view);return hostedView;}},{key:"mount",value:function mount(view){var _iterator111=_createForOfIteratorHelper(this.manager.tooltipViews),_step111;try{for(_iterator111.s();!(_step111=_iterator111.n()).done;){var hostedView=_step111.value;if(hostedView.mount)hostedView.mount(view);}}catch(err){_iterator111.e(err);}finally{_iterator111.f();}this.mounted=true;}},{key:"positioned",value:function positioned(space4){var _iterator112=_createForOfIteratorHelper(this.manager.tooltipViews),_step112;try{for(_iterator112.s();!(_step112=_iterator112.n()).done;){var hostedView=_step112.value;if(hostedView.positioned)hostedView.positioned(space4);}}catch(err){_iterator112.e(err);}finally{_iterator112.f();}}},{key:"update",value:function update(_update15){this.manager.update(_update15);}},{key:"destroy",value:function destroy(){var _a2;var _iterator113=_createForOfIteratorHelper(this.manager.tooltipViews),_step113;try{for(_iterator113.s();!(_step113=_iterator113.n()).done;){var t2=_step113.value;(_a2=t2.destroy)===null||_a2===void 0?void 0:_a2.call(t2);}}catch(err){_iterator113.e(err);}finally{_iterator113.f();}}},{key:"passProp",value:function passProp(name2){var value=void 0;var _iterator114=_createForOfIteratorHelper(this.manager.tooltipViews),_step114;try{for(_iterator114.s();!(_step114=_iterator114.n()).done;){var view=_step114.value;var given=view[name2];if(given!==void 0){if(value===void 0)value=given;else if(value!==given)return void 0;}}}catch(err){_iterator114.e(err);}finally{_iterator114.f();}return value;}},{key:"offset",get:function get(){return this.passProp("offset");}},{key:"getCoords",get:function get(){return this.passProp("getCoords");}},{key:"overlap",get:function get(){return this.passProp("overlap");}},{key:"resize",get:function get(){return this.passProp("resize");}}],[{key:"create",value:function create(view){return new HoverTooltipHost(view);}}]);return HoverTooltipHost;}();var showHoverTooltipHost=/* @__PURE__ */showTooltip.compute([showHoverTooltip],function(state){var tooltips=state.facet(showHoverTooltip).filter(function(t2){return t2;});if(tooltips.length===0)return null;return{pos:Math.min.apply(Math,_toConsumableArray(tooltips.map(function(t2){return t2.pos;}))),end:Math.max.apply(Math,_toConsumableArray(tooltips.filter(function(t2){return t2.end!=null;}).map(function(t2){return t2.end;}))),create:HoverTooltipHost.create,above:tooltips[0].above,arrow:tooltips.some(function(t2){return t2.arrow;})};});var HoverPlugin=/*#__PURE__*/function(){function HoverPlugin(view,source,field,setHover,hoverTime){_classCallCheck(this,HoverPlugin);this.view=view;this.source=source;this.field=field;this.setHover=setHover;this.hoverTime=hoverTime;this.hoverTimeout=-1;this.restartTimeout=-1;this.pending=null;this.lastMove={x:0,y:0,target:view.dom,time:0};this.checkHover=this.checkHover.bind(this);view.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this));view.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this));}_createClass(HoverPlugin,[{key:"update",value:function update(){var _this60=this;if(this.pending){this.pending=null;clearTimeout(this.restartTimeout);this.restartTimeout=setTimeout(function(){return _this60.startHover();},20);}}},{key:"active",get:function get(){return this.view.state.field(this.field);}},{key:"checkHover",value:function checkHover(){this.hoverTimeout=-1;if(this.active)return;var hovered=Date.now()-this.lastMove.time;if(hovered<this.hoverTime)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-hovered);else this.startHover();}},{key:"startHover",value:function startHover(){var _this61=this;clearTimeout(this.restartTimeout);var view=this.view,lastMove=this.lastMove;var desc=view.docView.nearest(lastMove.target);if(!desc)return;var pos,side=1;if(desc instanceof WidgetView){pos=desc.posAtStart;}else{pos=view.posAtCoords(lastMove);if(pos==null)return;var posCoords=view.coordsAtPos(pos);if(!posCoords||lastMove.y<posCoords.top||lastMove.y>posCoords.bottom||lastMove.x<posCoords.left-view.defaultCharacterWidth||lastMove.x>posCoords.right+view.defaultCharacterWidth)return;var bidi=view.bidiSpans(view.state.doc.lineAt(pos)).find(function(s){return s.from<=pos&&s.to>=pos;});var rtl=bidi&&bidi.dir==Direction.RTL?-1:1;side=lastMove.x<posCoords.left?-rtl:rtl;}var open=this.source(view,pos,side);if(open===null||open===void 0?void 0:open.then){var pending=this.pending={pos:pos};open.then(function(result){if(_this61.pending==pending){_this61.pending=null;if(result)view.dispatch({effects:_this61.setHover.of(result)});}},function(e){return logException(view.state,e,"hover tooltip");});}else if(open){view.dispatch({effects:this.setHover.of(open)});}}},{key:"mousemove",value:function mousemove(event){var _a2;this.lastMove={x:event.clientX,y:event.clientY,target:event.target,time:Date.now()};if(this.hoverTimeout<0)this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime);var tooltip=this.active;if(tooltip&&!isInTooltip(this.lastMove.target)||this.pending){var _ref15=tooltip||this.pending,pos=_ref15.pos,end=(_a2=tooltip===null||tooltip===void 0?void 0:tooltip.end)!==null&&_a2!==void 0?_a2:pos;if(pos==end?this.view.posAtCoords(this.lastMove)!=pos:!isOverRange(this.view,pos,end,event.clientX,event.clientY)){this.view.dispatch({effects:this.setHover.of(null)});this.pending=null;}}}},{key:"mouseleave",value:function mouseleave(e){clearTimeout(this.hoverTimeout);this.hoverTimeout=-1;if(this.active&&!isInTooltip(e.relatedTarget))this.view.dispatch({effects:this.setHover.of(null)});}},{key:"destroy",value:function destroy(){clearTimeout(this.hoverTimeout);this.view.dom.removeEventListener("mouseleave",this.mouseleave);this.view.dom.removeEventListener("mousemove",this.mousemove);}}]);return HoverPlugin;}();function isInTooltip(elt2){for(var cur2=elt2;cur2;cur2=cur2.parentNode){if(cur2.nodeType==1&&cur2.classList.contains("cm-tooltip"))return true;}return false;}function isOverRange(view,from,to,x,y,margin){var rect=view.scrollDOM.getBoundingClientRect();var docBottom=view.documentTop+view.documentPadding.top+view.contentHeight;if(rect.left>x||rect.right<x||rect.top>y||Math.min(rect.bottom,docBottom)<y)return false;var pos=view.posAtCoords({x:x,y:y},false);return pos>=from&&pos<=to;}function hoverTooltip(source){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var setHover=StateEffect.define();var hoverState=StateField.define({create:function create(){return null;},update:function update(value,tr){if(value&&(options.hideOnChange&&(tr.docChanged||tr.selection)||options.hideOn&&options.hideOn(tr,value)))return null;if(value&&tr.docChanged){var newPos=tr.changes.mapPos(value.pos,-1,MapMode.TrackDel);if(newPos==null)return null;var copy=Object.assign(/* @__PURE__ */Object.create(null),value);copy.pos=newPos;if(value.end!=null)copy.end=tr.changes.mapPos(value.end);value=copy;}var _iterator115=_createForOfIteratorHelper(tr.effects),_step115;try{for(_iterator115.s();!(_step115=_iterator115.n()).done;){var effect=_step115.value;if(effect.is(setHover))value=effect.value;if(effect.is(closeHoverTooltipEffect))value=null;}}catch(err){_iterator115.e(err);}finally{_iterator115.f();}return value;},provide:function provide(f){return showHoverTooltip.from(f);}});return[hoverState,ViewPlugin.define(function(view){return new HoverPlugin(view,source,hoverState,setHover,options.hoverTime||300);}),showHoverTooltipHost];}function getTooltip(view,tooltip){var plugin=view.plugin(tooltipPlugin);if(!plugin)return null;var found=plugin.manager.tooltips.indexOf(tooltip);return found<0?null:plugin.manager.tooltipViews[found];}var closeHoverTooltipEffect=/* @__PURE__ */StateEffect.define();var panelConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){var topContainer,bottomContainer;var _iterator116=_createForOfIteratorHelper(configs),_step116;try{for(_iterator116.s();!(_step116=_iterator116.n()).done;){var c=_step116.value;topContainer=topContainer||c.topContainer;bottomContainer=bottomContainer||c.bottomContainer;}}catch(err){_iterator116.e(err);}finally{_iterator116.f();}return{topContainer:topContainer,bottomContainer:bottomContainer};}});function getPanel(view,panel){var plugin=view.plugin(panelPlugin);var index=plugin?plugin.specs.indexOf(panel):-1;return index>-1?plugin.panels[index]:null;}var panelPlugin=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class6(view){_classCallCheck(this,_class6);this.input=view.state.facet(showPanel);this.specs=this.input.filter(function(s){return s;});this.panels=this.specs.map(function(spec){return spec(view);});var conf=view.state.facet(panelConfig);this.top=new PanelGroup(view,true,conf.topContainer);this.bottom=new PanelGroup(view,false,conf.bottomContainer);this.top.sync(this.panels.filter(function(p){return p.top;}));this.bottom.sync(this.panels.filter(function(p){return!p.top;}));var _iterator117=_createForOfIteratorHelper(this.panels),_step117;try{for(_iterator117.s();!(_step117=_iterator117.n()).done;){var _p2=_step117.value;_p2.dom.classList.add("cm-panel");if(_p2.mount)_p2.mount();}}catch(err){_iterator117.e(err);}finally{_iterator117.f();}}_createClass(_class6,[{key:"update",value:function update(_update16){var conf=_update16.state.facet(panelConfig);if(this.top.container!=conf.topContainer){this.top.sync([]);this.top=new PanelGroup(_update16.view,true,conf.topContainer);}if(this.bottom.container!=conf.bottomContainer){this.bottom.sync([]);this.bottom=new PanelGroup(_update16.view,false,conf.bottomContainer);}this.top.syncClasses();this.bottom.syncClasses();var input=_update16.state.facet(showPanel);if(input!=this.input){var specs=input.filter(function(x){return x;});var panels=[],top2=[],bottom=[],mount=[];var _iterator118=_createForOfIteratorHelper(specs),_step118;try{for(_iterator118.s();!(_step118=_iterator118.n()).done;){var spec=_step118.value;var known=this.specs.indexOf(spec),panel=void 0;if(known<0){panel=spec(_update16.view);mount.push(panel);}else{panel=this.panels[known];if(panel.update)panel.update(_update16);}panels.push(panel);(panel.top?top2:bottom).push(panel);}}catch(err){_iterator118.e(err);}finally{_iterator118.f();}this.specs=specs;this.panels=panels;this.top.sync(top2);this.bottom.sync(bottom);for(var _i114=0,_mount=mount;_i114<_mount.length;_i114++){var _p3=_mount[_i114];_p3.dom.classList.add("cm-panel");if(_p3.mount)_p3.mount();}}else{var _iterator119=_createForOfIteratorHelper(this.panels),_step119;try{for(_iterator119.s();!(_step119=_iterator119.n()).done;){var _p4=_step119.value;if(_p4.update)_p4.update(_update16);}}catch(err){_iterator119.e(err);}finally{_iterator119.f();}}}},{key:"destroy",value:function destroy(){this.top.sync([]);this.bottom.sync([]);}}]);return _class6;}(),{provide:function provide(plugin){return EditorView.scrollMargins.of(function(view){var value=view.plugin(plugin);return value&&{top:value.top.scrollMargin(),bottom:value.bottom.scrollMargin()};});}});var PanelGroup=/*#__PURE__*/function(){function PanelGroup(view,top2,container){_classCallCheck(this,PanelGroup);this.view=view;this.top=top2;this.container=container;this.dom=void 0;this.classes="";this.panels=[];this.syncClasses();}_createClass(PanelGroup,[{key:"sync",value:function sync(panels){var _iterator120=_createForOfIteratorHelper(this.panels),_step120;try{for(_iterator120.s();!(_step120=_iterator120.n()).done;){var _p5=_step120.value;if(_p5.destroy&&panels.indexOf(_p5)<0)_p5.destroy();}}catch(err){_iterator120.e(err);}finally{_iterator120.f();}this.panels=panels;this.syncDOM();}},{key:"syncDOM",value:function syncDOM(){if(this.panels.length==0){if(this.dom){this.dom.remove();this.dom=void 0;}return;}if(!this.dom){this.dom=document.createElement("div");this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom";this.dom.style[this.top?"top":"bottom"]="0";var parent=this.container||this.view.dom;parent.insertBefore(this.dom,this.top?parent.firstChild:null);}var curDOM=this.dom.firstChild;var _iterator121=_createForOfIteratorHelper(this.panels),_step121;try{for(_iterator121.s();!(_step121=_iterator121.n()).done;){var panel=_step121.value;if(panel.dom.parentNode==this.dom){while(curDOM!=panel.dom){curDOM=rm(curDOM);}curDOM=curDOM.nextSibling;}else{this.dom.insertBefore(panel.dom,curDOM);}}}catch(err){_iterator121.e(err);}finally{_iterator121.f();}while(curDOM){curDOM=rm(curDOM);}}},{key:"scrollMargin",value:function scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top);}},{key:"syncClasses",value:function syncClasses(){if(!this.container||this.classes==this.view.themeClasses)return;var _iterator122=_createForOfIteratorHelper(this.classes.split(" ")),_step122;try{for(_iterator122.s();!(_step122=_iterator122.n()).done;){var cls=_step122.value;if(cls)this.container.classList.remove(cls);}}catch(err){_iterator122.e(err);}finally{_iterator122.f();}var _iterator123=_createForOfIteratorHelper((this.classes=this.view.themeClasses).split(" ")),_step123;try{for(_iterator123.s();!(_step123=_iterator123.n()).done;){var _cls=_step123.value;if(_cls)this.container.classList.add(_cls);}}catch(err){_iterator123.e(err);}finally{_iterator123.f();}}}]);return PanelGroup;}();function rm(node){var next=node.nextSibling;node.remove();return next;}var showPanel=/* @__PURE__ */Facet.define({enables:panelPlugin});var GutterMarker=/*#__PURE__*/function(_RangeValue2){_inherits(GutterMarker,_RangeValue2);var _super24=_createSuper(GutterMarker);function GutterMarker(){_classCallCheck(this,GutterMarker);return _super24.apply(this,arguments);}_createClass(GutterMarker,[{key:"compare",value:function compare(other){return this==other||this.constructor==other.constructor&&this.eq(other);}},{key:"eq",value:function eq(other){return false;}},{key:"destroy",value:function destroy(dom){}}]);return GutterMarker;}(RangeValue);GutterMarker.prototype.elementClass="";GutterMarker.prototype.toDOM=void 0;GutterMarker.prototype.mapMode=MapMode.TrackBefore;GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1;GutterMarker.prototype.point=true;var gutterLineClass=/* @__PURE__ */Facet.define();var defaults={"class":"",renderEmptyElements:false,elementStyle:"",markers:function markers(){return RangeSet.empty;},lineMarker:function lineMarker(){return null;},widgetMarker:function widgetMarker(){return null;},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}};var activeGutters=/* @__PURE__ */Facet.define();function gutter(config2){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults),config2))];}var unfixGutters=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.some(function(x){return x;});}});function gutters(config2){var result=[gutterView];if(config2&&config2.fixed===false)result.push(unfixGutters.of(true));return result;}var gutterView=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class7(view){_classCallCheck(this,_class7);this.view=view;this.prevViewport=view.viewport;this.dom=document.createElement("div");this.dom.className="cm-gutters";this.dom.setAttribute("aria-hidden","true");this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px";this.gutters=view.state.facet(activeGutters).map(function(conf){return new SingleGutterView(view,conf);});var _iterator124=_createForOfIteratorHelper(this.gutters),_step124;try{for(_iterator124.s();!(_step124=_iterator124.n()).done;){var gutter2=_step124.value;this.dom.appendChild(gutter2.dom);}}catch(err){_iterator124.e(err);}finally{_iterator124.f();}this.fixed=!view.state.facet(unfixGutters);if(this.fixed){this.dom.style.position="sticky";}this.syncGutters(false);view.scrollDOM.insertBefore(this.dom,view.contentDOM);}_createClass(_class7,[{key:"update",value:function update(_update17){if(this.updateGutters(_update17)){var vpA=this.prevViewport,vpB=_update17.view.viewport;var vpOverlap=Math.min(vpA.to,vpB.to)-Math.max(vpA.from,vpB.from);this.syncGutters(vpOverlap<(vpB.to-vpB.from)*0.8);}if(_update17.geometryChanged)this.dom.style.minHeight=this.view.contentHeight+"px";if(this.view.state.facet(unfixGutters)!=!this.fixed){this.fixed=!this.fixed;this.dom.style.position=this.fixed?"sticky":"";}this.prevViewport=_update17.view.viewport;}},{key:"syncGutters",value:function syncGutters(detach){var _this62=this;var after=this.dom.nextSibling;if(detach)this.dom.remove();var lineClasses=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from);var classSet=[];var contexts=this.gutters.map(function(gutter2){return new UpdateContext(gutter2,_this62.view.viewport,-_this62.view.documentPadding.top);});var _iterator125=_createForOfIteratorHelper(this.view.viewportLineBlocks),_step125;try{for(_iterator125.s();!(_step125=_iterator125.n()).done;){var line=_step125.value;if(classSet.length)classSet=[];if(Array.isArray(line.type)){var first=true;var _iterator127=_createForOfIteratorHelper(line.type),_step127;try{for(_iterator127.s();!(_step127=_iterator127.n()).done;){var b=_step127.value;if(b.type==BlockType.Text&&first){advanceCursor(lineClasses,classSet,b.from);var _iterator128=_createForOfIteratorHelper(contexts),_step128;try{for(_iterator128.s();!(_step128=_iterator128.n()).done;){var cx=_step128.value;cx.line(this.view,b,classSet);}}catch(err){_iterator128.e(err);}finally{_iterator128.f();}first=false;}else if(b.widget){var _iterator129=_createForOfIteratorHelper(contexts),_step129;try{for(_iterator129.s();!(_step129=_iterator129.n()).done;){var _cx2=_step129.value;_cx2.widget(this.view,b);}}catch(err){_iterator129.e(err);}finally{_iterator129.f();}}}}catch(err){_iterator127.e(err);}finally{_iterator127.f();}}else if(line.type==BlockType.Text){advanceCursor(lineClasses,classSet,line.from);var _iterator130=_createForOfIteratorHelper(contexts),_step130;try{for(_iterator130.s();!(_step130=_iterator130.n()).done;){var _cx3=_step130.value;_cx3.line(this.view,line,classSet);}}catch(err){_iterator130.e(err);}finally{_iterator130.f();}}else if(line.widget){var _iterator131=_createForOfIteratorHelper(contexts),_step131;try{for(_iterator131.s();!(_step131=_iterator131.n()).done;){var _cx4=_step131.value;_cx4.widget(this.view,line);}}catch(err){_iterator131.e(err);}finally{_iterator131.f();}}}}catch(err){_iterator125.e(err);}finally{_iterator125.f();}var _iterator126=_createForOfIteratorHelper(contexts),_step126;try{for(_iterator126.s();!(_step126=_iterator126.n()).done;){var _cx5=_step126.value;_cx5.finish();}}catch(err){_iterator126.e(err);}finally{_iterator126.f();}if(detach)this.view.scrollDOM.insertBefore(this.dom,after);}},{key:"updateGutters",value:function updateGutters(update){var prev=update.startState.facet(activeGutters),cur2=update.state.facet(activeGutters);var change=update.docChanged||update.heightChanged||update.viewportChanged||!RangeSet.eq(update.startState.facet(gutterLineClass),update.state.facet(gutterLineClass),update.view.viewport.from,update.view.viewport.to);if(prev==cur2){var _iterator132=_createForOfIteratorHelper(this.gutters),_step132;try{for(_iterator132.s();!(_step132=_iterator132.n()).done;){var gutter2=_step132.value;if(gutter2.update(update))change=true;}}catch(err){_iterator132.e(err);}finally{_iterator132.f();}}else{change=true;var gutters2=[];var _iterator133=_createForOfIteratorHelper(cur2),_step133;try{for(_iterator133.s();!(_step133=_iterator133.n()).done;){var conf=_step133.value;var known=prev.indexOf(conf);if(known<0){gutters2.push(new SingleGutterView(this.view,conf));}else{this.gutters[known].update(update);gutters2.push(this.gutters[known]);}}}catch(err){_iterator133.e(err);}finally{_iterator133.f();}var _iterator134=_createForOfIteratorHelper(this.gutters),_step134;try{for(_iterator134.s();!(_step134=_iterator134.n()).done;){var _g=_step134.value;_g.dom.remove();if(gutters2.indexOf(_g)<0)_g.destroy();}}catch(err){_iterator134.e(err);}finally{_iterator134.f();}for(var _i115=0,_gutters=gutters2;_i115<_gutters.length;_i115++){var g=_gutters[_i115];this.dom.appendChild(g.dom);}this.gutters=gutters2;}return change;}},{key:"destroy",value:function destroy(){var _iterator135=_createForOfIteratorHelper(this.gutters),_step135;try{for(_iterator135.s();!(_step135=_iterator135.n()).done;){var view=_step135.value;view.destroy();}}catch(err){_iterator135.e(err);}finally{_iterator135.f();}this.dom.remove();}}]);return _class7;}(),{provide:function provide(plugin){return EditorView.scrollMargins.of(function(view){var value=view.plugin(plugin);if(!value||value.gutters.length==0||!value.fixed)return null;return view.textDirection==Direction.LTR?{left:value.dom.offsetWidth*view.scaleX}:{right:value.dom.offsetWidth*view.scaleX};});}});function asArray2(val){return Array.isArray(val)?val:[val];}function advanceCursor(cursor2,collect,pos){while(cursor2.value&&cursor2.from<=pos){if(cursor2.from==pos)collect.push(cursor2.value);cursor2.next();}}var UpdateContext=/*#__PURE__*/function(){function UpdateContext(gutter2,viewport,height){_classCallCheck(this,UpdateContext);this.gutter=gutter2;this.height=height;this.i=0;this.cursor=RangeSet.iter(gutter2.markers,viewport.from);}_createClass(UpdateContext,[{key:"addElement",value:function addElement(view,block,markers){var gutter2=this.gutter,above=(block.top-this.height)/view.scaleY,height=block.height/view.scaleY;if(this.i==gutter2.elements.length){var newElt=new GutterElement(view,height,above,markers);gutter2.elements.push(newElt);gutter2.dom.appendChild(newElt.dom);}else{gutter2.elements[this.i].update(view,height,above,markers);}this.height=block.bottom;this.i++;}},{key:"line",value:function line(view,_line3,extraMarkers){var localMarkers=[];advanceCursor(this.cursor,localMarkers,_line3.from);if(extraMarkers.length)localMarkers=localMarkers.concat(extraMarkers);var forLine=this.gutter.config.lineMarker(view,_line3,localMarkers);if(forLine)localMarkers.unshift(forLine);var gutter2=this.gutter;if(localMarkers.length==0&&!gutter2.config.renderEmptyElements)return;this.addElement(view,_line3,localMarkers);}},{key:"widget",value:function widget(view,block){var marker=this.gutter.config.widgetMarker(view,block.widget,block);if(marker)this.addElement(view,block,[marker]);}},{key:"finish",value:function finish(){var gutter2=this.gutter;while(gutter2.elements.length>this.i){var last=gutter2.elements.pop();gutter2.dom.removeChild(last.dom);last.destroy();}}}]);return UpdateContext;}();var SingleGutterView=/*#__PURE__*/function(){function SingleGutterView(view,config2){var _this63=this;_classCallCheck(this,SingleGutterView);this.view=view;this.config=config2;this.elements=[];this.spacer=null;this.dom=document.createElement("div");this.dom.className="cm-gutter"+(this.config["class"]?" "+this.config["class"]:"");var _loop8=function _loop8(prop){_this63.dom.addEventListener(prop,function(event){var target=event.target,y;if(target!=_this63.dom&&_this63.dom.contains(target)){while(target.parentNode!=_this63.dom){target=target.parentNode;}var rect=target.getBoundingClientRect();y=(rect.top+rect.bottom)/2;}else{y=event.clientY;}var line=view.lineBlockAtHeight(y-view.documentTop);if(config2.domEventHandlers[prop](view,line,event))event.preventDefault();});};for(var prop in config2.domEventHandlers){_loop8(prop);}this.markers=asArray2(config2.markers(view));if(config2.initialSpacer){this.spacer=new GutterElement(view,0,0,[config2.initialSpacer(view)]);this.dom.appendChild(this.spacer.dom);this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none";}}_createClass(SingleGutterView,[{key:"update",value:function update(_update18){var prevMarkers=this.markers;this.markers=asArray2(this.config.markers(_update18.view));if(this.spacer&&this.config.updateSpacer){var updated=this.config.updateSpacer(this.spacer.markers[0],_update18);if(updated!=this.spacer.markers[0])this.spacer.update(_update18.view,0,0,[updated]);}var vp=_update18.view.viewport;return!RangeSet.eq(this.markers,prevMarkers,vp.from,vp.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(_update18):false);}},{key:"destroy",value:function destroy(){var _iterator136=_createForOfIteratorHelper(this.elements),_step136;try{for(_iterator136.s();!(_step136=_iterator136.n()).done;){var elt2=_step136.value;elt2.destroy();}}catch(err){_iterator136.e(err);}finally{_iterator136.f();}}}]);return SingleGutterView;}();var GutterElement=/*#__PURE__*/function(){function GutterElement(view,height,above,markers){_classCallCheck(this,GutterElement);this.height=-1;this.above=0;this.markers=[];this.dom=document.createElement("div");this.dom.className="cm-gutterElement";this.update(view,height,above,markers);}_createClass(GutterElement,[{key:"update",value:function update(view,height,above,markers){if(this.height!=height){this.height=height;this.dom.style.height=height+"px";}if(this.above!=above)this.dom.style.marginTop=(this.above=above)?above+"px":"";if(!sameMarkers(this.markers,markers))this.setMarkers(view,markers);}},{key:"setMarkers",value:function setMarkers(view,markers){var cls="cm-gutterElement",domPos=this.dom.firstChild;for(var iNew=0,iOld=0;;){var skipTo=iOld,marker=iNew<markers.length?markers[iNew++]:null,matched=false;if(marker){var c=marker.elementClass;if(c)cls+=" "+c;for(var _i116=iOld;_i116<this.markers.length;_i116++){if(this.markers[_i116].compare(marker)){skipTo=_i116;matched=true;break;}}}else{skipTo=this.markers.length;}while(iOld<skipTo){var next=this.markers[iOld++];if(next.toDOM){next.destroy(domPos);var after=domPos.nextSibling;domPos.remove();domPos=after;}}if(!marker)break;if(marker.toDOM){if(matched)domPos=domPos.nextSibling;else this.dom.insertBefore(marker.toDOM(view),domPos);}if(matched)iOld++;}this.dom.className=cls;this.markers=markers;}},{key:"destroy",value:function destroy(){this.setMarkers(null,[]);}}]);return GutterElement;}();function sameMarkers(a,b){if(a.length!=b.length)return false;for(var _i117=0;_i117<a.length;_i117++){if(!a[_i117].compare(b[_i117]))return false;}return true;}var lineNumberMarkers=/* @__PURE__ */Facet.define();var lineNumberConfig=/* @__PURE__ */Facet.define({combine:function combine(values2){return combineConfig(values2,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function domEventHandlers(a,b){var result=Object.assign({},a);var _loop9=function _loop9(event){var exists=result[event],add2=b[event];result[event]=exists?function(view,line,event2){return exists(view,line,event2)||add2(view,line,event2);}:add2;};for(var event in b){_loop9(event);}return result;}});}});var NumberMarker=/*#__PURE__*/function(_GutterMarker){_inherits(NumberMarker,_GutterMarker);var _super25=_createSuper(NumberMarker);function NumberMarker(number2){var _this64;_classCallCheck(this,NumberMarker);_this64=_super25.call(this);_this64.number=number2;return _this64;}_createClass(NumberMarker,[{key:"eq",value:function eq(other){return this.number==other.number;}},{key:"toDOM",value:function toDOM(){return document.createTextNode(this.number);}}]);return NumberMarker;}(GutterMarker);function formatNumber(view,number2){return view.state.facet(lineNumberConfig).formatNumber(number2,view.state);}var lineNumberGutter=/* @__PURE__ */activeGutters.compute([lineNumberConfig],function(state){return{"class":"cm-lineNumbers",renderEmptyElements:false,markers:function markers(view){return view.state.facet(lineNumberMarkers);},lineMarker:function lineMarker(view,line,others){if(others.some(function(m){return m.toDOM;}))return null;return new NumberMarker(formatNumber(view,view.state.doc.lineAt(line.from).number));},widgetMarker:function widgetMarker(){return null;},lineMarkerChange:function lineMarkerChange(update){return update.startState.facet(lineNumberConfig)!=update.state.facet(lineNumberConfig);},initialSpacer:function initialSpacer(view){return new NumberMarker(formatNumber(view,maxLineNumber(view.state.doc.lines)));},updateSpacer:function updateSpacer(spacer,update){var max=formatNumber(update.view,maxLineNumber(update.view.state.doc.lines));return max==spacer.number?spacer:new NumberMarker(max);},domEventHandlers:state.facet(lineNumberConfig).domEventHandlers};});function lineNumbers(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[lineNumberConfig.of(config2),gutters(),lineNumberGutter];}function maxLineNumber(lines){var last=9;while(last<lines){last=last*10+9;}return last;}var activeLineGutterMarker=/* @__PURE__ */new(/*#__PURE__*/function(_GutterMarker2){_inherits(_class8,_GutterMarker2);var _super26=_createSuper(_class8);function _class8(){var _this65;_classCallCheck(this,_class8);_this65=_super26.apply(this,arguments);_this65.elementClass="cm-activeLineGutter";return _this65;}return _createClass(_class8);}(GutterMarker))();var activeLineGutterHighlighter=/* @__PURE__ */gutterLineClass.compute(["selection"],function(state){var marks=[],last=-1;var _iterator137=_createForOfIteratorHelper(state.selection.ranges),_step137;try{for(_iterator137.s();!(_step137=_iterator137.n()).done;){var range=_step137.value;var linePos=state.doc.lineAt(range.head).from;if(linePos>last){last=linePos;marks.push(activeLineGutterMarker.range(linePos));}}}catch(err){_iterator137.e(err);}finally{_iterator137.f();}return RangeSet.of(marks);});function highlightActiveLineGutter(){return activeLineGutterHighlighter;}// ../node_modules/@codemirror/language/dist/index.js
var dist_exports={};__export(dist_exports,{DocInput:function DocInput(){return _DocInput;},HighlightStyle:function HighlightStyle(){return _HighlightStyle;},IndentContext:function IndentContext(){return _IndentContext;},LRLanguage:function LRLanguage(){return _LRLanguage;},Language:function Language(){return _Language;},LanguageDescription:function LanguageDescription(){return _LanguageDescription;},LanguageSupport:function LanguageSupport(){return _LanguageSupport;},ParseContext:function ParseContext(){return _ParseContext;},StreamLanguage:function StreamLanguage(){return _StreamLanguage;},StringStream:function StringStream(){return _StringStream;},TreeIndentContext:function TreeIndentContext(){return _TreeIndentContext;},bracketMatching:function bracketMatching(){return _bracketMatching;},bracketMatchingHandle:function bracketMatchingHandle(){return _bracketMatchingHandle;},codeFolding:function codeFolding(){return _codeFolding;},continuedIndent:function continuedIndent(){return _continuedIndent;},defaultHighlightStyle:function defaultHighlightStyle(){return _defaultHighlightStyle;},defineLanguageFacet:function defineLanguageFacet(){return _defineLanguageFacet;},delimitedIndent:function delimitedIndent(){return _delimitedIndent;},ensureSyntaxTree:function ensureSyntaxTree(){return _ensureSyntaxTree;},flatIndent:function flatIndent(){return _flatIndent;},foldAll:function foldAll(){return _foldAll;},foldCode:function foldCode(){return _foldCode;},foldEffect:function foldEffect(){return _foldEffect;},foldGutter:function foldGutter(){return _foldGutter;},foldInside:function foldInside(){return _foldInside;},foldKeymap:function foldKeymap(){return _foldKeymap;},foldNodeProp:function foldNodeProp(){return _foldNodeProp;},foldService:function foldService(){return _foldService;},foldState:function foldState(){return _foldState;},foldable:function foldable(){return _foldable;},foldedRanges:function foldedRanges(){return _foldedRanges;},forceParsing:function forceParsing(){return _forceParsing;},getIndentUnit:function getIndentUnit(){return _getIndentUnit;},getIndentation:function getIndentation(){return _getIndentation;},highlightingFor:function highlightingFor(){return _highlightingFor;},indentNodeProp:function indentNodeProp(){return _indentNodeProp;},indentOnInput:function indentOnInput(){return _indentOnInput;},indentRange:function indentRange(){return _indentRange;},indentService:function indentService(){return _indentService;},indentString:function indentString(){return _indentString;},indentUnit:function indentUnit(){return _indentUnit;},language:function language(){return _language;},languageDataProp:function languageDataProp(){return _languageDataProp;},matchBrackets:function matchBrackets(){return _matchBrackets;},sublanguageProp:function sublanguageProp(){return _sublanguageProp;},syntaxHighlighting:function syntaxHighlighting(){return _syntaxHighlighting;},syntaxParserRunning:function syntaxParserRunning(){return _syntaxParserRunning;},syntaxTree:function syntaxTree(){return _syntaxTree;},syntaxTreeAvailable:function syntaxTreeAvailable(){return _syntaxTreeAvailable;},toggleFold:function toggleFold(){return _toggleFold;},unfoldAll:function unfoldAll(){return _unfoldAll;},unfoldCode:function unfoldCode(){return _unfoldCode;},unfoldEffect:function unfoldEffect(){return _unfoldEffect;}});// ../node_modules/@lezer/common/dist/index.js
var DefaultBufferLength=1024;var nextPropID=0;var Range2=/*#__PURE__*/_createClass(function Range2(from,to){_classCallCheck(this,Range2);this.from=from;this.to=to;});var NodeProp=/*#__PURE__*/function(){function NodeProp(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,NodeProp);this.id=nextPropID++;this.perNode=!!config2.perNode;this.deserialize=config2.deserialize||function(){throw new Error("This node type doesn't define a deserialize function");};}_createClass(NodeProp,[{key:"add",value:function add(match){var _this66=this;if(this.perNode)throw new RangeError("Can't add per-node props to node types");if(typeof match!="function")match=NodeType.match(match);return function(type){var result=match(type);return result===void 0?null:[_this66,result];};}}]);return NodeProp;}();NodeProp.closedBy=new NodeProp({deserialize:function deserialize(str){return str.split(" ");}});NodeProp.openedBy=new NodeProp({deserialize:function deserialize(str){return str.split(" ");}});NodeProp.group=new NodeProp({deserialize:function deserialize(str){return str.split(" ");}});NodeProp.contextHash=new NodeProp({perNode:true});NodeProp.lookAhead=new NodeProp({perNode:true});NodeProp.mounted=new NodeProp({perNode:true});var MountedTree=/*#__PURE__*/function(){function MountedTree(tree,overlay,parser5){_classCallCheck(this,MountedTree);this.tree=tree;this.overlay=overlay;this.parser=parser5;}_createClass(MountedTree,null,[{key:"get",value:function get(tree){return tree&&tree.props&&tree.props[NodeProp.mounted.id];}}]);return MountedTree;}();var noProps=/* @__PURE__ */Object.create(null);var NodeType=/*#__PURE__*/function(){function NodeType(name2,props,id2){var flags=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;_classCallCheck(this,NodeType);this.name=name2;this.props=props;this.id=id2;this.flags=flags;}_createClass(NodeType,[{key:"prop",value:function prop(_prop){return this.props[_prop.id];}},{key:"isTop",get:function get(){return(this.flags&1)>0;}},{key:"isSkipped",get:function get(){return(this.flags&2)>0;}},{key:"isError",get:function get(){return(this.flags&4)>0;}},{key:"isAnonymous",get:function get(){return(this.flags&8)>0;}},{key:"is",value:function is(name2){if(typeof name2=="string"){if(this.name==name2)return true;var group=this.prop(NodeProp.group);return group?group.indexOf(name2)>-1:false;}return this.id==name2;}}],[{key:"define",value:function define(spec){var props=spec.props&&spec.props.length?/* @__PURE__ */Object.create(null):noProps;var flags=(spec.top?1:0)|(spec.skipped?2:0)|(spec.error?4:0)|(spec.name==null?8:0);var type=new NodeType(spec.name||"",props,spec.id,flags);if(spec.props){var _iterator138=_createForOfIteratorHelper(spec.props),_step138;try{for(_iterator138.s();!(_step138=_iterator138.n()).done;){var src=_step138.value;if(!Array.isArray(src))src=src(type);if(src){if(src[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");props[src[0].id]=src[1];}}}catch(err){_iterator138.e(err);}finally{_iterator138.f();}}return type;}},{key:"match",value:function match(map){var direct=/* @__PURE__ */Object.create(null);for(var prop in map){var _iterator139=_createForOfIteratorHelper(prop.split(" ")),_step139;try{for(_iterator139.s();!(_step139=_iterator139.n()).done;){var name2=_step139.value;direct[name2]=map[prop];}}catch(err){_iterator139.e(err);}finally{_iterator139.f();}}return function(node){for(var groups=node.prop(NodeProp.group),_i118=-1;_i118<(groups?groups.length:0);_i118++){var found=direct[_i118<0?node.name:groups[_i118]];if(found)return found;}};}}]);return NodeType;}();NodeType.none=new NodeType("",/* @__PURE__ */Object.create(null),0,8);var NodeSet=/*#__PURE__*/function(){function NodeSet(types2){_classCallCheck(this,NodeSet);this.types=types2;for(var _i119=0;_i119<types2.length;_i119++){if(types2[_i119].id!=_i119)throw new RangeError("Node type ids should correspond to array positions when creating a node set");}}_createClass(NodeSet,[{key:"extend",value:function extend(){var newTypes=[];for(var _len7=arguments.length,props=new Array(_len7),_key5=0;_key5<_len7;_key5++){props[_key5]=arguments[_key5];}var _iterator140=_createForOfIteratorHelper(this.types),_step140;try{for(_iterator140.s();!(_step140=_iterator140.n()).done;){var type=_step140.value;var newProps=null;var _iterator141=_createForOfIteratorHelper(props),_step141;try{for(_iterator141.s();!(_step141=_iterator141.n()).done;){var source=_step141.value;var add2=source(type);if(add2){if(!newProps)newProps=Object.assign({},type.props);newProps[add2[0].id]=add2[1];}}}catch(err){_iterator141.e(err);}finally{_iterator141.f();}newTypes.push(newProps?new NodeType(type.name,newProps,type.id,type.flags):type);}}catch(err){_iterator140.e(err);}finally{_iterator140.f();}return new NodeSet(newTypes);}}]);return NodeSet;}();var CachedNode=/* @__PURE__ */new WeakMap();var CachedInnerNode=/* @__PURE__ */new WeakMap();var IterMode;(function(IterMode2){IterMode2[IterMode2["ExcludeBuffers"]=1]="ExcludeBuffers";IterMode2[IterMode2["IncludeAnonymous"]=2]="IncludeAnonymous";IterMode2[IterMode2["IgnoreMounts"]=4]="IgnoreMounts";IterMode2[IterMode2["IgnoreOverlays"]=8]="IgnoreOverlays";})(IterMode||(IterMode={}));var Tree=/*#__PURE__*/function(){function Tree(type,children,positions,length,props){_classCallCheck(this,Tree);this.type=type;this.children=children;this.positions=positions;this.length=length;this.props=null;if(props&&props.length){this.props=/* @__PURE__ */Object.create(null);var _iterator142=_createForOfIteratorHelper(props),_step142;try{for(_iterator142.s();!(_step142=_iterator142.n()).done;){var _step142$value=_slicedToArray(_step142.value,2),prop=_step142$value[0],value=_step142$value[1];this.props[typeof prop=="number"?prop:prop.id]=value;}}catch(err){_iterator142.e(err);}finally{_iterator142.f();}}}_createClass(Tree,[{key:"toString",value:function toString(){var mounted=MountedTree.get(this);if(mounted&&!mounted.overlay)return mounted.tree.toString();var children="";var _iterator143=_createForOfIteratorHelper(this.children),_step143;try{for(_iterator143.s();!(_step143=_iterator143.n()).done;){var ch=_step143.value;var str=ch.toString();if(str){if(children)children+=",";children+=str;}}}catch(err){_iterator143.e(err);}finally{_iterator143.f();}return!this.type.name?children:(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(children.length?"("+children+")":"");}},{key:"cursor",value:function cursor(){var mode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new TreeCursor(this.topNode,mode);}},{key:"cursorAt",value:function cursorAt(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var scope=CachedNode.get(this)||this.topNode;var cursor2=new TreeCursor(scope);cursor2.moveTo(pos,side);CachedNode.set(this,cursor2._tree);return cursor2;}},{key:"topNode",get:function get(){return new TreeNode(this,0,0,null);}},{key:"resolve",value:function resolve(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var node=resolveNode(CachedNode.get(this)||this.topNode,pos,side,false);CachedNode.set(this,node);return node;}},{key:"resolveInner",value:function resolveInner(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var node=resolveNode(CachedInnerNode.get(this)||this.topNode,pos,side,true);CachedInnerNode.set(this,node);return node;}},{key:"resolveStack",value:function resolveStack(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return stackIterator(this,pos,side);}},{key:"iterate",value:function iterate(spec){var enter=spec.enter,leave=spec.leave,_spec$from=spec.from,from=_spec$from===void 0?0:_spec$from,_spec$to2=spec.to,to=_spec$to2===void 0?this.length:_spec$to2;var mode=spec.mode||0,anon=(mode&IterMode.IncludeAnonymous)>0;for(var c=this.cursor(mode|IterMode.IncludeAnonymous);;){var entered=false;if(c.from<=to&&c.to>=from&&(!anon&&c.type.isAnonymous||enter(c)!==false)){if(c.firstChild())continue;entered=true;}for(;;){if(entered&&leave&&(anon||!c.type.isAnonymous))leave(c);if(c.nextSibling())break;if(!c.parent())return;entered=true;}}}},{key:"prop",value:function prop(_prop2){return!_prop2.perNode?this.type.prop(_prop2):this.props?this.props[_prop2.id]:void 0;}},{key:"propValues",get:function get(){var result=[];if(this.props)for(var id2 in this.props){result.push([+id2,this.props[id2]]);}return result;}},{key:"balance",value:function balance(){var _this67=this;var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,function(children,positions,length){return new Tree(_this67.type,children,positions,length,_this67.propValues);},config2.makeTree||function(children,positions,length){return new Tree(NodeType.none,children,positions,length);});}}],[{key:"build",value:function build(data2){return buildTree(data2);}}]);return Tree;}();Tree.empty=new Tree(NodeType.none,[],[],0);var FlatBufferCursor=/*#__PURE__*/function(){function FlatBufferCursor(buffer,index){_classCallCheck(this,FlatBufferCursor);this.buffer=buffer;this.index=index;}_createClass(FlatBufferCursor,[{key:"id",get:function get(){return this.buffer[this.index-4];}},{key:"start",get:function get(){return this.buffer[this.index-3];}},{key:"end",get:function get(){return this.buffer[this.index-2];}},{key:"size",get:function get(){return this.buffer[this.index-1];}},{key:"pos",get:function get(){return this.index;}},{key:"next",value:function next(){this.index-=4;}},{key:"fork",value:function fork(){return new FlatBufferCursor(this.buffer,this.index);}}]);return FlatBufferCursor;}();var TreeBuffer=/*#__PURE__*/function(){function TreeBuffer(buffer,length,set){_classCallCheck(this,TreeBuffer);this.buffer=buffer;this.length=length;this.set=set;}_createClass(TreeBuffer,[{key:"type",get:function get(){return NodeType.none;}},{key:"toString",value:function toString(){var result=[];for(var index=0;index<this.buffer.length;){result.push(this.childString(index));index=this.buffer[index+3];}return result.join(",");}},{key:"childString",value:function childString(index){var id2=this.buffer[index],endIndex=this.buffer[index+3];var type=this.set.types[id2],result=type.name;if(/\W/.test(result)&&!type.isError)result=JSON.stringify(result);index+=4;if(endIndex==index)return result;var children=[];while(index<endIndex){children.push(this.childString(index));index=this.buffer[index+3];}return result+"("+children.join(",")+")";}},{key:"findChild",value:function findChild(startIndex,endIndex,dir,pos,side){var buffer=this.buffer,pick=-1;for(var _i120=startIndex;_i120!=endIndex;_i120=buffer[_i120+3]){if(checkSide(side,pos,buffer[_i120+1],buffer[_i120+2])){pick=_i120;if(dir>0)break;}}return pick;}},{key:"slice",value:function slice(startI,endI,from){var b=this.buffer;var copy=new Uint16Array(endI-startI),len=0;for(var _i121=startI,j=0;_i121<endI;){copy[j++]=b[_i121++];copy[j++]=b[_i121++]-from;var to=copy[j++]=b[_i121++]-from;copy[j++]=b[_i121++]-startI;len=Math.max(len,to);}return new TreeBuffer(copy,len,this.set);}}]);return TreeBuffer;}();function checkSide(side,pos,from,to){switch(side){case-2:return from<pos;case-1:return to>=pos&&from<pos;case 0:return from<pos&&to>pos;case 1:return from<=pos&&to>pos;case 2:return to>pos;case 4:return true;}}function resolveNode(node,pos,side,overlays){var _a2;while(node.from==node.to||(side<1?node.from>=pos:node.from>pos)||(side>-1?node.to<=pos:node.to<pos)){var parent=!overlays&&node instanceof TreeNode&&node.index<0?null:node.parent;if(!parent)return node;node=parent;}var mode=overlays?0:IterMode.IgnoreOverlays;if(overlays)for(var scan=node,_parent2=scan.parent;_parent2;scan=_parent2,_parent2=scan.parent){if(scan instanceof TreeNode&&scan.index<0&&((_a2=_parent2.enter(pos,side,mode))===null||_a2===void 0?void 0:_a2.from)!=scan.from)node=_parent2;}for(;;){var inner=node.enter(pos,side,mode);if(!inner)return node;node=inner;}}var BaseNode=/*#__PURE__*/function(){function BaseNode(){_classCallCheck(this,BaseNode);}_createClass(BaseNode,[{key:"cursor",value:function cursor(){var mode=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new TreeCursor(this,mode);}},{key:"getChild",value:function getChild(type){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var r=_getChildren(this,type,before,after);return r.length?r[0]:null;}},{key:"getChildren",value:function getChildren(type){var before=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return _getChildren(this,type,before,after);}},{key:"resolve",value:function resolve(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return resolveNode(this,pos,side,false);}},{key:"resolveInner",value:function resolveInner(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return resolveNode(this,pos,side,true);}},{key:"matchContext",value:function matchContext(context){return matchNodeContext(this,context);}},{key:"enterUnfinishedNodesBefore",value:function enterUnfinishedNodesBefore(pos){var scan=this.childBefore(pos),node=this;while(scan){var last=scan.lastChild;if(!last||last.to!=scan.to)break;if(last.type.isError&&last.from==last.to){node=scan;scan=last.prevSibling;}else{scan=last;}}return node;}},{key:"node",get:function get(){return this;}},{key:"next",get:function get(){return this.parent;}}]);return BaseNode;}();var TreeNode=/*#__PURE__*/function(_BaseNode){_inherits(TreeNode,_BaseNode);var _super27=_createSuper(TreeNode);function TreeNode(_tree,from,index,_parent){var _this68;_classCallCheck(this,TreeNode);_this68=_super27.call(this);_this68._tree=_tree;_this68.from=from;_this68.index=index;_this68._parent=_parent;return _this68;}_createClass(TreeNode,[{key:"type",get:function get(){return this._tree.type;}},{key:"name",get:function get(){return this._tree.type.name;}},{key:"to",get:function get(){return this.from+this._tree.length;}},{key:"nextChild",value:function nextChild(i,dir,pos,side){var mode=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;for(var parent=this;;){for(var _parent$_tree=parent._tree,children=_parent$_tree.children,positions=_parent$_tree.positions,e=dir>0?children.length:-1;i!=e;i+=dir){var next=children[i],start=positions[i]+parent.from;if(!checkSide(side,pos,start,start+next.length))continue;if(next instanceof TreeBuffer){if(mode&IterMode.ExcludeBuffers)continue;var index=next.findChild(0,next.buffer.length,dir,pos-start,side);if(index>-1)return new BufferNode(new BufferContext(parent,next,i,start),null,index);}else if(mode&IterMode.IncludeAnonymous||!next.type.isAnonymous||hasChild(next)){var mounted=void 0;if(!(mode&IterMode.IgnoreMounts)&&(mounted=MountedTree.get(next))&&!mounted.overlay)return new TreeNode(mounted.tree,start,i,parent);var inner=new TreeNode(next,start,i,parent);return mode&IterMode.IncludeAnonymous||!inner.type.isAnonymous?inner:inner.nextChild(dir<0?next.children.length-1:0,dir,pos,side);}}if(mode&IterMode.IncludeAnonymous||!parent.type.isAnonymous)return null;if(parent.index>=0)i=parent.index+dir;else i=dir<0?-1:parent._parent._tree.children.length;parent=parent._parent;if(!parent)return null;}}},{key:"firstChild",get:function get(){return this.nextChild(0,1,0,4);}},{key:"lastChild",get:function get(){return this.nextChild(this._tree.children.length-1,-1,0,4);}},{key:"childAfter",value:function childAfter(pos){return this.nextChild(0,1,pos,2);}},{key:"childBefore",value:function childBefore(pos){return this.nextChild(this._tree.children.length-1,-1,pos,-2);}},{key:"enter",value:function enter(pos,side){var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var mounted;if(!(mode&IterMode.IgnoreOverlays)&&(mounted=MountedTree.get(this._tree))&&mounted.overlay){var rPos=pos-this.from;var _iterator144=_createForOfIteratorHelper(mounted.overlay),_step144;try{for(_iterator144.s();!(_step144=_iterator144.n()).done;){var _step144$value=_step144.value,from=_step144$value.from,to=_step144$value.to;if((side>0?from<=rPos:from<rPos)&&(side<0?to>=rPos:to>rPos))return new TreeNode(mounted.tree,mounted.overlay[0].from+this.from,-1,this);}}catch(err){_iterator144.e(err);}finally{_iterator144.f();}}return this.nextChild(0,1,pos,side,mode);}},{key:"nextSignificantParent",value:function nextSignificantParent(){var val=this;while(val.type.isAnonymous&&val._parent){val=val._parent;}return val;}},{key:"parent",get:function get(){return this._parent?this._parent.nextSignificantParent():null;}},{key:"nextSibling",get:function get(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null;}},{key:"prevSibling",get:function get(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null;}},{key:"tree",get:function get(){return this._tree;}},{key:"toTree",value:function toTree(){return this._tree;}},{key:"toString",value:function toString(){return this._tree.toString();}}]);return TreeNode;}(BaseNode);function _getChildren(node,type,before,after){var cur2=node.cursor(),result=[];if(!cur2.firstChild())return result;if(before!=null){while(!cur2.type.is(before)){if(!cur2.nextSibling())return result;}}for(;;){if(after!=null&&cur2.type.is(after))return result;if(cur2.type.is(type))result.push(cur2.node);if(!cur2.nextSibling())return after==null?result:[];}}function matchNodeContext(node,context){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:context.length-1;for(var _p6=node.parent;i>=0;_p6=_p6.parent){if(!_p6)return false;if(!_p6.type.isAnonymous){if(context[i]&&context[i]!=_p6.name)return false;i--;}}return true;}var BufferContext=/*#__PURE__*/_createClass(function BufferContext(parent,buffer,index,start){_classCallCheck(this,BufferContext);this.parent=parent;this.buffer=buffer;this.index=index;this.start=start;});var BufferNode=/*#__PURE__*/function(_BaseNode2){_inherits(BufferNode,_BaseNode2);var _super28=_createSuper(BufferNode);function BufferNode(context,_parent,index){var _this69;_classCallCheck(this,BufferNode);_this69=_super28.call(this);_this69.context=context;_this69._parent=_parent;_this69.index=index;_this69.type=context.buffer.set.types[context.buffer.buffer[index]];return _this69;}_createClass(BufferNode,[{key:"name",get:function get(){return this.type.name;}},{key:"from",get:function get(){return this.context.start+this.context.buffer.buffer[this.index+1];}},{key:"to",get:function get(){return this.context.start+this.context.buffer.buffer[this.index+2];}},{key:"child",value:function child(dir,pos,side){var buffer=this.context.buffer;var index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.context.start,side);return index<0?null:new BufferNode(this.context,this,index);}},{key:"firstChild",get:function get(){return this.child(1,0,4);}},{key:"lastChild",get:function get(){return this.child(-1,0,4);}},{key:"childAfter",value:function childAfter(pos){return this.child(1,pos,2);}},{key:"childBefore",value:function childBefore(pos){return this.child(-1,pos,-2);}},{key:"enter",value:function enter(pos,side){var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(mode&IterMode.ExcludeBuffers)return null;var buffer=this.context.buffer;var index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],side>0?1:-1,pos-this.context.start,side);return index<0?null:new BufferNode(this.context,this,index);}},{key:"parent",get:function get(){return this._parent||this.context.parent.nextSignificantParent();}},{key:"externalSibling",value:function externalSibling(dir){return this._parent?null:this.context.parent.nextChild(this.context.index+dir,dir,0,4);}},{key:"nextSibling",get:function get(){var buffer=this.context.buffer;var after=buffer.buffer[this.index+3];if(after<(this._parent?buffer.buffer[this._parent.index+3]:buffer.buffer.length))return new BufferNode(this.context,this._parent,after);return this.externalSibling(1);}},{key:"prevSibling",get:function get(){var buffer=this.context.buffer;var parentStart=this._parent?this._parent.index+4:0;if(this.index==parentStart)return this.externalSibling(-1);return new BufferNode(this.context,this._parent,buffer.findChild(parentStart,this.index,-1,0,4));}},{key:"tree",get:function get(){return null;}},{key:"toTree",value:function toTree(){var children=[],positions=[];var buffer=this.context.buffer;var startI=this.index+4,endI=buffer.buffer[this.index+3];if(endI>startI){var from=buffer.buffer[this.index+1];children.push(buffer.slice(startI,endI,from));positions.push(0);}return new Tree(this.type,children,positions,this.to-this.from);}},{key:"toString",value:function toString(){return this.context.buffer.childString(this.index);}}]);return BufferNode;}(BaseNode);function iterStack(heads){if(!heads.length)return null;var pick=0,picked=heads[0];for(var _i122=1;_i122<heads.length;_i122++){var node=heads[_i122];if(node.from>picked.from||node.to<picked.to){picked=node;pick=_i122;}}var next=picked instanceof TreeNode&&picked.index<0?null:picked.parent;var newHeads=heads.slice();if(next)newHeads[pick]=next;else newHeads.splice(pick,1);return new StackIterator(newHeads,picked);}var StackIterator=/*#__PURE__*/function(){function StackIterator(heads,node){_classCallCheck(this,StackIterator);this.heads=heads;this.node=node;}_createClass(StackIterator,[{key:"next",get:function get(){return iterStack(this.heads);}}]);return StackIterator;}();function stackIterator(tree,pos,side){var inner=tree.resolveInner(pos,side),layers=null;for(var scan=inner instanceof TreeNode?inner:inner.context.parent;scan;scan=scan.parent){if(scan.index<0){var parent=scan.parent;(layers||(layers=[inner])).push(parent.resolve(pos,side));scan=parent;}else{var mount=MountedTree.get(scan.tree);if(mount&&mount.overlay&&mount.overlay[0].from<=pos&&mount.overlay[mount.overlay.length-1].to>=pos){var root=new TreeNode(mount.tree,mount.overlay[0].from+scan.from,-1,scan);(layers||(layers=[inner])).push(resolveNode(root,pos,side,false));}}}return layers?iterStack(layers):inner;}var TreeCursor=/*#__PURE__*/function(){function TreeCursor(node){var mode=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;_classCallCheck(this,TreeCursor);this.mode=mode;this.buffer=null;this.stack=[];this.index=0;this.bufferNode=null;if(node instanceof TreeNode){this.yieldNode(node);}else{this._tree=node.context.parent;this.buffer=node.context;for(var n=node._parent;n;n=n._parent){this.stack.unshift(n.index);}this.bufferNode=node;this.yieldBuf(node.index);}}_createClass(TreeCursor,[{key:"name",get:function get(){return this.type.name;}},{key:"yieldNode",value:function yieldNode(node){if(!node)return false;this._tree=node;this.type=node.type;this.from=node.from;this.to=node.to;return true;}},{key:"yieldBuf",value:function yieldBuf(index,type){this.index=index;var _this$buffer=this.buffer,start=_this$buffer.start,buffer=_this$buffer.buffer;this.type=type||buffer.set.types[buffer.buffer[index]];this.from=start+buffer.buffer[index+1];this.to=start+buffer.buffer[index+2];return true;}},{key:"yield",value:function _yield(node){if(!node)return false;if(node instanceof TreeNode){this.buffer=null;return this.yieldNode(node);}this.buffer=node.context;return this.yieldBuf(node.index,node.type);}},{key:"toString",value:function toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString();}},{key:"enterChild",value:function enterChild(dir,pos,side){if(!this.buffer)return this["yield"](this._tree.nextChild(dir<0?this._tree._tree.children.length-1:0,dir,pos,side,this.mode));var buffer=this.buffer.buffer;var index=buffer.findChild(this.index+4,buffer.buffer[this.index+3],dir,pos-this.buffer.start,side);if(index<0)return false;this.stack.push(this.index);return this.yieldBuf(index);}},{key:"firstChild",value:function firstChild(){return this.enterChild(1,0,4);}},{key:"lastChild",value:function lastChild(){return this.enterChild(-1,0,4);}},{key:"childAfter",value:function childAfter(pos){return this.enterChild(1,pos,2);}},{key:"childBefore",value:function childBefore(pos){return this.enterChild(-1,pos,-2);}},{key:"enter",value:function enter(pos,side){var mode=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this.mode;if(!this.buffer)return this["yield"](this._tree.enter(pos,side,mode));return mode&IterMode.ExcludeBuffers?false:this.enterChild(1,pos,side);}},{key:"parent",value:function parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());var parent=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();this.buffer=null;return this.yieldNode(parent);}},{key:"sibling",value:function sibling(dir){if(!this.buffer)return!this._tree._parent?false:this["yield"](this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+dir,dir,0,4,this.mode));var buffer=this.buffer.buffer,d=this.stack.length-1;if(dir<0){var parentStart=d<0?0:this.stack[d]+4;if(this.index!=parentStart)return this.yieldBuf(buffer.findChild(parentStart,this.index,-1,0,4));}else{var after=buffer.buffer[this.index+3];if(after<(d<0?buffer.buffer.length:buffer.buffer[this.stack[d]+3]))return this.yieldBuf(after);}return d<0?this["yield"](this.buffer.parent.nextChild(this.buffer.index+dir,dir,0,4,this.mode)):false;}},{key:"nextSibling",value:function nextSibling(){return this.sibling(1);}},{key:"prevSibling",value:function prevSibling(){return this.sibling(-1);}},{key:"atLastNode",value:function atLastNode(dir){var index,parent,buffer=this.buffer;if(buffer){if(dir>0){if(this.index<buffer.buffer.buffer.length)return false;}else{for(var _i123=0;_i123<this.index;_i123++){if(buffer.buffer.buffer[_i123+3]<this.index)return false;}}index=buffer.index;parent=buffer.parent;}else{var _this$_tree=this._tree;index=_this$_tree.index;parent=_this$_tree._parent;}for(;parent;_parent3=parent,index=_parent3.index,parent=_parent3._parent,_parent3){var _parent3;if(index>-1)for(var _i124=index+dir,e=dir<0?-1:parent._tree.children.length;_i124!=e;_i124+=dir){var child=parent._tree.children[_i124];if(this.mode&IterMode.IncludeAnonymous||child instanceof TreeBuffer||!child.type.isAnonymous||hasChild(child))return false;}}return true;}},{key:"move",value:function move(dir,enter){if(enter&&this.enterChild(dir,0,4))return true;for(;;){if(this.sibling(dir))return true;if(this.atLastNode(dir)||!this.parent())return false;}}},{key:"next",value:function next(){var enter=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return this.move(1,enter);}},{key:"prev",value:function prev(){var enter=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;return this.move(-1,enter);}},{key:"moveTo",value:function moveTo(pos){var side=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;while(this.from==this.to||(side<1?this.from>=pos:this.from>pos)||(side>-1?this.to<=pos:this.to<pos)){if(!this.parent())break;}while(this.enterChild(1,pos,side)){}return this;}},{key:"node",get:function get(){if(!this.buffer)return this._tree;var cache2=this.bufferNode,result=null,depth=0;if(cache2&&cache2.context==this.buffer){scan:for(var index=this.index,d=this.stack.length;d>=0;){for(var c=cache2;c;c=c._parent){if(c.index==index){if(index==this.index)return c;result=c;depth=d+1;break scan;}}index=this.stack[--d];}}for(var _i125=depth;_i125<this.stack.length;_i125++){result=new BufferNode(this.buffer,result,this.stack[_i125]);}return this.bufferNode=new BufferNode(this.buffer,result,this.index);}},{key:"tree",get:function get(){return this.buffer?null:this._tree._tree;}},{key:"iterate",value:function iterate(enter,leave){for(var depth=0;;){var mustLeave=false;if(this.type.isAnonymous||enter(this)!==false){if(this.firstChild()){depth++;continue;}if(!this.type.isAnonymous)mustLeave=true;}for(;;){if(mustLeave&&leave)leave(this);mustLeave=this.type.isAnonymous;if(this.nextSibling())break;if(!depth)return;this.parent();depth--;mustLeave=true;}}}},{key:"matchContext",value:function matchContext(context){if(!this.buffer)return matchNodeContext(this.node,context);var buffer=this.buffer.buffer,types2=buffer.set.types;for(var _i126=context.length-1,d=this.stack.length-1;_i126>=0;d--){if(d<0)return matchNodeContext(this.node,context,_i126);var type=types2[buffer.buffer[this.stack[d]]];if(!type.isAnonymous){if(context[_i126]&&context[_i126]!=type.name)return false;_i126--;}}return true;}}]);return TreeCursor;}();function hasChild(tree){return tree.children.some(function(ch){return ch instanceof TreeBuffer||!ch.type.isAnonymous||hasChild(ch);});}function buildTree(data2){var _a2;var buffer=data2.buffer,nodeSet2=data2.nodeSet,_data2$maxBufferLengt=data2.maxBufferLength,maxBufferLength=_data2$maxBufferLengt===void 0?DefaultBufferLength:_data2$maxBufferLengt,_data2$reused=data2.reused,reused=_data2$reused===void 0?[]:_data2$reused,_data2$minRepeatType=data2.minRepeatType,minRepeatType=_data2$minRepeatType===void 0?nodeSet2.types.length:_data2$minRepeatType;var cursor2=Array.isArray(buffer)?new FlatBufferCursor(buffer,buffer.length):buffer;var types2=nodeSet2.types;var contextHash=0,lookAhead=0;function takeNode(parentStart,minPos,children2,positions2,inRepeat,depth){var id2=cursor2.id,start=cursor2.start,end=cursor2.end,size=cursor2.size;var lookAheadAtStart=lookAhead;while(size<0){cursor2.next();if(size==-1){var node2=reused[id2];children2.push(node2);positions2.push(start-parentStart);return;}else if(size==-3){contextHash=id2;return;}else if(size==-4){lookAhead=id2;return;}else{throw new RangeError("Unrecognized record size: ".concat(size));}}var type=types2[id2],node,buffer2;var startPos=start-parentStart;if(end-start<=maxBufferLength&&(buffer2=findBufferSize(cursor2.pos-minPos,inRepeat))){var data3=new Uint16Array(buffer2.size-buffer2.skip);var endPos=cursor2.pos-buffer2.size,index=data3.length;while(cursor2.pos>endPos){index=copyToBuffer(buffer2.start,data3,index);}node=new TreeBuffer(data3,end-buffer2.start,nodeSet2);startPos=buffer2.start-parentStart;}else{var _endPos=cursor2.pos-size;cursor2.next();var localChildren=[],localPositions=[];var localInRepeat=id2>=minRepeatType?id2:-1;var lastGroup=0,lastEnd=end;while(cursor2.pos>_endPos){if(localInRepeat>=0&&cursor2.id==localInRepeat&&cursor2.size>=0){if(cursor2.end<=lastEnd-maxBufferLength){makeRepeatLeaf(localChildren,localPositions,start,lastGroup,cursor2.end,lastEnd,localInRepeat,lookAheadAtStart);lastGroup=localChildren.length;lastEnd=cursor2.end;}cursor2.next();}else if(depth>2500){takeFlatNode(start,_endPos,localChildren,localPositions);}else{takeNode(start,_endPos,localChildren,localPositions,localInRepeat,depth+1);}}if(localInRepeat>=0&&lastGroup>0&&lastGroup<localChildren.length)makeRepeatLeaf(localChildren,localPositions,start,lastGroup,start,lastEnd,localInRepeat,lookAheadAtStart);localChildren.reverse();localPositions.reverse();if(localInRepeat>-1&&lastGroup>0){var make=makeBalanced(type);node=balanceRange(type,localChildren,localPositions,0,localChildren.length,0,end-start,make,make);}else{node=makeTree(type,localChildren,localPositions,end-start,lookAheadAtStart-end);}}children2.push(node);positions2.push(startPos);}function takeFlatNode(parentStart,minPos,children2,positions2){var nodes=[];var nodeCount=0,stopAt=-1;while(cursor2.pos>minPos){var id2=cursor2.id,start=cursor2.start,end=cursor2.end,size=cursor2.size;if(size>4){cursor2.next();}else if(stopAt>-1&&start<stopAt){break;}else{if(stopAt<0)stopAt=end-maxBufferLength;nodes.push(id2,start,end);nodeCount++;cursor2.next();}}if(nodeCount){var buffer2=new Uint16Array(nodeCount*4);var _start3=nodes[nodes.length-2];for(var _i127=nodes.length-3,j=0;_i127>=0;_i127-=3){buffer2[j++]=nodes[_i127];buffer2[j++]=nodes[_i127+1]-_start3;buffer2[j++]=nodes[_i127+2]-_start3;buffer2[j++]=j;}children2.push(new TreeBuffer(buffer2,nodes[2]-_start3,nodeSet2));positions2.push(_start3-parentStart);}}function makeBalanced(type){return function(children2,positions2,length2){var lookAhead2=0,lastI=children2.length-1,last,lookAheadProp;if(lastI>=0&&(last=children2[lastI])instanceof Tree){if(!lastI&&last.type==type&&last.length==length2)return last;if(lookAheadProp=last.prop(NodeProp.lookAhead))lookAhead2=positions2[lastI]+last.length+lookAheadProp;}return makeTree(type,children2,positions2,length2,lookAhead2);};}function makeRepeatLeaf(children2,positions2,base2,i,from,to,type,lookAhead2){var localChildren=[],localPositions=[];while(children2.length>i){localChildren.push(children2.pop());localPositions.push(positions2.pop()+base2-from);}children2.push(makeTree(nodeSet2.types[type],localChildren,localPositions,to-from,lookAhead2-to));positions2.push(from-base2);}function makeTree(type,children2,positions2,length2){var lookAhead2=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var props=arguments.length>5?arguments[5]:undefined;if(contextHash){var pair2=[NodeProp.contextHash,contextHash];props=props?[pair2].concat(props):[pair2];}if(lookAhead2>25){var _pair=[NodeProp.lookAhead,lookAhead2];props=props?[_pair].concat(props):[_pair];}return new Tree(type,children2,positions2,length2,props);}function findBufferSize(maxSize,inRepeat){var fork=cursor2.fork();var size=0,start=0,skip=0,minStart=fork.end-maxBufferLength;var result={size:0,start:0,skip:0};scan:for(var minPos=fork.pos-maxSize;fork.pos>minPos;){var nodeSize2=fork.size;if(fork.id==inRepeat&&nodeSize2>=0){result.size=size;result.start=start;result.skip=skip;skip+=4;size+=4;fork.next();continue;}var startPos=fork.pos-nodeSize2;if(nodeSize2<0||startPos<minPos||fork.start<minStart)break;var localSkipped=fork.id>=minRepeatType?4:0;var nodeStart2=fork.start;fork.next();while(fork.pos>startPos){if(fork.size<0){if(fork.size==-3)localSkipped+=4;else break scan;}else if(fork.id>=minRepeatType){localSkipped+=4;}fork.next();}start=nodeStart2;size+=nodeSize2;skip+=localSkipped;}if(inRepeat<0||size==maxSize){result.size=size;result.start=start;result.skip=skip;}return result.size>4?result:void 0;}function copyToBuffer(bufferStart,buffer2,index){var id2=cursor2.id,start=cursor2.start,end=cursor2.end,size=cursor2.size;cursor2.next();if(size>=0&&id2<minRepeatType){var startIndex=index;if(size>4){var endPos=cursor2.pos-(size-4);while(cursor2.pos>endPos){index=copyToBuffer(bufferStart,buffer2,index);}}buffer2[--index]=startIndex;buffer2[--index]=end-bufferStart;buffer2[--index]=start-bufferStart;buffer2[--index]=id2;}else if(size==-3){contextHash=id2;}else if(size==-4){lookAhead=id2;}return index;}var children=[],positions=[];while(cursor2.pos>0){takeNode(data2.start||0,data2.bufferStart||0,children,positions,-1,0);}var length=(_a2=data2.length)!==null&&_a2!==void 0?_a2:children.length?positions[0]+children[0].length:0;return new Tree(types2[data2.topID],children.reverse(),positions.reverse(),length);}var nodeSizeCache=/* @__PURE__ */new WeakMap();function nodeSize(balanceType,node){if(!balanceType.isAnonymous||node instanceof TreeBuffer||node.type!=balanceType)return 1;var size=nodeSizeCache.get(node);if(size==null){size=1;var _iterator145=_createForOfIteratorHelper(node.children),_step145;try{for(_iterator145.s();!(_step145=_iterator145.n()).done;){var child=_step145.value;if(child.type!=balanceType||!(child instanceof Tree)){size=1;break;}size+=nodeSize(balanceType,child);}}catch(err){_iterator145.e(err);}finally{_iterator145.f();}nodeSizeCache.set(node,size);}return size;}function balanceRange(balanceType,children,positions,from,to,start,length,mkTop,mkTree){var total=0;for(var _i128=from;_i128<to;_i128++){total+=nodeSize(balanceType,children[_i128]);}var maxChild=Math.ceil(total*1.5/8);var localChildren=[],localPositions=[];function divide(children2,positions2,from2,to2,offset){for(var _i129=from2;_i129<to2;){var groupFrom=_i129,groupStart=positions2[_i129],groupSize=nodeSize(balanceType,children2[_i129]);_i129++;for(;_i129<to2;_i129++){var nextSize=nodeSize(balanceType,children2[_i129]);if(groupSize+nextSize>=maxChild)break;groupSize+=nextSize;}if(_i129==groupFrom+1){if(groupSize>maxChild){var only=children2[groupFrom];divide(only.children,only.positions,0,only.children.length,positions2[groupFrom]+offset);continue;}localChildren.push(children2[groupFrom]);}else{var length2=positions2[_i129-1]+children2[_i129-1].length-groupStart;localChildren.push(balanceRange(balanceType,children2,positions2,groupFrom,_i129,groupStart,length2,null,mkTree));}localPositions.push(groupStart+offset-start);}}divide(children,positions,from,to,0);return(mkTop||mkTree)(localChildren,localPositions,length);}var NodeWeakMap=/*#__PURE__*/function(){function NodeWeakMap(){_classCallCheck(this,NodeWeakMap);this.map=/* @__PURE__ */new WeakMap();}_createClass(NodeWeakMap,[{key:"setBuffer",value:function setBuffer(buffer,index,value){var inner=this.map.get(buffer);if(!inner)this.map.set(buffer,inner=/* @__PURE__ */new Map());inner.set(index,value);}},{key:"getBuffer",value:function getBuffer(buffer,index){var inner=this.map.get(buffer);return inner&&inner.get(index);}},{key:"set",value:function set(node,value){if(node instanceof BufferNode)this.setBuffer(node.context.buffer,node.index,value);else if(node instanceof TreeNode)this.map.set(node.tree,value);}},{key:"get",value:function get(node){return node instanceof BufferNode?this.getBuffer(node.context.buffer,node.index):node instanceof TreeNode?this.map.get(node.tree):void 0;}},{key:"cursorSet",value:function cursorSet(cursor2,value){if(cursor2.buffer)this.setBuffer(cursor2.buffer.buffer,cursor2.index,value);else this.map.set(cursor2.tree,value);}},{key:"cursorGet",value:function cursorGet(cursor2){return cursor2.buffer?this.getBuffer(cursor2.buffer.buffer,cursor2.index):this.map.get(cursor2.tree);}}]);return NodeWeakMap;}();var TreeFragment=/*#__PURE__*/function(){function TreeFragment(from,to,tree,offset){var openStart=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;var openEnd=arguments.length>5&&arguments[5]!==undefined?arguments[5]:false;_classCallCheck(this,TreeFragment);this.from=from;this.to=to;this.tree=tree;this.offset=offset;this.open=(openStart?1:0)|(openEnd?2:0);}_createClass(TreeFragment,[{key:"openStart",get:function get(){return(this.open&1)>0;}},{key:"openEnd",get:function get(){return(this.open&2)>0;}}],[{key:"addTree",value:function addTree(tree){var fragments=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var partial=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var result=[new TreeFragment(0,tree.length,tree,0,false,partial)];var _iterator146=_createForOfIteratorHelper(fragments),_step146;try{for(_iterator146.s();!(_step146=_iterator146.n()).done;){var f=_step146.value;if(f.to>tree.length)result.push(f);}}catch(err){_iterator146.e(err);}finally{_iterator146.f();}return result;}},{key:"applyChanges",value:function applyChanges(fragments,changes){var minGap=arguments.length>2&&arguments[2]!==undefined?arguments[2]:128;if(!changes.length)return fragments;var result=[];var fI=1,nextF=fragments.length?fragments[0]:null;for(var cI=0,pos=0,off=0;;cI++){var nextC=cI<changes.length?changes[cI]:null;var nextPos=nextC?nextC.fromA:1e9;if(nextPos-pos>=minGap)while(nextF&&nextF.from<nextPos){var cut=nextF;if(pos>=cut.from||nextPos<=cut.to||off){var fFrom=Math.max(cut.from,pos)-off,fTo=Math.min(cut.to,nextPos)-off;cut=fFrom>=fTo?null:new TreeFragment(fFrom,fTo,cut.tree,cut.offset+off,cI>0,!!nextC);}if(cut)result.push(cut);if(nextF.to>nextPos)break;nextF=fI<fragments.length?fragments[fI++]:null;}if(!nextC)break;pos=nextC.toA;off=nextC.toA-nextC.toB;}return result;}}]);return TreeFragment;}();var Parser=/*#__PURE__*/function(){function Parser(){_classCallCheck(this,Parser);}_createClass(Parser,[{key:"startParse",value:function startParse(input,fragments,ranges){if(typeof input=="string")input=new StringInput(input);ranges=!ranges?[new Range2(0,input.length)]:ranges.length?ranges.map(function(r){return new Range2(r.from,r.to);}):[new Range2(0,0)];return this.createParse(input,fragments||[],ranges);}},{key:"parse",value:function parse(input,fragments,ranges){var parse=this.startParse(input,fragments,ranges);for(;;){var done=parse.advance();if(done)return done;}}}]);return Parser;}();var StringInput=/*#__PURE__*/function(){function StringInput(string2){_classCallCheck(this,StringInput);this.string=string2;}_createClass(StringInput,[{key:"length",get:function get(){return this.string.length;}},{key:"chunk",value:function chunk(from){return this.string.slice(from);}},{key:"lineChunks",get:function get(){return false;}},{key:"read",value:function read(from,to){return this.string.slice(from,to);}}]);return StringInput;}();function parseMixed(nest){return function(parse,input,fragments,ranges){return new MixedParse(parse,nest,input,fragments,ranges);};}var InnerParse=/*#__PURE__*/_createClass(function InnerParse(parser5,parse,overlay,target,from){_classCallCheck(this,InnerParse);this.parser=parser5;this.parse=parse;this.overlay=overlay;this.target=target;this.from=from;});function checkRanges(ranges){if(!ranges.length||ranges.some(function(r){return r.from>=r.to;}))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(ranges));}var ActiveOverlay=/*#__PURE__*/_createClass(function ActiveOverlay(parser5,predicate,mounts,index,start,target,prev){_classCallCheck(this,ActiveOverlay);this.parser=parser5;this.predicate=predicate;this.mounts=mounts;this.index=index;this.start=start;this.target=target;this.prev=prev;this.depth=0;this.ranges=[];});var stoppedInner=new NodeProp({perNode:true});var MixedParse=/*#__PURE__*/function(){function MixedParse(base2,nest,input,fragments,ranges){_classCallCheck(this,MixedParse);this.nest=nest;this.input=input;this.fragments=fragments;this.ranges=ranges;this.inner=[];this.innerDone=0;this.baseTree=null;this.stoppedAt=null;this.baseParse=base2;}_createClass(MixedParse,[{key:"advance",value:function advance(){if(this.baseParse){var done2=this.baseParse.advance();if(!done2)return null;this.baseParse=null;this.baseTree=done2;this.startInner();if(this.stoppedAt!=null){var _iterator147=_createForOfIteratorHelper(this.inner),_step147;try{for(_iterator147.s();!(_step147=_iterator147.n()).done;){var inner2=_step147.value;inner2.parse.stopAt(this.stoppedAt);}}catch(err){_iterator147.e(err);}finally{_iterator147.f();}}}if(this.innerDone==this.inner.length){var result=this.baseTree;if(this.stoppedAt!=null)result=new Tree(result.type,result.children,result.positions,result.length,result.propValues.concat([[stoppedInner,this.stoppedAt]]));return result;}var inner=this.inner[this.innerDone],done=inner.parse.advance();if(done){this.innerDone++;var props=Object.assign(/* @__PURE__ */Object.create(null),inner.target.props);props[NodeProp.mounted.id]=new MountedTree(done,inner.overlay,inner.parser);inner.target.props=props;}return null;}},{key:"parsedPos",get:function get(){if(this.baseParse)return 0;var pos=this.input.length;for(var _i130=this.innerDone;_i130<this.inner.length;_i130++){if(this.inner[_i130].from<pos)pos=Math.min(pos,this.inner[_i130].parse.parsedPos);}return pos;}},{key:"stopAt",value:function stopAt(pos){this.stoppedAt=pos;if(this.baseParse)this.baseParse.stopAt(pos);else for(var _i131=this.innerDone;_i131<this.inner.length;_i131++){this.inner[_i131].parse.stopAt(pos);}}},{key:"startInner",value:function startInner(){var fragmentCursor=new FragmentCursor(this.fragments);var overlay=null;var covered=null;var cursor2=new TreeCursor(new TreeNode(this.baseTree,this.ranges[0].from,0,null),IterMode.IncludeAnonymous|IterMode.IgnoreMounts);scan:for(var nest,isCovered;;){var enter=true,range=void 0;if(this.stoppedAt!=null&&cursor2.from>=this.stoppedAt){enter=false;}else if(fragmentCursor.hasNode(cursor2)){if(overlay){var match=overlay.mounts.find(function(m){return m.frag.from<=cursor2.from&&m.frag.to>=cursor2.to&&m.mount.overlay;});if(match){var _iterator148=_createForOfIteratorHelper(match.mount.overlay),_step148;try{var _loop10=function _loop10(){var r=_step148.value;var from=r.from+match.pos,to=r.to+match.pos;if(from>=cursor2.from&&to<=cursor2.to&&!overlay.ranges.some(function(r2){return r2.from<to&&r2.to>from;}))overlay.ranges.push({from:from,to:to});};for(_iterator148.s();!(_step148=_iterator148.n()).done;){_loop10();}}catch(err){_iterator148.e(err);}finally{_iterator148.f();}}}enter=false;}else if(covered&&(isCovered=checkCover(covered.ranges,cursor2.from,cursor2.to))){enter=isCovered!=2;}else if(!cursor2.type.isAnonymous&&(nest=this.nest(cursor2,this.input))&&(cursor2.from<cursor2.to||!nest.overlay)){if(!cursor2.tree)materialize(cursor2);var oldMounts=fragmentCursor.findMounts(cursor2.from,nest.parser);if(typeof nest.overlay=="function"){overlay=new ActiveOverlay(nest.parser,nest.overlay,oldMounts,this.inner.length,cursor2.from,cursor2.tree,overlay);}else{var ranges=punchRanges(this.ranges,nest.overlay||(cursor2.from<cursor2.to?[new Range2(cursor2.from,cursor2.to)]:[]));if(ranges.length)checkRanges(ranges);if(ranges.length||!nest.overlay)this.inner.push(new InnerParse(nest.parser,ranges.length?nest.parser.startParse(this.input,enterFragments(oldMounts,ranges),ranges):nest.parser.startParse(""),nest.overlay?nest.overlay.map(function(r){return new Range2(r.from-cursor2.from,r.to-cursor2.from);}):null,cursor2.tree,ranges.length?ranges[0].from:cursor2.from));if(!nest.overlay)enter=false;else if(ranges.length)covered={ranges:ranges,depth:0,prev:covered};}}else if(overlay&&(range=overlay.predicate(cursor2))){if(range===true)range=new Range2(cursor2.from,cursor2.to);if(range.from<range.to)overlay.ranges.push(range);}if(enter&&cursor2.firstChild()){if(overlay)overlay.depth++;if(covered)covered.depth++;}else{for(;;){if(cursor2.nextSibling())break;if(!cursor2.parent())break scan;if(overlay&&! --overlay.depth){var _ranges=punchRanges(this.ranges,overlay.ranges);if(_ranges.length){checkRanges(_ranges);this.inner.splice(overlay.index,0,new InnerParse(overlay.parser,overlay.parser.startParse(this.input,enterFragments(overlay.mounts,_ranges),_ranges),overlay.ranges.map(function(r){return new Range2(r.from-overlay.start,r.to-overlay.start);}),overlay.target,_ranges[0].from));}overlay=overlay.prev;}if(covered&&! --covered.depth)covered=covered.prev;}}}}}]);return MixedParse;}();function checkCover(covered,from,to){var _iterator149=_createForOfIteratorHelper(covered),_step149;try{for(_iterator149.s();!(_step149=_iterator149.n()).done;){var range=_step149.value;if(range.from>=to)break;if(range.to>from)return range.from<=from&&range.to>=to?2:1;}}catch(err){_iterator149.e(err);}finally{_iterator149.f();}return 0;}function sliceBuf(buf,startI,endI,nodes,positions,off){if(startI<endI){var from=buf.buffer[startI+1];nodes.push(buf.slice(startI,endI,from));positions.push(from-off);}}function materialize(cursor2){var node=cursor2.node,stack=[];do{stack.push(cursor2.index);cursor2.parent();}while(!cursor2.tree);var i=0,base2=cursor2.tree,off=0;for(;;i++){off=base2.positions[i]+cursor2.from;if(off<=node.from&&off+base2.children[i].length>=node.to)break;}var buf=base2.children[i],b=buf.buffer,newStack=[i];function split(startI,endI,type,innerOffset,length,stackPos){var targetI=stack[stackPos];var children=[],positions=[];sliceBuf(buf,startI,targetI,children,positions,innerOffset);var from=b[targetI+1],to=b[targetI+2];newStack.push(children.length);var child=stackPos?split(targetI+4,b[targetI+3],buf.set.types[b[targetI]],from,to-from,stackPos-1):node.toTree();children.push(child);positions.push(from-innerOffset);sliceBuf(buf,b[targetI+3],endI,children,positions,innerOffset);return new Tree(type,children,positions,length);}base2.children[i]=split(0,b.length,NodeType.none,0,buf.length,stack.length-1);for(var _i132=0,_newStack=newStack;_i132<_newStack.length;_i132++){var index=_newStack[_i132];var tree=cursor2.tree.children[index],pos=cursor2.tree.positions[index];cursor2["yield"](new TreeNode(tree,pos+cursor2.from,index,cursor2._tree));}}var StructureCursor=/*#__PURE__*/function(){function StructureCursor(root,offset){_classCallCheck(this,StructureCursor);this.offset=offset;this.done=false;this.cursor=root.cursor(IterMode.IncludeAnonymous|IterMode.IgnoreMounts);}_createClass(StructureCursor,[{key:"moveTo",value:function moveTo(pos){var cursor2=this.cursor,p=pos-this.offset;while(!this.done&&cursor2.from<p){if(cursor2.to>=pos&&cursor2.enter(p,1,IterMode.IgnoreOverlays|IterMode.ExcludeBuffers));else if(!cursor2.next(false))this.done=true;}}},{key:"hasNode",value:function hasNode(cursor2){this.moveTo(cursor2.from);if(!this.done&&this.cursor.from+this.offset==cursor2.from&&this.cursor.tree){for(var tree=this.cursor.tree;;){if(tree==cursor2.tree)return true;if(tree.children.length&&tree.positions[0]==0&&tree.children[0]instanceof Tree)tree=tree.children[0];else break;}}return false;}}]);return StructureCursor;}();var FragmentCursor=/*#__PURE__*/function(){function FragmentCursor(fragments){_classCallCheck(this,FragmentCursor);var _a2;this.fragments=fragments;this.curTo=0;this.fragI=0;if(fragments.length){var first=this.curFrag=fragments[0];this.curTo=(_a2=first.tree.prop(stoppedInner))!==null&&_a2!==void 0?_a2:first.to;this.inner=new StructureCursor(first.tree,-first.offset);}else{this.curFrag=this.inner=null;}}_createClass(FragmentCursor,[{key:"hasNode",value:function hasNode(node){while(this.curFrag&&node.from>=this.curTo){this.nextFrag();}return this.curFrag&&this.curFrag.from<=node.from&&this.curTo>=node.to&&this.inner.hasNode(node);}},{key:"nextFrag",value:function nextFrag(){var _a2;this.fragI++;if(this.fragI==this.fragments.length){this.curFrag=this.inner=null;}else{var frag=this.curFrag=this.fragments[this.fragI];this.curTo=(_a2=frag.tree.prop(stoppedInner))!==null&&_a2!==void 0?_a2:frag.to;this.inner=new StructureCursor(frag.tree,-frag.offset);}}},{key:"findMounts",value:function findMounts(pos,parser5){var _a2;var result=[];if(this.inner){this.inner.cursor.moveTo(pos,1);for(var pos2=this.inner.cursor.node;pos2;pos2=pos2.parent){var mount=(_a2=pos2.tree)===null||_a2===void 0?void 0:_a2.prop(NodeProp.mounted);if(mount&&mount.parser==parser5){for(var _i133=this.fragI;_i133<this.fragments.length;_i133++){var frag=this.fragments[_i133];if(frag.from>=pos2.to)break;if(frag.tree==this.curFrag.tree)result.push({frag:frag,pos:pos2.from-frag.offset,mount:mount});}}}}return result;}}]);return FragmentCursor;}();function punchRanges(outer,ranges){var copy=null,current=ranges;for(var _i134=1,j=0;_i134<outer.length;_i134++){var gapFrom=outer[_i134-1].to,gapTo=outer[_i134].from;for(;j<current.length;j++){var _r6=current[j];if(_r6.from>=gapTo)break;if(_r6.to<=gapFrom)continue;if(!copy)current=copy=ranges.slice();if(_r6.from<gapFrom){copy[j]=new Range2(_r6.from,gapFrom);if(_r6.to>gapTo)copy.splice(j+1,0,new Range2(gapTo,_r6.to));}else if(_r6.to>gapTo){copy[j--]=new Range2(gapTo,_r6.to);}else{copy.splice(j--,1);}}}return current;}function findCoverChanges(a,b,from,to){var iA=0,iB=0,inA=false,inB=false,pos=-1e9;var result=[];for(;;){var nextA=iA==a.length?1e9:inA?a[iA].to:a[iA].from;var nextB=iB==b.length?1e9:inB?b[iB].to:b[iB].from;if(inA!=inB){var start=Math.max(pos,from),end=Math.min(nextA,nextB,to);if(start<end)result.push(new Range2(start,end));}pos=Math.min(nextA,nextB);if(pos==1e9)break;if(nextA==pos){if(!inA)inA=true;else{inA=false;iA++;}}if(nextB==pos){if(!inB)inB=true;else{inB=false;iB++;}}}return result;}function enterFragments(mounts,ranges){var result=[];var _iterator150=_createForOfIteratorHelper(mounts),_step150;try{var _loop11=function _loop11(){var _step150$value=_step150.value,pos=_step150$value.pos,mount=_step150$value.mount,frag=_step150$value.frag;var startPos=pos+(mount.overlay?mount.overlay[0].from:0),endPos=startPos+mount.tree.length;var from=Math.max(frag.from,startPos),to=Math.min(frag.to,endPos);if(mount.overlay){var overlay=mount.overlay.map(function(r){return new Range2(r.from+pos,r.to+pos);});var changes=findCoverChanges(ranges,overlay,from,to);for(var _i135=0,pos2=from;;_i135++){var last=_i135==changes.length,end=last?to:changes[_i135].from;if(end>pos2)result.push(new TreeFragment(pos2,end,mount.tree,-startPos,frag.from>=pos2||frag.openStart,frag.to<=end||frag.openEnd));if(last)break;pos2=changes[_i135].to;}}else{result.push(new TreeFragment(from,to,mount.tree,-startPos,frag.from>=startPos||frag.openStart,frag.to<=endPos||frag.openEnd));}};for(_iterator150.s();!(_step150=_iterator150.n()).done;){_loop11();}}catch(err){_iterator150.e(err);}finally{_iterator150.f();}return result;}// ../node_modules/@lezer/highlight/dist/index.js
var nextTagID=0;var Tag=/*#__PURE__*/function(){function Tag(set,base2,modified){_classCallCheck(this,Tag);this.set=set;this.base=base2;this.modified=modified;this.id=nextTagID++;}_createClass(Tag,null,[{key:"define",value:function define(parent){if(parent===null||parent===void 0?void 0:parent.base)throw new Error("Can not derive from a modified tag");var tag=new Tag([],null,[]);tag.set.push(tag);if(parent){var _iterator151=_createForOfIteratorHelper(parent.set),_step151;try{for(_iterator151.s();!(_step151=_iterator151.n()).done;){var t2=_step151.value;tag.set.push(t2);}}catch(err){_iterator151.e(err);}finally{_iterator151.f();}}return tag;}},{key:"defineModifier",value:function defineModifier(){var mod=new Modifier();return function(tag){if(tag.modified.indexOf(mod)>-1)return tag;return Modifier.get(tag.base||tag,tag.modified.concat(mod).sort(function(a,b){return a.id-b.id;}));};}}]);return Tag;}();var nextModifierID=0;var Modifier=/*#__PURE__*/function(){function Modifier(){_classCallCheck(this,Modifier);this.instances=[];this.id=nextModifierID++;}_createClass(Modifier,null,[{key:"get",value:function get(base2,mods){if(!mods.length)return base2;var exists=mods[0].instances.find(function(t2){return t2.base==base2&&sameArray2(mods,t2.modified);});if(exists)return exists;var set=[],tag=new Tag(set,base2,mods);var _iterator152=_createForOfIteratorHelper(mods),_step152;try{for(_iterator152.s();!(_step152=_iterator152.n()).done;){var m=_step152.value;m.instances.push(tag);}}catch(err){_iterator152.e(err);}finally{_iterator152.f();}var configs=powerSet(mods);var _iterator153=_createForOfIteratorHelper(base2.set),_step153;try{for(_iterator153.s();!(_step153=_iterator153.n()).done;){var parent=_step153.value;if(!parent.modified.length){var _iterator154=_createForOfIteratorHelper(configs),_step154;try{for(_iterator154.s();!(_step154=_iterator154.n()).done;){var config2=_step154.value;set.push(Modifier.get(parent,config2));}}catch(err){_iterator154.e(err);}finally{_iterator154.f();}}}}catch(err){_iterator153.e(err);}finally{_iterator153.f();}return tag;}}]);return Modifier;}();function sameArray2(a,b){return a.length==b.length&&a.every(function(x,i){return x==b[i];});}function powerSet(array){var sets=[[]];for(var _i136=0;_i136<array.length;_i136++){for(var j=0,e=sets.length;j<e;j++){sets.push(sets[j].concat(array[_i136]));}}return sets.sort(function(a,b){return b.length-a.length;});}function styleTags(spec){var byName=/* @__PURE__ */Object.create(null);for(var prop in spec){var tags3=spec[prop];if(!Array.isArray(tags3))tags3=[tags3];var _iterator155=_createForOfIteratorHelper(prop.split(" ")),_step155;try{for(_iterator155.s();!(_step155=_iterator155.n()).done;){var part=_step155.value;if(part){var pieces=[],mode=2,rest=part;for(var pos=0;;){if(rest=="..."&&pos>0&&pos+3==part.length){mode=1;break;}var m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(rest);if(!m)throw new RangeError("Invalid path: "+part);pieces.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]);pos+=m[0].length;if(pos==part.length)break;var next=part[pos++];if(pos==part.length&&next=="!"){mode=0;break;}if(next!="/")throw new RangeError("Invalid path: "+part);rest=part.slice(pos);}var last=pieces.length-1,inner=pieces[last];if(!inner)throw new RangeError("Invalid path: "+part);var rule=new Rule(tags3,mode,last>0?pieces.slice(0,last):null);byName[inner]=rule.sort(byName[inner]);}}}catch(err){_iterator155.e(err);}finally{_iterator155.f();}}return ruleNodeProp.add(byName);}var ruleNodeProp=new NodeProp();var Rule=/*#__PURE__*/function(){function Rule(tags3,mode,context,next){_classCallCheck(this,Rule);this.tags=tags3;this.mode=mode;this.context=context;this.next=next;}_createClass(Rule,[{key:"opaque",get:function get(){return this.mode==0;}},{key:"inherit",get:function get(){return this.mode==1;}},{key:"sort",value:function sort(other){if(!other||other.depth<this.depth){this.next=other;return this;}other.next=this.sort(other.next);return other;}},{key:"depth",get:function get(){return this.context?this.context.length:0;}}]);return Rule;}();Rule.empty=new Rule([],2,null);function tagHighlighter(tags3,options){var map=/* @__PURE__ */Object.create(null);var _iterator156=_createForOfIteratorHelper(tags3),_step156;try{for(_iterator156.s();!(_step156=_iterator156.n()).done;){var style=_step156.value;if(!Array.isArray(style.tag))map[style.tag.id]=style["class"];else{var _iterator159=_createForOfIteratorHelper(style.tag),_step159;try{for(_iterator159.s();!(_step159=_iterator159.n()).done;){var tag=_step159.value;map[tag.id]=style["class"];}}catch(err){_iterator159.e(err);}finally{_iterator159.f();}}}}catch(err){_iterator156.e(err);}finally{_iterator156.f();}var _ref16=options||{},scope=_ref16.scope,_ref16$all=_ref16.all,all=_ref16$all===void 0?null:_ref16$all;return{style:function style(tags4){var cls=all;var _iterator157=_createForOfIteratorHelper(tags4),_step157;try{for(_iterator157.s();!(_step157=_iterator157.n()).done;){var tag=_step157.value;var _iterator158=_createForOfIteratorHelper(tag.set),_step158;try{for(_iterator158.s();!(_step158=_iterator158.n()).done;){var sub=_step158.value;var tagClass=map[sub.id];if(tagClass){cls=cls?cls+" "+tagClass:tagClass;break;}}}catch(err){_iterator158.e(err);}finally{_iterator158.f();}}}catch(err){_iterator157.e(err);}finally{_iterator157.f();}return cls;},scope:scope};}function highlightTags(highlighters,tags3){var result=null;var _iterator160=_createForOfIteratorHelper(highlighters),_step160;try{for(_iterator160.s();!(_step160=_iterator160.n()).done;){var highlighter=_step160.value;var value=highlighter.style(tags3);if(value)result=result?result+" "+value:value;}}catch(err){_iterator160.e(err);}finally{_iterator160.f();}return result;}function highlightTree(tree,highlighter,putStyle){var from=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var to=arguments.length>4&&arguments[4]!==undefined?arguments[4]:tree.length;var builder=new HighlightBuilder(from,Array.isArray(highlighter)?highlighter:[highlighter],putStyle);builder.highlightRange(tree.cursor(),from,to,"",builder.highlighters);builder.flush(to);}var HighlightBuilder=/*#__PURE__*/function(){function HighlightBuilder(at,highlighters,span){_classCallCheck(this,HighlightBuilder);this.at=at;this.highlighters=highlighters;this.span=span;this["class"]="";}_createClass(HighlightBuilder,[{key:"startSpan",value:function startSpan(at,cls){if(cls!=this["class"]){this.flush(at);if(at>this.at)this.at=at;this["class"]=cls;}}},{key:"flush",value:function flush(to){if(to>this.at&&this["class"])this.span(this.at,to,this["class"]);}},{key:"highlightRange",value:function highlightRange(cursor2,from,to,inheritedClass,highlighters){var type=cursor2.type,start=cursor2.from,end=cursor2.to;if(start>=to||end<=from)return;if(type.isTop)highlighters=this.highlighters.filter(function(h){return!h.scope||h.scope(type);});var cls=inheritedClass;var rule=getStyleTags(cursor2)||Rule.empty;var tagCls=highlightTags(highlighters,rule.tags);if(tagCls){if(cls)cls+=" ";cls+=tagCls;if(rule.mode==1)inheritedClass+=(inheritedClass?" ":"")+tagCls;}this.startSpan(Math.max(from,start),cls);if(rule.opaque)return;var mounted=cursor2.tree&&cursor2.tree.prop(NodeProp.mounted);if(mounted&&mounted.overlay){var inner=cursor2.node.enter(mounted.overlay[0].from+start,1);var innerHighlighters=this.highlighters.filter(function(h){return!h.scope||h.scope(mounted.tree.type);});var hasChild2=cursor2.firstChild();for(var _i137=0,pos=start;;_i137++){var next=_i137<mounted.overlay.length?mounted.overlay[_i137]:null;var nextPos=next?next.from+start:end;var rangeFrom=Math.max(from,pos),rangeTo=Math.min(to,nextPos);if(rangeFrom<rangeTo&&hasChild2){while(cursor2.from<rangeTo){this.highlightRange(cursor2,rangeFrom,rangeTo,inheritedClass,highlighters);this.startSpan(Math.min(rangeTo,cursor2.to),cls);if(cursor2.to>=nextPos||!cursor2.nextSibling())break;}}if(!next||nextPos>to)break;pos=next.to+start;if(pos>from){this.highlightRange(inner.cursor(),Math.max(from,next.from+start),Math.min(to,pos),"",innerHighlighters);this.startSpan(Math.min(to,pos),cls);}}if(hasChild2)cursor2.parent();}else if(cursor2.firstChild()){if(mounted)inheritedClass="";do{if(cursor2.to<=from)continue;if(cursor2.from>=to)break;this.highlightRange(cursor2,from,to,inheritedClass,highlighters);this.startSpan(Math.min(to,cursor2.to),cls);}while(cursor2.nextSibling());cursor2.parent();}}}]);return HighlightBuilder;}();function getStyleTags(node){var rule=node.type.prop(ruleNodeProp);while(rule&&rule.context&&!node.matchContext(rule.context)){rule=rule.next;}return rule||null;}var t=Tag.define;var comment=t();var name=t();var typeName=t(name);var propertyName=t(name);var literal=t();var string=t(literal);var number=t(literal);var content=t();var heading=t(content);var keyword=t();var operator=t();var punctuation=t();var bracket=t(punctuation);var meta=t();var tags={comment:comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name:name,variableName:t(name),typeName:typeName,tagName:t(typeName),propertyName:propertyName,attributeName:t(propertyName),className:t(name),labelName:t(name),namespace:t(name),macroName:t(name),literal:literal,string:string,docString:t(string),character:t(string),attributeValue:t(string),number:number,integer:t(number),"float":t(number),bool:t(literal),regexp:t(literal),escape:t(literal),color:t(literal),url:t(literal),keyword:keyword,self:t(keyword),"null":t(keyword),atom:t(keyword),unit:t(keyword),modifier:t(keyword),operatorKeyword:t(keyword),controlKeyword:t(keyword),definitionKeyword:t(keyword),moduleKeyword:t(keyword),operator:operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation:punctuation,separator:t(punctuation),bracket:bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content:content,heading:heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta:meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier(),constant:Tag.defineModifier(),"function":Tag.defineModifier(),standard:Tag.defineModifier(),local:Tag.defineModifier(),special:Tag.defineModifier()};var classHighlighter=tagHighlighter([{tag:tags.link,"class":"tok-link"},{tag:tags.heading,"class":"tok-heading"},{tag:tags.emphasis,"class":"tok-emphasis"},{tag:tags.strong,"class":"tok-strong"},{tag:tags.keyword,"class":"tok-keyword"},{tag:tags.atom,"class":"tok-atom"},{tag:tags.bool,"class":"tok-bool"},{tag:tags.url,"class":"tok-url"},{tag:tags.labelName,"class":"tok-labelName"},{tag:tags.inserted,"class":"tok-inserted"},{tag:tags.deleted,"class":"tok-deleted"},{tag:tags.literal,"class":"tok-literal"},{tag:tags.string,"class":"tok-string"},{tag:tags.number,"class":"tok-number"},{tag:[tags.regexp,tags.escape,tags.special(tags.string)],"class":"tok-string2"},{tag:tags.variableName,"class":"tok-variableName"},{tag:tags.local(tags.variableName),"class":"tok-variableName tok-local"},{tag:tags.definition(tags.variableName),"class":"tok-variableName tok-definition"},{tag:tags.special(tags.variableName),"class":"tok-variableName2"},{tag:tags.definition(tags.propertyName),"class":"tok-propertyName tok-definition"},{tag:tags.typeName,"class":"tok-typeName"},{tag:tags.namespace,"class":"tok-namespace"},{tag:tags.className,"class":"tok-className"},{tag:tags.macroName,"class":"tok-macroName"},{tag:tags.propertyName,"class":"tok-propertyName"},{tag:tags.operator,"class":"tok-operator"},{tag:tags.comment,"class":"tok-comment"},{tag:tags.meta,"class":"tok-meta"},{tag:tags.invalid,"class":"tok-invalid"},{tag:tags.punctuation,"class":"tok-punctuation"}]);// ../node_modules/@codemirror/language/dist/index.js
var _a;var _languageDataProp=/* @__PURE__ */new NodeProp();function _defineLanguageFacet(baseData){return Facet.define({combine:baseData?function(values2){return values2.concat(baseData);}:void 0});}var _sublanguageProp=/* @__PURE__ */new NodeProp();var _Language=/*#__PURE__*/function(){function _Language(data2,parser5){var extraExtensions=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var name2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"";_classCallCheck(this,_Language);this.data=data2;this.name=name2;if(!EditorState.prototype.hasOwnProperty("tree"))Object.defineProperty(EditorState.prototype,"tree",{get:function get(){return _syntaxTree(this);}});this.parser=parser5;this.extension=[_language.of(this),EditorState.languageData.of(function(state,pos,side){var top2=topNodeAt(state,pos,side),data3=top2.type.prop(_languageDataProp);if(!data3)return[];var base2=state.facet(data3),sub=top2.type.prop(_sublanguageProp);if(sub){var innerNode=top2.resolve(pos-top2.from,side);var _iterator161=_createForOfIteratorHelper(sub),_step161;try{for(_iterator161.s();!(_step161=_iterator161.n()).done;){var sublang=_step161.value;if(sublang.test(innerNode,state)){var data4=state.facet(sublang.facet);return sublang.type=="replace"?data4:data4.concat(base2);}}}catch(err){_iterator161.e(err);}finally{_iterator161.f();}}return base2;})].concat(extraExtensions);}_createClass(_Language,[{key:"isActiveAt",value:function isActiveAt(state,pos){var side=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;return topNodeAt(state,pos,side).type.prop(_languageDataProp)==this.data;}},{key:"findRegions",value:function findRegions(state){var _this70=this;var lang=state.facet(_language);if((lang===null||lang===void 0?void 0:lang.data)==this.data)return[{from:0,to:state.doc.length}];if(!lang||!lang.allowsNesting)return[];var result=[];var explore=function explore(tree,from){if(tree.prop(_languageDataProp)==_this70.data){result.push({from:from,to:from+tree.length});return;}var mount=tree.prop(NodeProp.mounted);if(mount){if(mount.tree.prop(_languageDataProp)==_this70.data){if(mount.overlay){var _iterator162=_createForOfIteratorHelper(mount.overlay),_step162;try{for(_iterator162.s();!(_step162=_iterator162.n()).done;){var _r7=_step162.value;result.push({from:_r7.from+from,to:_r7.to+from});}}catch(err){_iterator162.e(err);}finally{_iterator162.f();}}else result.push({from:from,to:from+tree.length});return;}else if(mount.overlay){var size=result.length;explore(mount.tree,mount.overlay[0].from+from);if(result.length>size)return;}}for(var _i138=0;_i138<tree.children.length;_i138++){var ch=tree.children[_i138];if(ch instanceof Tree)explore(ch,tree.positions[_i138]+from);}};explore(_syntaxTree(state),0);return result;}},{key:"allowsNesting",get:function get(){return true;}}]);return _Language;}();_Language.setState=/* @__PURE__ */StateEffect.define();function topNodeAt(state,pos,side){var topLang=state.facet(_language),tree=_syntaxTree(state).topNode;if(!topLang||topLang.allowsNesting){for(var node=tree;node;node=node.enter(pos,side,IterMode.ExcludeBuffers)){if(node.type.isTop)tree=node;}}return tree;}var _LRLanguage=/*#__PURE__*/function(_Language2){_inherits(_LRLanguage,_Language2);var _super29=_createSuper(_LRLanguage);function _LRLanguage(data2,parser5,name2){var _this71;_classCallCheck(this,_LRLanguage);_this71=_super29.call(this,data2,parser5,[],name2);_this71.parser=parser5;return _this71;}_createClass(_LRLanguage,[{key:"configure",value:function configure(options,name2){return new _LRLanguage(this.data,this.parser.configure(options),name2||this.name);}},{key:"allowsNesting",get:function get(){return this.parser.hasWrappers();}}],[{key:"define",value:function define(spec){var data2=_defineLanguageFacet(spec.languageData);return new _LRLanguage(data2,spec.parser.configure({props:[_languageDataProp.add(function(type){return type.isTop?data2:void 0;})]}),spec.name);}}]);return _LRLanguage;}(_Language);function _syntaxTree(state){var field=state.field(_Language.state,false);return field?field.tree:Tree.empty;}function _ensureSyntaxTree(state,upto){var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:50;var _a2;var parse=(_a2=state.field(_Language.state,false))===null||_a2===void 0?void 0:_a2.context;if(!parse)return null;var oldVieport=parse.viewport;parse.updateViewport({from:0,to:upto});var result=parse.isDone(upto)||parse.work(timeout,upto)?parse.tree:null;parse.updateViewport(oldVieport);return result;}function _syntaxTreeAvailable(state){var upto=arguments.length>1&&arguments[1]!==undefined?arguments[1]:state.doc.length;var _a2;return((_a2=state.field(_Language.state,false))===null||_a2===void 0?void 0:_a2.context.isDone(upto))||false;}function _forceParsing(view){var upto=arguments.length>1&&arguments[1]!==undefined?arguments[1]:view.viewport.to;var timeout=arguments.length>2&&arguments[2]!==undefined?arguments[2]:100;var success=_ensureSyntaxTree(view.state,upto,timeout);if(success!=_syntaxTree(view.state))view.dispatch({});return!!success;}function _syntaxParserRunning(view){var _a2;return((_a2=view.plugin(parseWorker))===null||_a2===void 0?void 0:_a2.isWorking())||false;}var _DocInput=/*#__PURE__*/function(){function _DocInput(doc2){_classCallCheck(this,_DocInput);this.doc=doc2;this.cursorPos=0;this.string="";this.cursor=doc2.iter();}_createClass(_DocInput,[{key:"length",get:function get(){return this.doc.length;}},{key:"syncTo",value:function syncTo(pos){this.string=this.cursor.next(pos-this.cursorPos).value;this.cursorPos=pos+this.string.length;return this.cursorPos-this.string.length;}},{key:"chunk",value:function chunk(pos){this.syncTo(pos);return this.string;}},{key:"lineChunks",get:function get(){return true;}},{key:"read",value:function read(from,to){var stringStart=this.cursorPos-this.string.length;if(from<stringStart||to>=this.cursorPos)return this.doc.sliceString(from,to);else return this.string.slice(from-stringStart,to-stringStart);}}]);return _DocInput;}();var currentContext=null;var _ParseContext=/*#__PURE__*/function(){function _ParseContext(parser5,state){var fragments=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var tree=arguments.length>3?arguments[3]:undefined;var treeLen=arguments.length>4?arguments[4]:undefined;var viewport=arguments.length>5?arguments[5]:undefined;var skipped=arguments.length>6?arguments[6]:undefined;var scheduleOn=arguments.length>7?arguments[7]:undefined;_classCallCheck(this,_ParseContext);this.parser=parser5;this.state=state;this.fragments=fragments;this.tree=tree;this.treeLen=treeLen;this.viewport=viewport;this.skipped=skipped;this.scheduleOn=scheduleOn;this.parse=null;this.tempSkipped=[];}_createClass(_ParseContext,[{key:"startParse",value:function startParse(){return this.parser.startParse(new _DocInput(this.state.doc),this.fragments);}},{key:"work",value:function work(until,upto){var _this72=this;if(upto!=null&&upto>=this.state.doc.length)upto=void 0;if(this.tree!=Tree.empty&&this.isDone(upto!==null&&upto!==void 0?upto:this.state.doc.length)){this.takeTree();return true;}return this.withContext(function(){var _a2;if(typeof until=="number"){var endTime=Date.now()+until;until=function until(){return Date.now()>endTime;};}if(!_this72.parse)_this72.parse=_this72.startParse();if(upto!=null&&(_this72.parse.stoppedAt==null||_this72.parse.stoppedAt>upto)&&upto<_this72.state.doc.length)_this72.parse.stopAt(upto);for(;;){var done=_this72.parse.advance();if(done){_this72.fragments=_this72.withoutTempSkipped(TreeFragment.addTree(done,_this72.fragments,_this72.parse.stoppedAt!=null));_this72.treeLen=(_a2=_this72.parse.stoppedAt)!==null&&_a2!==void 0?_a2:_this72.state.doc.length;_this72.tree=done;_this72.parse=null;if(_this72.treeLen<(upto!==null&&upto!==void 0?upto:_this72.state.doc.length))_this72.parse=_this72.startParse();else return true;}if(until())return false;}});}},{key:"takeTree",value:function takeTree(){var _this73=this;var pos,tree;if(this.parse&&(pos=this.parse.parsedPos)>=this.treeLen){if(this.parse.stoppedAt==null||this.parse.stoppedAt>pos)this.parse.stopAt(pos);this.withContext(function(){while(!(tree=_this73.parse.advance())){}});this.treeLen=pos;this.tree=tree;this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,true));this.parse=null;}}},{key:"withContext",value:function withContext(f){var prev=currentContext;currentContext=this;try{return f();}finally{currentContext=prev;}}},{key:"withoutTempSkipped",value:function withoutTempSkipped(fragments){for(var _r8;_r8=this.tempSkipped.pop();){fragments=cutFragments(fragments,_r8.from,_r8.to);}return fragments;}},{key:"changes",value:function changes(_changes,newState){var fragments=this.fragments,tree=this.tree,treeLen=this.treeLen,viewport=this.viewport,skipped=this.skipped;this.takeTree();if(!_changes.empty){var ranges=[];_changes.iterChangedRanges(function(fromA,toA,fromB,toB){return ranges.push({fromA:fromA,toA:toA,fromB:fromB,toB:toB});});fragments=TreeFragment.applyChanges(fragments,ranges);tree=Tree.empty;treeLen=0;viewport={from:_changes.mapPos(viewport.from,-1),to:_changes.mapPos(viewport.to,1)};if(this.skipped.length){skipped=[];var _iterator163=_createForOfIteratorHelper(this.skipped),_step163;try{for(_iterator163.s();!(_step163=_iterator163.n()).done;){var _r9=_step163.value;var from=_changes.mapPos(_r9.from,1),to=_changes.mapPos(_r9.to,-1);if(from<to)skipped.push({from:from,to:to});}}catch(err){_iterator163.e(err);}finally{_iterator163.f();}}}return new _ParseContext(this.parser,newState,fragments,tree,treeLen,viewport,skipped,this.scheduleOn);}},{key:"updateViewport",value:function updateViewport(viewport){if(this.viewport.from==viewport.from&&this.viewport.to==viewport.to)return false;this.viewport=viewport;var startLen=this.skipped.length;for(var _i139=0;_i139<this.skipped.length;_i139++){var _this$skipped$_i=this.skipped[_i139],from=_this$skipped$_i.from,to=_this$skipped$_i.to;if(from<viewport.to&&to>viewport.from){this.fragments=cutFragments(this.fragments,from,to);this.skipped.splice(_i139--,1);}}if(this.skipped.length>=startLen)return false;this.reset();return true;}},{key:"reset",value:function reset(){if(this.parse){this.takeTree();this.parse=null;}}},{key:"skipUntilInView",value:function skipUntilInView(from,to){this.skipped.push({from:from,to:to});}},{key:"isDone",value:function isDone(upto){upto=Math.min(upto,this.state.doc.length);var frags=this.fragments;return this.treeLen>=upto&&frags.length&&frags[0].from==0&&frags[0].to>=upto;}}],[{key:"create",value:function create(parser5,state,viewport){return new _ParseContext(parser5,state,[],Tree.empty,0,viewport,[],null);}},{key:"getSkippingParser",value:function getSkippingParser(until){return new(/*#__PURE__*/function(_Parser){_inherits(_class9,_Parser);var _super30=_createSuper(_class9);function _class9(){_classCallCheck(this,_class9);return _super30.apply(this,arguments);}_createClass(_class9,[{key:"createParse",value:function createParse(input,fragments,ranges){var from=ranges[0].from,to=ranges[ranges.length-1].to;var parser5={parsedPos:from,advance:function advance(){var cx=currentContext;if(cx){var _iterator164=_createForOfIteratorHelper(ranges),_step164;try{for(_iterator164.s();!(_step164=_iterator164.n()).done;){var _r10=_step164.value;cx.tempSkipped.push(_r10);}}catch(err){_iterator164.e(err);}finally{_iterator164.f();}if(until)cx.scheduleOn=cx.scheduleOn?Promise.all([cx.scheduleOn,until]):until;}this.parsedPos=to;return new Tree(NodeType.none,[],[],to-from);},stoppedAt:null,stopAt:function stopAt(){}};return parser5;}}]);return _class9;}(Parser))();}},{key:"get",value:function get(){return currentContext;}}]);return _ParseContext;}();function cutFragments(fragments,from,to){return TreeFragment.applyChanges(fragments,[{fromA:from,toA:to,fromB:from,toB:to}]);}var LanguageState=/*#__PURE__*/function(){function LanguageState(context){_classCallCheck(this,LanguageState);this.context=context;this.tree=context.tree;}_createClass(LanguageState,[{key:"apply",value:function apply(tr){if(!tr.docChanged&&this.tree==this.context.tree)return this;var newCx=this.context.changes(tr.changes,tr.state);var upto=this.context.treeLen==tr.startState.doc.length?void 0:Math.max(tr.changes.mapPos(this.context.treeLen),newCx.viewport.to);if(!newCx.work(20,upto))newCx.takeTree();return new LanguageState(newCx);}}],[{key:"init",value:function init(state){var vpTo=Math.min(3e3,state.doc.length);var parseState=_ParseContext.create(state.facet(_language).parser,state,{from:0,to:vpTo});if(!parseState.work(20,vpTo))parseState.takeTree();return new LanguageState(parseState);}}]);return LanguageState;}();_Language.state=/* @__PURE__ */StateField.define({create:LanguageState.init,update:function update(value,tr){var _iterator165=_createForOfIteratorHelper(tr.effects),_step165;try{for(_iterator165.s();!(_step165=_iterator165.n()).done;){var e=_step165.value;if(e.is(_Language.setState))return e.value;}}catch(err){_iterator165.e(err);}finally{_iterator165.f();}if(tr.startState.facet(_language)!=tr.state.facet(_language))return LanguageState.init(tr.state);return value.apply(tr);}});var requestIdle=function requestIdle(callback){var timeout=setTimeout(function(){return callback();},500);return function(){return clearTimeout(timeout);};};if(typeof requestIdleCallback!="undefined")requestIdle=function requestIdle(callback){var idle=-1,timeout=setTimeout(function(){idle=requestIdleCallback(callback,{timeout:500-100});},100);return function(){return idle<0?clearTimeout(timeout):cancelIdleCallback(idle);};};var isInputPending=typeof navigator!="undefined"&&((_a=navigator.scheduling)===null||_a===void 0?void 0:_a.isInputPending)?function(){return navigator.scheduling.isInputPending();}:null;var parseWorker=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function ParseWorker(view){_classCallCheck(this,ParseWorker);this.view=view;this.working=null;this.workScheduled=0;this.chunkEnd=-1;this.chunkBudget=-1;this.work=this.work.bind(this);this.scheduleWork();}_createClass(ParseWorker,[{key:"update",value:function update(_update19){var cx=this.view.state.field(_Language.state).context;if(cx.updateViewport(_update19.view.viewport)||this.view.viewport.to>cx.treeLen)this.scheduleWork();if(_update19.docChanged||_update19.selectionSet){if(this.view.hasFocus)this.chunkBudget+=50;this.scheduleWork();}this.checkAsyncSchedule(cx);}},{key:"scheduleWork",value:function scheduleWork(){if(this.working)return;var state=this.view.state,field=state.field(_Language.state);if(field.tree!=field.context.tree||!field.context.isDone(state.doc.length))this.working=requestIdle(this.work);}},{key:"work",value:function work(deadline){this.working=null;var now=Date.now();if(this.chunkEnd<now&&(this.chunkEnd<0||this.view.hasFocus)){this.chunkEnd=now+3e4;this.chunkBudget=3e3;}if(this.chunkBudget<=0)return;var _this$view3=this.view,state=_this$view3.state,vpTo=_this$view3.viewport.to,field=state.field(_Language.state);if(field.tree==field.context.tree&&field.context.isDone(vpTo+1e5))return;var endTime=Date.now()+Math.min(this.chunkBudget,100,deadline&&!isInputPending?Math.max(25,deadline.timeRemaining()-5):1e9);var viewportFirst=field.context.treeLen<vpTo&&state.doc.length>vpTo+1e3;var done=field.context.work(function(){return isInputPending&&isInputPending()||Date.now()>endTime;},vpTo+(viewportFirst?0:1e5));this.chunkBudget-=Date.now()-now;if(done||this.chunkBudget<=0){field.context.takeTree();this.view.dispatch({effects:_Language.setState.of(new LanguageState(field.context))});}if(this.chunkBudget>0&&!(done&&!viewportFirst))this.scheduleWork();this.checkAsyncSchedule(field.context);}},{key:"checkAsyncSchedule",value:function checkAsyncSchedule(cx){var _this74=this;if(cx.scheduleOn){this.workScheduled++;cx.scheduleOn.then(function(){return _this74.scheduleWork();})["catch"](function(err){return logException(_this74.view.state,err);}).then(function(){return _this74.workScheduled--;});cx.scheduleOn=null;}}},{key:"destroy",value:function destroy(){if(this.working)this.working();}},{key:"isWorking",value:function isWorking(){return!!(this.working||this.workScheduled>0);}}]);return ParseWorker;}(),{eventHandlers:{focus:function focus(){this.scheduleWork();}}});var _language=/* @__PURE__ */Facet.define({combine:function combine(languages){return languages.length?languages[0]:null;},enables:function enables(language2){return[_Language.state,parseWorker,EditorView.contentAttributes.compute([language2],function(state){var lang=state.facet(language2);return lang&&lang.name?{"data-language":lang.name}:{};})];}});var _LanguageSupport=/*#__PURE__*/_createClass(function _LanguageSupport(language2){var support=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,_LanguageSupport);this.language=language2;this.support=support;this.extension=[language2,support];});var _LanguageDescription=/*#__PURE__*/function(){function _LanguageDescription(name2,alias,extensions,filename,loadFunc){var support=arguments.length>5&&arguments[5]!==undefined?arguments[5]:void 0;_classCallCheck(this,_LanguageDescription);this.name=name2;this.alias=alias;this.extensions=extensions;this.filename=filename;this.loadFunc=loadFunc;this.support=support;this.loading=null;}_createClass(_LanguageDescription,[{key:"load",value:function load(){var _this75=this;return this.loading||(this.loading=this.loadFunc().then(function(support){return _this75.support=support;},function(err){_this75.loading=null;throw err;}));}}],[{key:"of",value:function of(spec){var load=spec.load,support=spec.support;if(!load){if(!support)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");load=function load(){return Promise.resolve(support);};}return new _LanguageDescription(spec.name,(spec.alias||[]).concat(spec.name).map(function(s){return s.toLowerCase();}),spec.extensions||[],spec.filename,load,support);}},{key:"matchFilename",value:function matchFilename(descs,filename){var _iterator166=_createForOfIteratorHelper(descs),_step166;try{for(_iterator166.s();!(_step166=_iterator166.n()).done;){var _d2=_step166.value;if(_d2.filename&&_d2.filename.test(filename))return _d2;}}catch(err){_iterator166.e(err);}finally{_iterator166.f();}var ext=/\.([^.]+)$/.exec(filename);if(ext){var _iterator167=_createForOfIteratorHelper(descs),_step167;try{for(_iterator167.s();!(_step167=_iterator167.n()).done;){var d=_step167.value;if(d.extensions.indexOf(ext[1])>-1)return d;}}catch(err){_iterator167.e(err);}finally{_iterator167.f();}}return null;}},{key:"matchLanguageName",value:function matchLanguageName(descs,name2){var fuzzy=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;name2=name2.toLowerCase();var _iterator168=_createForOfIteratorHelper(descs),_step168;try{for(_iterator168.s();!(_step168=_iterator168.n()).done;){var _d3=_step168.value;if(_d3.alias.some(function(a){return a==name2;}))return _d3;}}catch(err){_iterator168.e(err);}finally{_iterator168.f();}if(fuzzy){var _iterator169=_createForOfIteratorHelper(descs),_step169;try{for(_iterator169.s();!(_step169=_iterator169.n()).done;){var d=_step169.value;var _iterator170=_createForOfIteratorHelper(d.alias),_step170;try{for(_iterator170.s();!(_step170=_iterator170.n()).done;){var a=_step170.value;var found=name2.indexOf(a);if(found>-1&&(a.length>2||!/\w/.test(name2[found-1])&&!/\w/.test(name2[found+a.length])))return d;}}catch(err){_iterator170.e(err);}finally{_iterator170.f();}}}catch(err){_iterator169.e(err);}finally{_iterator169.f();}}return null;}}]);return _LanguageDescription;}();var _indentService=/* @__PURE__ */Facet.define();var _indentUnit=/* @__PURE__ */Facet.define({combine:function combine(values2){if(!values2.length)return"  ";var unit=values2[0];if(!unit||/\S/.test(unit)||Array.from(unit).some(function(e){return e!=unit[0];}))throw new Error("Invalid indent unit: "+JSON.stringify(values2[0]));return unit;}});function _getIndentUnit(state){var unit=state.facet(_indentUnit);return unit.charCodeAt(0)==9?state.tabSize*unit.length:unit.length;}function _indentString(state,cols){var result="",ts=state.tabSize,ch=state.facet(_indentUnit)[0];if(ch=="	"){while(cols>=ts){result+="	";cols-=ts;}ch=" ";}for(var _i140=0;_i140<cols;_i140++){result+=ch;}return result;}function _getIndentation(context,pos){if(context instanceof EditorState)context=new _IndentContext(context);var _iterator171=_createForOfIteratorHelper(context.state.facet(_indentService)),_step171;try{for(_iterator171.s();!(_step171=_iterator171.n()).done;){var service=_step171.value;var result=service(context,pos);if(result!==void 0)return result;}}catch(err){_iterator171.e(err);}finally{_iterator171.f();}var tree=_syntaxTree(context.state);return tree.length>=pos?syntaxIndentation(context,tree,pos):null;}function _indentRange(state,from,to){var updated=/* @__PURE__ */Object.create(null);var context=new _IndentContext(state,{overrideIndentation:function overrideIndentation(start){var _a2;return(_a2=updated[start])!==null&&_a2!==void 0?_a2:-1;}});var changes=[];for(var pos=from;pos<=to;){var line=state.doc.lineAt(pos);pos=line.to+1;var indent=_getIndentation(context,line.from);if(indent==null)continue;if(!/\S/.test(line.text))indent=0;var cur2=/^\s*/.exec(line.text)[0];var norm=_indentString(state,indent);if(cur2!=norm){updated[line.from]=indent;changes.push({from:line.from,to:line.from+cur2.length,insert:norm});}}return state.changes(changes);}var _IndentContext=/*#__PURE__*/function(){function _IndentContext(state){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,_IndentContext);this.state=state;this.options=options;this.unit=_getIndentUnit(state);}_createClass(_IndentContext,[{key:"lineAt",value:function lineAt(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var line=this.state.doc.lineAt(pos);var _this$options=this.options,simulateBreak=_this$options.simulateBreak,simulateDoubleBreak=_this$options.simulateDoubleBreak;if(simulateBreak!=null&&simulateBreak>=line.from&&simulateBreak<=line.to){if(simulateDoubleBreak&&simulateBreak==pos)return{text:"",from:pos};else if(bias<0?simulateBreak<pos:simulateBreak<=pos)return{text:line.text.slice(simulateBreak-line.from),from:simulateBreak};else return{text:line.text.slice(0,simulateBreak-line.from),from:line.from};}return line;}},{key:"textAfterPos",value:function textAfterPos(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(this.options.simulateDoubleBreak&&pos==this.options.simulateBreak)return"";var _this$lineAt=this.lineAt(pos,bias),text=_this$lineAt.text,from=_this$lineAt.from;return text.slice(pos-from,Math.min(text.length,pos+100-from));}},{key:"column",value:function column(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var _this$lineAt2=this.lineAt(pos,bias),text=_this$lineAt2.text,from=_this$lineAt2.from;var result=this.countColumn(text,pos-from);var override=this.options.overrideIndentation?this.options.overrideIndentation(from):-1;if(override>-1)result+=override-this.countColumn(text,text.search(/\S|$/));return result;}},{key:"countColumn",value:function countColumn(line){var pos=arguments.length>1&&arguments[1]!==undefined?arguments[1]:line.length;return _countColumn(line,this.state.tabSize,pos);}},{key:"lineIndent",value:function lineIndent(pos){var bias=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var _this$lineAt3=this.lineAt(pos,bias),text=_this$lineAt3.text,from=_this$lineAt3.from;var override=this.options.overrideIndentation;if(override){var overriden=override(from);if(overriden>-1)return overriden;}return this.countColumn(text,text.search(/\S|$/));}},{key:"simulatedBreak",get:function get(){return this.options.simulateBreak||null;}}]);return _IndentContext;}();var _indentNodeProp=/* @__PURE__ */new NodeProp();function syntaxIndentation(cx,ast,pos){var stack=ast.resolveStack(pos);var inner=stack.node.enterUnfinishedNodesBefore(pos);if(inner!=stack.node){var add2=[];for(var cur2=inner;cur2!=stack.node;cur2=cur2.parent){add2.push(cur2);}for(var _i141=add2.length-1;_i141>=0;_i141--){stack={node:add2[_i141],next:stack};}}return indentFor(stack,cx,pos);}function indentFor(stack,cx,pos){for(var cur2=stack;cur2;cur2=cur2.next){var strategy=indentStrategy(cur2.node);if(strategy)return strategy(_TreeIndentContext.create(cx,pos,cur2));}return 0;}function ignoreClosed(cx){return cx.pos==cx.options.simulateBreak&&cx.options.simulateDoubleBreak;}function indentStrategy(tree){var strategy=tree.type.prop(_indentNodeProp);if(strategy)return strategy;var first=tree.firstChild,close;if(first&&(close=first.type.prop(NodeProp.closedBy))){var last=tree.lastChild,closed=last&&close.indexOf(last.name)>-1;return function(cx){return delimitedStrategy(cx,true,1,void 0,closed&&!ignoreClosed(cx)?last.from:void 0);};}return tree.parent==null?topIndent:null;}function topIndent(){return 0;}var _TreeIndentContext=/*#__PURE__*/function(_IndentContext2){_inherits(_TreeIndentContext,_IndentContext2);var _super31=_createSuper(_TreeIndentContext);function _TreeIndentContext(base2,pos,context){var _this76;_classCallCheck(this,_TreeIndentContext);_this76=_super31.call(this,base2.state,base2.options);_this76.base=base2;_this76.pos=pos;_this76.context=context;return _this76;}_createClass(_TreeIndentContext,[{key:"node",get:function get(){return this.context.node;}},{key:"textAfter",get:function get(){return this.textAfterPos(this.pos);}},{key:"baseIndent",get:function get(){return this.baseIndentFor(this.node);}},{key:"baseIndentFor",value:function baseIndentFor(node){var line=this.state.doc.lineAt(node.from);for(;;){var atBreak=node.resolve(line.from);while(atBreak.parent&&atBreak.parent.from==atBreak.from){atBreak=atBreak.parent;}if(isParent(atBreak,node))break;line=this.state.doc.lineAt(atBreak.from);}return this.lineIndent(line.from);}},{key:"continue",value:function _continue(){return indentFor(this.context.next,this.base,this.pos);}}],[{key:"create",value:function create(base2,pos,context){return new _TreeIndentContext(base2,pos,context);}}]);return _TreeIndentContext;}(_IndentContext);function isParent(parent,of){for(var cur2=of;cur2;cur2=cur2.parent){if(parent==cur2)return true;}return false;}function bracketedAligned(context){var tree=context.node;var openToken=tree.childAfter(tree.from),last=tree.lastChild;if(!openToken)return null;var sim=context.options.simulateBreak;var openLine=context.state.doc.lineAt(openToken.from);var lineEnd2=sim==null||sim<=openLine.from?openLine.to:Math.min(openLine.to,sim);for(var pos=openToken.to;;){var next=tree.childAfter(pos);if(!next||next==last)return null;if(!next.type.isSkipped)return next.from<lineEnd2?openToken:null;pos=next.to;}}function _delimitedIndent(_ref17){var closing2=_ref17.closing,_ref17$align=_ref17.align,align=_ref17$align===void 0?true:_ref17$align,_ref17$units=_ref17.units,units=_ref17$units===void 0?1:_ref17$units;return function(context){return delimitedStrategy(context,align,units,closing2);};}function delimitedStrategy(context,align,units,closing2,closedAt){var after=context.textAfter,space4=after.match(/^\s*/)[0].length;var closed=closing2&&after.slice(space4,space4+closing2.length)==closing2||closedAt==context.pos+space4;var aligned=align?bracketedAligned(context):null;if(aligned)return closed?context.column(aligned.from):context.column(aligned.to);return context.baseIndent+(closed?0:context.unit*units);}var _flatIndent=function _flatIndent(context){return context.baseIndent;};function _continuedIndent(){var _ref18=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},except=_ref18.except,_ref18$units=_ref18.units,units=_ref18$units===void 0?1:_ref18$units;return function(context){var matchExcept=except&&except.test(context.textAfter);return context.baseIndent+(matchExcept?0:units*context.unit);};}var DontIndentBeyond=200;function _indentOnInput(){return EditorState.transactionFilter.of(function(tr){if(!tr.docChanged||!tr.isUserEvent("input.type")&&!tr.isUserEvent("input.complete"))return tr;var rules=tr.startState.languageDataAt("indentOnInput",tr.startState.selection.main.head);if(!rules.length)return tr;var doc2=tr.newDoc,head=tr.newSelection.main.head,line=doc2.lineAt(head);if(head>line.from+DontIndentBeyond)return tr;var lineStart=doc2.sliceString(line.from,head);if(!rules.some(function(r){return r.test(lineStart);}))return tr;var state=tr.state,last=-1,changes=[];var _iterator172=_createForOfIteratorHelper(state.selection.ranges),_step172;try{for(_iterator172.s();!(_step172=_iterator172.n()).done;){var head2=_step172.value.head;var line2=state.doc.lineAt(head2);if(line2.from==last)continue;last=line2.from;var indent=_getIndentation(state,line2.from);if(indent==null)continue;var cur2=/^\s*/.exec(line2.text)[0];var norm=_indentString(state,indent);if(cur2!=norm)changes.push({from:line2.from,to:line2.from+cur2.length,insert:norm});}}catch(err){_iterator172.e(err);}finally{_iterator172.f();}return changes.length?[tr,{changes:changes,sequential:true}]:tr;});}var _foldService=/* @__PURE__ */Facet.define();var _foldNodeProp=/* @__PURE__ */new NodeProp();function _foldInside(node){var first=node.firstChild,last=node.lastChild;return first&&first.to<last.from?{from:first.to,to:last.type.isError?node.to:last.from}:null;}function syntaxFolding(state,start,end){var tree=_syntaxTree(state);if(tree.length<end)return null;var stack=tree.resolveStack(end,1);var found=null;for(var iter=stack;iter;iter=iter.next){var cur2=iter.node;if(cur2.to<=end||cur2.from>end)continue;if(found&&cur2.from<start)break;var prop=cur2.type.prop(_foldNodeProp);if(prop&&(cur2.to<tree.length-50||tree.length==state.doc.length||!isUnfinished(cur2))){var value=prop(cur2,state);if(value&&value.from<=end&&value.from>=start&&value.to>end)found=value;}}return found;}function isUnfinished(node){var ch=node.lastChild;return ch&&ch.to==node.to&&ch.type.isError;}function _foldable(state,lineStart,lineEnd2){var _iterator173=_createForOfIteratorHelper(state.facet(_foldService)),_step173;try{for(_iterator173.s();!(_step173=_iterator173.n()).done;){var service=_step173.value;var result=service(state,lineStart,lineEnd2);if(result)return result;}}catch(err){_iterator173.e(err);}finally{_iterator173.f();}return syntaxFolding(state,lineStart,lineEnd2);}function mapRange(range,mapping){var from=mapping.mapPos(range.from,1),to=mapping.mapPos(range.to,-1);return from>=to?void 0:{from:from,to:to};}var _foldEffect=/* @__PURE__ */StateEffect.define({map:mapRange});var _unfoldEffect=/* @__PURE__ */StateEffect.define({map:mapRange});function selectedLines(view){var lines=[];var _iterator174=_createForOfIteratorHelper(view.state.selection.ranges),_step174;try{var _loop12=function _loop12(){var head=_step174.value.head;if(lines.some(function(l){return l.from<=head&&l.to>=head;}))return"continue";lines.push(view.lineBlockAt(head));};for(_iterator174.s();!(_step174=_iterator174.n()).done;){var _ret3=_loop12();if(_ret3==="continue")continue;}}catch(err){_iterator174.e(err);}finally{_iterator174.f();}return lines;}var _foldState=/* @__PURE__ */StateField.define({create:function create(){return Decoration.none;},update:function update(folded,tr){folded=folded.map(tr.changes);var _iterator175=_createForOfIteratorHelper(tr.effects),_step175;try{var _loop13=function _loop13(){var e=_step175.value;if(e.is(_foldEffect)&&!foldExists(folded,e.value.from,e.value.to)){var _tr$state$facet=tr.state.facet(foldConfig),preparePlaceholder=_tr$state$facet.preparePlaceholder;var widget=!preparePlaceholder?foldWidget:Decoration.replace({widget:new PreparedFoldWidget(preparePlaceholder(tr.state,e.value))});folded=folded.update({add:[widget.range(e.value.from,e.value.to)]});}else if(e.is(_unfoldEffect)){folded=folded.update({filter:function filter(from,to){return e.value.from!=from||e.value.to!=to;},filterFrom:e.value.from,filterTo:e.value.to});}};for(_iterator175.s();!(_step175=_iterator175.n()).done;){_loop13();}}catch(err){_iterator175.e(err);}finally{_iterator175.f();}if(tr.selection){var onSelection=false,head=tr.selection.main.head;folded.between(head,head,function(a,b){if(a<head&&b>head)onSelection=true;});if(onSelection)folded=folded.update({filterFrom:head,filterTo:head,filter:function filter(a,b){return b<=head||a>=head;}});}return folded;},provide:function provide(f){return EditorView.decorations.from(f);},toJSON:function toJSON(folded,state){var ranges=[];folded.between(0,state.doc.length,function(from,to){ranges.push(from,to);});return ranges;},fromJSON:function fromJSON(value){if(!Array.isArray(value)||value.length%2)throw new RangeError("Invalid JSON for fold state");var ranges=[];for(var _i142=0;_i142<value.length;){var from=value[_i142++],to=value[_i142++];if(typeof from!="number"||typeof to!="number")throw new RangeError("Invalid JSON for fold state");ranges.push(foldWidget.range(from,to));}return Decoration.set(ranges,true);}});function _foldedRanges(state){return state.field(_foldState,false)||RangeSet.empty;}function findFold(state,from,to){var _a2;var found=null;(_a2=state.field(_foldState,false))===null||_a2===void 0?void 0:_a2.between(from,to,function(from2,to2){if(!found||found.from>from2)found={from:from2,to:to2};});return found;}function foldExists(folded,from,to){var found=false;folded.between(from,from,function(a,b){if(a==from&&b==to)found=true;});return found;}function maybeEnable(state,other){return state.field(_foldState,false)?other:other.concat(StateEffect.appendConfig.of(_codeFolding()));}var _foldCode=function _foldCode(view){var _iterator176=_createForOfIteratorHelper(selectedLines(view)),_step176;try{for(_iterator176.s();!(_step176=_iterator176.n()).done;){var line=_step176.value;var range=_foldable(view.state,line.from,line.to);if(range){view.dispatch({effects:maybeEnable(view.state,[_foldEffect.of(range),announceFold(view,range)])});return true;}}}catch(err){_iterator176.e(err);}finally{_iterator176.f();}return false;};var _unfoldCode=function _unfoldCode(view){if(!view.state.field(_foldState,false))return false;var effects=[];var _iterator177=_createForOfIteratorHelper(selectedLines(view)),_step177;try{for(_iterator177.s();!(_step177=_iterator177.n()).done;){var line=_step177.value;var folded=findFold(view.state,line.from,line.to);if(folded)effects.push(_unfoldEffect.of(folded),announceFold(view,folded,false));}}catch(err){_iterator177.e(err);}finally{_iterator177.f();}if(effects.length)view.dispatch({effects:effects});return effects.length>0;};function announceFold(view,range){var fold=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;var lineFrom=view.state.doc.lineAt(range.from).number,lineTo=view.state.doc.lineAt(range.to).number;return EditorView.announce.of("".concat(view.state.phrase(fold?"Folded lines":"Unfolded lines")," ").concat(lineFrom," ").concat(view.state.phrase("to")," ").concat(lineTo,"."));}var _foldAll=function _foldAll(view){var state=view.state,effects=[];for(var pos=0;pos<state.doc.length;){var line=view.lineBlockAt(pos),range=_foldable(state,line.from,line.to);if(range)effects.push(_foldEffect.of(range));pos=(range?view.lineBlockAt(range.to):line).to+1;}if(effects.length)view.dispatch({effects:maybeEnable(view.state,effects)});return!!effects.length;};var _unfoldAll=function _unfoldAll(view){var field=view.state.field(_foldState,false);if(!field||!field.size)return false;var effects=[];field.between(0,view.state.doc.length,function(from,to){effects.push(_unfoldEffect.of({from:from,to:to}));});view.dispatch({effects:effects});return true;};function foldableContainer(view,lineBlock){for(var line=lineBlock;;){var foldableRegion=_foldable(view.state,line.from,line.to);if(foldableRegion&&foldableRegion.to>lineBlock.from)return foldableRegion;if(!line.from)return null;line=view.lineBlockAt(line.from-1);}}var _toggleFold=function _toggleFold(view){var effects=[];var _iterator178=_createForOfIteratorHelper(selectedLines(view)),_step178;try{for(_iterator178.s();!(_step178=_iterator178.n()).done;){var line=_step178.value;var folded=findFold(view.state,line.from,line.to);if(folded){effects.push(_unfoldEffect.of(folded),announceFold(view,folded,false));}else{var foldRange=foldableContainer(view,line);if(foldRange)effects.push(_foldEffect.of(foldRange),announceFold(view,foldRange));}}}catch(err){_iterator178.e(err);}finally{_iterator178.f();}if(effects.length>0)view.dispatch({effects:maybeEnable(view.state,effects)});return!!effects.length;};var _foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:_foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:_unfoldCode},{key:"Ctrl-Alt-[",run:_foldAll},{key:"Ctrl-Alt-]",run:_unfoldAll}];var defaultConfig={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"};var foldConfig=/* @__PURE__ */Facet.define({combine:function combine(values2){return combineConfig(values2,defaultConfig);}});function _codeFolding(config2){var result=[_foldState,baseTheme$12];if(config2)result.push(foldConfig.of(config2));return result;}function widgetToDOM(view,prepared){var state=view.state,conf=state.facet(foldConfig);var onclick=function onclick(event){var line=view.lineBlockAt(view.posAtDOM(event.target));var folded=findFold(view.state,line.from,line.to);if(folded)view.dispatch({effects:_unfoldEffect.of(folded)});event.preventDefault();};if(conf.placeholderDOM)return conf.placeholderDOM(view,onclick,prepared);var element=document.createElement("span");element.textContent=conf.placeholderText;element.setAttribute("aria-label",state.phrase("folded code"));element.title=state.phrase("unfold");element.className="cm-foldPlaceholder";element.onclick=onclick;return element;}var foldWidget=/* @__PURE__ */Decoration.replace({widget:/* @__PURE__ */new(/*#__PURE__*/function(_WidgetType6){_inherits(_class10,_WidgetType6);var _super32=_createSuper(_class10);function _class10(){_classCallCheck(this,_class10);return _super32.apply(this,arguments);}_createClass(_class10,[{key:"toDOM",value:function toDOM(view){return widgetToDOM(view,null);}}]);return _class10;}(WidgetType))()});var PreparedFoldWidget=/*#__PURE__*/function(_WidgetType7){_inherits(PreparedFoldWidget,_WidgetType7);var _super33=_createSuper(PreparedFoldWidget);function PreparedFoldWidget(value){var _this77;_classCallCheck(this,PreparedFoldWidget);_this77=_super33.call(this);_this77.value=value;return _this77;}_createClass(PreparedFoldWidget,[{key:"eq",value:function eq(other){return this.value==other.value;}},{key:"toDOM",value:function toDOM(view){return widgetToDOM(view,this.value);}}]);return PreparedFoldWidget;}(WidgetType);var foldGutterDefaults={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:function foldingChanged(){return false;}};var FoldMarker=/*#__PURE__*/function(_GutterMarker3){_inherits(FoldMarker,_GutterMarker3);var _super34=_createSuper(FoldMarker);function FoldMarker(config2,open){var _this78;_classCallCheck(this,FoldMarker);_this78=_super34.call(this);_this78.config=config2;_this78.open=open;return _this78;}_createClass(FoldMarker,[{key:"eq",value:function eq(other){return this.config==other.config&&this.open==other.open;}},{key:"toDOM",value:function toDOM(view){if(this.config.markerDOM)return this.config.markerDOM(this.open);var span=document.createElement("span");span.textContent=this.open?this.config.openText:this.config.closedText;span.title=view.state.phrase(this.open?"Fold line":"Unfold line");return span;}}]);return FoldMarker;}(GutterMarker);function _foldGutter(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var fullConfig=Object.assign(Object.assign({},foldGutterDefaults),config2);var canFold=new FoldMarker(fullConfig,true),canUnfold=new FoldMarker(fullConfig,false);var _markers=ViewPlugin.fromClass(/*#__PURE__*/function(){function _class11(view){_classCallCheck(this,_class11);this.from=view.viewport.from;this.markers=this.buildMarkers(view);}_createClass(_class11,[{key:"update",value:function update(_update20){if(_update20.docChanged||_update20.viewportChanged||_update20.startState.facet(_language)!=_update20.state.facet(_language)||_update20.startState.field(_foldState,false)!=_update20.state.field(_foldState,false)||_syntaxTree(_update20.startState)!=_syntaxTree(_update20.state)||fullConfig.foldingChanged(_update20))this.markers=this.buildMarkers(_update20.view);}},{key:"buildMarkers",value:function buildMarkers(view){var builder=new RangeSetBuilder();var _iterator179=_createForOfIteratorHelper(view.viewportLineBlocks),_step179;try{for(_iterator179.s();!(_step179=_iterator179.n()).done;){var line=_step179.value;var mark=findFold(view.state,line.from,line.to)?canUnfold:_foldable(view.state,line.from,line.to)?canFold:null;if(mark)builder.add(line.from,line.from,mark);}}catch(err){_iterator179.e(err);}finally{_iterator179.f();}return builder.finish();}}]);return _class11;}());var domEventHandlers=fullConfig.domEventHandlers;return[_markers,gutter({"class":"cm-foldGutter",markers:function markers(view){var _a2;return((_a2=view.plugin(_markers))===null||_a2===void 0?void 0:_a2.markers)||RangeSet.empty;},initialSpacer:function initialSpacer(){return new FoldMarker(fullConfig,false);},domEventHandlers:Object.assign(Object.assign({},domEventHandlers),{click:function click(view,line,event){if(domEventHandlers.click&&domEventHandlers.click(view,line,event))return true;var folded=findFold(view.state,line.from,line.to);if(folded){view.dispatch({effects:_unfoldEffect.of(folded)});return true;}var range=_foldable(view.state,line.from,line.to);if(range){view.dispatch({effects:_foldEffect.of(range)});return true;}return false;}})}),_codeFolding()];}var baseTheme$12=/* @__PURE__ */EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});var _HighlightStyle=/*#__PURE__*/function(){function _HighlightStyle(specs,options){_classCallCheck(this,_HighlightStyle);this.specs=specs;var modSpec;function def(spec){var cls=StyleModule.newName();(modSpec||(modSpec=/* @__PURE__ */Object.create(null)))["."+cls]=spec;return cls;}var all=typeof options.all=="string"?options.all:options.all?def(options.all):void 0;var scopeOpt=options.scope;this.scope=scopeOpt instanceof _Language?function(type){return type.prop(_languageDataProp)==scopeOpt.data;}:scopeOpt?function(type){return type==scopeOpt;}:void 0;this.style=tagHighlighter(specs.map(function(style){return{tag:style.tag,"class":style["class"]||def(Object.assign({},style,{tag:null}))};}),{all:all}).style;this.module=modSpec?new StyleModule(modSpec):null;this.themeType=options.themeType;}_createClass(_HighlightStyle,null,[{key:"define",value:function define(specs,options){return new _HighlightStyle(specs,options||{});}}]);return _HighlightStyle;}();var highlighterFacet=/* @__PURE__ */Facet.define();var fallbackHighlighter=/* @__PURE__ */Facet.define({combine:function combine(values2){return values2.length?[values2[0]]:null;}});function getHighlighters(state){var main=state.facet(highlighterFacet);return main.length?main:state.facet(fallbackHighlighter);}function _syntaxHighlighting(highlighter,options){var ext=[treeHighlighter],themeType;if(highlighter instanceof _HighlightStyle){if(highlighter.module)ext.push(EditorView.styleModule.of(highlighter.module));themeType=highlighter.themeType;}if(options===null||options===void 0?void 0:options.fallback)ext.push(fallbackHighlighter.of(highlighter));else if(themeType)ext.push(highlighterFacet.computeN([EditorView.darkTheme],function(state){return state.facet(EditorView.darkTheme)==(themeType=="dark")?[highlighter]:[];}));else ext.push(highlighterFacet.of(highlighter));return ext;}function _highlightingFor(state,tags3,scope){var highlighters=getHighlighters(state);var result=null;if(highlighters){var _iterator180=_createForOfIteratorHelper(highlighters),_step180;try{for(_iterator180.s();!(_step180=_iterator180.n()).done;){var highlighter=_step180.value;if(!highlighter.scope||scope&&highlighter.scope(scope)){var cls=highlighter.style(tags3);if(cls)result=result?result+" "+cls:cls;}}}catch(err){_iterator180.e(err);}finally{_iterator180.f();}}return result;}var TreeHighlighter=/*#__PURE__*/function(){function TreeHighlighter(view){_classCallCheck(this,TreeHighlighter);this.markCache=/* @__PURE__ */Object.create(null);this.tree=_syntaxTree(view.state);this.decorations=this.buildDeco(view,getHighlighters(view.state));}_createClass(TreeHighlighter,[{key:"update",value:function update(_update21){var tree=_syntaxTree(_update21.state),highlighters=getHighlighters(_update21.state);var styleChange=highlighters!=getHighlighters(_update21.startState);if(tree.length<_update21.view.viewport.to&&!styleChange&&tree.type==this.tree.type){this.decorations=this.decorations.map(_update21.changes);}else if(tree!=this.tree||_update21.viewportChanged||styleChange){this.tree=tree;this.decorations=this.buildDeco(_update21.view,highlighters);}}},{key:"buildDeco",value:function buildDeco(view,highlighters){var _this79=this;if(!highlighters||!this.tree.length)return Decoration.none;var builder=new RangeSetBuilder();var _iterator181=_createForOfIteratorHelper(view.visibleRanges),_step181;try{for(_iterator181.s();!(_step181=_iterator181.n()).done;){var _step181$value=_step181.value,from=_step181$value.from,to=_step181$value.to;highlightTree(this.tree,highlighters,function(from2,to2,style){builder.add(from2,to2,_this79.markCache[style]||(_this79.markCache[style]=Decoration.mark({"class":style})));},from,to);}}catch(err){_iterator181.e(err);}finally{_iterator181.f();}return builder.finish();}}]);return TreeHighlighter;}();var treeHighlighter=/* @__PURE__ */Prec.high(/* @__PURE__ */ViewPlugin.fromClass(TreeHighlighter,{decorations:function decorations(v){return v.decorations;}}));var _defaultHighlightStyle=/* @__PURE__ */_HighlightStyle.define([{tag:tags.meta,color:"#404740"},{tag:tags.link,textDecoration:"underline"},{tag:tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strong,fontWeight:"bold"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.keyword,color:"#708"},{tag:[tags.atom,tags.bool,tags.url,tags.contentSeparator,tags.labelName],color:"#219"},{tag:[tags.literal,tags.inserted],color:"#164"},{tag:[tags.string,tags.deleted],color:"#a11"},{tag:[tags.regexp,tags.escape,/* @__PURE__ */tags.special(tags.string)],color:"#e40"},{tag:/* @__PURE__ */tags.definition(tags.variableName),color:"#00f"},{tag:/* @__PURE__ */tags.local(tags.variableName),color:"#30a"},{tag:[tags.typeName,tags.namespace],color:"#085"},{tag:tags.className,color:"#167"},{tag:[/* @__PURE__ */tags.special(tags.variableName),tags.macroName],color:"#256"},{tag:/* @__PURE__ */tags.definition(tags.propertyName),color:"#00c"},{tag:tags.comment,color:"#940"},{tag:tags.invalid,color:"#f00"}]);var baseTheme2=/* @__PURE__ */EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}});var DefaultScanDist=1e4;var DefaultBrackets="()[]{}";var bracketMatchingConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){return combineConfig(configs,{afterCursor:true,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch});}});var matchingMark=/* @__PURE__ */Decoration.mark({"class":"cm-matchingBracket"});var nonmatchingMark=/* @__PURE__ */Decoration.mark({"class":"cm-nonmatchingBracket"});function defaultRenderMatch(match){var decorations2=[];var mark=match.matched?matchingMark:nonmatchingMark;decorations2.push(mark.range(match.start.from,match.start.to));if(match.end)decorations2.push(mark.range(match.end.from,match.end.to));return decorations2;}var bracketMatchingState=/* @__PURE__ */StateField.define({create:function create(){return Decoration.none;},update:function update(deco,tr){if(!tr.docChanged&&!tr.selection)return deco;var decorations2=[];var config2=tr.state.facet(bracketMatchingConfig);var _iterator182=_createForOfIteratorHelper(tr.state.selection.ranges),_step182;try{for(_iterator182.s();!(_step182=_iterator182.n()).done;){var range=_step182.value;if(!range.empty)continue;var match=_matchBrackets(tr.state,range.head,-1,config2)||range.head>0&&_matchBrackets(tr.state,range.head-1,1,config2)||config2.afterCursor&&(_matchBrackets(tr.state,range.head,1,config2)||range.head<tr.state.doc.length&&_matchBrackets(tr.state,range.head+1,-1,config2));if(match)decorations2=decorations2.concat(config2.renderMatch(match,tr.state));}}catch(err){_iterator182.e(err);}finally{_iterator182.f();}return Decoration.set(decorations2,true);},provide:function provide(f){return EditorView.decorations.from(f);}});var bracketMatchingUnique=[bracketMatchingState,baseTheme2];function _bracketMatching(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[bracketMatchingConfig.of(config2),bracketMatchingUnique];}var _bracketMatchingHandle=/* @__PURE__ */new NodeProp();function matchingNodes(node,dir,brackets){var byProp=node.prop(dir<0?NodeProp.openedBy:NodeProp.closedBy);if(byProp)return byProp;if(node.name.length==1){var index=brackets.indexOf(node.name);if(index>-1&&index%2==(dir<0?1:0))return[brackets[index+dir]];}return null;}function findHandle(node){var hasHandle=node.type.prop(_bracketMatchingHandle);return hasHandle?hasHandle(node.node):node;}function _matchBrackets(state,pos,dir){var config2=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var maxScanDistance=config2.maxScanDistance||DefaultScanDist,brackets=config2.brackets||DefaultBrackets;var tree=_syntaxTree(state),node=tree.resolveInner(pos,dir);for(var cur2=node;cur2;cur2=cur2.parent){var matches=matchingNodes(cur2.type,dir,brackets);if(matches&&cur2.from<cur2.to){var handle=findHandle(cur2);if(handle&&(dir>0?pos>=handle.from&&pos<handle.to:pos>handle.from&&pos<=handle.to))return matchMarkedBrackets(state,pos,dir,cur2,handle,matches,brackets);}}return matchPlainBrackets(state,pos,dir,tree,node.type,maxScanDistance,brackets);}function matchMarkedBrackets(_state,_pos,dir,token,handle,matching,brackets){var parent=token.parent,firstToken={from:handle.from,to:handle.to};var depth=0,cursor2=parent===null||parent===void 0?void 0:parent.cursor();if(cursor2&&(dir<0?cursor2.childBefore(token.from):cursor2.childAfter(token.to)))do{if(dir<0?cursor2.to<=token.from:cursor2.from>=token.to){if(depth==0&&matching.indexOf(cursor2.type.name)>-1&&cursor2.from<cursor2.to){var endHandle=findHandle(cursor2);return{start:firstToken,end:endHandle?{from:endHandle.from,to:endHandle.to}:void 0,matched:true};}else if(matchingNodes(cursor2.type,dir,brackets)){depth++;}else if(matchingNodes(cursor2.type,-dir,brackets)){if(depth==0){var _endHandle=findHandle(cursor2);return{start:firstToken,end:_endHandle&&_endHandle.from<_endHandle.to?{from:_endHandle.from,to:_endHandle.to}:void 0,matched:false};}depth--;}}}while(dir<0?cursor2.prevSibling():cursor2.nextSibling());return{start:firstToken,matched:false};}function matchPlainBrackets(state,pos,dir,tree,tokenType,maxScanDistance,brackets){var startCh=dir<0?state.sliceDoc(pos-1,pos):state.sliceDoc(pos,pos+1);var bracket2=brackets.indexOf(startCh);if(bracket2<0||bracket2%2==0!=dir>0)return null;var startToken={from:dir<0?pos-1:pos,to:dir>0?pos+1:pos};var iter=state.doc.iterRange(pos,dir>0?state.doc.length:0),depth=0;for(var distance=0;!iter.next().done&&distance<=maxScanDistance;){var _text6=iter.value;if(dir<0)distance+=_text6.length;var basePos=pos+distance*dir;for(var pos2=dir>0?0:_text6.length-1,end=dir>0?_text6.length:-1;pos2!=end;pos2+=dir){var found=brackets.indexOf(_text6[pos2]);if(found<0||tree.resolveInner(basePos+pos2,1).type!=tokenType)continue;if(found%2==0==dir>0){depth++;}else if(depth==1){return{start:startToken,end:{from:basePos+pos2,to:basePos+pos2+1},matched:found>>1==bracket2>>1};}else{depth--;}}if(dir>0)distance+=_text6.length;}return iter.done?{start:startToken,matched:false}:null;}function countCol(string2,end,tabSize){var startIndex=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var startValue=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(end==null){end=string2.search(/[^\s\u00a0]/);if(end==-1)end=string2.length;}var n=startValue;for(var _i143=startIndex;_i143<end;_i143++){if(string2.charCodeAt(_i143)==9)n+=tabSize-n%tabSize;else n++;}return n;}var _StringStream=/*#__PURE__*/function(){function _StringStream(string2,tabSize,indentUnit2,overrideIndent){_classCallCheck(this,_StringStream);this.string=string2;this.tabSize=tabSize;this.indentUnit=indentUnit2;this.overrideIndent=overrideIndent;this.pos=0;this.start=0;this.lastColumnPos=0;this.lastColumnValue=0;}_createClass(_StringStream,[{key:"eol",value:function eol(){return this.pos>=this.string.length;}},{key:"sol",value:function sol(){return this.pos==0;}},{key:"peek",value:function peek(){return this.string.charAt(this.pos)||void 0;}},{key:"next",value:function next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++);}},{key:"eat",value:function eat(match){var ch=this.string.charAt(this.pos);var ok;if(typeof match=="string")ok=ch==match;else ok=ch&&(match instanceof RegExp?match.test(ch):match(ch));if(ok){++this.pos;return ch;}}},{key:"eatWhile",value:function eatWhile(match){var start=this.pos;while(this.eat(match)){}return this.pos>start;}},{key:"eatSpace",value:function eatSpace(){var start=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos;}return this.pos>start;}},{key:"skipToEnd",value:function skipToEnd(){this.pos=this.string.length;}},{key:"skipTo",value:function skipTo(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1){this.pos=found;return true;}}},{key:"backUp",value:function backUp(n){this.pos-=n;}},{key:"column",value:function column(){if(this.lastColumnPos<this.start){this.lastColumnValue=countCol(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start;}return this.lastColumnValue;}},{key:"indentation",value:function indentation(){var _a2;return(_a2=this.overrideIndent)!==null&&_a2!==void 0?_a2:countCol(this.string,null,this.tabSize);}},{key:"match",value:function match(pattern,consume,caseInsensitive){if(typeof pattern=="string"){var cased=function cased(str){return caseInsensitive?str.toLowerCase():str;};var substr=this.string.substr(this.pos,pattern.length);if(cased(substr)==cased(pattern)){if(consume!==false)this.pos+=pattern.length;return true;}else return null;}else{var match=this.string.slice(this.pos).match(pattern);if(match&&match.index>0)return null;if(match&&consume!==false)this.pos+=match[0].length;return match;}}},{key:"current",value:function current(){return this.string.slice(this.start,this.pos);}}]);return _StringStream;}();function fullParser(spec){return{name:spec.name||"",token:spec.token,blankLine:spec.blankLine||function(){},startState:spec.startState||function(){return true;},copyState:spec.copyState||defaultCopyState,indent:spec.indent||function(){return null;},languageData:spec.languageData||{},tokenTable:spec.tokenTable||noTokens};}function defaultCopyState(state){if(_typeof(state)!="object")return state;var newState={};for(var prop in state){var val=state[prop];newState[prop]=val instanceof Array?val.slice():val;}return newState;}var IndentedFrom=/* @__PURE__ */new WeakMap();var _StreamLanguage=/*#__PURE__*/function(_Language3){_inherits(_StreamLanguage,_Language3);var _super35=_createSuper(_StreamLanguage);function _StreamLanguage(parser5){var _this80;_classCallCheck(this,_StreamLanguage);var data2=_defineLanguageFacet(parser5.languageData);var p=fullParser(parser5),self;var impl=new(/*#__PURE__*/function(_Parser2){_inherits(_class12,_Parser2);var _super36=_createSuper(_class12);function _class12(){_classCallCheck(this,_class12);return _super36.apply(this,arguments);}_createClass(_class12,[{key:"createParse",value:function createParse(input,fragments,ranges){return new Parse(self,input,fragments,ranges);}}]);return _class12;}(Parser))();_this80=_super35.call(this,data2,impl,[_indentService.of(function(cx,pos){return _this80.getIndent(cx,pos);})],parser5.name);_this80.topNode=docID(data2);self=_assertThisInitialized(_this80);_this80.streamParser=p;_this80.stateAfter=new NodeProp({perNode:true});_this80.tokenTable=parser5.tokenTable?new TokenTable(p.tokenTable):defaultTokenTable;return _this80;}_createClass(_StreamLanguage,[{key:"getIndent",value:function getIndent(cx,pos){var tree=_syntaxTree(cx.state),at=tree.resolve(pos);while(at&&at.type!=this.topNode){at=at.parent;}if(!at)return null;var from=void 0;var overrideIndentation=cx.options.overrideIndentation;if(overrideIndentation){from=IndentedFrom.get(cx.state);if(from!=null&&from<pos-1e4)from=void 0;}var start=findState(this,tree,0,at.from,from!==null&&from!==void 0?from:pos),statePos,state;if(start){state=start.state;statePos=start.pos+1;}else{state=this.streamParser.startState(cx.unit);statePos=0;}if(pos-statePos>1e4)return null;while(statePos<pos){var line2=cx.state.doc.lineAt(statePos),end=Math.min(pos,line2.to);if(line2.length){var indentation=overrideIndentation?overrideIndentation(line2.from):-1;var stream=new _StringStream(line2.text,cx.state.tabSize,cx.unit,indentation<0?void 0:indentation);while(stream.pos<end-line2.from){readToken(this.streamParser.token,stream,state);}}else{this.streamParser.blankLine(state,cx.unit);}if(end==pos)break;statePos=line2.to+1;}var line=cx.lineAt(pos);if(overrideIndentation&&from==null)IndentedFrom.set(cx.state,line.from);return this.streamParser.indent(state,/^\s*(.*)/.exec(line.text)[1],cx);}},{key:"allowsNesting",get:function get(){return false;}}],[{key:"define",value:function define(spec){return new _StreamLanguage(spec);}}]);return _StreamLanguage;}(_Language);function findState(lang,tree,off,startPos,before){var state=off>=startPos&&off+tree.length<=before&&tree.prop(lang.stateAfter);if(state)return{state:lang.streamParser.copyState(state),pos:off+tree.length};for(var _i144=tree.children.length-1;_i144>=0;_i144--){var child=tree.children[_i144],pos=off+tree.positions[_i144];var found=child instanceof Tree&&pos<before&&findState(lang,child,pos,startPos,before);if(found)return found;}return null;}function cutTree(lang,tree,from,to,inside2){if(inside2&&from<=0&&to>=tree.length)return tree;if(!inside2&&tree.type==lang.topNode)inside2=true;for(var _i145=tree.children.length-1;_i145>=0;_i145--){var pos=tree.positions[_i145],child=tree.children[_i145],inner=void 0;if(pos<to&&child instanceof Tree){if(!(inner=cutTree(lang,child,from-pos,to-pos,inside2)))break;return!inside2?inner:new Tree(tree.type,tree.children.slice(0,_i145).concat(inner),tree.positions.slice(0,_i145+1),pos+inner.length);}}return null;}function findStartInFragments(lang,fragments,startPos,editorState){var _iterator183=_createForOfIteratorHelper(fragments),_step183;try{for(_iterator183.s();!(_step183=_iterator183.n()).done;){var f=_step183.value;var from=f.from+(f.openStart?25:0),to=f.to-(f.openEnd?25:0);var found=from<=startPos&&to>startPos&&findState(lang,f.tree,0-f.offset,startPos,to),tree=void 0;if(found&&(tree=cutTree(lang,f.tree,startPos+f.offset,found.pos+f.offset,false)))return{state:found.state,tree:tree};}}catch(err){_iterator183.e(err);}finally{_iterator183.f();}return{state:lang.streamParser.startState(editorState?_getIndentUnit(editorState):4),tree:Tree.empty};}var Parse=/*#__PURE__*/function(){function Parse(lang,input,fragments,ranges){_classCallCheck(this,Parse);this.lang=lang;this.input=input;this.fragments=fragments;this.ranges=ranges;this.stoppedAt=null;this.chunks=[];this.chunkPos=[];this.chunk=[];this.chunkReused=void 0;this.rangeIndex=0;this.to=ranges[ranges.length-1].to;var context=_ParseContext.get(),from=ranges[0].from;var _findStartInFragments=findStartInFragments(lang,fragments,from,context===null||context===void 0?void 0:context.state),state=_findStartInFragments.state,tree=_findStartInFragments.tree;this.state=state;this.parsedPos=this.chunkStart=from+tree.length;for(var _i146=0;_i146<tree.children.length;_i146++){this.chunks.push(tree.children[_i146]);this.chunkPos.push(tree.positions[_i146]);}if(context&&this.parsedPos<context.viewport.from-1e5){this.state=this.lang.streamParser.startState(_getIndentUnit(context.state));context.skipUntilInView(this.parsedPos,context.viewport.from);this.parsedPos=context.viewport.from;}this.moveRangeIndex();}_createClass(Parse,[{key:"advance",value:function advance(){var context=_ParseContext.get();var parseEnd=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt);var end=Math.min(parseEnd,this.chunkStart+2048);if(context)end=Math.min(end,context.viewport.to);while(this.parsedPos<end){this.parseLine(context);}if(this.chunkStart<this.parsedPos)this.finishChunk();if(this.parsedPos>=parseEnd)return this.finish();if(context&&this.parsedPos>=context.viewport.to){context.skipUntilInView(this.parsedPos,parseEnd);return this.finish();}return null;}},{key:"stopAt",value:function stopAt(pos){this.stoppedAt=pos;}},{key:"lineAfter",value:function lineAfter(pos){var chunk=this.input.chunk(pos);if(!this.input.lineChunks){var eol=chunk.indexOf("\n");if(eol>-1)chunk=chunk.slice(0,eol);}else if(chunk=="\n"){chunk="";}return pos+chunk.length<=this.to?chunk:chunk.slice(0,this.to-pos);}},{key:"nextLine",value:function nextLine(){var from=this.parsedPos,line=this.lineAfter(from),end=from+line.length;for(var index=this.rangeIndex;;){var rangeEnd2=this.ranges[index].to;if(rangeEnd2>=end)break;line=line.slice(0,rangeEnd2-(end-line.length));index++;if(index==this.ranges.length)break;var rangeStart=this.ranges[index].from;var after=this.lineAfter(rangeStart);line+=after;end=rangeStart+after.length;}return{line:line,end:end};}},{key:"skipGapsTo",value:function skipGapsTo(pos,offset,side){for(;;){var end=this.ranges[this.rangeIndex].to,offPos=pos+offset;if(side>0?end>offPos:end>=offPos)break;var start=this.ranges[++this.rangeIndex].from;offset+=start-end;}return offset;}},{key:"moveRangeIndex",value:function moveRangeIndex(){while(this.ranges[this.rangeIndex].to<this.parsedPos){this.rangeIndex++;}}},{key:"emitToken",value:function emitToken(id2,from,to,size,offset){if(this.ranges.length>1){offset=this.skipGapsTo(from,offset,1);from+=offset;var len0=this.chunk.length;offset=this.skipGapsTo(to,offset,-1);to+=offset;size+=this.chunk.length-len0;}this.chunk.push(id2,from,to,size);return offset;}},{key:"parseLine",value:function parseLine(context){var _this$nextLine=this.nextLine(),line=_this$nextLine.line,end=_this$nextLine.end,offset=0,streamParser=this.lang.streamParser;var stream=new _StringStream(line,context?context.state.tabSize:4,context?_getIndentUnit(context.state):2);if(stream.eol()){streamParser.blankLine(this.state,stream.indentUnit);}else{while(!stream.eol()){var token=readToken(streamParser.token,stream,this.state);if(token)offset=this.emitToken(this.lang.tokenTable.resolve(token),this.parsedPos+stream.start,this.parsedPos+stream.pos,4,offset);if(stream.start>1e4)break;}}this.parsedPos=end;this.moveRangeIndex();if(this.parsedPos<this.to)this.parsedPos++;}},{key:"finishChunk",value:function finishChunk(){var tree=Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:nodeSet,topID:0,maxBufferLength:2048,reused:this.chunkReused});tree=new Tree(tree.type,tree.children,tree.positions,tree.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]);this.chunks.push(tree);this.chunkPos.push(this.chunkStart-this.ranges[0].from);this.chunk=[];this.chunkReused=void 0;this.chunkStart=this.parsedPos;}},{key:"finish",value:function finish(){return new Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance();}}]);return Parse;}();function readToken(token,stream,state){stream.start=stream.pos;for(var _i147=0;_i147<10;_i147++){var result=token(stream,state);if(stream.pos>stream.start)return result;}throw new Error("Stream parser failed to advance stream.");}var noTokens=/* @__PURE__ */Object.create(null);var typeArray=[NodeType.none];var nodeSet=/* @__PURE__ */new NodeSet(typeArray);var warned=[];var defaultTable=/* @__PURE__ */Object.create(null);for(var _i148=0,_arr3=[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]];_i148<_arr3.length;_i148++){var _arr3$_i=_slicedToArray(_arr3[_i148],2),legacyName=_arr3$_i[0],name2=_arr3$_i[1];defaultTable[legacyName]=/* @__PURE__ */createTokenType(noTokens,name2);}var TokenTable=/*#__PURE__*/function(){function TokenTable(extra){_classCallCheck(this,TokenTable);this.extra=extra;this.table=Object.assign(/* @__PURE__ */Object.create(null),defaultTable);}_createClass(TokenTable,[{key:"resolve",value:function resolve(tag){return!tag?0:this.table[tag]||(this.table[tag]=createTokenType(this.extra,tag));}}]);return TokenTable;}();var defaultTokenTable=/* @__PURE__ */new TokenTable(noTokens);function warnForPart(part,msg){if(warned.indexOf(part)>-1)return;warned.push(part);console.warn(msg);}function createTokenType(extra,tagStr){var tags$1=[];var _iterator184=_createForOfIteratorHelper(tagStr.split(" ")),_step184;try{for(_iterator184.s();!(_step184=_iterator184.n()).done;){var name3=_step184.value;var found=[];var _iterator185=_createForOfIteratorHelper(name3.split(".")),_step185;try{for(_iterator185.s();!(_step185=_iterator185.n()).done;){var part=_step185.value;var value=extra[part]||tags[part];if(!value){warnForPart(part,"Unknown highlighting tag ".concat(part));}else if(typeof value=="function"){if(!found.length)warnForPart(part,"Modifier ".concat(part," used at start of tag"));else found=found.map(value);}else{if(found.length)warnForPart(part,"Tag ".concat(part," used as modifier"));else found=Array.isArray(value)?value:[value];}}}catch(err){_iterator185.e(err);}finally{_iterator185.f();}var _iterator186=_createForOfIteratorHelper(found),_step186;try{for(_iterator186.s();!(_step186=_iterator186.n()).done;){var tag=_step186.value;tags$1.push(tag);}}catch(err){_iterator186.e(err);}finally{_iterator186.f();}}}catch(err){_iterator184.e(err);}finally{_iterator184.f();}if(!tags$1.length)return 0;var name2=tagStr.replace(/ /g,"_"),type=NodeType.define({id:typeArray.length,name:name2,props:[styleTags(_defineProperty({},name2,tags$1))]});typeArray.push(type);return type.id;}function docID(data2){var type=NodeType.define({id:typeArray.length,name:"Document",props:[_languageDataProp.add(function(){return data2;})],top:true});typeArray.push(type);return type;}// ../node_modules/@codemirror/commands/dist/index.js
var toggleComment=function toggleComment(target){var config2=getConfig(target.state);return config2.line?toggleLineComment(target):config2.block?toggleBlockCommentByLine(target):false;};function command(f,option){return function(_ref19){var state=_ref19.state,dispatch=_ref19.dispatch;if(state.readOnly)return false;var tr=f(option,state);if(!tr)return false;dispatch(state.update(tr));return true;};}var toggleLineComment=/* @__PURE__ */command(changeLineComment,0);var toggleBlockComment=/* @__PURE__ */command(changeBlockComment,0);var toggleBlockCommentByLine=/* @__PURE__ */command(function(o,s){return changeBlockComment(o,s,selectedLineRanges(s));},0);function getConfig(state){var pos=arguments.length>1&&arguments[1]!==undefined?arguments[1]:state.selection.main.head;var data2=state.languageDataAt("commentTokens",pos);return data2.length?data2[0]:{};}var SearchMargin=50;function findBlockComment(state,_ref20,from,to){var open=_ref20.open,close=_ref20.close;var textBefore=state.sliceDoc(from-SearchMargin,from);var textAfter=state.sliceDoc(to,to+SearchMargin);var spaceBefore=/\s*$/.exec(textBefore)[0].length,spaceAfter=/^\s*/.exec(textAfter)[0].length;var beforeOff=textBefore.length-spaceBefore;if(textBefore.slice(beforeOff-open.length,beforeOff)==open&&textAfter.slice(spaceAfter,spaceAfter+close.length)==close){return{open:{pos:from-spaceBefore,margin:spaceBefore&&1},close:{pos:to+spaceAfter,margin:spaceAfter&&1}};}var startText,endText;if(to-from<=2*SearchMargin){startText=endText=state.sliceDoc(from,to);}else{startText=state.sliceDoc(from,from+SearchMargin);endText=state.sliceDoc(to-SearchMargin,to);}var startSpace=/^\s*/.exec(startText)[0].length,endSpace=/\s*$/.exec(endText)[0].length;var endOff=endText.length-endSpace-close.length;if(startText.slice(startSpace,startSpace+open.length)==open&&endText.slice(endOff,endOff+close.length)==close){return{open:{pos:from+startSpace+open.length,margin:/\s/.test(startText.charAt(startSpace+open.length))?1:0},close:{pos:to-endSpace-close.length,margin:/\s/.test(endText.charAt(endOff-1))?1:0}};}return null;}function selectedLineRanges(state){var ranges=[];var _iterator187=_createForOfIteratorHelper(state.selection.ranges),_step187;try{for(_iterator187.s();!(_step187=_iterator187.n()).done;){var _r11=_step187.value;var fromLine=state.doc.lineAt(_r11.from);var toLine=_r11.to<=fromLine.to?fromLine:state.doc.lineAt(_r11.to);var last=ranges.length-1;if(last>=0&&ranges[last].to>fromLine.from)ranges[last].to=toLine.to;else ranges.push({from:fromLine.from,to:toLine.to});}}catch(err){_iterator187.e(err);}finally{_iterator187.f();}return ranges;}function changeBlockComment(option,state){var ranges=arguments.length>2&&arguments[2]!==undefined?arguments[2]:state.selection.ranges;var tokens=ranges.map(function(r){return getConfig(state,r.from).block;});if(!tokens.every(function(c){return c;}))return null;var comments=ranges.map(function(r,i){return findBlockComment(state,tokens[i],r.from,r.to);});if(option!=2&&!comments.every(function(c){return c;})){return{changes:state.changes(ranges.map(function(range,i){if(comments[i])return[];return[{from:range.from,insert:tokens[i].open+" "},{from:range.to,insert:" "+tokens[i].close}];}))};}else if(option!=1&&comments.some(function(c){return c;})){var changes=[];for(var _i149=0,comment2;_i149<comments.length;_i149++){if(comment2=comments[_i149]){var token=tokens[_i149],_comment=comment2,open=_comment.open,close=_comment.close;changes.push({from:open.pos-token.open.length,to:open.pos+open.margin},{from:close.pos-close.margin,to:close.pos+token.close.length});}}return{changes:changes};}return null;}function changeLineComment(option,state){var ranges=arguments.length>2&&arguments[2]!==undefined?arguments[2]:state.selection.ranges;var lines=[];var prevLine=-1;var _iterator188=_createForOfIteratorHelper(ranges),_step188;try{for(_iterator188.s();!(_step188=_iterator188.n()).done;){var _step188$value=_step188.value,_from2=_step188$value.from,_to2=_step188$value.to;var startI=lines.length,minIndent=1e9;for(var pos=_from2;pos<=_to2;){var _line5=state.doc.lineAt(pos);if(_line5.from>prevLine&&(_from2==_to2||_to2>_line5.from)){prevLine=_line5.from;var _token2=getConfig(state,pos).line;if(!_token2)continue;var _indent=/^\s*/.exec(_line5.text)[0].length;var _empty=_indent==_line5.length;var _comment2=_line5.text.slice(_indent,_indent+_token2.length)==_token2?_indent:-1;if(_indent<_line5.text.length&&_indent<minIndent)minIndent=_indent;lines.push({line:_line5,comment:_comment2,token:_token2,indent:_indent,empty:_empty,single:false});}pos=_line5.to+1;}if(minIndent<1e9){for(var _i150=startI;_i150<lines.length;_i150++){if(lines[_i150].indent<lines[_i150].line.text.length)lines[_i150].indent=minIndent;}}if(lines.length==startI+1)lines[startI].single=true;}}catch(err){_iterator188.e(err);}finally{_iterator188.f();}if(option!=2&&lines.some(function(l){return l.comment<0&&(!l.empty||l.single);})){var changes=[];var _iterator189=_createForOfIteratorHelper(lines),_step189;try{for(_iterator189.s();!(_step189=_iterator189.n()).done;){var _step189$value=_step189.value,line=_step189$value.line,token=_step189$value.token,indent=_step189$value.indent,empty2=_step189$value.empty,single=_step189$value.single;if(single||!empty2)changes.push({from:line.from+indent,insert:token+" "});}}catch(err){_iterator189.e(err);}finally{_iterator189.f();}var changeSet=state.changes(changes);return{changes:changeSet,selection:state.selection.map(changeSet,1)};}else if(option!=1&&lines.some(function(l){return l.comment>=0;})){var _changes2=[];var _iterator190=_createForOfIteratorHelper(lines),_step190;try{for(_iterator190.s();!(_step190=_iterator190.n()).done;){var _step190$value=_step190.value,_line4=_step190$value.line,comment2=_step190$value.comment,_token=_step190$value.token;if(comment2>=0){var from=_line4.from+comment2,to=from+_token.length;if(_line4.text[to-_line4.from]==" ")to++;_changes2.push({from:from,to:to});}}}catch(err){_iterator190.e(err);}finally{_iterator190.f();}return{changes:_changes2};}return null;}var fromHistory=/* @__PURE__ */Annotation.define();var isolateHistory=/* @__PURE__ */Annotation.define();var invertedEffects=/* @__PURE__ */Facet.define();var historyConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){return combineConfig(configs,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min});}});function changeEnd(changes){var end=0;changes.iterChangedRanges(function(_,to){return end=to;});return end;}var historyField_=/* @__PURE__ */StateField.define({create:function create(){return HistoryState.empty;},update:function update(state,tr){var config2=tr.state.facet(historyConfig);var fromHist=tr.annotation(fromHistory);if(fromHist){var selection2=tr.docChanged?EditorSelection.single(changeEnd(tr.changes)):void 0;var item=HistEvent.fromTransaction(tr,selection2),from=fromHist.side;var other=from==0?state.undone:state.done;if(item)other=updateBranch(other,other.length,config2.minDepth,item);else other=_addSelection(other,tr.startState.selection);return new HistoryState(from==0?fromHist.rest:other,from==0?other:fromHist.rest);}var isolate=tr.annotation(isolateHistory);if(isolate=="full"||isolate=="before")state=state.isolate();if(tr.annotation(Transaction.addToHistory)===false)return!tr.changes.empty?state.addMapping(tr.changes.desc):state;var event=HistEvent.fromTransaction(tr);var time=tr.annotation(Transaction.time),userEvent=tr.annotation(Transaction.userEvent);if(event)state=state.addChanges(event,time,userEvent,config2.newGroupDelay,config2.minDepth);else if(tr.selection)state=state.addSelection(tr.startState.selection,time,userEvent,config2.newGroupDelay);if(isolate=="full"||isolate=="after")state=state.isolate();return state;},toJSON:function toJSON(value){return{done:value.done.map(function(e){return e.toJSON();}),undone:value.undone.map(function(e){return e.toJSON();})};},fromJSON:function fromJSON(json){return new HistoryState(json.done.map(HistEvent.fromJSON),json.undone.map(HistEvent.fromJSON));}});function history(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[historyField_,historyConfig.of(config2),EditorView.domEventHandlers({beforeinput:function beforeinput(e,view){var command2=e.inputType=="historyUndo"?undo:e.inputType=="historyRedo"?redo:null;if(!command2)return false;e.preventDefault();return command2(view);}})];}function cmd(side,selection2){return function(_ref21){var state=_ref21.state,dispatch=_ref21.dispatch;if(!selection2&&state.readOnly)return false;var historyState=state.field(historyField_,false);if(!historyState)return false;var tr=historyState.pop(side,state,selection2);if(!tr)return false;dispatch(tr);return true;};}var undo=/* @__PURE__ */cmd(0,false);var redo=/* @__PURE__ */cmd(1,false);var undoSelection=/* @__PURE__ */cmd(0,true);var redoSelection=/* @__PURE__ */cmd(1,true);var HistEvent=/*#__PURE__*/function(){function HistEvent(changes,effects,mapped,startSelection,selectionsAfter){_classCallCheck(this,HistEvent);this.changes=changes;this.effects=effects;this.mapped=mapped;this.startSelection=startSelection;this.selectionsAfter=selectionsAfter;}_createClass(HistEvent,[{key:"setSelAfter",value:function setSelAfter(after){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,after);}},{key:"toJSON",value:function toJSON(){var _a2,_b,_c;return{changes:(_a2=this.changes)===null||_a2===void 0?void 0:_a2.toJSON(),mapped:(_b=this.mapped)===null||_b===void 0?void 0:_b.toJSON(),startSelection:(_c=this.startSelection)===null||_c===void 0?void 0:_c.toJSON(),selectionsAfter:this.selectionsAfter.map(function(s){return s.toJSON();})};}}],[{key:"fromJSON",value:function fromJSON(json){return new HistEvent(json.changes&&ChangeSet.fromJSON(json.changes),[],json.mapped&&ChangeDesc.fromJSON(json.mapped),json.startSelection&&EditorSelection.fromJSON(json.startSelection),json.selectionsAfter.map(EditorSelection.fromJSON));}},{key:"fromTransaction",value:function fromTransaction(tr,selection2){var effects=none2;var _iterator191=_createForOfIteratorHelper(tr.startState.facet(invertedEffects)),_step191;try{for(_iterator191.s();!(_step191=_iterator191.n()).done;){var invert=_step191.value;var result=invert(tr);if(result.length)effects=effects.concat(result);}}catch(err){_iterator191.e(err);}finally{_iterator191.f();}if(!effects.length&&tr.changes.empty)return null;return new HistEvent(tr.changes.invert(tr.startState.doc),effects,void 0,selection2||tr.startState.selection,none2);}},{key:"selection",value:function selection(selections){return new HistEvent(void 0,none2,void 0,void 0,selections);}}]);return HistEvent;}();function updateBranch(branch,to,maxLen,newEvent){var start=to+1>maxLen+20?to-maxLen-1:0;var newBranch=branch.slice(start,to);newBranch.push(newEvent);return newBranch;}function isAdjacent(a,b){var ranges=[],isAdjacent2=false;a.iterChangedRanges(function(f,t2){return ranges.push(f,t2);});b.iterChangedRanges(function(_f,_t,f,t2){for(var _i151=0;_i151<ranges.length;){var from=ranges[_i151++],to=ranges[_i151++];if(t2>=from&&f<=to)isAdjacent2=true;}});return isAdjacent2;}function eqSelectionShape(a,b){return a.ranges.length==b.ranges.length&&a.ranges.filter(function(r,i){return r.empty!=b.ranges[i].empty;}).length===0;}function conc(a,b){return!a.length?b:!b.length?a:a.concat(b);}var none2=[];var MaxSelectionsPerEvent=200;function _addSelection(branch,selection2){if(!branch.length){return[HistEvent.selection([selection2])];}else{var lastEvent=branch[branch.length-1];var sels=lastEvent.selectionsAfter.slice(Math.max(0,lastEvent.selectionsAfter.length-MaxSelectionsPerEvent));if(sels.length&&sels[sels.length-1].eq(selection2))return branch;sels.push(selection2);return updateBranch(branch,branch.length-1,1e9,lastEvent.setSelAfter(sels));}}function popSelection(branch){var last=branch[branch.length-1];var newBranch=branch.slice();newBranch[branch.length-1]=last.setSelAfter(last.selectionsAfter.slice(0,last.selectionsAfter.length-1));return newBranch;}function addMappingToBranch(branch,mapping){if(!branch.length)return branch;var length=branch.length,selections=none2;while(length){var event=mapEvent(branch[length-1],mapping,selections);if(event.changes&&!event.changes.empty||event.effects.length){var result=branch.slice(0,length);result[length-1]=event;return result;}else{mapping=event.mapped;length--;selections=event.selectionsAfter;}}return selections.length?[HistEvent.selection(selections)]:none2;}function mapEvent(event,mapping,extraSelections){var selections=conc(event.selectionsAfter.length?event.selectionsAfter.map(function(s){return s.map(mapping);}):none2,extraSelections);if(!event.changes)return HistEvent.selection(selections);var mappedChanges=event.changes.map(mapping),before=mapping.mapDesc(event.changes,true);var fullMapping=event.mapped?event.mapped.composeDesc(before):before;return new HistEvent(mappedChanges,StateEffect.mapEffects(event.effects,mapping),fullMapping,event.startSelection.map(before),selections);}var joinableUserEvent=/^(input\.type|delete)($|\.)/;var HistoryState=/*#__PURE__*/function(){function HistoryState(done,undone){var prevTime=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var prevUserEvent=arguments.length>3&&arguments[3]!==undefined?arguments[3]:void 0;_classCallCheck(this,HistoryState);this.done=done;this.undone=undone;this.prevTime=prevTime;this.prevUserEvent=prevUserEvent;}_createClass(HistoryState,[{key:"isolate",value:function isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this;}},{key:"addChanges",value:function addChanges(event,time,userEvent,newGroupDelay,maxLen){var done=this.done,lastEvent=done[done.length-1];if(lastEvent&&lastEvent.changes&&!lastEvent.changes.empty&&event.changes&&(!userEvent||joinableUserEvent.test(userEvent))&&(!lastEvent.selectionsAfter.length&&time-this.prevTime<newGroupDelay&&isAdjacent(lastEvent.changes,event.changes)||userEvent=="input.type.compose")){done=updateBranch(done,done.length-1,maxLen,new HistEvent(event.changes.compose(lastEvent.changes),conc(event.effects,lastEvent.effects),lastEvent.mapped,lastEvent.startSelection,none2));}else{done=updateBranch(done,done.length,maxLen,event);}return new HistoryState(done,none2,time,userEvent);}},{key:"addSelection",value:function addSelection(selection2,time,userEvent,newGroupDelay){var last=this.done.length?this.done[this.done.length-1].selectionsAfter:none2;if(last.length>0&&time-this.prevTime<newGroupDelay&&userEvent==this.prevUserEvent&&userEvent&&/^select($|\.)/.test(userEvent)&&eqSelectionShape(last[last.length-1],selection2))return this;return new HistoryState(_addSelection(this.done,selection2),this.undone,time,userEvent);}},{key:"addMapping",value:function addMapping(mapping){return new HistoryState(addMappingToBranch(this.done,mapping),addMappingToBranch(this.undone,mapping),this.prevTime,this.prevUserEvent);}},{key:"pop",value:function pop(side,state,selection2){var branch=side==0?this.done:this.undone;if(branch.length==0)return null;var event=branch[branch.length-1];if(selection2&&event.selectionsAfter.length){return state.update({selection:event.selectionsAfter[event.selectionsAfter.length-1],annotations:fromHistory.of({side:side,rest:popSelection(branch)}),userEvent:side==0?"select.undo":"select.redo",scrollIntoView:true});}else if(!event.changes){return null;}else{var rest=branch.length==1?none2:branch.slice(0,branch.length-1);if(event.mapped)rest=addMappingToBranch(rest,event.mapped);return state.update({changes:event.changes,selection:event.startSelection,effects:event.effects,annotations:fromHistory.of({side:side,rest:rest}),filter:false,userEvent:side==0?"undo":"redo",scrollIntoView:true});}}}]);return HistoryState;}();HistoryState.empty=/* @__PURE__ */new HistoryState(none2,none2);var historyKeymap=[{key:"Mod-z",run:undo,preventDefault:true},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:true},{linux:"Ctrl-Shift-z",run:redo,preventDefault:true},{key:"Mod-u",run:undoSelection,preventDefault:true},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:true}];function updateSel(sel,by){return EditorSelection.create(sel.ranges.map(by),sel.mainIndex);}function setSel(state,selection2){return state.update({selection:selection2,scrollIntoView:true,userEvent:"select"});}function moveSel(_ref22,how){var state=_ref22.state,dispatch=_ref22.dispatch;var selection2=updateSel(state.selection,how);if(selection2.eq(state.selection))return false;dispatch(setSel(state,selection2));return true;}function rangeEnd(range,forward){return EditorSelection.cursor(forward?range.to:range.from);}function cursorByChar(view,forward){return moveSel(view,function(range){return range.empty?view.moveByChar(range,forward):rangeEnd(range,forward);});}function ltrAtCursor(view){return view.textDirectionAt(view.state.selection.main.head)==Direction.LTR;}var cursorCharLeft=function cursorCharLeft(view){return cursorByChar(view,!ltrAtCursor(view));};var cursorCharRight=function cursorCharRight(view){return cursorByChar(view,ltrAtCursor(view));};function cursorByGroup(view,forward){return moveSel(view,function(range){return range.empty?view.moveByGroup(range,forward):rangeEnd(range,forward);});}var cursorGroupLeft=function cursorGroupLeft(view){return cursorByGroup(view,!ltrAtCursor(view));};var cursorGroupRight=function cursorGroupRight(view){return cursorByGroup(view,ltrAtCursor(view));};function interestingNode(state,node,bracketProp){if(node.type.prop(bracketProp))return true;var len=node.to-node.from;return len&&(len>2||/[^\s,.;:]/.test(state.sliceDoc(node.from,node.to)))||node.firstChild;}function moveBySyntax(state,start,forward){var pos=_syntaxTree(state).resolveInner(start.head);var bracketProp=forward?NodeProp.closedBy:NodeProp.openedBy;for(var at=start.head;;){var next=forward?pos.childAfter(at):pos.childBefore(at);if(!next)break;if(interestingNode(state,next,bracketProp))pos=next;else at=forward?next.to:next.from;}var bracket2=pos.type.prop(bracketProp),match,newPos;if(bracket2&&(match=forward?_matchBrackets(state,pos.from,1):_matchBrackets(state,pos.to,-1))&&match.matched)newPos=forward?match.end.to:match.end.from;else newPos=forward?pos.to:pos.from;return EditorSelection.cursor(newPos,forward?-1:1);}var cursorSyntaxLeft=function cursorSyntaxLeft(view){return moveSel(view,function(range){return moveBySyntax(view.state,range,!ltrAtCursor(view));});};var cursorSyntaxRight=function cursorSyntaxRight(view){return moveSel(view,function(range){return moveBySyntax(view.state,range,ltrAtCursor(view));});};function cursorByLine(view,forward){return moveSel(view,function(range){if(!range.empty)return rangeEnd(range,forward);var moved=view.moveVertically(range,forward);return moved.head!=range.head?moved:view.moveToLineBoundary(range,forward);});}var cursorLineUp=function cursorLineUp(view){return cursorByLine(view,false);};var cursorLineDown=function cursorLineDown(view){return cursorByLine(view,true);};function pageHeight(view){return Math.max(view.defaultLineHeight,Math.min(view.dom.clientHeight,innerHeight)-5);}function cursorByPage(view,forward){var state=view.state,selection2=updateSel(state.selection,function(range){return range.empty?view.moveVertically(range,forward,pageHeight(view)):rangeEnd(range,forward);});if(selection2.eq(state.selection))return false;var startPos=view.coordsAtPos(state.selection.main.head);var scrollRect=view.scrollDOM.getBoundingClientRect();var effect;if(startPos&&startPos.top>scrollRect.top&&startPos.bottom<scrollRect.bottom&&startPos.top-scrollRect.top<=view.scrollDOM.scrollHeight-view.scrollDOM.scrollTop-view.scrollDOM.clientHeight)effect=EditorView.scrollIntoView(selection2.main.head,{y:"start",yMargin:startPos.top-scrollRect.top});view.dispatch(setSel(state,selection2),{effects:effect});return true;}var cursorPageUp=function cursorPageUp(view){return cursorByPage(view,false);};var cursorPageDown=function cursorPageDown(view){return cursorByPage(view,true);};function moveByLineBoundary(view,start,forward){var line=view.lineBlockAt(start.head),moved=view.moveToLineBoundary(start,forward);if(moved.head==start.head&&moved.head!=(forward?line.to:line.from))moved=view.moveToLineBoundary(start,forward,false);if(!forward&&moved.head==line.from&&line.length){var space4=/^\s*/.exec(view.state.sliceDoc(line.from,Math.min(line.from+100,line.to)))[0].length;if(space4&&start.head!=line.from+space4)moved=EditorSelection.cursor(line.from+space4);}return moved;}var cursorLineBoundaryForward=function cursorLineBoundaryForward(view){return moveSel(view,function(range){return moveByLineBoundary(view,range,true);});};var cursorLineBoundaryBackward=function cursorLineBoundaryBackward(view){return moveSel(view,function(range){return moveByLineBoundary(view,range,false);});};var cursorLineStart=function cursorLineStart(view){return moveSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).from,1);});};var cursorLineEnd=function cursorLineEnd(view){return moveSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).to,-1);});};function toMatchingBracket(state,dispatch,extend2){var found=false,selection2=updateSel(state.selection,function(range){var matching=_matchBrackets(state,range.head,-1)||_matchBrackets(state,range.head,1)||range.head>0&&_matchBrackets(state,range.head-1,1)||range.head<state.doc.length&&_matchBrackets(state,range.head+1,-1);if(!matching||!matching.end)return range;found=true;var head=matching.start.from==range.head?matching.end.to:matching.end.from;return extend2?EditorSelection.range(range.anchor,head):EditorSelection.cursor(head);});if(!found)return false;dispatch(setSel(state,selection2));return true;}var cursorMatchingBracket=function cursorMatchingBracket(_ref23){var state=_ref23.state,dispatch=_ref23.dispatch;return toMatchingBracket(state,dispatch,false);};function extendSel(view,how){var selection2=updateSel(view.state.selection,function(range){var head=how(range);return EditorSelection.range(range.anchor,head.head,head.goalColumn);});if(selection2.eq(view.state.selection))return false;view.dispatch(setSel(view.state,selection2));return true;}function selectByChar(view,forward){return extendSel(view,function(range){return view.moveByChar(range,forward);});}var selectCharLeft=function selectCharLeft(view){return selectByChar(view,!ltrAtCursor(view));};var selectCharRight=function selectCharRight(view){return selectByChar(view,ltrAtCursor(view));};function selectByGroup(view,forward){return extendSel(view,function(range){return view.moveByGroup(range,forward);});}var selectGroupLeft=function selectGroupLeft(view){return selectByGroup(view,!ltrAtCursor(view));};var selectGroupRight=function selectGroupRight(view){return selectByGroup(view,ltrAtCursor(view));};var selectSyntaxLeft=function selectSyntaxLeft(view){return extendSel(view,function(range){return moveBySyntax(view.state,range,!ltrAtCursor(view));});};var selectSyntaxRight=function selectSyntaxRight(view){return extendSel(view,function(range){return moveBySyntax(view.state,range,ltrAtCursor(view));});};function selectByLine(view,forward){return extendSel(view,function(range){return view.moveVertically(range,forward);});}var selectLineUp=function selectLineUp(view){return selectByLine(view,false);};var selectLineDown=function selectLineDown(view){return selectByLine(view,true);};function selectByPage(view,forward){return extendSel(view,function(range){return view.moveVertically(range,forward,pageHeight(view));});}var selectPageUp=function selectPageUp(view){return selectByPage(view,false);};var selectPageDown=function selectPageDown(view){return selectByPage(view,true);};var selectLineBoundaryForward=function selectLineBoundaryForward(view){return extendSel(view,function(range){return moveByLineBoundary(view,range,true);});};var selectLineBoundaryBackward=function selectLineBoundaryBackward(view){return extendSel(view,function(range){return moveByLineBoundary(view,range,false);});};var selectLineStart=function selectLineStart(view){return extendSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).from);});};var selectLineEnd=function selectLineEnd(view){return extendSel(view,function(range){return EditorSelection.cursor(view.lineBlockAt(range.head).to);});};var cursorDocStart=function cursorDocStart(_ref24){var state=_ref24.state,dispatch=_ref24.dispatch;dispatch(setSel(state,{anchor:0}));return true;};var cursorDocEnd=function cursorDocEnd(_ref25){var state=_ref25.state,dispatch=_ref25.dispatch;dispatch(setSel(state,{anchor:state.doc.length}));return true;};var selectDocStart=function selectDocStart(_ref26){var state=_ref26.state,dispatch=_ref26.dispatch;dispatch(setSel(state,{anchor:state.selection.main.anchor,head:0}));return true;};var selectDocEnd=function selectDocEnd(_ref27){var state=_ref27.state,dispatch=_ref27.dispatch;dispatch(setSel(state,{anchor:state.selection.main.anchor,head:state.doc.length}));return true;};var selectAll=function selectAll(_ref28){var state=_ref28.state,dispatch=_ref28.dispatch;dispatch(state.update({selection:{anchor:0,head:state.doc.length},userEvent:"select"}));return true;};var selectLine=function selectLine(_ref29){var state=_ref29.state,dispatch=_ref29.dispatch;var ranges=selectedLineBlocks(state).map(function(_ref30){var from=_ref30.from,to=_ref30.to;return EditorSelection.range(from,Math.min(to+1,state.doc.length));});dispatch(state.update({selection:EditorSelection.create(ranges),userEvent:"select"}));return true;};var selectParentSyntax=function selectParentSyntax(_ref31){var state=_ref31.state,dispatch=_ref31.dispatch;var selection2=updateSel(state.selection,function(range){var _a2;var context=_syntaxTree(state).resolveInner(range.head,1);while(!(context.from<range.from&&context.to>=range.to||context.to>range.to&&context.from<=range.from||!((_a2=context.parent)===null||_a2===void 0?void 0:_a2.parent))){context=context.parent;}return EditorSelection.range(context.to,context.from);});dispatch(setSel(state,selection2));return true;};var simplifySelection=function simplifySelection(_ref32){var state=_ref32.state,dispatch=_ref32.dispatch;var cur2=state.selection,selection2=null;if(cur2.ranges.length>1)selection2=EditorSelection.create([cur2.main]);else if(!cur2.main.empty)selection2=EditorSelection.create([EditorSelection.cursor(cur2.main.head)]);if(!selection2)return false;dispatch(setSel(state,selection2));return true;};function deleteBy(_ref33,by){var state=_ref33.state,dispatch=_ref33.dispatch;if(state.readOnly)return false;var event="delete.selection";var changes=state.changeByRange(function(range){var from=range.from,to=range.to;if(from==to){var towards=by(from);if(towards<from)event="delete.backward";else if(towards>from)event="delete.forward";from=Math.min(from,towards);to=Math.max(to,towards);}return from==to?{range:range}:{changes:{from:from,to:to},range:EditorSelection.cursor(from)};});if(changes.changes.empty)return false;dispatch(state.update(changes,{scrollIntoView:true,userEvent:event,effects:event=="delete.selection"?EditorView.announce.of(state.phrase("Selection deleted")):void 0}));return true;}function skipAtomic(target,pos,forward){if(target instanceof EditorView){var _iterator192=_createForOfIteratorHelper(target.state.facet(EditorView.atomicRanges).map(function(f){return f(target);})),_step192;try{for(_iterator192.s();!(_step192=_iterator192.n()).done;){var ranges=_step192.value;ranges.between(pos,pos,function(from,to){if(from<pos&&to>pos)pos=forward?to:from;});}}catch(err){_iterator192.e(err);}finally{_iterator192.f();}}return pos;}var deleteByChar=function deleteByChar(target,forward){return deleteBy(target,function(pos){var state=target.state,line=state.doc.lineAt(pos),before,targetPos;if(!forward&&pos>line.from&&pos<line.from+200&&!/[^ \t]/.test(before=line.text.slice(0,pos-line.from))){if(before[before.length-1]=="	")return pos-1;var col=_countColumn(before,state.tabSize),drop=col%_getIndentUnit(state)||_getIndentUnit(state);for(var _i152=0;_i152<drop&&before[before.length-1-_i152]==" ";_i152++){pos--;}targetPos=pos;}else{targetPos=findClusterBreak(line.text,pos-line.from,forward,forward)+line.from;if(targetPos==pos&&line.number!=(forward?state.doc.lines:1))targetPos+=forward?1:-1;}return skipAtomic(target,targetPos,forward);});};var deleteCharBackward=function deleteCharBackward(view){return deleteByChar(view,false);};var deleteCharForward=function deleteCharForward(view){return deleteByChar(view,true);};var deleteByGroup=function deleteByGroup(target,forward){return deleteBy(target,function(start){var pos=start,state=target.state,line=state.doc.lineAt(pos);var categorize=state.charCategorizer(pos);for(var cat=null;;){if(pos==(forward?line.to:line.from)){if(pos==start&&line.number!=(forward?state.doc.lines:1))pos+=forward?1:-1;break;}var next=findClusterBreak(line.text,pos-line.from,forward)+line.from;var nextChar2=line.text.slice(Math.min(pos,next)-line.from,Math.max(pos,next)-line.from);var nextCat=categorize(nextChar2);if(cat!=null&&nextCat!=cat)break;if(nextChar2!=" "||pos!=start)cat=nextCat;pos=next;}return skipAtomic(target,pos,forward);});};var deleteGroupBackward=function deleteGroupBackward(target){return deleteByGroup(target,false);};var deleteGroupForward=function deleteGroupForward(target){return deleteByGroup(target,true);};var deleteToLineEnd=function deleteToLineEnd(view){return deleteBy(view,function(pos){var lineEnd2=view.lineBlockAt(pos).to;return skipAtomic(view,pos<lineEnd2?lineEnd2:Math.min(view.state.doc.length,pos+1),true);});};var deleteToLineStart=function deleteToLineStart(view){return deleteBy(view,function(pos){var lineStart=view.lineBlockAt(pos).from;return skipAtomic(view,pos>lineStart?lineStart:Math.max(0,pos-1),false);});};var splitLine=function splitLine(_ref34){var state=_ref34.state,dispatch=_ref34.dispatch;if(state.readOnly)return false;var changes=state.changeByRange(function(range){return{changes:{from:range.from,to:range.to,insert:Text.of(["",""])},range:EditorSelection.cursor(range.from)};});dispatch(state.update(changes,{scrollIntoView:true,userEvent:"input"}));return true;};var transposeChars=function transposeChars(_ref35){var state=_ref35.state,dispatch=_ref35.dispatch;if(state.readOnly)return false;var changes=state.changeByRange(function(range){if(!range.empty||range.from==0||range.from==state.doc.length)return{range:range};var pos=range.from,line=state.doc.lineAt(pos);var from=pos==line.from?pos-1:findClusterBreak(line.text,pos-line.from,false)+line.from;var to=pos==line.to?pos+1:findClusterBreak(line.text,pos-line.from,true)+line.from;return{changes:{from:from,to:to,insert:state.doc.slice(pos,to).append(state.doc.slice(from,pos))},range:EditorSelection.cursor(to)};});if(changes.changes.empty)return false;dispatch(state.update(changes,{scrollIntoView:true,userEvent:"move.character"}));return true;};function selectedLineBlocks(state){var blocks=[],upto=-1;var _iterator193=_createForOfIteratorHelper(state.selection.ranges),_step193;try{for(_iterator193.s();!(_step193=_iterator193.n()).done;){var range=_step193.value;var startLine=state.doc.lineAt(range.from),endLine=state.doc.lineAt(range.to);if(!range.empty&&range.to==endLine.from)endLine=state.doc.lineAt(range.to-1);if(upto>=startLine.number){var prev=blocks[blocks.length-1];prev.to=endLine.to;prev.ranges.push(range);}else{blocks.push({from:startLine.from,to:endLine.to,ranges:[range]});}upto=endLine.number+1;}}catch(err){_iterator193.e(err);}finally{_iterator193.f();}return blocks;}function moveLine(state,dispatch,forward){if(state.readOnly)return false;var changes=[],ranges=[];var _iterator194=_createForOfIteratorHelper(selectedLineBlocks(state)),_step194;try{for(_iterator194.s();!(_step194=_iterator194.n()).done;){var block=_step194.value;if(forward?block.to==state.doc.length:block.from==0)continue;var nextLine=state.doc.lineAt(forward?block.to+1:block.from-1);var size=nextLine.length+1;if(forward){changes.push({from:block.to,to:nextLine.to},{from:block.from,insert:nextLine.text+state.lineBreak});var _iterator195=_createForOfIteratorHelper(block.ranges),_step195;try{for(_iterator195.s();!(_step195=_iterator195.n()).done;){var _r12=_step195.value;ranges.push(EditorSelection.range(Math.min(state.doc.length,_r12.anchor+size),Math.min(state.doc.length,_r12.head+size)));}}catch(err){_iterator195.e(err);}finally{_iterator195.f();}}else{changes.push({from:nextLine.from,to:block.from},{from:block.to,insert:state.lineBreak+nextLine.text});var _iterator196=_createForOfIteratorHelper(block.ranges),_step196;try{for(_iterator196.s();!(_step196=_iterator196.n()).done;){var _r13=_step196.value;ranges.push(EditorSelection.range(_r13.anchor-size,_r13.head-size));}}catch(err){_iterator196.e(err);}finally{_iterator196.f();}}}}catch(err){_iterator194.e(err);}finally{_iterator194.f();}if(!changes.length)return false;dispatch(state.update({changes:changes,scrollIntoView:true,selection:EditorSelection.create(ranges,state.selection.mainIndex),userEvent:"move.line"}));return true;}var moveLineUp=function moveLineUp(_ref36){var state=_ref36.state,dispatch=_ref36.dispatch;return moveLine(state,dispatch,false);};var moveLineDown=function moveLineDown(_ref37){var state=_ref37.state,dispatch=_ref37.dispatch;return moveLine(state,dispatch,true);};function copyLine(state,dispatch,forward){if(state.readOnly)return false;var changes=[];var _iterator197=_createForOfIteratorHelper(selectedLineBlocks(state)),_step197;try{for(_iterator197.s();!(_step197=_iterator197.n()).done;){var block=_step197.value;if(forward)changes.push({from:block.from,insert:state.doc.slice(block.from,block.to)+state.lineBreak});else changes.push({from:block.to,insert:state.lineBreak+state.doc.slice(block.from,block.to)});}}catch(err){_iterator197.e(err);}finally{_iterator197.f();}dispatch(state.update({changes:changes,scrollIntoView:true,userEvent:"input.copyline"}));return true;}var copyLineUp=function copyLineUp(_ref38){var state=_ref38.state,dispatch=_ref38.dispatch;return copyLine(state,dispatch,false);};var copyLineDown=function copyLineDown(_ref39){var state=_ref39.state,dispatch=_ref39.dispatch;return copyLine(state,dispatch,true);};var deleteLine=function deleteLine(view){if(view.state.readOnly)return false;var state=view.state,changes=state.changes(selectedLineBlocks(state).map(function(_ref40){var from=_ref40.from,to=_ref40.to;if(from>0)from--;else if(to<state.doc.length)to++;return{from:from,to:to};}));var selection2=updateSel(state.selection,function(range){return view.moveVertically(range,true);}).map(changes);view.dispatch({changes:changes,selection:selection2,scrollIntoView:true,userEvent:"delete.line"});return true;};function isBetweenBrackets(state,pos){if(/\(\)|\[\]|\{\}/.test(state.sliceDoc(pos-1,pos+1)))return{from:pos,to:pos};var context=_syntaxTree(state).resolveInner(pos);var before=context.childBefore(pos),after=context.childAfter(pos),closedBy;if(before&&after&&before.to<=pos&&after.from>=pos&&(closedBy=before.type.prop(NodeProp.closedBy))&&closedBy.indexOf(after.name)>-1&&state.doc.lineAt(before.to).from==state.doc.lineAt(after.from).from)return{from:before.to,to:after.from};return null;}var insertNewlineAndIndent=/* @__PURE__ */newlineAndIndent(false);var insertBlankLine=/* @__PURE__ */newlineAndIndent(true);function newlineAndIndent(atEof){return function(_ref41){var state=_ref41.state,dispatch=_ref41.dispatch;if(state.readOnly)return false;var changes=state.changeByRange(function(range){var from=range.from,to=range.to,line=state.doc.lineAt(from);var explode=!atEof&&from==to&&isBetweenBrackets(state,from);if(atEof)from=to=(to<=line.to?line:state.doc.lineAt(to)).to;var cx=new _IndentContext(state,{simulateBreak:from,simulateDoubleBreak:!!explode});var indent=_getIndentation(cx,from);if(indent==null)indent=/^\s*/.exec(state.doc.lineAt(from).text)[0].length;while(to<line.to&&/\s/.test(line.text[to-line.from])){to++;}if(explode){from=explode.from;to=explode.to;}else if(from>line.from&&from<line.from+100&&!/\S/.test(line.text.slice(0,from)))from=line.from;var insert2=["",_indentString(state,indent)];if(explode)insert2.push(_indentString(state,cx.lineIndent(line.from,-1)));return{changes:{from:from,to:to,insert:Text.of(insert2)},range:EditorSelection.cursor(from+1+insert2[1].length)};});dispatch(state.update(changes,{scrollIntoView:true,userEvent:"input"}));return true;};}function changeBySelectedLine(state,f){var atLine=-1;return state.changeByRange(function(range){var changes=[];for(var pos=range.from;pos<=range.to;){var line=state.doc.lineAt(pos);if(line.number>atLine&&(range.empty||range.to>line.from)){f(line,changes,range);atLine=line.number;}pos=line.to+1;}var changeSet=state.changes(changes);return{changes:changes,range:EditorSelection.range(changeSet.mapPos(range.anchor,1),changeSet.mapPos(range.head,1))};});}var indentSelection=function indentSelection(_ref42){var state=_ref42.state,dispatch=_ref42.dispatch;if(state.readOnly)return false;var updated=/* @__PURE__ */Object.create(null);var context=new _IndentContext(state,{overrideIndentation:function overrideIndentation(start){var found=updated[start];return found==null?-1:found;}});var changes=changeBySelectedLine(state,function(line,changes2,range){var indent=_getIndentation(context,line.from);if(indent==null)return;if(!/\S/.test(line.text))indent=0;var cur2=/^\s*/.exec(line.text)[0];var norm=_indentString(state,indent);if(cur2!=norm||range.from<line.from+cur2.length){updated[line.from]=indent;changes2.push({from:line.from,to:line.from+cur2.length,insert:norm});}});if(!changes.changes.empty)dispatch(state.update(changes,{userEvent:"indent"}));return true;};var indentMore=function indentMore(_ref43){var state=_ref43.state,dispatch=_ref43.dispatch;if(state.readOnly)return false;dispatch(state.update(changeBySelectedLine(state,function(line,changes){changes.push({from:line.from,insert:state.facet(_indentUnit)});}),{userEvent:"input.indent"}));return true;};var indentLess=function indentLess(_ref44){var state=_ref44.state,dispatch=_ref44.dispatch;if(state.readOnly)return false;dispatch(state.update(changeBySelectedLine(state,function(line,changes){var space4=/^\s*/.exec(line.text)[0];if(!space4)return;var col=_countColumn(space4,state.tabSize),keep=0;var insert2=_indentString(state,Math.max(0,col-_getIndentUnit(state)));while(keep<space4.length&&keep<insert2.length&&space4.charCodeAt(keep)==insert2.charCodeAt(keep)){keep++;}changes.push({from:line.from+keep,to:line.from+space4.length,insert:insert2.slice(keep)});}),{userEvent:"delete.dedent"}));return true;};var emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:true},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}];var standardKeymap=/* @__PURE__ */[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:true},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:true},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:true},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:true},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:true},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:true},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteToLineStart},{mac:"Mod-Delete",run:deleteToLineEnd}].concat(/* @__PURE__ */emacsStyleKeymap.map(function(b){return{mac:b.key,run:b.run,shift:b.shift};}));var defaultKeymap=/* @__PURE__ */[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:true},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment}].concat(standardKeymap);// ../node_modules/crelt/index.es.js
function crelt(){var elt2=arguments[0];if(typeof elt2=="string")elt2=document.createElement(elt2);var i=1,next=arguments[1];if(next&&_typeof(next)=="object"&&next.nodeType==null&&!Array.isArray(next)){for(var name2 in next){if(Object.prototype.hasOwnProperty.call(next,name2)){var value=next[name2];if(typeof value=="string")elt2.setAttribute(name2,value);else if(value!=null)elt2[name2]=value;}}i++;}for(;i<arguments.length;i++){add(elt2,arguments[i]);}return elt2;}function add(elt2,child){if(typeof child=="string"){elt2.appendChild(document.createTextNode(child));}else if(child==null){}else if(child.nodeType!=null){elt2.appendChild(child);}else if(Array.isArray(child)){for(var i=0;i<child.length;i++){add(elt2,child[i]);}}else{throw new RangeError("Unsupported child node: "+child);}}// ../node_modules/@codemirror/search/dist/index.js
var basicNormalize=typeof String.prototype.normalize=="function"?function(x){return x.normalize("NFKD");}:function(x){return x;};var SearchCursor=/*#__PURE__*/function(){function SearchCursor(text,query){var from=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var to=arguments.length>3&&arguments[3]!==undefined?arguments[3]:text.length;var normalize=arguments.length>4?arguments[4]:undefined;_classCallCheck(this,SearchCursor);this.value={from:0,to:0};this.done=false;this.matches=[];this.buffer="";this.bufferPos=0;this.iter=text.iterRange(from,to);this.bufferStart=from;this.normalize=normalize?function(x){return normalize(basicNormalize(x));}:basicNormalize;this.query=this.normalize(query);}_createClass(SearchCursor,[{key:"peek",value:function peek(){if(this.bufferPos==this.buffer.length){this.bufferStart+=this.buffer.length;this.iter.next();if(this.iter.done)return-1;this.bufferPos=0;this.buffer=this.iter.value;}return codePointAt(this.buffer,this.bufferPos);}},{key:"next",value:function next(){while(this.matches.length){this.matches.pop();}return this.nextOverlapping();}},{key:"nextOverlapping",value:function nextOverlapping(){for(;;){var next=this.peek();if(next<0){this.done=true;return this;}var str=fromCodePoint(next),start=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(next);var norm=this.normalize(str);for(var _i153=0,pos=start;;_i153++){var _code=norm.charCodeAt(_i153);var match=this.match(_code,pos);if(match){this.value=match;return this;}if(_i153==norm.length-1)break;if(pos==start&&_i153<str.length&&str.charCodeAt(_i153)==_code)pos++;}}}},{key:"match",value:function match(code,pos){var match=null;for(var _i154=0;_i154<this.matches.length;_i154+=2){var index=this.matches[_i154],keep=false;if(this.query.charCodeAt(index)==code){if(index==this.query.length-1){match={from:this.matches[_i154+1],to:pos+1};}else{this.matches[_i154]++;keep=true;}}if(!keep){this.matches.splice(_i154,2);_i154-=2;}}if(this.query.charCodeAt(0)==code){if(this.query.length==1)match={from:pos,to:pos+1};else this.matches.push(1,pos);}return match;}}]);return SearchCursor;}();if(typeof Symbol!="undefined")SearchCursor.prototype[Symbol.iterator]=function(){return this;};var empty={from:-1,to:-1,match:/* @__PURE__ */ /.*/.exec("")};var baseFlags="gm"+(/x/.unicode==null?"":"u");var RegExpCursor=/*#__PURE__*/function(){function RegExpCursor(text,query,options){var from=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var to=arguments.length>4&&arguments[4]!==undefined?arguments[4]:text.length;_classCallCheck(this,RegExpCursor);this.to=to;this.curLine="";this.done=false;this.value=empty;if(/\\[sWDnr]|\n|\r|\[\^/.test(query))return new MultilineRegExpCursor(text,query,options,from,to);this.re=new RegExp(query,baseFlags+((options===null||options===void 0?void 0:options.ignoreCase)?"i":""));this.iter=text.iter();var startLine=text.lineAt(from);this.curLineStart=startLine.from;this.matchPos=from;this.getLine(this.curLineStart);}_createClass(RegExpCursor,[{key:"getLine",value:function getLine(skip){this.iter.next(skip);if(this.iter.lineBreak){this.curLine="";}else{this.curLine=this.iter.value;if(this.curLineStart+this.curLine.length>this.to)this.curLine=this.curLine.slice(0,this.to-this.curLineStart);this.iter.next();}}},{key:"nextLine",value:function nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1;if(this.curLineStart>this.to)this.curLine="";else this.getLine(0);}},{key:"next",value:function next(){for(var off=this.matchPos-this.curLineStart;;){this.re.lastIndex=off;var match=this.matchPos<=this.to&&this.re.exec(this.curLine);if(match){var from=this.curLineStart+match.index,to=from+match[0].length;this.matchPos=to+(from==to?1:0);if(from==this.curLine.length)this.nextLine();if(from<to||from>this.value.to){this.value={from:from,to:to,match:match};return this;}off=this.matchPos-this.curLineStart;}else if(this.curLineStart+this.curLine.length<this.to){this.nextLine();off=0;}else{this.done=true;return this;}}}}]);return RegExpCursor;}();var flattened=/* @__PURE__ */new WeakMap();var FlattenedDoc=/*#__PURE__*/function(){function FlattenedDoc(from,text){_classCallCheck(this,FlattenedDoc);this.from=from;this.text=text;}_createClass(FlattenedDoc,[{key:"to",get:function get(){return this.from+this.text.length;}}],[{key:"get",value:function get(doc2,from,to){var cached=flattened.get(doc2);if(!cached||cached.from>=to||cached.to<=from){var flat=new FlattenedDoc(from,doc2.sliceString(from,to));flattened.set(doc2,flat);return flat;}if(cached.from==from&&cached.to==to)return cached;var text=cached.text,cachedFrom=cached.from;if(cachedFrom>from){text=doc2.sliceString(from,cachedFrom)+text;cachedFrom=from;}if(cached.to<to)text+=doc2.sliceString(cached.to,to);flattened.set(doc2,new FlattenedDoc(cachedFrom,text));return new FlattenedDoc(from,text.slice(from-cachedFrom,to-cachedFrom));}}]);return FlattenedDoc;}();var MultilineRegExpCursor=/*#__PURE__*/function(){function MultilineRegExpCursor(text,query,options,from,to){_classCallCheck(this,MultilineRegExpCursor);this.text=text;this.to=to;this.done=false;this.value=empty;this.matchPos=from;this.re=new RegExp(query,baseFlags+((options===null||options===void 0?void 0:options.ignoreCase)?"i":""));this.flat=FlattenedDoc.get(text,from,this.chunkEnd(from+5e3));}_createClass(MultilineRegExpCursor,[{key:"chunkEnd",value:function chunkEnd(pos){return pos>=this.to?this.to:this.text.lineAt(pos).to;}},{key:"next",value:function next(){for(;;){var off=this.re.lastIndex=this.matchPos-this.flat.from;var match=this.re.exec(this.flat.text);if(match&&!match[0]&&match.index==off){this.re.lastIndex=off+1;match=this.re.exec(this.flat.text);}if(match&&this.flat.to<this.to&&match.index+match[0].length>this.flat.text.length-10)match=null;if(match){var from=this.flat.from+match.index,to=from+match[0].length;this.value={from:from,to:to,match:match};this.matchPos=to+(from==to?1:0);return this;}else{if(this.flat.to==this.to){this.done=true;return this;}this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2));}}}}]);return MultilineRegExpCursor;}();if(typeof Symbol!="undefined"){RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this;};}function validRegExp(source){try{new RegExp(source,baseFlags);return true;}catch(_a2){return false;}}function createLineDialog(view){var input=crelt("input",{"class":"cm-textfield",name:"line"});var dom=crelt("form",{"class":"cm-gotoLine",onkeydown:function onkeydown(event){if(event.keyCode==27){event.preventDefault();view.dispatch({effects:dialogEffect.of(false)});view.focus();}else if(event.keyCode==13){event.preventDefault();go();}},onsubmit:function onsubmit(event){event.preventDefault();go();}},crelt("label",view.state.phrase("Go to line"),": ",input)," ",crelt("button",{"class":"cm-button",type:"submit"},view.state.phrase("go")));function go(){var match=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(input.value);if(!match)return;var state=view.state,startLine=state.doc.lineAt(state.selection.main.head);var _match=_slicedToArray(match,5),sign=_match[1],ln=_match[2],cl=_match[3],percent2=_match[4];var col=cl?+cl.slice(1):0;var line=ln?+ln:startLine.number;if(ln&&percent2){var pc=line/100;if(sign)pc=pc*(sign=="-"?-1:1)+startLine.number/state.doc.lines;line=Math.round(state.doc.lines*pc);}else if(ln&&sign){line=line*(sign=="-"?-1:1)+startLine.number;}var docLine=state.doc.line(Math.max(1,Math.min(state.doc.lines,line)));view.dispatch({effects:dialogEffect.of(false),selection:EditorSelection.cursor(docLine.from+Math.max(0,Math.min(col,docLine.length))),scrollIntoView:true});view.focus();}return{dom:dom};}var dialogEffect=/* @__PURE__ */StateEffect.define();var dialogField=/* @__PURE__ */StateField.define({create:function create(){return true;},update:function update(value,tr){var _iterator198=_createForOfIteratorHelper(tr.effects),_step198;try{for(_iterator198.s();!(_step198=_iterator198.n()).done;){var e=_step198.value;if(e.is(dialogEffect))value=e.value;}}catch(err){_iterator198.e(err);}finally{_iterator198.f();}return value;},provide:function provide(f){return showPanel.from(f,function(val){return val?createLineDialog:null;});}});var gotoLine=function gotoLine(view){var panel=getPanel(view,createLineDialog);if(!panel){var effects=[dialogEffect.of(true)];if(view.state.field(dialogField,false)==null)effects.push(StateEffect.appendConfig.of([dialogField,baseTheme$13]));view.dispatch({effects:effects});panel=getPanel(view,createLineDialog);}if(panel)panel.dom.querySelector("input").focus();return true;};var baseTheme$13=/* @__PURE__ */EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}});var defaultHighlightOptions={highlightWordAroundCursor:false,minSelectionLength:1,maxMatches:100,wholeWords:false};var highlightConfig=/* @__PURE__ */Facet.define({combine:function combine(options){return combineConfig(options,defaultHighlightOptions,{highlightWordAroundCursor:function highlightWordAroundCursor(a,b){return a||b;},minSelectionLength:Math.min,maxMatches:Math.min});}});function highlightSelectionMatches(options){var ext=[defaultTheme,matchHighlighter];if(options)ext.push(highlightConfig.of(options));return ext;}var matchDeco=/* @__PURE__ */Decoration.mark({"class":"cm-selectionMatch"});var mainMatchDeco=/* @__PURE__ */Decoration.mark({"class":"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(check,state,from,to){return(from==0||check(state.sliceDoc(from-1,from))!=CharCategory.Word)&&(to==state.doc.length||check(state.sliceDoc(to,to+1))!=CharCategory.Word);}function insideWord(check,state,from,to){return check(state.sliceDoc(from,from+1))==CharCategory.Word&&check(state.sliceDoc(to-1,to))==CharCategory.Word;}var matchHighlighter=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class13(view){_classCallCheck(this,_class13);this.decorations=this.getDeco(view);}_createClass(_class13,[{key:"update",value:function update(_update22){if(_update22.selectionSet||_update22.docChanged||_update22.viewportChanged)this.decorations=this.getDeco(_update22.view);}},{key:"getDeco",value:function getDeco(view){var conf=view.state.facet(highlightConfig);var state=view.state,sel=state.selection;if(sel.ranges.length>1)return Decoration.none;var range=sel.main,query,check=null;if(range.empty){if(!conf.highlightWordAroundCursor)return Decoration.none;var word=state.wordAt(range.head);if(!word)return Decoration.none;check=state.charCategorizer(range.head);query=state.sliceDoc(word.from,word.to);}else{var len=range.to-range.from;if(len<conf.minSelectionLength||len>200)return Decoration.none;if(conf.wholeWords){query=state.sliceDoc(range.from,range.to);check=state.charCategorizer(range.head);if(!(insideWordBoundaries(check,state,range.from,range.to)&&insideWord(check,state,range.from,range.to)))return Decoration.none;}else{query=state.sliceDoc(range.from,range.to).trim();if(!query)return Decoration.none;}}var deco=[];var _iterator199=_createForOfIteratorHelper(view.visibleRanges),_step199;try{for(_iterator199.s();!(_step199=_iterator199.n()).done;){var part=_step199.value;var cursor2=new SearchCursor(state.doc,query,part.from,part.to);while(!cursor2.next().done){var _cursor2$value=cursor2.value,from=_cursor2$value.from,to=_cursor2$value.to;if(!check||insideWordBoundaries(check,state,from,to)){if(range.empty&&from<=range.from&&to>=range.to)deco.push(mainMatchDeco.range(from,to));else if(from>=range.to||to<=range.from)deco.push(matchDeco.range(from,to));if(deco.length>conf.maxMatches)return Decoration.none;}}}}catch(err){_iterator199.e(err);}finally{_iterator199.f();}return Decoration.set(deco);}}]);return _class13;}(),{decorations:function decorations(v){return v.decorations;}});var defaultTheme=/* @__PURE__ */EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}});var selectWord=function selectWord(_ref45){var state=_ref45.state,dispatch=_ref45.dispatch;var selection2=state.selection;var newSel=EditorSelection.create(selection2.ranges.map(function(range){return state.wordAt(range.head)||EditorSelection.cursor(range.head);}),selection2.mainIndex);if(newSel.eq(selection2))return false;dispatch(state.update({selection:newSel}));return true;};function findNextOccurrence(state,query){var _state$selection=state.selection,main=_state$selection.main,ranges=_state$selection.ranges;var word=state.wordAt(main.head),fullWord=word&&word.from==main.from&&word.to==main.to;var _loop14=function _loop14(_cycled,_cursor){_cursor.next();if(_cursor.done){if(_cycled){cursor2=_cursor;{cycled=_cycled;return{v:null};}}_cursor=new SearchCursor(state.doc,query,0,Math.max(0,ranges[ranges.length-1].from-1));_cycled=true;}else{if(_cycled&&ranges.some(function(r){return r.from==_cursor.value.from;})){cursor2=_cursor;{cycled=_cycled;return"continue";}}if(fullWord){var word2=state.wordAt(_cursor.value.from);if(!word2||word2.from!=_cursor.value.from||word2.to!=_cursor.value.to){cursor2=_cursor;{cycled=_cycled;return"continue";}}}cycled=_cycled;cursor2=_cursor;return{v:_cursor.value};}cycled=_cycled;cursor2=_cursor;};for(var cycled=false,cursor2=new SearchCursor(state.doc,query,ranges[ranges.length-1].to);;){var _ret4=_loop14(cycled,cursor2);if(_ret4==="continue")continue;if(_typeof(_ret4)==="object")return _ret4.v;}}var selectNextOccurrence=function selectNextOccurrence(_ref46){var state=_ref46.state,dispatch=_ref46.dispatch;var ranges=state.selection.ranges;if(ranges.some(function(sel){return sel.from===sel.to;}))return selectWord({state:state,dispatch:dispatch});var searchedText=state.sliceDoc(ranges[0].from,ranges[0].to);if(state.selection.ranges.some(function(r){return state.sliceDoc(r.from,r.to)!=searchedText;}))return false;var range=findNextOccurrence(state,searchedText);if(!range)return false;dispatch(state.update({selection:state.selection.addRange(EditorSelection.range(range.from,range.to),false),effects:EditorView.scrollIntoView(range.to)}));return true;};var searchConfigFacet=/* @__PURE__ */Facet.define({combine:function combine(configs){var _a2;return{top:configs.reduce(function(val,conf){return val!==null&&val!==void 0?val:conf.top;},void 0)||false,caseSensitive:configs.reduce(function(val,conf){return val!==null&&val!==void 0?val:conf.caseSensitive;},void 0)||false,createPanel:((_a2=configs.find(function(c){return c.createPanel;}))===null||_a2===void 0?void 0:_a2.createPanel)||function(view){return new SearchPanel(view);}};}});var SearchQuery=/*#__PURE__*/function(){function SearchQuery(config2){_classCallCheck(this,SearchQuery);this.search=config2.search;this.caseSensitive=!!config2.caseSensitive;this.regexp=!!config2.regexp;this.replace=config2.replace||"";this.valid=!!this.search&&(!this.regexp||validRegExp(this.search));this.unquoted=config2.literal?this.search:this.search.replace(/\\([nrt\\])/g,function(_,ch){return ch=="n"?"\n":ch=="r"?"\r":ch=="t"?"	":"\\";});}_createClass(SearchQuery,[{key:"eq",value:function eq(other){return this.search==other.search&&this.replace==other.replace&&this.caseSensitive==other.caseSensitive&&this.regexp==other.regexp;}},{key:"create",value:function create(){return this.regexp?new RegExpQuery(this):new StringQuery(this);}},{key:"getCursor",value:function getCursor(doc2){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var to=arguments.length>2&&arguments[2]!==undefined?arguments[2]:doc2.length;return this.regexp?regexpCursor(this,doc2,from,to):stringCursor(this,doc2,from,to);}}]);return SearchQuery;}();var QueryType2=/*#__PURE__*/_createClass(function QueryType2(spec){_classCallCheck(this,QueryType2);this.spec=spec;});function stringCursor(spec,doc2,from,to){return new SearchCursor(doc2,spec.unquoted,from,to,spec.caseSensitive?void 0:function(x){return x.toLowerCase();});}var StringQuery=/*#__PURE__*/function(_QueryType){_inherits(StringQuery,_QueryType);var _super37=_createSuper(StringQuery);function StringQuery(spec){_classCallCheck(this,StringQuery);return _super37.call(this,spec);}_createClass(StringQuery,[{key:"nextMatch",value:function nextMatch(doc2,curFrom,curTo){var cursor2=stringCursor(this.spec,doc2,curTo,doc2.length).nextOverlapping();if(cursor2.done)cursor2=stringCursor(this.spec,doc2,0,curFrom).nextOverlapping();return cursor2.done?null:cursor2.value;}},{key:"prevMatchInRange",value:function prevMatchInRange(doc2,from,to){for(var pos=to;;){var start=Math.max(from,pos-1e4-this.spec.unquoted.length);var _cursor2=stringCursor(this.spec,doc2,start,pos),range=null;while(!_cursor2.nextOverlapping().done){range=_cursor2.value;}if(range)return range;if(start==from)return null;pos-=1e4;}}},{key:"prevMatch",value:function prevMatch(doc2,curFrom,curTo){return this.prevMatchInRange(doc2,0,curFrom)||this.prevMatchInRange(doc2,curTo,doc2.length);}},{key:"getReplacement",value:function getReplacement(_result){return this.spec.replace;}},{key:"matchAll",value:function matchAll(doc2,limit){var cursor2=stringCursor(this.spec,doc2,0,doc2.length),ranges=[];while(!cursor2.next().done){if(ranges.length>=limit)return null;ranges.push(cursor2.value);}return ranges;}},{key:"highlight",value:function highlight(doc2,from,to,add2){var cursor2=stringCursor(this.spec,doc2,Math.max(0,from-this.spec.unquoted.length),Math.min(to+this.spec.unquoted.length,doc2.length));while(!cursor2.next().done){add2(cursor2.value.from,cursor2.value.to);}}}]);return StringQuery;}(QueryType2);function regexpCursor(spec,doc2,from,to){return new RegExpCursor(doc2,spec.search,spec.caseSensitive?void 0:{ignoreCase:true},from,to);}var RegExpQuery=/*#__PURE__*/function(_QueryType2){_inherits(RegExpQuery,_QueryType2);var _super38=_createSuper(RegExpQuery);function RegExpQuery(){_classCallCheck(this,RegExpQuery);return _super38.apply(this,arguments);}_createClass(RegExpQuery,[{key:"nextMatch",value:function nextMatch(doc2,curFrom,curTo){var cursor2=regexpCursor(this.spec,doc2,curTo,doc2.length).next();if(cursor2.done)cursor2=regexpCursor(this.spec,doc2,0,curFrom).next();return cursor2.done?null:cursor2.value;}},{key:"prevMatchInRange",value:function prevMatchInRange(doc2,from,to){for(var size=1;;size++){var start=Math.max(from,to-size*1e4);var _cursor3=regexpCursor(this.spec,doc2,start,to),range=null;while(!_cursor3.next().done){range=_cursor3.value;}if(range&&(start==from||range.from>start+10))return range;if(start==from)return null;}}},{key:"prevMatch",value:function prevMatch(doc2,curFrom,curTo){return this.prevMatchInRange(doc2,0,curFrom)||this.prevMatchInRange(doc2,curTo,doc2.length);}},{key:"getReplacement",value:function getReplacement(result){return this.spec.replace.replace(/\$([$&\d+])/g,function(m,i){return i=="$"?"$":i=="&"?result.match[0]:i!="0"&&+i<result.match.length?result.match[i]:m;});}},{key:"matchAll",value:function matchAll(doc2,limit){var cursor2=regexpCursor(this.spec,doc2,0,doc2.length),ranges=[];while(!cursor2.next().done){if(ranges.length>=limit)return null;ranges.push(cursor2.value);}return ranges;}},{key:"highlight",value:function highlight(doc2,from,to,add2){var cursor2=regexpCursor(this.spec,doc2,Math.max(0,from-250),Math.min(to+250,doc2.length));while(!cursor2.next().done){add2(cursor2.value.from,cursor2.value.to);}}}]);return RegExpQuery;}(QueryType2);var setSearchQuery=/* @__PURE__ */StateEffect.define();var togglePanel=/* @__PURE__ */StateEffect.define();var searchState=/* @__PURE__ */StateField.define({create:function create(state){return new SearchState(defaultQuery(state).create(),null);},update:function update(value,tr){var _iterator200=_createForOfIteratorHelper(tr.effects),_step200;try{for(_iterator200.s();!(_step200=_iterator200.n()).done;){var effect=_step200.value;if(effect.is(setSearchQuery))value=new SearchState(effect.value.create(),value.panel);else if(effect.is(togglePanel))value=new SearchState(value.query,effect.value?createSearchPanel:null);}}catch(err){_iterator200.e(err);}finally{_iterator200.f();}return value;},provide:function provide(f){return showPanel.from(f,function(val){return val.panel;});}});var SearchState=/*#__PURE__*/_createClass(function SearchState(query,panel){_classCallCheck(this,SearchState);this.query=query;this.panel=panel;});var matchMark=/* @__PURE__ */Decoration.mark({"class":"cm-searchMatch"});var selectedMatchMark=/* @__PURE__ */Decoration.mark({"class":"cm-searchMatch cm-searchMatch-selected"});var searchHighlighter=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class14(view){_classCallCheck(this,_class14);this.view=view;this.decorations=this.highlight(view.state.field(searchState));}_createClass(_class14,[{key:"update",value:function update(_update23){var state=_update23.state.field(searchState);if(state!=_update23.startState.field(searchState)||_update23.docChanged||_update23.selectionSet||_update23.viewportChanged)this.decorations=this.highlight(state);}},{key:"highlight",value:function highlight(_ref47){var query=_ref47.query,panel=_ref47.panel;if(!panel||!query.spec.valid)return Decoration.none;var view=this.view;var builder=new RangeSetBuilder();for(var _i155=0,ranges=view.visibleRanges,_l2=ranges.length;_i155<_l2;_i155++){var _ranges$_i2=ranges[_i155],from=_ranges$_i2.from,to=_ranges$_i2.to;while(_i155<_l2-1&&to>ranges[_i155+1].from-2*250){to=ranges[++_i155].to;}query.highlight(view.state.doc,from,to,function(from2,to2){var selected=view.state.selection.ranges.some(function(r){return r.from==from2&&r.to==to2;});builder.add(from2,to2,selected?selectedMatchMark:matchMark);});}return builder.finish();}}]);return _class14;}(),{decorations:function decorations(v){return v.decorations;}});function searchCommand(f){return function(view){var state=view.state.field(searchState,false);return state&&state.query.spec.valid?f(view,state):openSearchPanel(view);};}var findNext=/* @__PURE__ */searchCommand(function(view,_ref48){var query=_ref48.query;var to=view.state.selection.main.to;var next=query.nextMatch(view.state.doc,to,to);if(!next)return false;view.dispatch({selection:{anchor:next.from,head:next.to},scrollIntoView:true,effects:announceMatch(view,next),userEvent:"select.search"});return true;});var findPrevious=/* @__PURE__ */searchCommand(function(view,_ref49){var query=_ref49.query;var state=view.state,from=state.selection.main.from;var range=query.prevMatch(state.doc,from,from);if(!range)return false;view.dispatch({selection:{anchor:range.from,head:range.to},scrollIntoView:true,effects:announceMatch(view,range),userEvent:"select.search"});return true;});var selectMatches=/* @__PURE__ */searchCommand(function(view,_ref50){var query=_ref50.query;var ranges=query.matchAll(view.state.doc,1e3);if(!ranges||!ranges.length)return false;view.dispatch({selection:EditorSelection.create(ranges.map(function(r){return EditorSelection.range(r.from,r.to);})),userEvent:"select.search.matches"});return true;});var selectSelectionMatches=function selectSelectionMatches(_ref51){var state=_ref51.state,dispatch=_ref51.dispatch;var sel=state.selection;if(sel.ranges.length>1||sel.main.empty)return false;var _sel$main=sel.main,from=_sel$main.from,to=_sel$main.to;var ranges=[],main=0;for(var cur2=new SearchCursor(state.doc,state.sliceDoc(from,to));!cur2.next().done;){if(ranges.length>1e3)return false;if(cur2.value.from==from)main=ranges.length;ranges.push(EditorSelection.range(cur2.value.from,cur2.value.to));}dispatch(state.update({selection:EditorSelection.create(ranges,main),userEvent:"select.search.matches"}));return true;};var replaceNext=/* @__PURE__ */searchCommand(function(view,_ref52){var query=_ref52.query;var state=view.state,_state$selection$main=state.selection.main,from=_state$selection$main.from,to=_state$selection$main.to;if(state.readOnly)return false;var next=query.nextMatch(state.doc,from,from);if(!next)return false;var changes=[],selection2,replacement;var announce=[];if(next.from==from&&next.to==to){replacement=state.toText(query.getReplacement(next));changes.push({from:next.from,to:next.to,insert:replacement});next=query.nextMatch(state.doc,next.from,next.to);announce.push(EditorView.announce.of(state.phrase("replaced match on line $",state.doc.lineAt(from).number)+"."));}if(next){var off=changes.length==0||changes[0].from>=next.to?0:next.to-next.from-replacement.length;selection2={anchor:next.from-off,head:next.to-off};announce.push(announceMatch(view,next));}view.dispatch({changes:changes,selection:selection2,scrollIntoView:!!selection2,effects:announce,userEvent:"input.replace"});return true;});var replaceAll=/* @__PURE__ */searchCommand(function(view,_ref53){var query=_ref53.query;if(view.state.readOnly)return false;var changes=query.matchAll(view.state.doc,1e9).map(function(match){var from=match.from,to=match.to;return{from:from,to:to,insert:query.getReplacement(match)};});if(!changes.length)return false;var announceText=view.state.phrase("replaced $ matches",changes.length)+".";view.dispatch({changes:changes,effects:EditorView.announce.of(announceText),userEvent:"input.replace.all"});return true;});function createSearchPanel(view){return view.state.facet(searchConfigFacet).createPanel(view);}function defaultQuery(state,fallback){var _a2;var sel=state.selection.main;var selText=sel.empty||sel.to>sel.from+100?"":state.sliceDoc(sel.from,sel.to);var caseSensitive=(_a2=fallback===null||fallback===void 0?void 0:fallback.caseSensitive)!==null&&_a2!==void 0?_a2:state.facet(searchConfigFacet).caseSensitive;return fallback&&!selText?fallback:new SearchQuery({search:selText.replace(/\n/g,"\\n"),caseSensitive:caseSensitive});}var openSearchPanel=function openSearchPanel(view){var state=view.state.field(searchState,false);if(state&&state.panel){var panel=getPanel(view,createSearchPanel);if(!panel)return false;var searchInput=panel.dom.querySelector("[main-field]");if(searchInput&&searchInput!=view.root.activeElement){var query=defaultQuery(view.state,state.query.spec);if(query.valid)view.dispatch({effects:setSearchQuery.of(query)});searchInput.focus();searchInput.select();}}else{view.dispatch({effects:[togglePanel.of(true),state?setSearchQuery.of(defaultQuery(view.state,state.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});}return true;};var closeSearchPanel=function closeSearchPanel(view){var state=view.state.field(searchState,false);if(!state||!state.panel)return false;var panel=getPanel(view,createSearchPanel);if(panel&&panel.dom.contains(view.root.activeElement))view.focus();view.dispatch({effects:togglePanel.of(false)});return true;};var searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:true},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:true},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:true}];var SearchPanel=/*#__PURE__*/function(){function SearchPanel(view){var _this81=this;_classCallCheck(this,SearchPanel);this.view=view;var query=this.query=view.state.field(searchState).query.spec;this.commit=this.commit.bind(this);this.searchField=crelt("input",{value:query.search,placeholder:phrase(view,"Find"),"aria-label":phrase(view,"Find"),"class":"cm-textfield",name:"search","main-field":"true",onchange:this.commit,onkeyup:this.commit});this.replaceField=crelt("input",{value:query.replace,placeholder:phrase(view,"Replace"),"aria-label":phrase(view,"Replace"),"class":"cm-textfield",name:"replace",onchange:this.commit,onkeyup:this.commit});this.caseField=crelt("input",{type:"checkbox",name:"case",checked:query.caseSensitive,onchange:this.commit});this.reField=crelt("input",{type:"checkbox",name:"re",checked:query.regexp,onchange:this.commit});function button(name2,onclick,content2){return crelt("button",{"class":"cm-button",name:name2,onclick:onclick,type:"button"},content2);}this.dom=crelt("div",{onkeydown:function onkeydown(e){return _this81.keydown(e);},"class":"cm-search"},[this.searchField,button("next",function(){return findNext(view);},[phrase(view,"next")]),button("prev",function(){return findPrevious(view);},[phrase(view,"previous")]),button("select",function(){return selectMatches(view);},[phrase(view,"all")]),crelt("label",null,[this.caseField,phrase(view,"match case")]),crelt("label",null,[this.reField,phrase(view,"regexp")])].concat(_toConsumableArray(view.state.readOnly?[]:[crelt("br"),this.replaceField,button("replace",function(){return replaceNext(view);},[phrase(view,"replace")]),button("replaceAll",function(){return replaceAll(view);},[phrase(view,"replace all")]),crelt("button",{name:"close",onclick:function onclick(){return closeSearchPanel(view);},"aria-label":phrase(view,"close"),type:"button"},["\xD7"])])));}_createClass(SearchPanel,[{key:"commit",value:function commit(){var query=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,replace:this.replaceField.value});if(!query.eq(this.query)){this.query=query;this.view.dispatch({effects:setSearchQuery.of(query)});}}},{key:"keydown",value:function keydown(e){if(runScopeHandlers(this.view,e,"search-panel")){e.preventDefault();}else if(e.keyCode==13&&e.target==this.searchField){e.preventDefault();(e.shiftKey?findPrevious:findNext)(this.view);}else if(e.keyCode==13&&e.target==this.replaceField){e.preventDefault();replaceNext(this.view);}}},{key:"update",value:function update(_update24){var _iterator201=_createForOfIteratorHelper(_update24.transactions),_step201;try{for(_iterator201.s();!(_step201=_iterator201.n()).done;){var tr=_step201.value;var _iterator202=_createForOfIteratorHelper(tr.effects),_step202;try{for(_iterator202.s();!(_step202=_iterator202.n()).done;){var effect=_step202.value;if(effect.is(setSearchQuery)&&!effect.value.eq(this.query))this.setQuery(effect.value);}}catch(err){_iterator202.e(err);}finally{_iterator202.f();}}}catch(err){_iterator201.e(err);}finally{_iterator201.f();}}},{key:"setQuery",value:function setQuery(query){this.query=query;this.searchField.value=query.search;this.replaceField.value=query.replace;this.caseField.checked=query.caseSensitive;this.reField.checked=query.regexp;}},{key:"mount",value:function mount(){this.searchField.select();}},{key:"pos",get:function get(){return 80;}},{key:"top",get:function get(){return this.view.state.facet(searchConfigFacet).top;}}]);return SearchPanel;}();function phrase(view,phrase2){return view.state.phrase(phrase2);}var AnnounceMargin=30;var Break=/[\s\.,:;?!]/;function announceMatch(view,_ref54){var from=_ref54.from,to=_ref54.to;var line=view.state.doc.lineAt(from),lineEnd2=view.state.doc.lineAt(to).to;var start=Math.max(line.from,from-AnnounceMargin),end=Math.min(lineEnd2,to+AnnounceMargin);var text=view.state.sliceDoc(start,end);if(start!=line.from){for(var _i156=0;_i156<AnnounceMargin;_i156++){if(!Break.test(text[_i156+1])&&Break.test(text[_i156])){text=text.slice(_i156);break;}}}if(end!=lineEnd2){for(var _i157=text.length-1;_i157>text.length-AnnounceMargin;_i157--){if(!Break.test(text[_i157-1])&&Break.test(text[_i157])){text=text.slice(0,_i157);break;}}}return EditorView.announce.of("".concat(view.state.phrase("current match"),". ").concat(text," ").concat(view.state.phrase("on line")," ").concat(line.number,"."));}var baseTheme3=/* @__PURE__ */EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}});var searchExtensions=[searchState,/* @__PURE__ */Prec.lowest(searchHighlighter),baseTheme3];// ../node_modules/@codemirror/autocomplete/dist/index.js
var dist_exports2={};__export(dist_exports2,{CompletionContext:function CompletionContext(){return _CompletionContext;},acceptCompletion:function acceptCompletion(){return _acceptCompletion;},autocompletion:function autocompletion(){return _autocompletion;},clearSnippet:function clearSnippet(){return _clearSnippet;},closeBrackets:function closeBrackets(){return _closeBrackets;},closeBracketsKeymap:function closeBracketsKeymap(){return _closeBracketsKeymap;},closeCompletion:function closeCompletion(){return _closeCompletion;},completeAnyWord:function completeAnyWord(){return _completeAnyWord;},completeFromList:function completeFromList(){return _completeFromList;},completionKeymap:function completionKeymap(){return _completionKeymap;},completionStatus:function completionStatus(){return _completionStatus;},currentCompletions:function currentCompletions(){return _currentCompletions;},deleteBracketPair:function deleteBracketPair(){return _deleteBracketPair;},hasNextSnippetField:function hasNextSnippetField(){return _hasNextSnippetField;},hasPrevSnippetField:function hasPrevSnippetField(){return _hasPrevSnippetField;},ifIn:function ifIn(){return _ifIn;},ifNotIn:function ifNotIn(){return _ifNotIn;},insertBracket:function insertBracket(){return _insertBracket;},insertCompletionText:function insertCompletionText(){return _insertCompletionText;},moveCompletionSelection:function moveCompletionSelection(){return _moveCompletionSelection;},nextSnippetField:function nextSnippetField(){return _nextSnippetField;},pickedCompletion:function pickedCompletion(){return _pickedCompletion;},prevSnippetField:function prevSnippetField(){return _prevSnippetField;},selectedCompletion:function selectedCompletion(){return _selectedCompletion;},selectedCompletionIndex:function selectedCompletionIndex(){return _selectedCompletionIndex;},setSelectedCompletion:function setSelectedCompletion(){return _setSelectedCompletion;},snippet:function snippet(){return _snippet;},snippetCompletion:function snippetCompletion(){return _snippetCompletion;},snippetKeymap:function snippetKeymap(){return _snippetKeymap;},startCompletion:function startCompletion(){return _startCompletion;}});var _CompletionContext=/*#__PURE__*/function(){function _CompletionContext(state,pos,explicit){_classCallCheck(this,_CompletionContext);this.state=state;this.pos=pos;this.explicit=explicit;this.abortListeners=[];}_createClass(_CompletionContext,[{key:"tokenBefore",value:function tokenBefore(types2){var token=_syntaxTree(this.state).resolveInner(this.pos,-1);while(token&&types2.indexOf(token.name)<0){token=token.parent;}return token?{from:token.from,to:this.pos,text:this.state.sliceDoc(token.from,this.pos),type:token.type}:null;}},{key:"matchBefore",value:function matchBefore(expr){var line=this.state.doc.lineAt(this.pos);var start=Math.max(line.from,this.pos-250);var str=line.text.slice(start-line.from,this.pos-line.from);var found=str.search(ensureAnchor(expr,false));return found<0?null:{from:start+found,to:this.pos,text:str.slice(found)};}},{key:"aborted",get:function get(){return this.abortListeners==null;}},{key:"addEventListener",value:function addEventListener(type,listener){if(type=="abort"&&this.abortListeners)this.abortListeners.push(listener);}}]);return _CompletionContext;}();function toSet(chars){var flat=Object.keys(chars).join("");var words=/\w/.test(flat);if(words)flat=flat.replace(/\w/g,"");return"[".concat(words?"\\w":"").concat(flat.replace(/[^\w\s]/g,"\\$&"),"]");}function prefixMatch(options){var first=/* @__PURE__ */Object.create(null),rest=/* @__PURE__ */Object.create(null);var _iterator203=_createForOfIteratorHelper(options),_step203;try{for(_iterator203.s();!(_step203=_iterator203.n()).done;){var label=_step203.value.label;first[label[0]]=true;for(var _i158=1;_i158<label.length;_i158++){rest[label[_i158]]=true;}}}catch(err){_iterator203.e(err);}finally{_iterator203.f();}var source=toSet(first)+toSet(rest)+"*$";return[new RegExp("^"+source),new RegExp(source)];}function _completeFromList(list){var options=list.map(function(o){return typeof o=="string"?{label:o}:o;});var _ref55=options.every(function(o){return /^\w+$/.test(o.label);})?[/\w*$/,/\w+$/]:prefixMatch(options),_ref56=_slicedToArray(_ref55,2),validFor=_ref56[0],match=_ref56[1];return function(context){var token=context.matchBefore(match);return token||context.explicit?{from:token?token.from:context.pos,options:options,validFor:validFor}:null;};}function _ifIn(nodes,source){return function(context){for(var pos=_syntaxTree(context.state).resolveInner(context.pos,-1);pos;pos=pos.parent){if(nodes.indexOf(pos.name)>-1)return source(context);if(pos.type.isTop)break;}return null;};}function _ifNotIn(nodes,source){return function(context){for(var pos=_syntaxTree(context.state).resolveInner(context.pos,-1);pos;pos=pos.parent){if(nodes.indexOf(pos.name)>-1)return null;if(pos.type.isTop)break;}return source(context);};}var Option=/*#__PURE__*/_createClass(function Option(completion,source,match,score2){_classCallCheck(this,Option);this.completion=completion;this.source=source;this.match=match;this.score=score2;});function cur(state){return state.selection.main.from;}function ensureAnchor(expr,start){var _a2;var source=expr.source;var addStart=start&&source[0]!="^",addEnd=source[source.length-1]!="$";if(!addStart&&!addEnd)return expr;return new RegExp("".concat(addStart?"^":"","(?:").concat(source,")").concat(addEnd?"$":""),(_a2=expr.flags)!==null&&_a2!==void 0?_a2:expr.ignoreCase?"i":"");}var _pickedCompletion=/* @__PURE__ */Annotation.define();function _insertCompletionText(state,text,from,to){var main=state.selection.main,fromOff=from-main.from,toOff=to-main.from;return Object.assign(Object.assign({},state.changeByRange(function(range){if(range!=main&&from!=to&&state.sliceDoc(range.from+fromOff,range.from+toOff)!=state.sliceDoc(from,to))return{range:range};return{changes:{from:range.from+fromOff,to:to==main.from?range.to:range.from+toOff,insert:text},range:EditorSelection.cursor(range.from+fromOff+text.length)};})),{scrollIntoView:true,userEvent:"input.complete"});}var SourceCache=/* @__PURE__ */new WeakMap();function asSource(source){if(!Array.isArray(source))return source;var known=SourceCache.get(source);if(!known)SourceCache.set(source,known=_completeFromList(source));return known;}var startCompletionEffect=/* @__PURE__ */StateEffect.define();var closeCompletionEffect=/* @__PURE__ */StateEffect.define();var FuzzyMatcher=/*#__PURE__*/function(){function FuzzyMatcher(pattern){_classCallCheck(this,FuzzyMatcher);this.pattern=pattern;this.chars=[];this.folded=[];this.any=[];this.precise=[];this.byWord=[];this.score=0;this.matched=[];for(var _p7=0;_p7<pattern.length;){var _char3=codePointAt(pattern,_p7),size=codePointSize(_char3);this.chars.push(_char3);var part=pattern.slice(_p7,_p7+size),upper=part.toUpperCase();this.folded.push(codePointAt(upper==part?part.toLowerCase():upper,0));_p7+=size;}this.astral=pattern.length!=this.chars.length;}_createClass(FuzzyMatcher,[{key:"ret",value:function ret(score2,matched){this.score=score2;this.matched=matched;return true;}},{key:"match",value:function match(word){if(this.pattern.length==0)return this.ret(-100,[]);if(word.length<this.pattern.length)return false;var chars=this.chars,folded=this.folded,any=this.any,precise=this.precise,byWord=this.byWord;if(chars.length==1){var first=codePointAt(word,0),firstSize=codePointSize(first);var score2=firstSize==word.length?0:-100;if(first==chars[0]);else if(first==folded[0])score2+=-200;else return false;return this.ret(score2,[0,firstSize]);}var direct=word.indexOf(this.pattern);if(direct==0)return this.ret(word.length==this.pattern.length?0:-100,[0,this.pattern.length]);var len=chars.length,anyTo=0;if(direct<0){for(var _i159=0,e=Math.min(word.length,200);_i159<e&&anyTo<len;){var next=codePointAt(word,_i159);if(next==chars[anyTo]||next==folded[anyTo])any[anyTo++]=_i159;_i159+=codePointSize(next);}if(anyTo<len)return false;}var preciseTo=0;var byWordTo=0,byWordFolded=false;var adjacentTo=0,adjacentStart=-1,adjacentEnd=-1;var hasLower=/[a-z]/.test(word),wordAdjacent=true;for(var _i160=0,_e2=Math.min(word.length,200),prevType=0;_i160<_e2&&byWordTo<len;){var _next4=codePointAt(word,_i160);if(direct<0){if(preciseTo<len&&_next4==chars[preciseTo])precise[preciseTo++]=_i160;if(adjacentTo<len){if(_next4==chars[adjacentTo]||_next4==folded[adjacentTo]){if(adjacentTo==0)adjacentStart=_i160;adjacentEnd=_i160+1;adjacentTo++;}else{adjacentTo=0;}}}var ch=void 0,type=_next4<255?_next4>=48&&_next4<=57||_next4>=97&&_next4<=122?2:_next4>=65&&_next4<=90?1:0:(ch=fromCodePoint(_next4))!=ch.toLowerCase()?1:ch!=ch.toUpperCase()?2:0;if(!_i160||type==1&&hasLower||prevType==0&&type!=0){if(chars[byWordTo]==_next4||folded[byWordTo]==_next4&&(byWordFolded=true))byWord[byWordTo++]=_i160;else if(byWord.length)wordAdjacent=false;}prevType=type;_i160+=codePointSize(_next4);}if(byWordTo==len&&byWord[0]==0&&wordAdjacent)return this.result(-100+(byWordFolded?-200:0),byWord,word);if(adjacentTo==len&&adjacentStart==0)return this.ret(-200-word.length+(adjacentEnd==word.length?0:-100),[0,adjacentEnd]);if(direct>-1)return this.ret(-700-word.length,[direct,direct+this.pattern.length]);if(adjacentTo==len)return this.ret(-200+-700-word.length,[adjacentStart,adjacentEnd]);if(byWordTo==len)return this.result(-100+(byWordFolded?-200:0)+-700+(wordAdjacent?0:-1100),byWord,word);return chars.length==2?false:this.result((any[0]?-700:0)+-200+-1100,any,word);}},{key:"result",value:function result(score2,positions,word){var result=[],i=0;var _iterator204=_createForOfIteratorHelper(positions),_step204;try{for(_iterator204.s();!(_step204=_iterator204.n()).done;){var pos=_step204.value;var to=pos+(this.astral?codePointSize(codePointAt(word,pos)):1);if(i&&result[i-1]==pos)result[i-1]=to;else{result[i++]=pos;result[i++]=to;}}}catch(err){_iterator204.e(err);}finally{_iterator204.f();}return this.ret(score2-word.length,result);}}]);return FuzzyMatcher;}();var completionConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){return combineConfig(configs,{activateOnTyping:true,selectOnOpen:true,override:null,closeOnBlur:true,maxRenderedOptions:100,defaultKeymap:true,tooltipClass:function tooltipClass(){return"";},optionClass:function optionClass(){return"";},aboveCursor:false,icons:true,addToOptions:[],positionInfo:defaultPositionInfo,compareCompletions:function compareCompletions(a,b){return a.label.localeCompare(b.label);},interactionDelay:75,updateSyncTime:100},{defaultKeymap:function defaultKeymap(a,b){return a&&b;},closeOnBlur:function closeOnBlur(a,b){return a&&b;},icons:function icons(a,b){return a&&b;},tooltipClass:function tooltipClass(a,b){return function(c){return joinClass(a(c),b(c));};},optionClass:function optionClass(a,b){return function(c){return joinClass(a(c),b(c));};},addToOptions:function addToOptions(a,b){return a.concat(b);}});}});function joinClass(a,b){return a?b?a+" "+b:a:b;}function defaultPositionInfo(view,list,option,info,space4,tooltip){var rtl=view.textDirection==Direction.RTL,left=rtl,narrow=false;var side="top",offset,maxWidth;var spaceLeft=list.left-space4.left,spaceRight=space4.right-list.right;var infoWidth=info.right-info.left,infoHeight=info.bottom-info.top;if(left&&spaceLeft<Math.min(infoWidth,spaceRight))left=false;else if(!left&&spaceRight<Math.min(infoWidth,spaceLeft))left=true;if(infoWidth<=(left?spaceLeft:spaceRight)){offset=Math.max(space4.top,Math.min(option.top,space4.bottom-infoHeight))-list.top;maxWidth=Math.min(400,left?spaceLeft:spaceRight);}else{narrow=true;maxWidth=Math.min(400,(rtl?list.right:space4.right-list.left)-30);var spaceBelow=space4.bottom-list.bottom;if(spaceBelow>=infoHeight||spaceBelow>list.top){offset=option.bottom-list.top;}else{side="bottom";offset=list.bottom-option.top;}}var scaleY=(list.bottom-list.top)/tooltip.offsetHeight;var scaleX=(list.right-list.left)/tooltip.offsetWidth;return{style:"".concat(side,": ").concat(offset/scaleY,"px; max-width: ").concat(maxWidth/scaleX,"px"),"class":"cm-completionInfo-"+(narrow?rtl?"left-narrow":"right-narrow":left?"left":"right")};}function optionContent(config2){var content2=config2.addToOptions.slice();if(config2.icons)content2.push({render:function render(completion){var _icon$classList;var icon=document.createElement("div");icon.classList.add("cm-completionIcon");if(completion.type)(_icon$classList=icon.classList).add.apply(_icon$classList,_toConsumableArray(completion.type.split(/\s+/g).map(function(cls){return"cm-completionIcon-"+cls;})));icon.setAttribute("aria-hidden","true");return icon;},position:20});content2.push({render:function render(completion,_s,_v,match){var labelElt=document.createElement("span");labelElt.className="cm-completionLabel";var label=completion.displayLabel||completion.label,off=0;for(var j=0;j<match.length;){var from=match[j++],to=match[j++];if(from>off)labelElt.appendChild(document.createTextNode(label.slice(off,from)));var span=labelElt.appendChild(document.createElement("span"));span.appendChild(document.createTextNode(label.slice(from,to)));span.className="cm-completionMatchedText";off=to;}if(off<label.length)labelElt.appendChild(document.createTextNode(label.slice(off)));return labelElt;},position:50},{render:function render(completion){if(!completion.detail)return null;var detailElt=document.createElement("span");detailElt.className="cm-completionDetail";detailElt.textContent=completion.detail;return detailElt;},position:80});return content2.sort(function(a,b){return a.position-b.position;}).map(function(a){return a.render;});}function rangeAroundSelected(total,selected,max){if(total<=max)return{from:0,to:total};if(selected<0)selected=0;if(selected<=total>>1){var off2=Math.floor(selected/max);return{from:off2*max,to:(off2+1)*max};}var off=Math.floor((total-selected)/max);return{from:total-(off+1)*max,to:total-off*max};}var CompletionTooltip=/*#__PURE__*/function(){function CompletionTooltip(view,stateField,applyCompletion2){var _this82=this;_classCallCheck(this,CompletionTooltip);this.view=view;this.stateField=stateField;this.applyCompletion=applyCompletion2;this.info=null;this.infoDestroy=null;this.placeInfoReq={read:function read(){return _this82.measureInfo();},write:function write(pos){return _this82.placeInfo(pos);},key:this};this.space=null;this.currentClass="";var cState=view.state.field(stateField);var _cState$open=cState.open,options=_cState$open.options,selected=_cState$open.selected;var config2=view.state.facet(completionConfig);this.optionContent=optionContent(config2);this.optionClass=config2.optionClass;this.tooltipClass=config2.tooltipClass;this.range=rangeAroundSelected(options.length,selected,config2.maxRenderedOptions);this.dom=document.createElement("div");this.dom.className="cm-tooltip-autocomplete";this.updateTooltipClass(view.state);this.dom.addEventListener("mousedown",function(e){var options2=view.state.field(stateField).open.options;for(var dom=e.target,match;dom&&dom!=_this82.dom;dom=dom.parentNode){if(dom.nodeName=="LI"&&(match=/-(\d+)$/.exec(dom.id))&&+match[1]<options2.length){_this82.applyCompletion(view,options2[+match[1]]);e.preventDefault();return;}}});this.dom.addEventListener("focusout",function(e){var state=view.state.field(_this82.stateField,false);if(state&&state.tooltip&&view.state.facet(completionConfig).closeOnBlur&&e.relatedTarget!=view.contentDOM)view.dispatch({effects:closeCompletionEffect.of(null)});});this.showOptions(options,cState.id);}_createClass(CompletionTooltip,[{key:"mount",value:function mount(){this.updateSel();}},{key:"showOptions",value:function showOptions(options,id2){var _this83=this;if(this.list)this.list.remove();this.list=this.dom.appendChild(this.createListBox(options,id2,this.range));this.list.addEventListener("scroll",function(){if(_this83.info)_this83.view.requestMeasure(_this83.placeInfoReq);});}},{key:"update",value:function update(_update25){var _a2;var cState=_update25.state.field(this.stateField);var prevState=_update25.startState.field(this.stateField);this.updateTooltipClass(_update25.state);if(cState!=prevState){var _cState$open2=cState.open,options=_cState$open2.options,selected=_cState$open2.selected,disabled=_cState$open2.disabled;if(!prevState.open||prevState.open.options!=options){this.range=rangeAroundSelected(options.length,selected,_update25.state.facet(completionConfig).maxRenderedOptions);this.showOptions(options,cState.id);}this.updateSel();if(disabled!=((_a2=prevState.open)===null||_a2===void 0?void 0:_a2.disabled))this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!disabled);}}},{key:"updateTooltipClass",value:function updateTooltipClass(state){var cls=this.tooltipClass(state);if(cls!=this.currentClass){var _iterator205=_createForOfIteratorHelper(this.currentClass.split(" ")),_step205;try{for(_iterator205.s();!(_step205=_iterator205.n()).done;){var c=_step205.value;if(c)this.dom.classList.remove(c);}}catch(err){_iterator205.e(err);}finally{_iterator205.f();}var _iterator206=_createForOfIteratorHelper(cls.split(" ")),_step206;try{for(_iterator206.s();!(_step206=_iterator206.n()).done;){var _c2=_step206.value;if(_c2)this.dom.classList.add(_c2);}}catch(err){_iterator206.e(err);}finally{_iterator206.f();}this.currentClass=cls;}}},{key:"positioned",value:function positioned(space4){this.space=space4;if(this.info)this.view.requestMeasure(this.placeInfoReq);}},{key:"updateSel",value:function updateSel(){var _this84=this;var cState=this.view.state.field(this.stateField),open=cState.open;if(open.selected>-1&&open.selected<this.range.from||open.selected>=this.range.to){this.range=rangeAroundSelected(open.options.length,open.selected,this.view.state.facet(completionConfig).maxRenderedOptions);this.showOptions(open.options,cState.id);}if(this.updateSelectedOption(open.selected)){this.destroyInfo();var completion=open.options[open.selected].completion;var info=completion.info;if(!info)return;var infoResult=typeof info==="string"?document.createTextNode(info):info(completion);if(!infoResult)return;if("then"in infoResult){infoResult.then(function(obj){if(obj&&_this84.view.state.field(_this84.stateField,false)==cState)_this84.addInfoPane(obj,completion);})["catch"](function(e){return logException(_this84.view.state,e,"completion info");});}else{this.addInfoPane(infoResult,completion);}}}},{key:"addInfoPane",value:function addInfoPane(content2,completion){this.destroyInfo();var wrap=this.info=document.createElement("div");wrap.className="cm-tooltip cm-completionInfo";if(content2.nodeType!=null){wrap.appendChild(content2);this.infoDestroy=null;}else{var dom=content2.dom,destroy=content2.destroy;wrap.appendChild(dom);this.infoDestroy=destroy||null;}this.dom.appendChild(wrap);this.view.requestMeasure(this.placeInfoReq);}},{key:"updateSelectedOption",value:function updateSelectedOption(selected){var set=null;for(var opt=this.list.firstChild,_i161=this.range.from;opt;opt=opt.nextSibling,_i161++){if(opt.nodeName!="LI"||!opt.id){_i161--;}else if(_i161==selected){if(!opt.hasAttribute("aria-selected")){opt.setAttribute("aria-selected","true");set=opt;}}else{if(opt.hasAttribute("aria-selected"))opt.removeAttribute("aria-selected");}}if(set)scrollIntoView2(this.list,set);return set;}},{key:"measureInfo",value:function measureInfo(){var sel=this.dom.querySelector("[aria-selected]");if(!sel||!this.info)return null;var listRect=this.dom.getBoundingClientRect();var infoRect=this.info.getBoundingClientRect();var selRect=sel.getBoundingClientRect();var space4=this.space;if(!space4){var win=this.dom.ownerDocument.defaultView||window;space4={left:0,top:0,right:win.innerWidth,bottom:win.innerHeight};}if(selRect.top>Math.min(space4.bottom,listRect.bottom)-10||selRect.bottom<Math.max(space4.top,listRect.top)+10)return null;return this.view.state.facet(completionConfig).positionInfo(this.view,listRect,selRect,infoRect,space4,this.dom);}},{key:"placeInfo",value:function placeInfo(pos){if(this.info){if(pos){if(pos.style)this.info.style.cssText=pos.style;this.info.className="cm-tooltip cm-completionInfo "+(pos["class"]||"");}else{this.info.style.cssText="top: -1e6px";}}}},{key:"createListBox",value:function createListBox(options,id2,range){var ul=document.createElement("ul");ul.id=id2;ul.setAttribute("role","listbox");ul.setAttribute("aria-expanded","true");ul.setAttribute("aria-label",this.view.state.phrase("Completions"));var curSection=null;for(var _i162=range.from;_i162<range.to;_i162++){var _options$_i=options[_i162],completion=_options$_i.completion,match=_options$_i.match,section=completion.section;if(section){var _name2=typeof section=="string"?section:section.name;if(_name2!=curSection&&(_i162>range.from||range.from==0)){curSection=_name2;if(typeof section!="string"&&section.header){ul.appendChild(section.header(section));}else{var header=ul.appendChild(document.createElement("completion-section"));header.textContent=_name2;}}}var li=ul.appendChild(document.createElement("li"));li.id=id2+"-"+_i162;li.setAttribute("role","option");var cls=this.optionClass(completion);if(cls)li.className=cls;var _iterator207=_createForOfIteratorHelper(this.optionContent),_step207;try{for(_iterator207.s();!(_step207=_iterator207.n()).done;){var source=_step207.value;var node=source(completion,this.view.state,this.view,match);if(node)li.appendChild(node);}}catch(err){_iterator207.e(err);}finally{_iterator207.f();}}if(range.from)ul.classList.add("cm-completionListIncompleteTop");if(range.to<options.length)ul.classList.add("cm-completionListIncompleteBottom");return ul;}},{key:"destroyInfo",value:function destroyInfo(){if(this.info){if(this.infoDestroy)this.infoDestroy();this.info.remove();this.info=null;}}},{key:"destroy",value:function destroy(){this.destroyInfo();}}]);return CompletionTooltip;}();function completionTooltip(stateField,applyCompletion2){return function(view){return new CompletionTooltip(view,stateField,applyCompletion2);};}function scrollIntoView2(container,element){var parent=container.getBoundingClientRect();var self=element.getBoundingClientRect();var scaleY=parent.height/container.offsetHeight;if(self.top<parent.top)container.scrollTop-=(parent.top-self.top)/scaleY;else if(self.bottom>parent.bottom)container.scrollTop+=(self.bottom-parent.bottom)/scaleY;}function score(option){return(option.boost||0)*100+(option.apply?10:0)+(option.info?5:0)+(option.type?1:0);}function sortOptions(active,state){var options=[];var sections=null;var addOption=function addOption(option){options.push(option);var section=option.completion.section;if(section){if(!sections)sections=[];var _name3=typeof section=="string"?section:section.name;if(!sections.some(function(s){return s.name==_name3;}))sections.push(typeof section=="string"?{name:_name3}:section);}};var _iterator208=_createForOfIteratorHelper(active),_step208;try{for(_iterator208.s();!(_step208=_iterator208.n()).done;){var a=_step208.value;if(a.hasResult()){var getMatch=a.result.getMatch;if(a.result.filter===false){var _iterator212=_createForOfIteratorHelper(a.result.options),_step212;try{for(_iterator212.s();!(_step212=_iterator212.n()).done;){var _option=_step212.value;addOption(new Option(_option,a.source,getMatch?getMatch(_option):[],1e9-options.length));}}catch(err){_iterator212.e(err);}finally{_iterator212.f();}}else{var matcher=new FuzzyMatcher(state.sliceDoc(a.from,a.to));var _iterator213=_createForOfIteratorHelper(a.result.options),_step213;try{for(_iterator213.s();!(_step213=_iterator213.n()).done;){var _option2=_step213.value;if(matcher.match(_option2.label)){var matched=!_option2.displayLabel?matcher.matched:getMatch?getMatch(_option2,matcher.matched):[];addOption(new Option(_option2,a.source,matched,matcher.score+(_option2.boost||0)));}}}catch(err){_iterator213.e(err);}finally{_iterator213.f();}}}}}catch(err){_iterator208.e(err);}finally{_iterator208.f();}if(sections){var sectionOrder=/* @__PURE__ */Object.create(null),pos=0;var cmp=function cmp(a,b){var _a2,_b;return((_a2=a.rank)!==null&&_a2!==void 0?_a2:1e9)-((_b=b.rank)!==null&&_b!==void 0?_b:1e9)||(a.name<b.name?-1:1);};var _iterator209=_createForOfIteratorHelper(sections.sort(cmp)),_step209;try{for(_iterator209.s();!(_step209=_iterator209.n()).done;){var s=_step209.value;pos-=1e5;sectionOrder[s.name]=pos;}}catch(err){_iterator209.e(err);}finally{_iterator209.f();}var _iterator210=_createForOfIteratorHelper(options),_step210;try{for(_iterator210.s();!(_step210=_iterator210.n()).done;){var option=_step210.value;var section=option.completion.section;if(section)option.score+=sectionOrder[typeof section=="string"?section:section.name];}}catch(err){_iterator210.e(err);}finally{_iterator210.f();}}var result=[],prev=null;var compare2=state.facet(completionConfig).compareCompletions;var _iterator211=_createForOfIteratorHelper(options.sort(function(a,b){return b.score-a.score||compare2(a.completion,b.completion);})),_step211;try{for(_iterator211.s();!(_step211=_iterator211.n()).done;){var opt=_step211.value;var cur2=opt.completion;if(!prev||prev.label!=cur2.label||prev.detail!=cur2.detail||prev.type!=null&&cur2.type!=null&&prev.type!=cur2.type||prev.apply!=cur2.apply||prev.boost!=cur2.boost)result.push(opt);else if(score(opt.completion)>score(prev))result[result.length-1]=opt;prev=opt.completion;}}catch(err){_iterator211.e(err);}finally{_iterator211.f();}return result;}var CompletionDialog=/*#__PURE__*/function(){function CompletionDialog(options,attrs,tooltip,timestamp,selected,disabled){_classCallCheck(this,CompletionDialog);this.options=options;this.attrs=attrs;this.tooltip=tooltip;this.timestamp=timestamp;this.selected=selected;this.disabled=disabled;}_createClass(CompletionDialog,[{key:"setSelected",value:function setSelected(selected,id2){return selected==this.selected||selected>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(id2,selected),this.tooltip,this.timestamp,selected,this.disabled);}},{key:"map",value:function map(changes){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:changes.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled);}}],[{key:"build",value:function build(active,state,id2,prev,conf){var options=sortOptions(active,state);if(!options.length){return prev&&active.some(function(a){return a.state==1;})?new CompletionDialog(prev.options,prev.attrs,prev.tooltip,prev.timestamp,prev.selected,true):null;}var selected=state.facet(completionConfig).selectOnOpen?0:-1;if(prev&&prev.selected!=selected&&prev.selected!=-1){var selectedValue=prev.options[prev.selected].completion;for(var _i163=0;_i163<options.length;_i163++){if(options[_i163].completion==selectedValue){selected=_i163;break;}}}return new CompletionDialog(options,makeAttrs(id2,selected),{pos:active.reduce(function(a,b){return b.hasResult()?Math.min(a,b.from):a;},1e8),create:createTooltip,above:conf.aboveCursor},prev?prev.timestamp:Date.now(),selected,false);}}]);return CompletionDialog;}();var CompletionState=/*#__PURE__*/function(){function CompletionState(active,id2,open){_classCallCheck(this,CompletionState);this.active=active;this.id=id2;this.open=open;}_createClass(CompletionState,[{key:"update",value:function update(tr){var _this85=this;var state=tr.state,conf=state.facet(completionConfig);var sources=conf.override||state.languageDataAt("autocomplete",cur(state)).map(asSource);var active=sources.map(function(source){var value=_this85.active.find(function(s){return s.source==source;})||new ActiveSource(source,_this85.active.some(function(a){return a.state!=0;})?1:0);return value.update(tr,conf);});if(active.length==this.active.length&&active.every(function(a,i){return a==_this85.active[i];}))active=this.active;var open=this.open;if(open&&tr.docChanged)open=open.map(tr.changes);if(tr.selection||active.some(function(a){return a.hasResult()&&tr.changes.touchesRange(a.from,a.to);})||!sameResults(active,this.active))open=CompletionDialog.build(active,state,this.id,open,conf);else if(open&&open.disabled&&!active.some(function(a){return a.state==1;}))open=null;if(!open&&active.every(function(a){return a.state!=1;})&&active.some(function(a){return a.hasResult();}))active=active.map(function(a){return a.hasResult()?new ActiveSource(a.source,0):a;});var _iterator214=_createForOfIteratorHelper(tr.effects),_step214;try{for(_iterator214.s();!(_step214=_iterator214.n()).done;){var effect=_step214.value;if(effect.is(setSelectedEffect))open=open&&open.setSelected(effect.value,this.id);}}catch(err){_iterator214.e(err);}finally{_iterator214.f();}return active==this.active&&open==this.open?this:new CompletionState(active,this.id,open);}},{key:"tooltip",get:function get(){return this.open?this.open.tooltip:null;}},{key:"attrs",get:function get(){return this.open?this.open.attrs:baseAttrs;}}],[{key:"start",value:function start(){return new CompletionState(none3,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null);}}]);return CompletionState;}();function sameResults(a,b){if(a==b)return true;for(var iA=0,iB=0;;){while(iA<a.length&&!a[iA].hasResult){iA++;}while(iB<b.length&&!b[iB].hasResult){iB++;}var endA=iA==a.length,endB=iB==b.length;if(endA||endB)return endA==endB;if(a[iA++].result!=b[iB++].result)return false;}}var baseAttrs={"aria-autocomplete":"list"};function makeAttrs(id2,selected){var result={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":id2};if(selected>-1)result["aria-activedescendant"]=id2+"-"+selected;return result;}var none3=[];function getUserEvent(tr){return tr.isUserEvent("input.type")?"input":tr.isUserEvent("delete.backward")?"delete":null;}var ActiveSource=/*#__PURE__*/function(){function ActiveSource(source,state){var explicitPos=arguments.length>2&&arguments[2]!==undefined?arguments[2]:-1;_classCallCheck(this,ActiveSource);this.source=source;this.state=state;this.explicitPos=explicitPos;}_createClass(ActiveSource,[{key:"hasResult",value:function hasResult(){return false;}},{key:"update",value:function update(tr,conf){var event=getUserEvent(tr),value=this;if(event)value=value.handleUserEvent(tr,event,conf);else if(tr.docChanged)value=value.handleChange(tr);else if(tr.selection&&value.state!=0)value=new ActiveSource(value.source,0);var _iterator215=_createForOfIteratorHelper(tr.effects),_step215;try{for(_iterator215.s();!(_step215=_iterator215.n()).done;){var effect=_step215.value;if(effect.is(startCompletionEffect))value=new ActiveSource(value.source,1,effect.value?cur(tr.state):-1);else if(effect.is(closeCompletionEffect))value=new ActiveSource(value.source,0);else if(effect.is(setActiveEffect)){var _iterator216=_createForOfIteratorHelper(effect.value),_step216;try{for(_iterator216.s();!(_step216=_iterator216.n()).done;){var active=_step216.value;if(active.source==value.source)value=active;}}catch(err){_iterator216.e(err);}finally{_iterator216.f();}}}}catch(err){_iterator215.e(err);}finally{_iterator215.f();}return value;}},{key:"handleUserEvent",value:function handleUserEvent(tr,type,conf){return type=="delete"||!conf.activateOnTyping?this.map(tr.changes):new ActiveSource(this.source,1);}},{key:"handleChange",value:function handleChange(tr){return tr.changes.touchesRange(cur(tr.startState))?new ActiveSource(this.source,0):this.map(tr.changes);}},{key:"map",value:function map(changes){return changes.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,changes.mapPos(this.explicitPos));}}]);return ActiveSource;}();var ActiveResult=/*#__PURE__*/function(_ActiveSource){_inherits(ActiveResult,_ActiveSource);var _super39=_createSuper(ActiveResult);function ActiveResult(source,explicitPos,result,from,to){var _this86;_classCallCheck(this,ActiveResult);_this86=_super39.call(this,source,2,explicitPos);_this86.result=result;_this86.from=from;_this86.to=to;return _this86;}_createClass(ActiveResult,[{key:"hasResult",value:function hasResult(){return true;}},{key:"handleUserEvent",value:function handleUserEvent(tr,type,conf){var _a2;var from=tr.changes.mapPos(this.from),to=tr.changes.mapPos(this.to,1);var pos=cur(tr.state);if((this.explicitPos<0?pos<=from:pos<this.from)||pos>to||type=="delete"&&cur(tr.startState)==this.from)return new ActiveSource(this.source,type=="input"&&conf.activateOnTyping?1:0);var explicitPos=this.explicitPos<0?-1:tr.changes.mapPos(this.explicitPos),updated;if(checkValid(this.result.validFor,tr.state,from,to))return new ActiveResult(this.source,explicitPos,this.result,from,to);if(this.result.update&&(updated=this.result.update(this.result,from,to,new _CompletionContext(tr.state,pos,explicitPos>=0))))return new ActiveResult(this.source,explicitPos,updated,updated.from,(_a2=updated.to)!==null&&_a2!==void 0?_a2:cur(tr.state));return new ActiveSource(this.source,1,explicitPos);}},{key:"handleChange",value:function handleChange(tr){return tr.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0):this.map(tr.changes);}},{key:"map",value:function map(mapping){return mapping.empty?this:new ActiveResult(this.source,this.explicitPos<0?-1:mapping.mapPos(this.explicitPos),this.result,mapping.mapPos(this.from),mapping.mapPos(this.to,1));}}]);return ActiveResult;}(ActiveSource);function checkValid(validFor,state,from,to){if(!validFor)return false;var text=state.sliceDoc(from,to);return typeof validFor=="function"?validFor(text,from,to,state):ensureAnchor(validFor,true).test(text);}var setActiveEffect=/* @__PURE__ */StateEffect.define({map:function map(sources,mapping){return sources.map(function(s){return s.map(mapping);});}});var setSelectedEffect=/* @__PURE__ */StateEffect.define();var completionState=/* @__PURE__ */StateField.define({create:function create(){return CompletionState.start();},update:function update(value,tr){return value.update(tr);},provide:function provide(f){return[showTooltip.from(f,function(val){return val.tooltip;}),EditorView.contentAttributes.from(f,function(state){return state.attrs;})];}});function applyCompletion(view,option){var apply=option.completion.apply||option.completion.label;var result=view.state.field(completionState).active.find(function(a){return a.source==option.source;});if(!(result instanceof ActiveResult))return false;if(typeof apply=="string")view.dispatch(Object.assign(Object.assign({},_insertCompletionText(view.state,apply,result.from,result.to)),{annotations:_pickedCompletion.of(option.completion)}));else apply(view,option.completion,result.from,result.to);return true;}var createTooltip=/* @__PURE__ */completionTooltip(completionState,applyCompletion);function _moveCompletionSelection(forward){var by=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"option";return function(view){var cState=view.state.field(completionState,false);if(!cState||!cState.open||cState.open.disabled||Date.now()-cState.open.timestamp<view.state.facet(completionConfig).interactionDelay)return false;var step=1,tooltip;if(by=="page"&&(tooltip=getTooltip(view,cState.open.tooltip)))step=Math.max(2,Math.floor(tooltip.dom.offsetHeight/tooltip.dom.querySelector("li").offsetHeight)-1);var length=cState.open.options.length;var selected=cState.open.selected>-1?cState.open.selected+step*(forward?1:-1):forward?0:length-1;if(selected<0)selected=by=="page"?0:length-1;else if(selected>=length)selected=by=="page"?length-1:0;view.dispatch({effects:setSelectedEffect.of(selected)});return true;};}var _acceptCompletion=function _acceptCompletion(view){var cState=view.state.field(completionState,false);if(view.state.readOnly||!cState||!cState.open||cState.open.selected<0||cState.open.disabled||Date.now()-cState.open.timestamp<view.state.facet(completionConfig).interactionDelay)return false;return applyCompletion(view,cState.open.options[cState.open.selected]);};var _startCompletion=function _startCompletion(view){var cState=view.state.field(completionState,false);if(!cState)return false;view.dispatch({effects:startCompletionEffect.of(true)});return true;};var _closeCompletion=function _closeCompletion(view){var cState=view.state.field(completionState,false);if(!cState||!cState.active.some(function(a){return a.state!=0;}))return false;view.dispatch({effects:closeCompletionEffect.of(null)});return true;};var RunningQuery=/*#__PURE__*/_createClass(function RunningQuery(active,context){_classCallCheck(this,RunningQuery);this.active=active;this.context=context;this.time=Date.now();this.updates=[];this.done=void 0;});var MaxUpdateCount=50;var MinAbortTime=1e3;var completionPlugin=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class15(view){_classCallCheck(this,_class15);this.view=view;this.debounceUpdate=-1;this.running=[];this.debounceAccept=-1;this.composing=0;var _iterator217=_createForOfIteratorHelper(view.state.field(completionState).active),_step217;try{for(_iterator217.s();!(_step217=_iterator217.n()).done;){var active=_step217.value;if(active.state==1)this.startQuery(active);}}catch(err){_iterator217.e(err);}finally{_iterator217.f();}}_createClass(_class15,[{key:"update",value:function update(_update26){var _this87=this;var cState=_update26.state.field(completionState);if(!_update26.selectionSet&&!_update26.docChanged&&_update26.startState.field(completionState)==cState)return;var doesReset=_update26.transactions.some(function(tr){return(tr.selection||tr.docChanged)&&!getUserEvent(tr);});for(var _i164=0;_i164<this.running.length;_i164++){var query=this.running[_i164];if(doesReset||query.updates.length+_update26.transactions.length>MaxUpdateCount&&Date.now()-query.time>MinAbortTime){var _iterator218=_createForOfIteratorHelper(query.context.abortListeners),_step218;try{for(_iterator218.s();!(_step218=_iterator218.n()).done;){var handler=_step218.value;try{handler();}catch(e){logException(this.view.state,e);}}}catch(err){_iterator218.e(err);}finally{_iterator218.f();}query.context.abortListeners=null;this.running.splice(_i164--,1);}else{var _query$updates;(_query$updates=query.updates).push.apply(_query$updates,_toConsumableArray(_update26.transactions));}}if(this.debounceUpdate>-1)clearTimeout(this.debounceUpdate);this.debounceUpdate=cState.active.some(function(a){return a.state==1&&!_this87.running.some(function(q){return q.active.source==a.source;});})?setTimeout(function(){return _this87.startUpdate();},50):-1;if(this.composing!=0){var _iterator219=_createForOfIteratorHelper(_update26.transactions),_step219;try{for(_iterator219.s();!(_step219=_iterator219.n()).done;){var tr=_step219.value;if(getUserEvent(tr)=="input")this.composing=2;else if(this.composing==2&&tr.selection)this.composing=3;}}catch(err){_iterator219.e(err);}finally{_iterator219.f();}}}},{key:"startUpdate",value:function startUpdate(){var _this88=this;this.debounceUpdate=-1;var state=this.view.state,cState=state.field(completionState);var _iterator220=_createForOfIteratorHelper(cState.active),_step220;try{var _loop15=function _loop15(){var active=_step220.value;if(active.state==1&&!_this88.running.some(function(r){return r.active.source==active.source;}))_this88.startQuery(active);};for(_iterator220.s();!(_step220=_iterator220.n()).done;){_loop15();}}catch(err){_iterator220.e(err);}finally{_iterator220.f();}}},{key:"startQuery",value:function startQuery(active){var _this89=this;var state=this.view.state,pos=cur(state);var context=new _CompletionContext(state,pos,active.explicitPos==pos);var pending=new RunningQuery(active,context);this.running.push(pending);Promise.resolve(active.source(context)).then(function(result){if(!pending.context.aborted){pending.done=result||null;_this89.scheduleAccept();}},function(err){_this89.view.dispatch({effects:closeCompletionEffect.of(null)});logException(_this89.view.state,err);});}},{key:"scheduleAccept",value:function scheduleAccept(){var _this90=this;if(this.running.every(function(q){return q.done!==void 0;}))this.accept();else if(this.debounceAccept<0)this.debounceAccept=setTimeout(function(){return _this90.accept();},this.view.state.facet(completionConfig).updateSyncTime);}},{key:"accept",value:function accept(){var _this91=this;var _a2;if(this.debounceAccept>-1)clearTimeout(this.debounceAccept);this.debounceAccept=-1;var updated=[];var conf=this.view.state.facet(completionConfig);var _loop16=function _loop16(_i166){var query=_this91.running[_i166];if(query.done===void 0){_i165=_i166;return"continue";}_this91.running.splice(_i166--,1);if(query.done){var active=new ActiveResult(query.active.source,query.active.explicitPos,query.done,query.done.from,(_a2=query.done.to)!==null&&_a2!==void 0?_a2:cur(query.updates.length?query.updates[0].startState:_this91.view.state));var _iterator221=_createForOfIteratorHelper(query.updates),_step221;try{for(_iterator221.s();!(_step221=_iterator221.n()).done;){var tr=_step221.value;active=active.update(tr,conf);}}catch(err){_iterator221.e(err);}finally{_iterator221.f();}if(active.hasResult()){updated.push(active);_i165=_i166;return"continue";}}var current=_this91.view.state.field(completionState).active.find(function(a){return a.source==query.active.source;});if(current&&current.state==1){if(query.done==null){var _active=new ActiveSource(query.active.source,0);var _iterator222=_createForOfIteratorHelper(query.updates),_step222;try{for(_iterator222.s();!(_step222=_iterator222.n()).done;){var _tr2=_step222.value;_active=_active.update(_tr2,conf);}}catch(err){_iterator222.e(err);}finally{_iterator222.f();}if(_active.state!=1)updated.push(_active);}else{_this91.startQuery(current);}}_i165=_i166;};for(var _i165=0;_i165<this.running.length;_i165++){var _ret5=_loop16(_i165);if(_ret5==="continue")continue;}if(updated.length)this.view.dispatch({effects:setActiveEffect.of(updated)});}}]);return _class15;}(),{eventHandlers:{blur:function blur(event){var state=this.view.state.field(completionState,false);if(state&&state.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){var dialog=state.open&&getTooltip(this.view,state.open.tooltip);if(!dialog||!dialog.dom.contains(event.relatedTarget))this.view.dispatch({effects:closeCompletionEffect.of(null)});}},compositionstart:function compositionstart(){this.composing=1;},compositionend:function compositionend(){var _this92=this;if(this.composing==3){setTimeout(function(){return _this92.view.dispatch({effects:startCompletionEffect.of(false)});},20);}this.composing=0;}}});var baseTheme4=/* @__PURE__ */EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:0.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:0.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"".concat(400,"px"),boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"".concat(30,"px")},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"".concat(30,"px")},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\uD835\uDC65'"}},".cm-completionIcon-constant":{"&:after":{content:"'\uD835\uDC36'"}},".cm-completionIcon-type":{"&:after":{content:"'\uD835\uDC61'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\uD83D\uDD11\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});var FieldPos=/*#__PURE__*/_createClass(function FieldPos(field,line,from,to){_classCallCheck(this,FieldPos);this.field=field;this.line=line;this.from=from;this.to=to;});var FieldRange=/*#__PURE__*/function(){function FieldRange(field,from,to){_classCallCheck(this,FieldRange);this.field=field;this.from=from;this.to=to;}_createClass(FieldRange,[{key:"map",value:function map(changes){var from=changes.mapPos(this.from,-1,MapMode.TrackDel);var to=changes.mapPos(this.to,1,MapMode.TrackDel);return from==null||to==null?null:new FieldRange(this.field,from,to);}}]);return FieldRange;}();var Snippet=/*#__PURE__*/function(){function Snippet(lines,fieldPositions){_classCallCheck(this,Snippet);this.lines=lines;this.fieldPositions=fieldPositions;}_createClass(Snippet,[{key:"instantiate",value:function instantiate(state,pos){var text=[],lineStart=[pos];var lineObj=state.doc.lineAt(pos),baseIndent=/^\s*/.exec(lineObj.text)[0];var _iterator223=_createForOfIteratorHelper(this.lines),_step223;try{for(_iterator223.s();!(_step223=_iterator223.n()).done;){var line=_step223.value;if(text.length){var indent=baseIndent,tabs=/^\t*/.exec(line)[0].length;for(var _i167=0;_i167<tabs;_i167++){indent+=state.facet(_indentUnit);}lineStart.push(pos+indent.length-tabs);line=indent+line.slice(tabs);}text.push(line);pos+=line.length+1;}}catch(err){_iterator223.e(err);}finally{_iterator223.f();}var ranges=this.fieldPositions.map(function(pos2){return new FieldRange(pos2.field,lineStart[pos2.line]+pos2.from,lineStart[pos2.line]+pos2.to);});return{text:text,ranges:ranges};}}],[{key:"parse",value:function parse(template){var fields=[];var lines=[],positions=[],m;var _iterator224=_createForOfIteratorHelper(template.split(/\r\n?|\n/)),_step224;try{for(_iterator224.s();!(_step224=_iterator224.n()).done;){var line=_step224.value;while(m=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(line)){var seq=m[1]?+m[1]:null,_name4=m[2]||m[3]||"",found=-1;for(var _i168=0;_i168<fields.length;_i168++){if(seq!=null?fields[_i168].seq==seq:_name4?fields[_i168].name==_name4:false)found=_i168;}if(found<0){var _i169=0;while(_i169<fields.length&&(seq==null||fields[_i169].seq!=null&&fields[_i169].seq<seq)){_i169++;}fields.splice(_i169,0,{seq:seq,name:_name4});found=_i169;var _iterator225=_createForOfIteratorHelper(positions),_step225;try{for(_iterator225.s();!(_step225=_iterator225.n()).done;){var pos=_step225.value;if(pos.field>=found)pos.field++;}}catch(err){_iterator225.e(err);}finally{_iterator225.f();}}positions.push(new FieldPos(found,lines.length,m.index,m.index+_name4.length));line=line.slice(0,m.index)+_name4+line.slice(m.index+m[0].length);}for(var esc;esc=/\\([{}])/.exec(line);){line=line.slice(0,esc.index)+esc[1]+line.slice(esc.index+esc[0].length);var _iterator226=_createForOfIteratorHelper(positions),_step226;try{for(_iterator226.s();!(_step226=_iterator226.n()).done;){var _pos2=_step226.value;if(_pos2.line==lines.length&&_pos2.from>esc.index){_pos2.from--;_pos2.to--;}}}catch(err){_iterator226.e(err);}finally{_iterator226.f();}}lines.push(line);}}catch(err){_iterator224.e(err);}finally{_iterator224.f();}return new Snippet(lines,positions);}}]);return Snippet;}();var fieldMarker=/* @__PURE__ */Decoration.widget({widget:/* @__PURE__ */new(/*#__PURE__*/function(_WidgetType8){_inherits(_class16,_WidgetType8);var _super40=_createSuper(_class16);function _class16(){_classCallCheck(this,_class16);return _super40.apply(this,arguments);}_createClass(_class16,[{key:"toDOM",value:function toDOM(){var span=document.createElement("span");span.className="cm-snippetFieldPosition";return span;}},{key:"ignoreEvent",value:function ignoreEvent(){return false;}}]);return _class16;}(WidgetType))()});var fieldRange=/* @__PURE__ */Decoration.mark({"class":"cm-snippetField"});var ActiveSnippet=/*#__PURE__*/function(){function ActiveSnippet(ranges,active){_classCallCheck(this,ActiveSnippet);this.ranges=ranges;this.active=active;this.deco=Decoration.set(ranges.map(function(r){return(r.from==r.to?fieldMarker:fieldRange).range(r.from,r.to);}));}_createClass(ActiveSnippet,[{key:"map",value:function map(changes){var ranges=[];var _iterator227=_createForOfIteratorHelper(this.ranges),_step227;try{for(_iterator227.s();!(_step227=_iterator227.n()).done;){var _r14=_step227.value;var mapped=_r14.map(changes);if(!mapped)return null;ranges.push(mapped);}}catch(err){_iterator227.e(err);}finally{_iterator227.f();}return new ActiveSnippet(ranges,this.active);}},{key:"selectionInsideField",value:function selectionInsideField(sel){var _this93=this;return sel.ranges.every(function(range){return _this93.ranges.some(function(r){return r.field==_this93.active&&r.from<=range.from&&r.to>=range.to;});});}}]);return ActiveSnippet;}();var setActive=/* @__PURE__ */StateEffect.define({map:function map(value,changes){return value&&value.map(changes);}});var moveToField=/* @__PURE__ */StateEffect.define();var snippetState=/* @__PURE__ */StateField.define({create:function create(){return null;},update:function update(value,tr){var _iterator228=_createForOfIteratorHelper(tr.effects),_step228;try{for(_iterator228.s();!(_step228=_iterator228.n()).done;){var effect=_step228.value;if(effect.is(setActive))return effect.value;if(effect.is(moveToField)&&value)return new ActiveSnippet(value.ranges,effect.value);}}catch(err){_iterator228.e(err);}finally{_iterator228.f();}if(value&&tr.docChanged)value=value.map(tr.changes);if(value&&tr.selection&&!value.selectionInsideField(tr.selection))value=null;return value;},provide:function provide(f){return EditorView.decorations.from(f,function(val){return val?val.deco:Decoration.none;});}});function fieldSelection(ranges,field){return EditorSelection.create(ranges.filter(function(r){return r.field==field;}).map(function(r){return EditorSelection.range(r.from,r.to);}));}function _snippet(template){var snippet2=Snippet.parse(template);return function(editor,completion,from,to){var _snippet2$instantiate=snippet2.instantiate(editor.state,from),text=_snippet2$instantiate.text,ranges=_snippet2$instantiate.ranges;var spec={changes:{from:from,to:to,insert:Text.of(text)},scrollIntoView:true,annotations:completion?_pickedCompletion.of(completion):void 0};if(ranges.length)spec.selection=fieldSelection(ranges,0);if(ranges.length>1){var active=new ActiveSnippet(ranges,0);var effects=spec.effects=[setActive.of(active)];if(editor.state.field(snippetState,false)===void 0)effects.push(StateEffect.appendConfig.of([snippetState,addSnippetKeymap,snippetPointerHandler,baseTheme4]));}editor.dispatch(editor.state.update(spec));};}function moveField(dir){return function(_ref57){var state=_ref57.state,dispatch=_ref57.dispatch;var active=state.field(snippetState,false);if(!active||dir<0&&active.active==0)return false;var next=active.active+dir,last=dir>0&&!active.ranges.some(function(r){return r.field==next+dir;});dispatch(state.update({selection:fieldSelection(active.ranges,next),effects:setActive.of(last?null:new ActiveSnippet(active.ranges,next)),scrollIntoView:true}));return true;};}var _clearSnippet=function _clearSnippet(_ref58){var state=_ref58.state,dispatch=_ref58.dispatch;var active=state.field(snippetState,false);if(!active)return false;dispatch(state.update({effects:setActive.of(null)}));return true;};var _nextSnippetField=/* @__PURE__ */moveField(1);var _prevSnippetField=/* @__PURE__ */moveField(-1);function _hasNextSnippetField(state){var active=state.field(snippetState,false);return!!(active&&active.ranges.some(function(r){return r.field==active.active+1;}));}function _hasPrevSnippetField(state){var active=state.field(snippetState,false);return!!(active&&active.active>0);}var defaultSnippetKeymap=[{key:"Tab",run:_nextSnippetField,shift:_prevSnippetField},{key:"Escape",run:_clearSnippet}];var _snippetKeymap=/* @__PURE__ */Facet.define({combine:function combine(maps){return maps.length?maps[0]:defaultSnippetKeymap;}});var addSnippetKeymap=/* @__PURE__ */Prec.highest(/* @__PURE__ */keymap.compute([_snippetKeymap],function(state){return state.facet(_snippetKeymap);}));function _snippetCompletion(template,completion){return Object.assign(Object.assign({},completion),{apply:_snippet(template)});}var snippetPointerHandler=/* @__PURE__ */EditorView.domEventHandlers({mousedown:function mousedown(event,view){var active=view.state.field(snippetState,false),pos;if(!active||(pos=view.posAtCoords({x:event.clientX,y:event.clientY}))==null)return false;var match=active.ranges.find(function(r){return r.from<=pos&&r.to>=pos;});if(!match||match.field==active.active)return false;view.dispatch({selection:fieldSelection(active.ranges,match.field),effects:setActive.of(active.ranges.some(function(r){return r.field>match.field;})?new ActiveSnippet(active.ranges,match.field):null),scrollIntoView:true});return true;}});function wordRE(wordChars){var escaped=wordChars.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp("[\\p{Alphabetic}\\p{Number}_".concat(escaped,"]+"),"ug");}catch(_a2){return new RegExp("[w".concat(escaped,"]"),"g");}}function mapRE(re,f){return new RegExp(f(re.source),re.unicode?"u":"");}var wordCaches=/* @__PURE__ */Object.create(null);function wordCache(wordChars){return wordCaches[wordChars]||(wordCaches[wordChars]=/* @__PURE__ */new WeakMap());}function storeWords(doc2,wordRE2,result,seen,ignoreAt){for(var lines=doc2.iterLines(),pos=0;!lines.next().done;){var value=lines.value,m=void 0;wordRE2.lastIndex=0;while(m=wordRE2.exec(value)){if(!seen[m[0]]&&pos+m.index!=ignoreAt){result.push({type:"text",label:m[0]});seen[m[0]]=true;if(result.length>=2e3)return;}}pos+=value.length+1;}}function collectWords(doc2,cache2,wordRE2,to,ignoreAt){var big=doc2.length>=1e3;var cached=big&&cache2.get(doc2);if(cached)return cached;var result=[],seen=/* @__PURE__ */Object.create(null);if(doc2.children){var pos=0;var _iterator229=_createForOfIteratorHelper(doc2.children),_step229;try{for(_iterator229.s();!(_step229=_iterator229.n()).done;){var ch=_step229.value;if(ch.length>=1e3){var _iterator230=_createForOfIteratorHelper(collectWords(ch,cache2,wordRE2,to-pos,ignoreAt-pos)),_step230;try{for(_iterator230.s();!(_step230=_iterator230.n()).done;){var c=_step230.value;if(!seen[c.label]){seen[c.label]=true;result.push(c);}}}catch(err){_iterator230.e(err);}finally{_iterator230.f();}}else{storeWords(ch,wordRE2,result,seen,ignoreAt-pos);}pos+=ch.length+1;}}catch(err){_iterator229.e(err);}finally{_iterator229.f();}}else{storeWords(doc2,wordRE2,result,seen,ignoreAt);}if(big&&result.length<2e3)cache2.set(doc2,result);return result;}var _completeAnyWord=function _completeAnyWord(context){var wordChars=context.state.languageDataAt("wordChars",context.pos).join("");var re=wordRE(wordChars);var token=context.matchBefore(mapRE(re,function(s){return s+"$";}));if(!token&&!context.explicit)return null;var from=token?token.from:context.pos;var options=collectWords(context.state.doc,wordCache(wordChars),re,5e4,from);return{from:from,options:options,validFor:mapRE(re,function(s){return"^"+s;})};};var defaults2={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]};var closeBracketEffect=/* @__PURE__ */StateEffect.define({map:function map(value,mapping){var mapped=mapping.mapPos(value,-1,MapMode.TrackAfter);return mapped==null?void 0:mapped;}});var closedBracket=/* @__PURE__ */new(/*#__PURE__*/function(_RangeValue3){_inherits(_class17,_RangeValue3);var _super41=_createSuper(_class17);function _class17(){_classCallCheck(this,_class17);return _super41.apply(this,arguments);}return _createClass(_class17);}(RangeValue))();closedBracket.startSide=1;closedBracket.endSide=-1;var bracketState=/* @__PURE__ */StateField.define({create:function create(){return RangeSet.empty;},update:function update(value,tr){if(tr.selection){var line=tr.state.doc.lineAt(tr.selection.main.head);value=value.update({filter:function filter(from){return from>=line.from&&from<=line.to;}});}value=value.map(tr.changes);var _iterator231=_createForOfIteratorHelper(tr.effects),_step231;try{for(_iterator231.s();!(_step231=_iterator231.n()).done;){var effect=_step231.value;if(effect.is(closeBracketEffect))value=value.update({add:[closedBracket.range(effect.value,effect.value+1)]});}}catch(err){_iterator231.e(err);}finally{_iterator231.f();}return value;}});function _closeBrackets(){return[inputHandler2,bracketState];}var definedClosing="()[]{}<>";function closing(ch){for(var _i170=0;_i170<definedClosing.length;_i170+=2){if(definedClosing.charCodeAt(_i170)==ch)return definedClosing.charAt(_i170+1);}return fromCodePoint(ch<128?ch:ch+1);}function config(state,pos){return state.languageDataAt("closeBrackets",pos)[0]||defaults2;}var android=(typeof navigator==="undefined"?"undefined":_typeof(navigator))=="object"&&/* @__PURE__ */ /Android\b/.test(navigator.userAgent);var inputHandler2=/* @__PURE__ */EditorView.inputHandler.of(function(view,from,to,insert2){if((android?view.composing:view.compositionStarted)||view.state.readOnly)return false;var sel=view.state.selection.main;if(insert2.length>2||insert2.length==2&&codePointSize(codePointAt(insert2,0))==1||from!=sel.from||to!=sel.to)return false;var tr=_insertBracket(view.state,insert2);if(!tr)return false;view.dispatch(tr);return true;});var _deleteBracketPair=function _deleteBracketPair(_ref59){var state=_ref59.state,dispatch=_ref59.dispatch;if(state.readOnly)return false;var conf=config(state,state.selection.main.head);var tokens=conf.brackets||defaults2.brackets;var dont=null,changes=state.changeByRange(function(range){if(range.empty){var before=prevChar(state.doc,range.head);var _iterator232=_createForOfIteratorHelper(tokens),_step232;try{for(_iterator232.s();!(_step232=_iterator232.n()).done;){var token=_step232.value;if(token==before&&nextChar(state.doc,range.head)==closing(codePointAt(token,0)))return{changes:{from:range.head-token.length,to:range.head+token.length},range:EditorSelection.cursor(range.head-token.length)};}}catch(err){_iterator232.e(err);}finally{_iterator232.f();}}return{range:dont=range};});if(!dont)dispatch(state.update(changes,{scrollIntoView:true,userEvent:"delete.backward"}));return!dont;};var _closeBracketsKeymap=[{key:"Backspace",run:_deleteBracketPair}];function _insertBracket(state,bracket2){var conf=config(state,state.selection.main.head);var tokens=conf.brackets||defaults2.brackets;var _iterator233=_createForOfIteratorHelper(tokens),_step233;try{for(_iterator233.s();!(_step233=_iterator233.n()).done;){var tok=_step233.value;var closed=closing(codePointAt(tok,0));if(bracket2==tok)return closed==tok?handleSame(state,tok,tokens.indexOf(tok+tok+tok)>-1,conf):handleOpen(state,tok,closed,conf.before||defaults2.before);if(bracket2==closed&&closedBracketAt(state,state.selection.main.from))return handleClose(state,tok,closed);}}catch(err){_iterator233.e(err);}finally{_iterator233.f();}return null;}function closedBracketAt(state,pos){var found=false;state.field(bracketState).between(0,state.doc.length,function(from){if(from==pos)found=true;});return found;}function nextChar(doc2,pos){var next=doc2.sliceString(pos,pos+2);return next.slice(0,codePointSize(codePointAt(next,0)));}function prevChar(doc2,pos){var prev=doc2.sliceString(pos-2,pos);return codePointSize(codePointAt(prev,0))==prev.length?prev:prev.slice(1);}function handleOpen(state,open,close,closeBefore){var dont=null,changes=state.changeByRange(function(range){if(!range.empty)return{changes:[{insert:open,from:range.from},{insert:close,from:range.to}],effects:closeBracketEffect.of(range.to+open.length),range:EditorSelection.range(range.anchor+open.length,range.head+open.length)};var next=nextChar(state.doc,range.head);if(!next||/\s/.test(next)||closeBefore.indexOf(next)>-1)return{changes:{insert:open+close,from:range.head},effects:closeBracketEffect.of(range.head+open.length),range:EditorSelection.cursor(range.head+open.length)};return{range:dont=range};});return dont?null:state.update(changes,{scrollIntoView:true,userEvent:"input.type"});}function handleClose(state,_open,close){var dont=null,changes=state.changeByRange(function(range){if(range.empty&&nextChar(state.doc,range.head)==close)return{changes:{from:range.head,to:range.head+close.length,insert:close},range:EditorSelection.cursor(range.head+close.length)};return dont={range:range};});return dont?null:state.update(changes,{scrollIntoView:true,userEvent:"input.type"});}function handleSame(state,token,allowTriple,config2){var stringPrefixes=config2.stringPrefixes||defaults2.stringPrefixes;var dont=null,changes=state.changeByRange(function(range){if(!range.empty)return{changes:[{insert:token,from:range.from},{insert:token,from:range.to}],effects:closeBracketEffect.of(range.to+token.length),range:EditorSelection.range(range.anchor+token.length,range.head+token.length)};var pos=range.head,next=nextChar(state.doc,pos),start;if(next==token){if(nodeStart(state,pos)){return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};}else if(closedBracketAt(state,pos)){var isTriple=allowTriple&&state.sliceDoc(pos,pos+token.length*3)==token+token+token;var content2=isTriple?token+token+token:token;return{changes:{from:pos,to:pos+content2.length,insert:content2},range:EditorSelection.cursor(pos+content2.length)};}}else if(allowTriple&&state.sliceDoc(pos-2*token.length,pos)==token+token&&(start=canStartStringAt(state,pos-2*token.length,stringPrefixes))>-1&&nodeStart(state,start)){return{changes:{insert:token+token+token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};}else if(state.charCategorizer(pos)(next)!=CharCategory.Word){if(canStartStringAt(state,pos,stringPrefixes)>-1&&!probablyInString(state,pos,token,stringPrefixes))return{changes:{insert:token+token,from:pos},effects:closeBracketEffect.of(pos+token.length),range:EditorSelection.cursor(pos+token.length)};}return{range:dont=range};});return dont?null:state.update(changes,{scrollIntoView:true,userEvent:"input.type"});}function nodeStart(state,pos){var tree=_syntaxTree(state).resolveInner(pos+1);return tree.parent&&tree.from==pos;}function probablyInString(state,pos,quoteToken,prefixes){var node=_syntaxTree(state).resolveInner(pos,-1);var maxPrefix=prefixes.reduce(function(m,p){return Math.max(m,p.length);},0);for(var _i171=0;_i171<5;_i171++){var start=state.sliceDoc(node.from,Math.min(node.to,node.from+quoteToken.length+maxPrefix));var quotePos=start.indexOf(quoteToken);if(!quotePos||quotePos>-1&&prefixes.indexOf(start.slice(0,quotePos))>-1){var first=node.firstChild;while(first&&first.from==node.from&&first.to-first.from>quoteToken.length+quotePos){if(state.sliceDoc(first.to-quoteToken.length,first.to)==quoteToken)return false;first=first.firstChild;}return true;}var parent=node.to==pos&&node.parent;if(!parent)break;node=parent;}return false;}function canStartStringAt(state,pos,prefixes){var charCat=state.charCategorizer(pos);if(charCat(state.sliceDoc(pos-1,pos))!=CharCategory.Word)return pos;var _iterator234=_createForOfIteratorHelper(prefixes),_step234;try{for(_iterator234.s();!(_step234=_iterator234.n()).done;){var prefix=_step234.value;var start=pos-prefix.length;if(state.sliceDoc(start,pos)==prefix&&charCat(state.sliceDoc(start-1,start))!=CharCategory.Word)return start;}}catch(err){_iterator234.e(err);}finally{_iterator234.f();}return-1;}function _autocompletion(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[completionState,completionConfig.of(config2),completionPlugin,completionKeymapExt,baseTheme4];}var _completionKeymap=[{key:"Ctrl-Space",run:_startCompletion},{key:"Escape",run:_closeCompletion},{key:"ArrowDown",run:/* @__PURE__ */_moveCompletionSelection(true)},{key:"ArrowUp",run:/* @__PURE__ */_moveCompletionSelection(false)},{key:"PageDown",run:/* @__PURE__ */_moveCompletionSelection(true,"page")},{key:"PageUp",run:/* @__PURE__ */_moveCompletionSelection(false,"page")},{key:"Enter",run:_acceptCompletion}];var completionKeymapExt=/* @__PURE__ */Prec.highest(/* @__PURE__ */keymap.computeN([completionConfig],function(state){return state.facet(completionConfig).defaultKeymap?[_completionKeymap]:[];}));function _completionStatus(state){var cState=state.field(completionState,false);return cState&&cState.active.some(function(a){return a.state==1;})?"pending":cState&&cState.active.some(function(a){return a.state!=0;})?"active":null;}var completionArrayCache=/* @__PURE__ */new WeakMap();function _currentCompletions(state){var _a2;var open=(_a2=state.field(completionState,false))===null||_a2===void 0?void 0:_a2.open;if(!open||open.disabled)return[];var completions=completionArrayCache.get(open.options);if(!completions)completionArrayCache.set(open.options,completions=open.options.map(function(o){return o.completion;}));return completions;}function _selectedCompletion(state){var _a2;var open=(_a2=state.field(completionState,false))===null||_a2===void 0?void 0:_a2.open;return open&&!open.disabled&&open.selected>=0?open.options[open.selected].completion:null;}function _selectedCompletionIndex(state){var _a2;var open=(_a2=state.field(completionState,false))===null||_a2===void 0?void 0:_a2.open;return open&&!open.disabled&&open.selected>=0?open.selected:null;}function _setSelectedCompletion(index){return setSelectedEffect.of(index);}// ../node_modules/@codemirror/lint/dist/index.js
var dist_exports3={};__export(dist_exports3,{closeLintPanel:function closeLintPanel(){return _closeLintPanel;},diagnosticCount:function diagnosticCount(){return _diagnosticCount;},forceLinting:function forceLinting(){return _forceLinting;},lintGutter:function lintGutter(){return _lintGutter;},lintKeymap:function lintKeymap(){return _lintKeymap;},linter:function linter(){return _linter;},nextDiagnostic:function nextDiagnostic(){return _nextDiagnostic;},openLintPanel:function openLintPanel(){return _openLintPanel;},setDiagnostics:function setDiagnostics(){return _setDiagnostics;},setDiagnosticsEffect:function setDiagnosticsEffect(){return _setDiagnosticsEffect;}});var SelectedDiagnostic=/*#__PURE__*/_createClass(function SelectedDiagnostic(from,to,diagnostic){_classCallCheck(this,SelectedDiagnostic);this.from=from;this.to=to;this.diagnostic=diagnostic;});var LintState=/*#__PURE__*/function(){function LintState(diagnostics,panel,selected){_classCallCheck(this,LintState);this.diagnostics=diagnostics;this.panel=panel;this.selected=selected;}_createClass(LintState,null,[{key:"init",value:function init(diagnostics,panel,state){var markedDiagnostics=diagnostics;var diagnosticFilter=state.facet(lintConfig).markerFilter;if(diagnosticFilter)markedDiagnostics=diagnosticFilter(markedDiagnostics);var ranges=Decoration.set(markedDiagnostics.map(function(d){return d.from==d.to||d.from==d.to-1&&state.doc.lineAt(d.from).to==d.from?Decoration.widget({widget:new DiagnosticWidget(d),diagnostic:d}).range(d.from):Decoration.mark({attributes:{"class":"cm-lintRange cm-lintRange-"+d.severity},diagnostic:d}).range(d.from,d.to);}),true);return new LintState(ranges,panel,findDiagnostic(ranges));}}]);return LintState;}();function findDiagnostic(diagnostics){var diagnostic=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var after=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var found=null;diagnostics.between(after,1e9,function(from,to,_ref60){var spec=_ref60.spec;if(diagnostic&&spec.diagnostic!=diagnostic)return;found=new SelectedDiagnostic(from,to,spec.diagnostic);return false;});return found;}function hideTooltip(tr,tooltip){return!!(tr.effects.some(function(e){return e.is(_setDiagnosticsEffect);})||tr.changes.touchesRange(tooltip.pos));}function maybeEnableLint(state,effects){return state.field(lintState,false)?effects:effects.concat(StateEffect.appendConfig.of([lintState,EditorView.decorations.compute([lintState],function(state2){var _state2$field=state2.field(lintState),selected=_state2$field.selected,panel=_state2$field.panel;return!selected||!panel||selected.from==selected.to?Decoration.none:Decoration.set([activeMark.range(selected.from,selected.to)]);}),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme5]));}function _setDiagnostics(state,diagnostics){return{effects:maybeEnableLint(state,[_setDiagnosticsEffect.of(diagnostics)])};}var _setDiagnosticsEffect=/* @__PURE__ */StateEffect.define();var togglePanel2=/* @__PURE__ */StateEffect.define();var movePanelSelection=/* @__PURE__ */StateEffect.define();var lintState=/* @__PURE__ */StateField.define({create:function create(){return new LintState(Decoration.none,null,null);},update:function update(value,tr){if(tr.docChanged){var mapped=value.diagnostics.map(tr.changes),selected=null;if(value.selected){var selPos=tr.changes.mapPos(value.selected.from,1);selected=findDiagnostic(mapped,value.selected.diagnostic,selPos)||findDiagnostic(mapped,null,selPos);}value=new LintState(mapped,value.panel,selected);}var _iterator235=_createForOfIteratorHelper(tr.effects),_step235;try{for(_iterator235.s();!(_step235=_iterator235.n()).done;){var effect=_step235.value;if(effect.is(_setDiagnosticsEffect)){value=LintState.init(effect.value,value.panel,tr.state);}else if(effect.is(togglePanel2)){value=new LintState(value.diagnostics,effect.value?LintPanel.open:null,value.selected);}else if(effect.is(movePanelSelection)){value=new LintState(value.diagnostics,value.panel,effect.value);}}}catch(err){_iterator235.e(err);}finally{_iterator235.f();}return value;},provide:function provide(f){return[showPanel.from(f,function(val){return val.panel;}),EditorView.decorations.from(f,function(s){return s.diagnostics;})];}});function _diagnosticCount(state){var lint=state.field(lintState,false);return lint?lint.diagnostics.size:0;}var activeMark=/* @__PURE__ */Decoration.mark({"class":"cm-lintRange cm-lintRange-active"});function lintTooltip(view,pos,side){var _view$state$field=view.state.field(lintState),diagnostics=_view$state$field.diagnostics;var found=[],stackStart=2e8,stackEnd=0;diagnostics.between(pos-(side<0?1:0),pos+(side>0?1:0),function(from,to,_ref61){var spec=_ref61.spec;if(pos>=from&&pos<=to&&(from==to||(pos>from||side>0)&&(pos<to||side<0))){found.push(spec.diagnostic);stackStart=Math.min(from,stackStart);stackEnd=Math.max(to,stackEnd);}});var diagnosticFilter=view.state.facet(lintConfig).tooltipFilter;if(diagnosticFilter)found=diagnosticFilter(found);if(!found.length)return null;return{pos:stackStart,end:stackEnd,above:view.state.doc.lineAt(stackStart).to<stackEnd,create:function create(){return{dom:diagnosticsTooltip(view,found)};}};}function diagnosticsTooltip(view,diagnostics){return crelt("ul",{"class":"cm-tooltip-lint"},diagnostics.map(function(d){return renderDiagnostic(view,d,false);}));}var _openLintPanel=function _openLintPanel(view){var field=view.state.field(lintState,false);if(!field||!field.panel)view.dispatch({effects:maybeEnableLint(view.state,[togglePanel2.of(true)])});var panel=getPanel(view,LintPanel.open);if(panel)panel.dom.querySelector(".cm-panel-lint ul").focus();return true;};var _closeLintPanel=function _closeLintPanel(view){var field=view.state.field(lintState,false);if(!field||!field.panel)return false;view.dispatch({effects:togglePanel2.of(false)});return true;};var _nextDiagnostic=function _nextDiagnostic(view){var field=view.state.field(lintState,false);if(!field)return false;var sel=view.state.selection.main,next=field.diagnostics.iter(sel.to+1);if(!next.value){next=field.diagnostics.iter(0);if(!next.value||next.from==sel.from&&next.to==sel.to)return false;}view.dispatch({selection:{anchor:next.from,head:next.to},scrollIntoView:true});return true;};var _lintKeymap=[{key:"Mod-Shift-m",run:_openLintPanel},{key:"F8",run:_nextDiagnostic}];var lintPlugin=/* @__PURE__ */ViewPlugin.fromClass(/*#__PURE__*/function(){function _class18(view){_classCallCheck(this,_class18);this.view=view;this.timeout=-1;this.set=true;var _view$state$facet=view.state.facet(lintConfig),delay=_view$state$facet.delay;this.lintTime=Date.now()+delay;this.run=this.run.bind(this);this.timeout=setTimeout(this.run,delay);}_createClass(_class18,[{key:"run",value:function run(){var _this94=this;var now=Date.now();if(now<this.lintTime-10){setTimeout(this.run,this.lintTime-now);}else{this.set=false;var state=this.view.state,_state$facet=state.facet(lintConfig),sources=_state$facet.sources;Promise.all(sources.map(function(source){return Promise.resolve(source(_this94.view));})).then(function(annotations){var all=annotations.reduce(function(a,b){return a.concat(b);});if(_this94.view.state.doc==state.doc)_this94.view.dispatch(_setDiagnostics(_this94.view.state,all));},function(error){logException(_this94.view.state,error);});}}},{key:"update",value:function update(_update27){var config2=_update27.state.facet(lintConfig);if(_update27.docChanged||config2!=_update27.startState.facet(lintConfig)){this.lintTime=Date.now()+config2.delay;if(!this.set){this.set=true;this.timeout=setTimeout(this.run,config2.delay);}}}},{key:"force",value:function force(){if(this.set){this.lintTime=Date.now();this.run();}}},{key:"destroy",value:function destroy(){clearTimeout(this.timeout);}}]);return _class18;}());var lintConfig=/* @__PURE__ */Facet.define({combine:function combine(input){return Object.assign({sources:input.map(function(i){return i.source;})},combineConfig(input.map(function(i){return i.config;}),{delay:750,markerFilter:null,tooltipFilter:null}));},enables:lintPlugin});function _linter(source){var config2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return lintConfig.of({source:source,config:config2});}function _forceLinting(view){var plugin=view.plugin(lintPlugin);if(plugin)plugin.force();}function assignKeys(actions){var assigned=[];if(actions){var _iterator236=_createForOfIteratorHelper(actions),_step236;try{actions:for(_iterator236.s();!(_step236=_iterator236.n()).done;){var _name5=_step236.value.name;var _loop17=function _loop17(_i172){var ch=_name5[_i172];if(/[a-zA-Z]/.test(ch)&&!assigned.some(function(c){return c.toLowerCase()==ch.toLowerCase();})){assigned.push(ch);return"continue|actions";}};for(var _i172=0;_i172<_name5.length;_i172++){var _ret6=_loop17(_i172);if(_ret6==="continue|actions")continue actions;}assigned.push("");}}catch(err){_iterator236.e(err);}finally{_iterator236.f();}}return assigned;}function renderDiagnostic(view,diagnostic,inPanel){var _a2;var keys2=inPanel?assignKeys(diagnostic.actions):[];return crelt("li",{"class":"cm-diagnostic cm-diagnostic-"+diagnostic.severity},crelt("span",{"class":"cm-diagnosticText"},diagnostic.renderMessage?diagnostic.renderMessage():diagnostic.message),(_a2=diagnostic.actions)===null||_a2===void 0?void 0:_a2.map(function(action,i){var click=function click(e){e.preventDefault();var found=findDiagnostic(view.state.field(lintState).diagnostics,diagnostic);if(found)action.apply(view,found.from,found.to);};var name2=action.name,keyIndex=keys2[i]?name2.indexOf(keys2[i]):-1;var nameElt=keyIndex<0?name2:[name2.slice(0,keyIndex),crelt("u",name2.slice(keyIndex,keyIndex+1)),name2.slice(keyIndex+1)];return crelt("button",{type:"button","class":"cm-diagnosticAction",onclick:click,onmousedown:click,"aria-label":" Action: ".concat(name2).concat(keyIndex<0?"":" (access key \"".concat(keys2[i],")\""),".")},nameElt);}),diagnostic.source&&crelt("div",{"class":"cm-diagnosticSource"},diagnostic.source));}var DiagnosticWidget=/*#__PURE__*/function(_WidgetType9){_inherits(DiagnosticWidget,_WidgetType9);var _super42=_createSuper(DiagnosticWidget);function DiagnosticWidget(diagnostic){var _this95;_classCallCheck(this,DiagnosticWidget);_this95=_super42.call(this);_this95.diagnostic=diagnostic;return _this95;}_createClass(DiagnosticWidget,[{key:"eq",value:function eq(other){return other.diagnostic==this.diagnostic;}},{key:"toDOM",value:function toDOM(){return crelt("span",{"class":"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity});}}]);return DiagnosticWidget;}(WidgetType);var PanelItem=/*#__PURE__*/_createClass(function PanelItem(view,diagnostic){_classCallCheck(this,PanelItem);this.diagnostic=diagnostic;this.id="item_"+Math.floor(Math.random()*4294967295).toString(16);this.dom=renderDiagnostic(view,diagnostic,true);this.dom.id=this.id;this.dom.setAttribute("role","option");});var LintPanel=/*#__PURE__*/function(){function LintPanel(view){var _this96=this;_classCallCheck(this,LintPanel);this.view=view;this.items=[];var onkeydown=function onkeydown(event){if(event.keyCode==27){_closeLintPanel(_this96.view);_this96.view.focus();}else if(event.keyCode==38||event.keyCode==33){_this96.moveSelection((_this96.selectedIndex-1+_this96.items.length)%_this96.items.length);}else if(event.keyCode==40||event.keyCode==34){_this96.moveSelection((_this96.selectedIndex+1)%_this96.items.length);}else if(event.keyCode==36){_this96.moveSelection(0);}else if(event.keyCode==35){_this96.moveSelection(_this96.items.length-1);}else if(event.keyCode==13){_this96.view.focus();}else if(event.keyCode>=65&&event.keyCode<=90&&_this96.selectedIndex>=0){var diagnostic=_this96.items[_this96.selectedIndex].diagnostic,keys2=assignKeys(diagnostic.actions);for(var _i173=0;_i173<keys2.length;_i173++){if(keys2[_i173].toUpperCase().charCodeAt(0)==event.keyCode){var found=findDiagnostic(_this96.view.state.field(lintState).diagnostics,diagnostic);if(found)diagnostic.actions[_i173].apply(view,found.from,found.to);}}}else{return;}event.preventDefault();};var onclick=function onclick(event){for(var _i174=0;_i174<_this96.items.length;_i174++){if(_this96.items[_i174].dom.contains(event.target))_this96.moveSelection(_i174);}};this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:onkeydown,onclick:onclick});this.dom=crelt("div",{"class":"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:function onclick(){return _closeLintPanel(_this96.view);}},"\xD7"));this.update();}_createClass(LintPanel,[{key:"selectedIndex",get:function get(){var selected=this.view.state.field(lintState).selected;if(!selected)return-1;for(var _i175=0;_i175<this.items.length;_i175++){if(this.items[_i175].diagnostic==selected.diagnostic)return _i175;}return-1;}},{key:"update",value:function update(){var _this97=this;var _this$view$state$fiel=this.view.state.field(lintState),diagnostics=_this$view$state$fiel.diagnostics,selected=_this$view$state$fiel.selected;var i=0,needsSync=false,newSelectedItem=null;diagnostics.between(0,this.view.state.doc.length,function(_start,_end,_ref62){var spec=_ref62.spec;var found=-1,item;for(var j=i;j<_this97.items.length;j++){if(_this97.items[j].diagnostic==spec.diagnostic){found=j;break;}}if(found<0){item=new PanelItem(_this97.view,spec.diagnostic);_this97.items.splice(i,0,item);needsSync=true;}else{item=_this97.items[found];if(found>i){_this97.items.splice(i,found-i);needsSync=true;}}if(selected&&item.diagnostic==selected.diagnostic){if(!item.dom.hasAttribute("aria-selected")){item.dom.setAttribute("aria-selected","true");newSelectedItem=item;}}else if(item.dom.hasAttribute("aria-selected")){item.dom.removeAttribute("aria-selected");}i++;});while(i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0)){needsSync=true;this.items.pop();}if(this.items.length==0){this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")}));needsSync=true;}if(newSelectedItem){this.list.setAttribute("aria-activedescendant",newSelectedItem.id);this.view.requestMeasure({key:this,read:function read(){return{sel:newSelectedItem.dom.getBoundingClientRect(),panel:_this97.list.getBoundingClientRect()};},write:function write(_ref63){var sel=_ref63.sel,panel=_ref63.panel;if(sel.top<panel.top)_this97.list.scrollTop-=panel.top-sel.top;else if(sel.bottom>panel.bottom)_this97.list.scrollTop+=sel.bottom-panel.bottom;}});}else if(this.selectedIndex<0){this.list.removeAttribute("aria-activedescendant");}if(needsSync)this.sync();}},{key:"sync",value:function sync(){var domPos=this.list.firstChild;function rm2(){var prev=domPos;domPos=prev.nextSibling;prev.remove();}var _iterator237=_createForOfIteratorHelper(this.items),_step237;try{for(_iterator237.s();!(_step237=_iterator237.n()).done;){var item=_step237.value;if(item.dom.parentNode==this.list){while(domPos!=item.dom){rm2();}domPos=item.dom.nextSibling;}else{this.list.insertBefore(item.dom,domPos);}}}catch(err){_iterator237.e(err);}finally{_iterator237.f();}while(domPos){rm2();}}},{key:"moveSelection",value:function moveSelection(selectedIndex){if(this.selectedIndex<0)return;var field=this.view.state.field(lintState);var selection2=findDiagnostic(field.diagnostics,this.items[selectedIndex].diagnostic);if(!selection2)return;this.view.dispatch({selection:{anchor:selection2.from,head:selection2.to},scrollIntoView:true,effects:movePanelSelection.of(selection2)});}}],[{key:"open",value:function open(view){return new LintPanel(view);}}]);return LintPanel;}();function svg(content2){var attrs=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"viewBox=\"0 0 40 40\"";return"url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" ".concat(attrs,">").concat(encodeURIComponent(content2),"</svg>')");}function underline(color){return svg("<path d=\"m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0\" stroke=\"".concat(color,"\" fill=\"none\" stroke-width=\".7\"/>"),"width=\"6\" height=\"3\"");}var baseTheme5=/* @__PURE__ */EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:0.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:/* @__PURE__ */underline("#d11")},".cm-lintRange-warning":{backgroundImage:/* @__PURE__ */underline("orange")},".cm-lintRange-info":{backgroundImage:/* @__PURE__ */underline("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});var LintGutterMarker=/*#__PURE__*/function(_GutterMarker4){_inherits(LintGutterMarker,_GutterMarker4);var _super43=_createSuper(LintGutterMarker);function LintGutterMarker(diagnostics){var _this98;_classCallCheck(this,LintGutterMarker);_this98=_super43.call(this);_this98.diagnostics=diagnostics;_this98.severity=diagnostics.reduce(function(max,d){var s=d.severity;return s=="error"||s=="warning"&&max=="info"?s:max;},"info");return _this98;}_createClass(LintGutterMarker,[{key:"toDOM",value:function toDOM(view){var elt2=document.createElement("div");elt2.className="cm-lint-marker cm-lint-marker-"+this.severity;var diagnostics=this.diagnostics;var diagnosticsFilter=view.state.facet(lintGutterConfig).tooltipFilter;if(diagnosticsFilter)diagnostics=diagnosticsFilter(diagnostics);if(diagnostics.length)elt2.onmouseover=function(){return gutterMarkerMouseOver(view,elt2,diagnostics);};return elt2;}}]);return LintGutterMarker;}(GutterMarker);function trackHoverOn(view,marker){var mousemove=function mousemove(event){var rect=marker.getBoundingClientRect();if(event.clientX>rect.left-10&&event.clientX<rect.right+10&&event.clientY>rect.top-10&&event.clientY<rect.bottom+10)return;for(var target=event.target;target;target=target.parentNode){if(target.nodeType==1&&target.classList.contains("cm-tooltip-lint"))return;}window.removeEventListener("mousemove",mousemove);if(view.state.field(lintGutterTooltip))view.dispatch({effects:setLintGutterTooltip.of(null)});};window.addEventListener("mousemove",mousemove);}function gutterMarkerMouseOver(view,marker,diagnostics){function hovered(){var line=view.elementAtHeight(marker.getBoundingClientRect().top+5-view.documentTop);var linePos=view.coordsAtPos(line.from);if(linePos){view.dispatch({effects:setLintGutterTooltip.of({pos:line.from,above:false,create:function create(){return{dom:diagnosticsTooltip(view,diagnostics),getCoords:function getCoords(){return marker.getBoundingClientRect();}};}})});}marker.onmouseout=marker.onmousemove=null;trackHoverOn(view,marker);}var _view$state$facet2=view.state.facet(lintGutterConfig),hoverTime=_view$state$facet2.hoverTime;var hoverTimeout=setTimeout(hovered,hoverTime);marker.onmouseout=function(){clearTimeout(hoverTimeout);marker.onmouseout=marker.onmousemove=null;};marker.onmousemove=function(){clearTimeout(hoverTimeout);hoverTimeout=setTimeout(hovered,hoverTime);};}function markersForDiagnostics(doc2,diagnostics){var byLine=/* @__PURE__ */Object.create(null);var _iterator238=_createForOfIteratorHelper(diagnostics),_step238;try{for(_iterator238.s();!(_step238=_iterator238.n()).done;){var diagnostic=_step238.value;var _line6=doc2.lineAt(diagnostic.from);(byLine[_line6.from]||(byLine[_line6.from]=[])).push(diagnostic);}}catch(err){_iterator238.e(err);}finally{_iterator238.f();}var markers=[];for(var line in byLine){markers.push(new LintGutterMarker(byLine[line]).range(+line));}return RangeSet.of(markers,true);}var lintGutterExtension=/* @__PURE__ */gutter({"class":"cm-gutter-lint",markers:function markers(view){return view.state.field(lintGutterMarkers);}});var lintGutterMarkers=/* @__PURE__ */StateField.define({create:function create(){return RangeSet.empty;},update:function update(markers,tr){markers=markers.map(tr.changes);var diagnosticFilter=tr.state.facet(lintGutterConfig).markerFilter;var _iterator239=_createForOfIteratorHelper(tr.effects),_step239;try{for(_iterator239.s();!(_step239=_iterator239.n()).done;){var effect=_step239.value;if(effect.is(_setDiagnosticsEffect)){var diagnostics=effect.value;if(diagnosticFilter)diagnostics=diagnosticFilter(diagnostics||[]);markers=markersForDiagnostics(tr.state.doc,diagnostics.slice(0));}}}catch(err){_iterator239.e(err);}finally{_iterator239.f();}return markers;}});var setLintGutterTooltip=/* @__PURE__ */StateEffect.define();var lintGutterTooltip=/* @__PURE__ */StateField.define({create:function create(){return null;},update:function update(tooltip,tr){if(tooltip&&tr.docChanged)tooltip=hideTooltip(tr,tooltip)?null:Object.assign(Object.assign({},tooltip),{pos:tr.changes.mapPos(tooltip.pos)});return tr.effects.reduce(function(t2,e){return e.is(setLintGutterTooltip)?e.value:t2;},tooltip);},provide:function provide(field){return showTooltip.from(field);}});var lintGutterTheme=/* @__PURE__ */EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:/* @__PURE__ */svg("<path fill=\"#aaf\" stroke=\"#77e\" stroke-width=\"6\" stroke-linejoin=\"round\" d=\"M5 5L35 5L35 35L5 35Z\"/>")},".cm-lint-marker-warning":{content:/* @__PURE__ */svg("<path fill=\"#fe8\" stroke=\"#fd7\" stroke-width=\"6\" stroke-linejoin=\"round\" d=\"M20 6L37 35L3 35Z\"/>")},".cm-lint-marker-error:before":{content:/* @__PURE__ */svg("<circle cx=\"20\" cy=\"20\" r=\"15\" fill=\"#f87\" stroke=\"#f43\" stroke-width=\"6\"/>")}});var lintGutterConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){return combineConfig(configs,{hoverTime:300,markerFilter:null,tooltipFilter:null});}});function _lintGutter(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[lintGutterConfig.of(config2),lintGutterMarkers,lintGutterExtension,lintGutterTheme,lintGutterTooltip];}// ../node_modules/codemirror/dist/index.js
var basicSetup=/* @__PURE__ */function(){return[lineNumbers(),highlightActiveLineGutter(),highlightSpecialChars(),history(),_foldGutter(),drawSelection(),dropCursor(),EditorState.allowMultipleSelections.of(true),_indentOnInput(),_syntaxHighlighting(_defaultHighlightStyle,{fallback:true}),_bracketMatching(),_closeBrackets(),_autocompletion(),rectangularSelection(),crosshairCursor(),highlightActiveLine(),highlightSelectionMatches(),keymap.of([].concat(_closeBracketsKeymap,_toConsumableArray(defaultKeymap),searchKeymap,historyKeymap,_foldKeymap,_completionKeymap,_lintKeymap))];}();// ../node_modules/@codemirror/collab/dist/index.js
var LocalUpdate=/*#__PURE__*/_createClass(function LocalUpdate(origin,changes,effects,clientID){_classCallCheck(this,LocalUpdate);this.origin=origin;this.changes=changes;this.effects=effects;this.clientID=clientID;});var CollabState=/*#__PURE__*/_createClass(function CollabState(version,unconfirmed){_classCallCheck(this,CollabState);this.version=version;this.unconfirmed=unconfirmed;});var collabConfig=/* @__PURE__ */Facet.define({combine:function combine(configs){var combined=combineConfig(configs,{startVersion:0,clientID:null,sharedEffects:function sharedEffects(){return[];}},{generatedID:function generatedID(a){return a;}});if(combined.clientID==null)combined.clientID=configs.length&&configs[0].generatedID||"";return combined;}});var collabReceive=/* @__PURE__ */Annotation.define();var collabField=/* @__PURE__ */StateField.define({create:function create(state){return new CollabState(state.facet(collabConfig).startVersion,[]);},update:function update(collab2,tr){var isSync=tr.annotation(collabReceive);if(isSync)return isSync;var _tr$startState$facet=tr.startState.facet(collabConfig),sharedEffects=_tr$startState$facet.sharedEffects,clientID=_tr$startState$facet.clientID;var effects=sharedEffects(tr);if(effects.length||!tr.changes.empty)return new CollabState(collab2.version,collab2.unconfirmed.concat(new LocalUpdate(tr,tr.changes,effects,clientID)));return collab2;}});function collab(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return[collabField,collabConfig.of(Object.assign({generatedID:Math.floor(Math.random()*1e9).toString(36)},config2))];}function receiveUpdates(state,updates){var _state$field=state.field(collabField),version=_state$field.version,unconfirmed=_state$field.unconfirmed;var _state$facet2=state.facet(collabConfig),clientID=_state$facet2.clientID;version+=updates.length;var effects=[],changes=null;var own=0;var _iterator240=_createForOfIteratorHelper(updates),_step240;try{for(_iterator240.s();!(_step240=_iterator240.n()).done;){var update=_step240.value;var ours=own<unconfirmed.length?unconfirmed[own]:null;if(ours&&ours.clientID==update.clientID){if(changes)changes=changes.map(ours.changes,true);effects=StateEffect.mapEffects(effects,update.changes);own++;}else{effects=StateEffect.mapEffects(effects,update.changes);if(update.effects)effects=effects.concat(update.effects);changes=changes?changes.compose(update.changes):update.changes;}}}catch(err){_iterator240.e(err);}finally{_iterator240.f();}if(own)unconfirmed=unconfirmed.slice(own);if(unconfirmed.length){if(changes)unconfirmed=unconfirmed.map(function(update){var updateChanges=update.changes.map(changes);changes=changes.map(update.changes,true);return new LocalUpdate(update.origin,updateChanges,StateEffect.mapEffects(update.effects,changes),clientID);});if(effects.length){var composed=unconfirmed.reduce(function(ch,u){return ch.compose(u.changes);},ChangeSet.empty(unconfirmed[0].changes.length));effects=StateEffect.mapEffects(effects,composed);}}if(!changes)return state.update({annotations:[collabReceive.of(new CollabState(version,unconfirmed))]});return state.update({changes:changes,effects:effects,annotations:[Transaction.addToHistory.of(false),Transaction.remote.of(true),collabReceive.of(new CollabState(version,unconfirmed))],filter:false});}function sendableUpdates(state){return state.field(collabField).unconfirmed;}function getSyncedVersion(state){return state.field(collabField).version;}// ../node_modules/@lezer/markdown/dist/index.js
var CompositeBlock=/*#__PURE__*/function(){function CompositeBlock(type,value,from,hash2,end,children,positions){_classCallCheck(this,CompositeBlock);this.type=type;this.value=value;this.from=from;this.hash=hash2;this.end=end;this.children=children;this.positions=positions;this.hashProp=[[NodeProp.contextHash,hash2]];}_createClass(CompositeBlock,[{key:"addChild",value:function addChild(child,pos){if(child.prop(NodeProp.contextHash)!=this.hash)child=new Tree(child.type,child.children,child.positions,child.length,this.hashProp);this.children.push(child);this.positions.push(pos);}},{key:"toTree",value:function toTree(nodeSet2){var _this99=this;var end=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.end;var last=this.children.length-1;if(last>=0)end=Math.max(end,this.positions[last]+this.children[last].length+this.from);return new Tree(nodeSet2.types[this.type],this.children,this.positions,end-this.from).balance({makeTree:function makeTree(children,positions,length){return new Tree(NodeType.none,children,positions,length,_this99.hashProp);}});}}],[{key:"create",value:function create(type,value,from,parentHash,end){var hash2=parentHash+(parentHash<<8)+type+(value<<4)|0;return new CompositeBlock(type,value,from,hash2,end,[],[]);}}]);return CompositeBlock;}();var Type;(function(Type2){Type2[Type2["Document"]=1]="Document";Type2[Type2["CodeBlock"]=2]="CodeBlock";Type2[Type2["FencedCode"]=3]="FencedCode";Type2[Type2["Blockquote"]=4]="Blockquote";Type2[Type2["HorizontalRule"]=5]="HorizontalRule";Type2[Type2["BulletList"]=6]="BulletList";Type2[Type2["OrderedList"]=7]="OrderedList";Type2[Type2["ListItem"]=8]="ListItem";Type2[Type2["ATXHeading1"]=9]="ATXHeading1";Type2[Type2["ATXHeading2"]=10]="ATXHeading2";Type2[Type2["ATXHeading3"]=11]="ATXHeading3";Type2[Type2["ATXHeading4"]=12]="ATXHeading4";Type2[Type2["ATXHeading5"]=13]="ATXHeading5";Type2[Type2["ATXHeading6"]=14]="ATXHeading6";Type2[Type2["SetextHeading1"]=15]="SetextHeading1";Type2[Type2["SetextHeading2"]=16]="SetextHeading2";Type2[Type2["HTMLBlock"]=17]="HTMLBlock";Type2[Type2["LinkReference"]=18]="LinkReference";Type2[Type2["Paragraph"]=19]="Paragraph";Type2[Type2["CommentBlock"]=20]="CommentBlock";Type2[Type2["ProcessingInstructionBlock"]=21]="ProcessingInstructionBlock";Type2[Type2["Escape"]=22]="Escape";Type2[Type2["Entity"]=23]="Entity";Type2[Type2["HardBreak"]=24]="HardBreak";Type2[Type2["Emphasis"]=25]="Emphasis";Type2[Type2["StrongEmphasis"]=26]="StrongEmphasis";Type2[Type2["Link"]=27]="Link";Type2[Type2["Image"]=28]="Image";Type2[Type2["InlineCode"]=29]="InlineCode";Type2[Type2["HTMLTag"]=30]="HTMLTag";Type2[Type2["Comment"]=31]="Comment";Type2[Type2["ProcessingInstruction"]=32]="ProcessingInstruction";Type2[Type2["URL"]=33]="URL";Type2[Type2["HeaderMark"]=34]="HeaderMark";Type2[Type2["QuoteMark"]=35]="QuoteMark";Type2[Type2["ListMark"]=36]="ListMark";Type2[Type2["LinkMark"]=37]="LinkMark";Type2[Type2["EmphasisMark"]=38]="EmphasisMark";Type2[Type2["CodeMark"]=39]="CodeMark";Type2[Type2["CodeText"]=40]="CodeText";Type2[Type2["CodeInfo"]=41]="CodeInfo";Type2[Type2["LinkTitle"]=42]="LinkTitle";Type2[Type2["LinkLabel"]=43]="LinkLabel";})(Type||(Type={}));var LeafBlock=/*#__PURE__*/_createClass(function LeafBlock(start,content2){_classCallCheck(this,LeafBlock);this.start=start;this.content=content2;this.marks=[];this.parsers=[];});var Line2=/*#__PURE__*/function(){function Line2(){_classCallCheck(this,Line2);this.text="";this.baseIndent=0;this.basePos=0;this.depth=0;this.markers=[];this.pos=0;this.indent=0;this.next=-1;}_createClass(Line2,[{key:"forward",value:function forward(){if(this.basePos>this.pos)this.forwardInner();}},{key:"forwardInner",value:function forwardInner(){var newPos=this.skipSpace(this.basePos);this.indent=this.countIndent(newPos,this.pos,this.indent);this.pos=newPos;this.next=newPos==this.text.length?-1:this.text.charCodeAt(newPos);}},{key:"skipSpace",value:function skipSpace(from){return _skipSpace(this.text,from);}},{key:"reset",value:function reset(text){this.text=text;this.baseIndent=this.basePos=this.pos=this.indent=0;this.forwardInner();this.depth=1;while(this.markers.length){this.markers.pop();}}},{key:"moveBase",value:function moveBase(to){this.basePos=to;this.baseIndent=this.countIndent(to,this.pos,this.indent);}},{key:"moveBaseColumn",value:function moveBaseColumn(indent){this.baseIndent=indent;this.basePos=this.findColumn(indent);}},{key:"addMarker",value:function addMarker(elt2){this.markers.push(elt2);}},{key:"countIndent",value:function countIndent(to){var from=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var indent=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;for(var _i176=from;_i176<to;_i176++){indent+=this.text.charCodeAt(_i176)==9?4-indent%4:1;}return indent;}},{key:"findColumn",value:function findColumn(goal){var i=0;for(var indent=0;i<this.text.length&&indent<goal;i++){indent+=this.text.charCodeAt(i)==9?4-indent%4:1;}return i;}},{key:"scrub",value:function scrub(){if(!this.baseIndent)return this.text;var result="";for(var _i177=0;_i177<this.basePos;_i177++){result+=" ";}return result+this.text.slice(this.basePos);}}]);return Line2;}();function skipForList(bl,cx,line){if(line.pos==line.text.length||bl!=cx.block&&line.indent>=cx.stack[line.depth+1].value+line.baseIndent)return true;if(line.indent>=line.baseIndent+4)return false;var size=(bl.type==Type.OrderedList?isOrderedList:isBulletList)(line,cx,false);return size>0&&(bl.type!=Type.BulletList||isHorizontalRule(line,cx,false)<0)&&line.text.charCodeAt(line.pos+size-1)==bl.value;}var DefaultSkipMarkup=(_DefaultSkipMarkup={},_defineProperty(_DefaultSkipMarkup,Type.Blockquote,function(bl,cx,line){if(line.next!=62)return false;line.markers.push(_elt(Type.QuoteMark,cx.lineStart+line.pos,cx.lineStart+line.pos+1));line.moveBase(line.pos+(space(line.text.charCodeAt(line.pos+1))?2:1));bl.end=cx.lineStart+line.text.length;return true;}),_defineProperty(_DefaultSkipMarkup,Type.ListItem,function(bl,_cx,line){if(line.indent<line.baseIndent+bl.value&&line.next>-1)return false;line.moveBaseColumn(line.baseIndent+bl.value);return true;}),_defineProperty(_DefaultSkipMarkup,Type.OrderedList,skipForList),_defineProperty(_DefaultSkipMarkup,Type.BulletList,skipForList),_defineProperty(_DefaultSkipMarkup,Type.Document,function(){return true;}),_DefaultSkipMarkup);function space(ch){return ch==32||ch==9||ch==10||ch==13;}function _skipSpace(line){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;while(i<line.length&&space(line.charCodeAt(i))){i++;}return i;}function skipSpaceBack(line,i,to){while(i>to&&space(line.charCodeAt(i-1))){i--;}return i;}function isFencedCode(line){if(line.next!=96&&line.next!=126)return-1;var pos=line.pos+1;while(pos<line.text.length&&line.text.charCodeAt(pos)==line.next){pos++;}if(pos<line.pos+3)return-1;if(line.next==96){for(var _i178=pos;_i178<line.text.length;_i178++){if(line.text.charCodeAt(_i178)==96)return-1;}}return pos;}function isBlockquote(line){return line.next!=62?-1:line.text.charCodeAt(line.pos+1)==32?2:1;}function isHorizontalRule(line,cx,breaking){if(line.next!=42&&line.next!=45&&line.next!=95)return-1;var count2=1;for(var pos=line.pos+1;pos<line.text.length;pos++){var ch=line.text.charCodeAt(pos);if(ch==line.next)count2++;else if(!space(ch))return-1;}if(breaking&&line.next==45&&isSetextUnderline(line)>-1&&line.depth==cx.stack.length)return-1;return count2<3?-1:1;}function inList(cx,type){for(var _i179=cx.stack.length-1;_i179>=0;_i179--){if(cx.stack[_i179].type==type)return true;}return false;}function isBulletList(line,cx,breaking){return(line.next==45||line.next==43||line.next==42)&&(line.pos==line.text.length-1||space(line.text.charCodeAt(line.pos+1)))&&(!breaking||inList(cx,Type.BulletList)||line.skipSpace(line.pos+2)<line.text.length)?1:-1;}function isOrderedList(line,cx,breaking){var pos=line.pos,next=line.next;for(;;){if(next>=48&&next<=57)pos++;else break;if(pos==line.text.length)return-1;next=line.text.charCodeAt(pos);}if(pos==line.pos||pos>line.pos+9||next!=46&&next!=41||pos<line.text.length-1&&!space(line.text.charCodeAt(pos+1))||breaking&&!inList(cx,Type.OrderedList)&&(line.skipSpace(pos+1)==line.text.length||pos>line.pos+1||line.next!=49))return-1;return pos+1-line.pos;}function isAtxHeading(line){if(line.next!=35)return-1;var pos=line.pos+1;while(pos<line.text.length&&line.text.charCodeAt(pos)==35){pos++;}if(pos<line.text.length&&line.text.charCodeAt(pos)!=32)return-1;var size=pos-line.pos;return size>6?-1:size;}function isSetextUnderline(line){if(line.next!=45&&line.next!=61||line.indent>=line.baseIndent+4)return-1;var pos=line.pos+1;while(pos<line.text.length&&line.text.charCodeAt(pos)==line.next){pos++;}var end=pos;while(pos<line.text.length&&space(line.text.charCodeAt(pos))){pos++;}return pos==line.text.length?end:-1;}var EmptyLine=/^[ \t]*$/;var CommentEnd=/-->/;var ProcessingEnd=/\?>/;var HTMLBlockStyle=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,CommentEnd],[/^\s*<\?/,ProcessingEnd],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,EmptyLine],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,EmptyLine]];function isHTMLBlock(line,_cx,breaking){if(line.next!=60)return-1;var rest=line.text.slice(line.pos);for(var _i180=0,e=HTMLBlockStyle.length-(breaking?1:0);_i180<e;_i180++){if(HTMLBlockStyle[_i180][0].test(rest))return _i180;}return-1;}function getListIndent(line,pos){var indentAfter=line.countIndent(pos,line.pos,line.indent);var indented=line.countIndent(line.skipSpace(pos),pos,indentAfter);return indented>=indentAfter+5?indentAfter+1:indented;}function addCodeText(marks,from,to){var last=marks.length-1;if(last>=0&&marks[last].to==from&&marks[last].type==Type.CodeText)marks[last].to=to;else marks.push(_elt(Type.CodeText,from,to));}var DefaultBlockParsers={LinkReference:void 0,IndentedCode:function IndentedCode(cx,line){var base2=line.baseIndent+4;if(line.indent<base2)return false;var start=line.findColumn(base2);var from=cx.lineStart+start,to=cx.lineStart+line.text.length;var marks=[],pendingMarks=[];addCodeText(marks,from,to);while(cx.nextLine()&&line.depth>=cx.stack.length){if(line.pos==line.text.length){addCodeText(pendingMarks,cx.lineStart-1,cx.lineStart);var _iterator241=_createForOfIteratorHelper(line.markers),_step241;try{for(_iterator241.s();!(_step241=_iterator241.n()).done;){var m=_step241.value;pendingMarks.push(m);}}catch(err){_iterator241.e(err);}finally{_iterator241.f();}}else if(line.indent<base2){break;}else{if(pendingMarks.length){var _iterator242=_createForOfIteratorHelper(pendingMarks),_step242;try{for(_iterator242.s();!(_step242=_iterator242.n()).done;){var _m=_step242.value;if(_m.type==Type.CodeText)addCodeText(marks,_m.from,_m.to);else marks.push(_m);}}catch(err){_iterator242.e(err);}finally{_iterator242.f();}pendingMarks=[];}addCodeText(marks,cx.lineStart-1,cx.lineStart);var _iterator243=_createForOfIteratorHelper(line.markers),_step243;try{for(_iterator243.s();!(_step243=_iterator243.n()).done;){var _m2=_step243.value;marks.push(_m2);}}catch(err){_iterator243.e(err);}finally{_iterator243.f();}to=cx.lineStart+line.text.length;var codeStart=cx.lineStart+line.findColumn(line.baseIndent+4);if(codeStart<to)addCodeText(marks,codeStart,to);}}if(pendingMarks.length){pendingMarks=pendingMarks.filter(function(m){return m.type!=Type.CodeText;});if(pendingMarks.length)line.markers=pendingMarks.concat(line.markers);}cx.addNode(cx.buffer.writeElements(marks,-from).finish(Type.CodeBlock,to-from),from);return true;},FencedCode:function FencedCode(cx,line){var fenceEnd=isFencedCode(line);if(fenceEnd<0)return false;var from=cx.lineStart+line.pos,ch=line.next,len=fenceEnd-line.pos;var infoFrom=line.skipSpace(fenceEnd),infoTo=skipSpaceBack(line.text,line.text.length,infoFrom);var marks=[_elt(Type.CodeMark,from,from+len)];if(infoFrom<infoTo)marks.push(_elt(Type.CodeInfo,cx.lineStart+infoFrom,cx.lineStart+infoTo));for(var first=true;cx.nextLine()&&line.depth>=cx.stack.length;first=false){var _i181=line.pos;if(line.indent-line.baseIndent<4)while(_i181<line.text.length&&line.text.charCodeAt(_i181)==ch){_i181++;}if(_i181-line.pos>=len&&line.skipSpace(_i181)==line.text.length){var _iterator244=_createForOfIteratorHelper(line.markers),_step244;try{for(_iterator244.s();!(_step244=_iterator244.n()).done;){var m=_step244.value;marks.push(m);}}catch(err){_iterator244.e(err);}finally{_iterator244.f();}marks.push(_elt(Type.CodeMark,cx.lineStart+line.pos,cx.lineStart+_i181));cx.nextLine();break;}else{if(!first)addCodeText(marks,cx.lineStart-1,cx.lineStart);var _iterator245=_createForOfIteratorHelper(line.markers),_step245;try{for(_iterator245.s();!(_step245=_iterator245.n()).done;){var _m3=_step245.value;marks.push(_m3);}}catch(err){_iterator245.e(err);}finally{_iterator245.f();}var textStart=cx.lineStart+line.basePos,textEnd=cx.lineStart+line.text.length;if(textStart<textEnd)addCodeText(marks,textStart,textEnd);}}cx.addNode(cx.buffer.writeElements(marks,-from).finish(Type.FencedCode,cx.prevLineEnd()-from),from);return true;},Blockquote:function Blockquote(cx,line){var size=isBlockquote(line);if(size<0)return false;cx.startContext(Type.Blockquote,line.pos);cx.addNode(Type.QuoteMark,cx.lineStart+line.pos,cx.lineStart+line.pos+1);line.moveBase(line.pos+size);return null;},HorizontalRule:function HorizontalRule(cx,line){if(isHorizontalRule(line,cx,false)<0)return false;var from=cx.lineStart+line.pos;cx.nextLine();cx.addNode(Type.HorizontalRule,from);return true;},BulletList:function BulletList(cx,line){var size=isBulletList(line,cx,false);if(size<0)return false;if(cx.block.type!=Type.BulletList)cx.startContext(Type.BulletList,line.basePos,line.next);var newBase=getListIndent(line,line.pos+1);cx.startContext(Type.ListItem,line.basePos,newBase-line.baseIndent);cx.addNode(Type.ListMark,cx.lineStart+line.pos,cx.lineStart+line.pos+size);line.moveBaseColumn(newBase);return null;},OrderedList:function OrderedList(cx,line){var size=isOrderedList(line,cx,false);if(size<0)return false;if(cx.block.type!=Type.OrderedList)cx.startContext(Type.OrderedList,line.basePos,line.text.charCodeAt(line.pos+size-1));var newBase=getListIndent(line,line.pos+size);cx.startContext(Type.ListItem,line.basePos,newBase-line.baseIndent);cx.addNode(Type.ListMark,cx.lineStart+line.pos,cx.lineStart+line.pos+size);line.moveBaseColumn(newBase);return null;},ATXHeading:function ATXHeading(cx,line){var size=isAtxHeading(line);if(size<0)return false;var off=line.pos,from=cx.lineStart+off;var endOfSpace=skipSpaceBack(line.text,line.text.length,off),after=endOfSpace;while(after>off&&line.text.charCodeAt(after-1)==line.next){after--;}if(after==endOfSpace||after==off||!space(line.text.charCodeAt(after-1)))after=line.text.length;var buf=cx.buffer.write(Type.HeaderMark,0,size).writeElements(cx.parser.parseInline(line.text.slice(off+size+1,after),from+size+1),-from);if(after<line.text.length)buf.write(Type.HeaderMark,after-off,endOfSpace-off);var node=buf.finish(Type.ATXHeading1-1+size,line.text.length-off);cx.nextLine();cx.addNode(node,from);return true;},HTMLBlock:function HTMLBlock(cx,line){var type=isHTMLBlock(line,cx,false);if(type<0)return false;var from=cx.lineStart+line.pos,end=HTMLBlockStyle[type][1];var marks=[],trailing=end!=EmptyLine;while(!end.test(line.text)&&cx.nextLine()){if(line.depth<cx.stack.length){trailing=false;break;}var _iterator246=_createForOfIteratorHelper(line.markers),_step246;try{for(_iterator246.s();!(_step246=_iterator246.n()).done;){var m=_step246.value;marks.push(m);}}catch(err){_iterator246.e(err);}finally{_iterator246.f();}}if(trailing)cx.nextLine();var nodeType=end==CommentEnd?Type.CommentBlock:end==ProcessingEnd?Type.ProcessingInstructionBlock:Type.HTMLBlock;var to=cx.prevLineEnd();cx.addNode(cx.buffer.writeElements(marks,-from).finish(nodeType,to-from),from);return true;},SetextHeading:void 0};var LinkReferenceParser=/*#__PURE__*/function(){function LinkReferenceParser(leaf){_classCallCheck(this,LinkReferenceParser);this.stage=0;this.elts=[];this.pos=0;this.start=leaf.start;this.advance(leaf.content);}_createClass(LinkReferenceParser,[{key:"nextLine",value:function nextLine(cx,line,leaf){if(this.stage==-1)return false;var content2=leaf.content+"\n"+line.scrub();var finish=this.advance(content2);if(finish>-1&&finish<content2.length)return this.complete(cx,leaf,finish);return false;}},{key:"finish",value:function finish(cx,leaf){if((this.stage==2||this.stage==3)&&_skipSpace(leaf.content,this.pos)==leaf.content.length)return this.complete(cx,leaf,leaf.content.length);return false;}},{key:"complete",value:function complete(cx,leaf,len){cx.addLeafElement(leaf,_elt(Type.LinkReference,this.start,this.start+len,this.elts));return true;}},{key:"nextStage",value:function nextStage(elt2){if(elt2){this.pos=elt2.to-this.start;this.elts.push(elt2);this.stage++;return true;}if(elt2===false)this.stage=-1;return false;}},{key:"advance",value:function advance(content2){for(;;){if(this.stage==-1){return-1;}else if(this.stage==0){if(!this.nextStage(parseLinkLabel(content2,this.pos,this.start,true)))return-1;if(content2.charCodeAt(this.pos)!=58)return this.stage=-1;this.elts.push(_elt(Type.LinkMark,this.pos+this.start,this.pos+this.start+1));this.pos++;}else if(this.stage==1){if(!this.nextStage(parseURL(content2,_skipSpace(content2,this.pos),this.start)))return-1;}else if(this.stage==2){var skip=_skipSpace(content2,this.pos),end=0;if(skip>this.pos){var title=parseLinkTitle(content2,skip,this.start);if(title){var titleEnd=lineEnd(content2,title.to-this.start);if(titleEnd>0){this.nextStage(title);end=titleEnd;}}}if(!end)end=lineEnd(content2,this.pos);return end>0&&end<content2.length?end:-1;}else{return lineEnd(content2,this.pos);}}}}]);return LinkReferenceParser;}();function lineEnd(text,pos){for(;pos<text.length;pos++){var next=text.charCodeAt(pos);if(next==10)break;if(!space(next))return-1;}return pos;}var SetextHeadingParser=/*#__PURE__*/function(){function SetextHeadingParser(){_classCallCheck(this,SetextHeadingParser);}_createClass(SetextHeadingParser,[{key:"nextLine",value:function nextLine(cx,line,leaf){var underline2=line.depth<cx.stack.length?-1:isSetextUnderline(line);var next=line.next;if(underline2<0)return false;var underlineMark=_elt(Type.HeaderMark,cx.lineStart+line.pos,cx.lineStart+underline2);cx.nextLine();cx.addLeafElement(leaf,_elt(next==61?Type.SetextHeading1:Type.SetextHeading2,leaf.start,cx.prevLineEnd(),[].concat(_toConsumableArray(cx.parser.parseInline(leaf.content,leaf.start)),[underlineMark])));return true;}},{key:"finish",value:function finish(){return false;}}]);return SetextHeadingParser;}();var DefaultLeafBlocks={LinkReference:function LinkReference(_,leaf){return leaf.content.charCodeAt(0)==91?new LinkReferenceParser(leaf):null;},SetextHeading:function SetextHeading(){return new SetextHeadingParser();}};var DefaultEndLeaf=[function(_,line){return isAtxHeading(line)>=0;},function(_,line){return isFencedCode(line)>=0;},function(_,line){return isBlockquote(line)>=0;},function(p,line){return isBulletList(line,p,true)>=0;},function(p,line){return isOrderedList(line,p,true)>=0;},function(p,line){return isHorizontalRule(line,p,true)>=0;},function(p,line){return isHTMLBlock(line,p,true)>=0;}];var scanLineResult={text:"",end:0};var BlockContext=/*#__PURE__*/function(){function BlockContext(parser5,input,fragments,ranges){_classCallCheck(this,BlockContext);this.parser=parser5;this.input=input;this.ranges=ranges;this.line=new Line2();this.atEnd=false;this.reusePlaceholders=/* @__PURE__ */new Map();this.stoppedAt=null;this.rangeI=0;this.to=ranges[ranges.length-1].to;this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=ranges[0].from;this.block=CompositeBlock.create(Type.Document,0,this.lineStart,0,0);this.stack=[this.block];this.fragments=fragments.length?new FragmentCursor2(fragments,input):null;this.readLine();}_createClass(BlockContext,[{key:"parsedPos",get:function get(){return this.absoluteLineStart;}},{key:"advance",value:function advance(){if(this.stoppedAt!=null&&this.absoluteLineStart>this.stoppedAt)return this.finish();var line=this.line;for(;;){while(line.depth<this.stack.length){this.finishContext();}var _iterator247=_createForOfIteratorHelper(line.markers),_step247;try{for(_iterator247.s();!(_step247=_iterator247.n()).done;){var mark=_step247.value;this.addNode(mark.type,mark.from,mark.to);}}catch(err){_iterator247.e(err);}finally{_iterator247.f();}if(line.pos<line.text.length)break;if(!this.nextLine())return this.finish();}if(this.fragments&&this.reuseFragment(line.basePos))return null;start:for(;;){var _iterator248=_createForOfIteratorHelper(this.parser.blockParsers),_step248;try{for(_iterator248.s();!(_step248=_iterator248.n()).done;){var type=_step248.value;if(type){var result=type(this,line);if(result!=false){if(result==true)return null;line.forward();continue start;}}}}catch(err){_iterator248.e(err);}finally{_iterator248.f();}break;}var leaf=new LeafBlock(this.lineStart+line.pos,line.text.slice(line.pos));var _iterator249=_createForOfIteratorHelper(this.parser.leafBlockParsers),_step249;try{for(_iterator249.s();!(_step249=_iterator249.n()).done;){var parse=_step249.value;if(parse){var _parser=parse(this,leaf);if(_parser)leaf.parsers.push(_parser);}}}catch(err){_iterator249.e(err);}finally{_iterator249.f();}lines:while(this.nextLine()){if(line.pos==line.text.length)break;if(line.indent<line.baseIndent+4){var _iterator250=_createForOfIteratorHelper(this.parser.endLeafBlock),_step250;try{for(_iterator250.s();!(_step250=_iterator250.n()).done;){var stop=_step250.value;if(stop(this,line,leaf))break lines;}}catch(err){_iterator250.e(err);}finally{_iterator250.f();}}var _iterator251=_createForOfIteratorHelper(leaf.parsers),_step251;try{for(_iterator251.s();!(_step251=_iterator251.n()).done;){var parser5=_step251.value;if(parser5.nextLine(this,line,leaf))return null;}}catch(err){_iterator251.e(err);}finally{_iterator251.f();}leaf.content+="\n"+line.scrub();var _iterator252=_createForOfIteratorHelper(line.markers),_step252;try{for(_iterator252.s();!(_step252=_iterator252.n()).done;){var m=_step252.value;leaf.marks.push(m);}}catch(err){_iterator252.e(err);}finally{_iterator252.f();}}this.finishLeaf(leaf);return null;}},{key:"stopAt",value:function stopAt(pos){if(this.stoppedAt!=null&&this.stoppedAt<pos)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=pos;}},{key:"reuseFragment",value:function reuseFragment(start){if(!this.fragments.moveTo(this.absoluteLineStart+start,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return false;var taken=this.fragments.takeNodes(this);if(!taken)return false;this.absoluteLineStart+=taken;this.lineStart=toRelative(this.absoluteLineStart,this.ranges);this.moveRangeI();if(this.absoluteLineStart<this.to){this.lineStart++;this.absoluteLineStart++;this.readLine();}else{this.atEnd=true;this.readLine();}return true;}},{key:"depth",get:function get(){return this.stack.length;}},{key:"parentType",value:function parentType(){var depth=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.depth-1;return this.parser.nodeSet.types[this.stack[depth].type];}},{key:"nextLine",value:function nextLine(){this.lineStart+=this.line.text.length;if(this.absoluteLineEnd>=this.to){this.absoluteLineStart=this.absoluteLineEnd;this.atEnd=true;this.readLine();return false;}else{this.lineStart++;this.absoluteLineStart=this.absoluteLineEnd+1;this.moveRangeI();this.readLine();return true;}}},{key:"moveRangeI",value:function moveRangeI(){while(this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to){this.rangeI++;this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from);}}},{key:"scanLine",value:function scanLine(start){var r=scanLineResult;r.end=start;if(start>=this.to){r.text="";}else{r.text=this.lineChunkAt(start);r.end+=r.text.length;if(this.ranges.length>1){var textOffset=this.absoluteLineStart,rangeI=this.rangeI;while(this.ranges[rangeI].to<r.end){rangeI++;var nextFrom=this.ranges[rangeI].from;var after=this.lineChunkAt(nextFrom);r.end=nextFrom+after.length;r.text=r.text.slice(0,this.ranges[rangeI-1].to-textOffset)+after;textOffset=r.end-r.text.length;}}}return r;}},{key:"readLine",value:function readLine(){var line=this.line,_this$scanLine=this.scanLine(this.absoluteLineStart),text=_this$scanLine.text,end=_this$scanLine.end;this.absoluteLineEnd=end;line.reset(text);for(;line.depth<this.stack.length;line.depth++){var cx=this.stack[line.depth],handler=this.parser.skipContextMarkup[cx.type];if(!handler)throw new Error("Unhandled block context "+Type[cx.type]);if(!handler(cx,this,line))break;line.forward();}}},{key:"lineChunkAt",value:function lineChunkAt(pos){var next=this.input.chunk(pos),text;if(!this.input.lineChunks){var eol=next.indexOf("\n");text=eol<0?next:next.slice(0,eol);}else{text=next=="\n"?"":next;}return pos+text.length>this.to?text.slice(0,this.to-pos):text;}},{key:"prevLineEnd",value:function prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1;}},{key:"startContext",value:function startContext(type,start){var value=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;this.block=CompositeBlock.create(type,value,this.lineStart+start,this.block.hash,this.lineStart+this.line.text.length);this.stack.push(this.block);}},{key:"startComposite",value:function startComposite(type,start){var value=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;this.startContext(this.parser.getNodeType(type),start,value);}},{key:"addNode",value:function addNode(block,from,to){if(typeof block=="number")block=new Tree(this.parser.nodeSet.types[block],none4,none4,(to!==null&&to!==void 0?to:this.prevLineEnd())-from);this.block.addChild(block,from-this.block.from);}},{key:"addElement",value:function addElement(elt2){this.block.addChild(elt2.toTree(this.parser.nodeSet),elt2.from-this.block.from);}},{key:"addLeafElement",value:function addLeafElement(leaf,elt2){this.addNode(this.buffer.writeElements(injectMarks(elt2.children,leaf.marks),-elt2.from).finish(elt2.type,elt2.to-elt2.from),elt2.from);}},{key:"finishContext",value:function finishContext(){var cx=this.stack.pop();var top2=this.stack[this.stack.length-1];top2.addChild(cx.toTree(this.parser.nodeSet),cx.from-top2.from);this.block=top2;}},{key:"finish",value:function finish(){while(this.stack.length>1){this.finishContext();}return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart));}},{key:"addGaps",value:function addGaps(tree){return this.ranges.length>1?injectGaps(this.ranges,0,tree.topNode,this.ranges[0].from,this.reusePlaceholders):tree;}},{key:"finishLeaf",value:function finishLeaf(leaf){var _iterator253=_createForOfIteratorHelper(leaf.parsers),_step253;try{for(_iterator253.s();!(_step253=_iterator253.n()).done;){var parser5=_step253.value;if(parser5.finish(this,leaf))return;}}catch(err){_iterator253.e(err);}finally{_iterator253.f();}var inline=injectMarks(this.parser.parseInline(leaf.content,leaf.start),leaf.marks);this.addNode(this.buffer.writeElements(inline,-leaf.start).finish(Type.Paragraph,leaf.content.length),leaf.start);}},{key:"elt",value:function elt(type,from,to,children){if(typeof type=="string")return _elt(this.parser.getNodeType(type),from,to,children);return new TreeElement(type,from);}},{key:"buffer",get:function get(){return new Buffer2(this.parser.nodeSet);}}]);return BlockContext;}();function injectGaps(ranges,rangeI,tree,offset,dummies){var rangeEnd2=ranges[rangeI].to;var children=[],positions=[],start=tree.from+offset;function movePastNext(upto,inclusive){while(inclusive?upto>=rangeEnd2:upto>rangeEnd2){var size=ranges[rangeI+1].from-rangeEnd2;offset+=size;upto+=size;rangeI++;rangeEnd2=ranges[rangeI].to;}}for(var ch=tree.firstChild;ch;ch=ch.nextSibling){movePastNext(ch.from+offset,true);var from=ch.from+offset,node=void 0,reuse=dummies.get(ch.tree);if(reuse){node=reuse;}else if(ch.to+offset>rangeEnd2){node=injectGaps(ranges,rangeI,ch,offset,dummies);movePastNext(ch.to+offset,false);}else{node=ch.toTree();}children.push(node);positions.push(from-start);}movePastNext(tree.to+offset,false);return new Tree(tree.type,children,positions,tree.to+offset-start,tree.tree?tree.tree.propValues:void 0);}var MarkdownParser=/*#__PURE__*/function(_Parser3){_inherits(MarkdownParser,_Parser3);var _super44=_createSuper(MarkdownParser);function MarkdownParser(nodeSet2,blockParsers,leafBlockParsers,blockNames,endLeafBlock,skipContextMarkup,inlineParsers,inlineNames,wrappers){var _this100;_classCallCheck(this,MarkdownParser);_this100=_super44.call(this);_this100.nodeSet=nodeSet2;_this100.blockParsers=blockParsers;_this100.leafBlockParsers=leafBlockParsers;_this100.blockNames=blockNames;_this100.endLeafBlock=endLeafBlock;_this100.skipContextMarkup=skipContextMarkup;_this100.inlineParsers=inlineParsers;_this100.inlineNames=inlineNames;_this100.wrappers=wrappers;_this100.nodeTypes=/* @__PURE__ */Object.create(null);var _iterator254=_createForOfIteratorHelper(nodeSet2.types),_step254;try{for(_iterator254.s();!(_step254=_iterator254.n()).done;){var t2=_step254.value;_this100.nodeTypes[t2.name]=t2.id;}}catch(err){_iterator254.e(err);}finally{_iterator254.f();}return _this100;}_createClass(MarkdownParser,[{key:"createParse",value:function createParse(input,fragments,ranges){var parse=new BlockContext(this,input,fragments,ranges);var _iterator255=_createForOfIteratorHelper(this.wrappers),_step255;try{for(_iterator255.s();!(_step255=_iterator255.n()).done;){var w=_step255.value;parse=w(parse,input,fragments,ranges);}}catch(err){_iterator255.e(err);}finally{_iterator255.f();}return parse;}},{key:"configure",value:function configure(spec){var _nodeSet;var config2=resolveConfig(spec);if(!config2)return this;var nodeSet2=this.nodeSet,skipContextMarkup=this.skipContextMarkup;var blockParsers=this.blockParsers.slice(),leafBlockParsers=this.leafBlockParsers.slice(),blockNames=this.blockNames.slice(),inlineParsers=this.inlineParsers.slice(),inlineNames=this.inlineNames.slice(),endLeafBlock=this.endLeafBlock.slice(),wrappers=this.wrappers;if(nonEmpty(config2.defineNodes)){skipContextMarkup=Object.assign({},skipContextMarkup);var nodeTypes2=nodeSet2.types.slice(),styles;var _iterator256=_createForOfIteratorHelper(config2.defineNodes),_step256;try{var _loop18=function _loop18(){var s=_step256.value;var _ref64=typeof s=="string"?{name:s}:s,name2=_ref64.name,block=_ref64.block,composite=_ref64.composite,style=_ref64.style;if(nodeTypes2.some(function(t2){return t2.name==name2;}))return"continue";if(composite)skipContextMarkup[nodeTypes2.length]=function(bl,cx,line){return composite(cx,line,bl.value);};var id2=nodeTypes2.length;var group=composite?["Block","BlockContext"]:!block?void 0:id2>=Type.ATXHeading1&&id2<=Type.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"];nodeTypes2.push(NodeType.define({id:id2,name:name2,props:group&&[[NodeProp.group,group]]}));if(style){if(!styles)styles={};if(Array.isArray(style)||style instanceof Tag)styles[name2]=style;else Object.assign(styles,style);}};for(_iterator256.s();!(_step256=_iterator256.n()).done;){var _ret7=_loop18();if(_ret7==="continue")continue;}}catch(err){_iterator256.e(err);}finally{_iterator256.f();}nodeSet2=new NodeSet(nodeTypes2);if(styles)nodeSet2=nodeSet2.extend(styleTags(styles));}if(nonEmpty(config2.props))nodeSet2=(_nodeSet=nodeSet2).extend.apply(_nodeSet,_toConsumableArray(config2.props));if(nonEmpty(config2.remove)){var _iterator257=_createForOfIteratorHelper(config2.remove),_step257;try{for(_iterator257.s();!(_step257=_iterator257.n()).done;){var rm2=_step257.value;var block=this.blockNames.indexOf(rm2),inline=this.inlineNames.indexOf(rm2);if(block>-1)blockParsers[block]=leafBlockParsers[block]=void 0;if(inline>-1)inlineParsers[inline]=void 0;}}catch(err){_iterator257.e(err);}finally{_iterator257.f();}}if(nonEmpty(config2.parseBlock)){var _iterator258=_createForOfIteratorHelper(config2.parseBlock),_step258;try{for(_iterator258.s();!(_step258=_iterator258.n()).done;){var spec2=_step258.value;var found=blockNames.indexOf(spec2.name);if(found>-1){blockParsers[found]=spec2.parse;leafBlockParsers[found]=spec2.leaf;}else{var pos=spec2.before?findName(blockNames,spec2.before):spec2.after?findName(blockNames,spec2.after)+1:blockNames.length-1;blockParsers.splice(pos,0,spec2.parse);leafBlockParsers.splice(pos,0,spec2.leaf);blockNames.splice(pos,0,spec2.name);}if(spec2.endLeaf)endLeafBlock.push(spec2.endLeaf);}}catch(err){_iterator258.e(err);}finally{_iterator258.f();}}if(nonEmpty(config2.parseInline)){var _iterator259=_createForOfIteratorHelper(config2.parseInline),_step259;try{for(_iterator259.s();!(_step259=_iterator259.n()).done;){var _spec=_step259.value;var _found=inlineNames.indexOf(_spec.name);if(_found>-1){inlineParsers[_found]=_spec.parse;}else{var _pos3=_spec.before?findName(inlineNames,_spec.before):_spec.after?findName(inlineNames,_spec.after)+1:inlineNames.length-1;inlineParsers.splice(_pos3,0,_spec.parse);inlineNames.splice(_pos3,0,_spec.name);}}}catch(err){_iterator259.e(err);}finally{_iterator259.f();}}if(config2.wrap)wrappers=wrappers.concat(config2.wrap);return new MarkdownParser(nodeSet2,blockParsers,leafBlockParsers,blockNames,endLeafBlock,skipContextMarkup,inlineParsers,inlineNames,wrappers);}},{key:"getNodeType",value:function getNodeType(name2){var found=this.nodeTypes[name2];if(found==null)throw new RangeError("Unknown node type '".concat(name2,"'"));return found;}},{key:"parseInline",value:function parseInline(text,offset){var cx=new InlineContext(this,text,offset);outer:for(var pos=offset;pos<cx.end;){var next=cx["char"](pos);var _iterator260=_createForOfIteratorHelper(this.inlineParsers),_step260;try{for(_iterator260.s();!(_step260=_iterator260.n()).done;){var token=_step260.value;if(token){var result=token(cx,next,pos);if(result>=0){pos=result;continue outer;}}}}catch(err){_iterator260.e(err);}finally{_iterator260.f();}pos++;}return cx.resolveMarkers(0);}}]);return MarkdownParser;}(Parser);function nonEmpty(a){return a!=null&&a.length>0;}function resolveConfig(spec){if(!Array.isArray(spec))return spec;if(spec.length==0)return null;var conf=resolveConfig(spec[0]);if(spec.length==1)return conf;var rest=resolveConfig(spec.slice(1));if(!rest||!conf)return conf||rest;var conc2=function conc2(a,b){return(a||none4).concat(b||none4);};var wrapA=conf.wrap,wrapB=rest.wrap;return{props:conc2(conf.props,rest.props),defineNodes:conc2(conf.defineNodes,rest.defineNodes),parseBlock:conc2(conf.parseBlock,rest.parseBlock),parseInline:conc2(conf.parseInline,rest.parseInline),remove:conc2(conf.remove,rest.remove),wrap:!wrapA?wrapB:!wrapB?wrapA:function(inner,input,fragments,ranges){return wrapA(wrapB(inner,input,fragments,ranges),input,fragments,ranges);}};}function findName(names,name2){var found=names.indexOf(name2);if(found<0)throw new RangeError("Position specified relative to unknown parser ".concat(name2));return found;}var nodeTypes=[NodeType.none];for(var _i182=1,_name6;_name6=Type[_i182];_i182++){nodeTypes[_i182]=NodeType.define({id:_i182,name:_name6,props:_i182>=Type.Escape?[]:[[NodeProp.group,_i182 in DefaultSkipMarkup?["Block","BlockContext"]:["Block","LeafBlock"]]],top:_name6=="Document"});}var none4=[];var Buffer2=/*#__PURE__*/function(){function Buffer2(nodeSet2){_classCallCheck(this,Buffer2);this.nodeSet=nodeSet2;this.content=[];this.nodes=[];}_createClass(Buffer2,[{key:"write",value:function write(type,from,to){var children=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;this.content.push(type,from,to,4+children*4);return this;}},{key:"writeElements",value:function writeElements(elts){var offset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var _iterator261=_createForOfIteratorHelper(elts),_step261;try{for(_iterator261.s();!(_step261=_iterator261.n()).done;){var e=_step261.value;e.writeTo(this,offset);}}catch(err){_iterator261.e(err);}finally{_iterator261.f();}return this;}},{key:"finish",value:function finish(type,length){return Tree.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:type,length:length});}}]);return Buffer2;}();var Element=/*#__PURE__*/function(){function Element(type,from,to){var children=arguments.length>3&&arguments[3]!==undefined?arguments[3]:none4;_classCallCheck(this,Element);this.type=type;this.from=from;this.to=to;this.children=children;}_createClass(Element,[{key:"writeTo",value:function writeTo(buf,offset){var startOff=buf.content.length;buf.writeElements(this.children,offset);buf.content.push(this.type,this.from+offset,this.to+offset,buf.content.length+4-startOff);}},{key:"toTree",value:function toTree(nodeSet2){return new Buffer2(nodeSet2).writeElements(this.children,-this.from).finish(this.type,this.to-this.from);}}]);return Element;}();var TreeElement=/*#__PURE__*/function(){function TreeElement(tree,from){_classCallCheck(this,TreeElement);this.tree=tree;this.from=from;}_createClass(TreeElement,[{key:"to",get:function get(){return this.from+this.tree.length;}},{key:"type",get:function get(){return this.tree.type.id;}},{key:"children",get:function get(){return none4;}},{key:"writeTo",value:function writeTo(buf,offset){buf.nodes.push(this.tree);buf.content.push(buf.nodes.length-1,this.from+offset,this.to+offset,-1);}},{key:"toTree",value:function toTree(){return this.tree;}}]);return TreeElement;}();function _elt(type,from,to,children){return new Element(type,from,to,children);}var EmphasisUnderscore={resolve:"Emphasis",mark:"EmphasisMark"};var EmphasisAsterisk={resolve:"Emphasis",mark:"EmphasisMark"};var LinkStart={};var ImageStart={};var InlineDelimiter=/*#__PURE__*/_createClass(function InlineDelimiter(type,from,to,side){_classCallCheck(this,InlineDelimiter);this.type=type;this.from=from;this.to=to;this.side=side;});var Escapable="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";var Punctuation=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Punctuation=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u");}catch(_){}var DefaultInline={Escape:function Escape(cx,next,start){if(next!=92||start==cx.end-1)return-1;var escaped=cx["char"](start+1);for(var _i183=0;_i183<Escapable.length;_i183++){if(Escapable.charCodeAt(_i183)==escaped)return cx.append(_elt(Type.Escape,start,start+2));}return-1;},Entity:function Entity(cx,next,start){if(next!=38)return-1;var m=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(cx.slice(start+1,start+31));return m?cx.append(_elt(Type.Entity,start,start+1+m[0].length)):-1;},InlineCode:function InlineCode(cx,next,start){if(next!=96||start&&cx["char"](start-1)==96)return-1;var pos=start+1;while(pos<cx.end&&cx["char"](pos)==96){pos++;}var size=pos-start,curSize=0;for(;pos<cx.end;pos++){if(cx["char"](pos)==96){curSize++;if(curSize==size&&cx["char"](pos+1)!=96)return cx.append(_elt(Type.InlineCode,start,pos+1,[_elt(Type.CodeMark,start,start+size),_elt(Type.CodeMark,pos+1-size,pos+1)]));}else{curSize=0;}}return-1;},HTMLTag:function HTMLTag(cx,next,start){if(next!=60||start==cx.end-1)return-1;var after=cx.slice(start+1,cx.end);var url=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(after);if(url)return cx.append(_elt(Type.URL,start,start+1+url[0].length));var comment2=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(after);if(comment2)return cx.append(_elt(Type.Comment,start,start+1+comment2[0].length));var procInst=/^\?[^]*?\?>/.exec(after);if(procInst)return cx.append(_elt(Type.ProcessingInstruction,start,start+1+procInst[0].length));var m=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(after);if(!m)return-1;return cx.append(_elt(Type.HTMLTag,start,start+1+m[0].length));},Emphasis:function Emphasis(cx,next,start){if(next!=95&&next!=42)return-1;var pos=start+1;while(cx["char"](pos)==next){pos++;}var before=cx.slice(start-1,start),after=cx.slice(pos,pos+1);var pBefore=Punctuation.test(before),pAfter=Punctuation.test(after);var sBefore=/\s|^$/.test(before),sAfter=/\s|^$/.test(after);var leftFlanking=!sAfter&&(!pAfter||sBefore||pBefore);var rightFlanking=!sBefore&&(!pBefore||sAfter||pAfter);var canOpen=leftFlanking&&(next==42||!rightFlanking||pBefore);var canClose=rightFlanking&&(next==42||!leftFlanking||pAfter);return cx.append(new InlineDelimiter(next==95?EmphasisUnderscore:EmphasisAsterisk,start,pos,(canOpen?1:0)|(canClose?2:0)));},HardBreak:function HardBreak(cx,next,start){if(next==92&&cx["char"](start+1)==10)return cx.append(_elt(Type.HardBreak,start,start+2));if(next==32){var pos=start+1;while(cx["char"](pos)==32){pos++;}if(cx["char"](pos)==10&&pos>=start+2)return cx.append(_elt(Type.HardBreak,start,pos+1));}return-1;},Link:function Link(cx,next,start){return next==91?cx.append(new InlineDelimiter(LinkStart,start,start+1,1)):-1;},Image:function Image(cx,next,start){return next==33&&cx["char"](start+1)==91?cx.append(new InlineDelimiter(ImageStart,start,start+2,1)):-1;},LinkEnd:function LinkEnd(cx,next,start){if(next!=93)return-1;for(var _i184=cx.parts.length-1;_i184>=0;_i184--){var part=cx.parts[_i184];if(part instanceof InlineDelimiter&&(part.type==LinkStart||part.type==ImageStart)){if(!part.side||cx.skipSpace(part.to)==start&&!/[(\[]/.test(cx.slice(start+1,start+2))){cx.parts[_i184]=null;return-1;}var content2=cx.takeContent(_i184);var link=cx.parts[_i184]=finishLink(cx,content2,part.type==LinkStart?Type.Link:Type.Image,part.from,start+1);if(part.type==LinkStart)for(var j=0;j<_i184;j++){var _p8=cx.parts[j];if(_p8 instanceof InlineDelimiter&&_p8.type==LinkStart)_p8.side=0;}return link.to;}}return-1;}};function finishLink(cx,content2,type,start,startPos){var text=cx.text,next=cx["char"](startPos),endPos=startPos;content2.unshift(_elt(Type.LinkMark,start,start+(type==Type.Image?2:1)));content2.push(_elt(Type.LinkMark,startPos-1,startPos));if(next==40){var pos=cx.skipSpace(startPos+1);var dest=parseURL(text,pos-cx.offset,cx.offset),title;if(dest){pos=cx.skipSpace(dest.to);title=parseLinkTitle(text,pos-cx.offset,cx.offset);if(title)pos=cx.skipSpace(title.to);}if(cx["char"](pos)==41){content2.push(_elt(Type.LinkMark,startPos,startPos+1));endPos=pos+1;if(dest)content2.push(dest);if(title)content2.push(title);content2.push(_elt(Type.LinkMark,pos,endPos));}}else if(next==91){var label=parseLinkLabel(text,startPos-cx.offset,cx.offset,false);if(label){content2.push(label);endPos=label.to;}}return _elt(type,start,endPos,content2);}function parseURL(text,start,offset){var next=text.charCodeAt(start);if(next==60){for(var pos=start+1;pos<text.length;pos++){var ch=text.charCodeAt(pos);if(ch==62)return _elt(Type.URL,start+offset,pos+1+offset);if(ch==60||ch==10)return false;}return null;}else{var depth=0,_pos4=start;for(var escaped=false;_pos4<text.length;_pos4++){var _ch2=text.charCodeAt(_pos4);if(space(_ch2)){break;}else if(escaped){escaped=false;}else if(_ch2==40){depth++;}else if(_ch2==41){if(!depth)break;depth--;}else if(_ch2==92){escaped=true;}}return _pos4>start?_elt(Type.URL,start+offset,_pos4+offset):_pos4==text.length?null:false;}}function parseLinkTitle(text,start,offset){var next=text.charCodeAt(start);if(next!=39&&next!=34&&next!=40)return false;var end=next==40?41:next;for(var pos=start+1,escaped=false;pos<text.length;pos++){var ch=text.charCodeAt(pos);if(escaped)escaped=false;else if(ch==end)return _elt(Type.LinkTitle,start+offset,pos+1+offset);else if(ch==92)escaped=true;}return null;}function parseLinkLabel(text,start,offset,requireNonWS){for(var escaped=false,pos=start+1,end=Math.min(text.length,pos+999);pos<end;pos++){var ch=text.charCodeAt(pos);if(escaped)escaped=false;else if(ch==93)return requireNonWS?false:_elt(Type.LinkLabel,start+offset,pos+1+offset);else{if(requireNonWS&&!space(ch))requireNonWS=false;if(ch==91)return false;else if(ch==92)escaped=true;}}return null;}var InlineContext=/*#__PURE__*/function(){function InlineContext(parser5,text,offset){_classCallCheck(this,InlineContext);this.parser=parser5;this.text=text;this.offset=offset;this.parts=[];}_createClass(InlineContext,[{key:"char",value:function char(pos){return pos>=this.end?-1:this.text.charCodeAt(pos-this.offset);}},{key:"end",get:function get(){return this.offset+this.text.length;}},{key:"slice",value:function slice(from,to){return this.text.slice(from-this.offset,to-this.offset);}},{key:"append",value:function append(elt2){this.parts.push(elt2);return elt2.to;}},{key:"addDelimiter",value:function addDelimiter(type,from,to,open,close){return this.append(new InlineDelimiter(type,from,to,(open?1:0)|(close?2:0)));}},{key:"addElement",value:function addElement(elt2){return this.append(elt2);}},{key:"resolveMarkers",value:function resolveMarkers(from){for(var _i185=from;_i185<this.parts.length;_i185++){var close=this.parts[_i185];if(!(close instanceof InlineDelimiter&&close.type.resolve&&close.side&2))continue;var emp=close.type==EmphasisUnderscore||close.type==EmphasisAsterisk;var closeSize=close.to-close.from;var open=void 0,j=_i185-1;for(;j>=from;j--){var part=this.parts[j];if(part instanceof InlineDelimiter&&part.side&1&&part.type==close.type&&!(emp&&(close.side&1||part.side&2)&&(part.to-part.from+closeSize)%3==0&&((part.to-part.from)%3||closeSize%3))){open=part;break;}}if(!open)continue;var type=close.type.resolve,content2=[];var start=open.from,end=close.to;if(emp){var size=Math.min(2,open.to-open.from,closeSize);start=open.to-size;end=close.from+size;type=size==1?"Emphasis":"StrongEmphasis";}if(open.type.mark)content2.push(this.elt(open.type.mark,start,open.to));for(var k=j+1;k<_i185;k++){if(this.parts[k]instanceof Element)content2.push(this.parts[k]);this.parts[k]=null;}if(close.type.mark)content2.push(this.elt(close.type.mark,close.from,end));var element=this.elt(type,start,end,content2);this.parts[j]=emp&&open.from!=start?new InlineDelimiter(open.type,open.from,start,open.side):null;var keep=this.parts[_i185]=emp&&close.to!=end?new InlineDelimiter(close.type,end,close.to,close.side):null;if(keep)this.parts.splice(_i185,0,element);else this.parts[_i185]=element;}var result=[];for(var _i186=from;_i186<this.parts.length;_i186++){var _part=this.parts[_i186];if(_part instanceof Element)result.push(_part);}return result;}},{key:"findOpeningDelimiter",value:function findOpeningDelimiter(type){for(var _i187=this.parts.length-1;_i187>=0;_i187--){var part=this.parts[_i187];if(part instanceof InlineDelimiter&&part.type==type)return _i187;}return null;}},{key:"takeContent",value:function takeContent(startIndex){var content2=this.resolveMarkers(startIndex);this.parts.length=startIndex;return content2;}},{key:"skipSpace",value:function skipSpace(from){return _skipSpace(this.text,from-this.offset)+this.offset;}},{key:"elt",value:function elt(type,from,to,children){if(typeof type=="string")return _elt(this.parser.getNodeType(type),from,to,children);return new TreeElement(type,from);}}]);return InlineContext;}();function injectMarks(elements,marks){if(!marks.length)return elements;if(!elements.length)return marks;var elts=elements.slice(),eI=0;var _iterator262=_createForOfIteratorHelper(marks),_step262;try{for(_iterator262.s();!(_step262=_iterator262.n()).done;){var mark=_step262.value;while(eI<elts.length&&elts[eI].to<mark.to){eI++;}if(eI<elts.length&&elts[eI].from<mark.from){var e=elts[eI];if(e instanceof Element)elts[eI]=new Element(e.type,e.from,e.to,injectMarks(e.children,[mark]));}else{elts.splice(eI++,0,mark);}}}catch(err){_iterator262.e(err);}finally{_iterator262.f();}return elts;}var NotLast=[Type.CodeBlock,Type.ListItem,Type.OrderedList,Type.BulletList];var FragmentCursor2=/*#__PURE__*/function(){function FragmentCursor2(fragments,input){_classCallCheck(this,FragmentCursor2);this.fragments=fragments;this.input=input;this.i=0;this.fragment=null;this.fragmentEnd=-1;this.cursor=null;if(fragments.length)this.fragment=fragments[this.i++];}_createClass(FragmentCursor2,[{key:"nextFragment",value:function nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null;this.cursor=null;this.fragmentEnd=-1;}},{key:"moveTo",value:function moveTo(pos,lineStart){while(this.fragment&&this.fragment.to<=pos){this.nextFragment();}if(!this.fragment||this.fragment.from>(pos?pos-1:0))return false;if(this.fragmentEnd<0){var end=this.fragment.to;while(end>0&&this.input.read(end-1,end)!="\n"){end--;}this.fragmentEnd=end?end-1:0;}var c=this.cursor;if(!c){c=this.cursor=this.fragment.tree.cursor();c.firstChild();}var rPos=pos+this.fragment.offset;while(c.to<=rPos){if(!c.parent())return false;}for(;;){if(c.from>=rPos)return this.fragment.from<=lineStart;if(!c.childAfter(rPos))return false;}}},{key:"matches",value:function matches(hash2){var tree=this.cursor.tree;return tree&&tree.prop(NodeProp.contextHash)==hash2;}},{key:"takeNodes",value:function takeNodes(cx){var cur2=this.cursor,off=this.fragment.offset,fragEnd=this.fragmentEnd-(this.fragment.openEnd?1:0);var start=cx.absoluteLineStart,end=start,blockI=cx.block.children.length;var prevEnd=end,prevI=blockI;for(;;){if(cur2.to-off>fragEnd){if(cur2.type.isAnonymous&&cur2.firstChild())continue;break;}var pos=toRelative(cur2.from-off,cx.ranges);if(cur2.to-off<=cx.ranges[cx.rangeI].to){cx.addNode(cur2.tree,pos);}else{var dummy=new Tree(cx.parser.nodeSet.types[Type.Paragraph],[],[],0,cx.block.hashProp);cx.reusePlaceholders.set(dummy,cur2.tree);cx.addNode(dummy,pos);}if(cur2.type.is("Block")){if(NotLast.indexOf(cur2.type.id)<0){end=cur2.to-off;blockI=cx.block.children.length;}else{end=prevEnd;blockI=prevI;prevEnd=cur2.to-off;prevI=cx.block.children.length;}}if(!cur2.nextSibling())break;}while(cx.block.children.length>blockI){cx.block.children.pop();cx.block.positions.pop();}return end-start;}}]);return FragmentCursor2;}();function toRelative(abs,ranges){var pos=abs;for(var _i188=1;_i188<ranges.length;_i188++){var gapFrom=ranges[_i188-1].to,gapTo=ranges[_i188].from;if(gapFrom<abs)pos-=gapTo-gapFrom;}return pos;}var markdownHighlighting=styleTags({"Blockquote/...":tags.quote,HorizontalRule:tags.contentSeparator,"ATXHeading1/... SetextHeading1/...":tags.heading1,"ATXHeading2/... SetextHeading2/...":tags.heading2,"ATXHeading3/...":tags.heading3,"ATXHeading4/...":tags.heading4,"ATXHeading5/...":tags.heading5,"ATXHeading6/...":tags.heading6,"Comment CommentBlock":tags.comment,Escape:tags.escape,Entity:tags.character,"Emphasis/...":tags.emphasis,"StrongEmphasis/...":tags.strong,"Link/... Image/...":tags.link,"OrderedList/... BulletList/...":tags.list,"BlockQuote/...":tags.quote,"InlineCode CodeText":tags.monospace,URL:tags.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":tags.processingInstruction,"CodeInfo LinkLabel":tags.labelName,LinkTitle:tags.string,Paragraph:tags.content});var parser=new MarkdownParser(new NodeSet(nodeTypes).extend(markdownHighlighting),Object.keys(DefaultBlockParsers).map(function(n){return DefaultBlockParsers[n];}),Object.keys(DefaultBlockParsers).map(function(n){return DefaultLeafBlocks[n];}),Object.keys(DefaultBlockParsers),DefaultEndLeaf,DefaultSkipMarkup,Object.keys(DefaultInline).map(function(n){return DefaultInline[n];}),Object.keys(DefaultInline),[]);function leftOverSpace(node,from,to){var ranges=[];for(var n=node.firstChild,pos=from;;n=n.nextSibling){var nextPos=n?n.from:to;if(nextPos>pos)ranges.push({from:pos,to:nextPos});if(!n)break;pos=n.to;}return ranges;}function parseCode(config2){var codeParser=config2.codeParser,htmlParser=config2.htmlParser;var wrap=parseMixed(function(node,input){var id2=node.type.id;if(codeParser&&(id2==Type.CodeBlock||id2==Type.FencedCode)){var info="";if(id2==Type.FencedCode){var infoNode=node.node.getChild(Type.CodeInfo);if(infoNode)info=input.read(infoNode.from,infoNode.to);}var parser5=codeParser(info);if(parser5)return{parser:parser5,overlay:function overlay(node2){return node2.type.id==Type.CodeText;}};}else if(htmlParser&&(id2==Type.HTMLBlock||id2==Type.HTMLTag)){return{parser:htmlParser,overlay:leftOverSpace(node.node,node.from,node.to)};}return null;});return{wrap:wrap};}var StrikethroughDelim={resolve:"Strikethrough",mark:"StrikethroughMark"};var Strikethrough={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":tags.strikethrough}},{name:"StrikethroughMark",style:tags.processingInstruction}],parseInline:[{name:"Strikethrough",parse:function parse(cx,next,pos){if(next!=126||cx["char"](pos+1)!=126||cx["char"](pos+2)==126)return-1;var before=cx.slice(pos-1,pos),after=cx.slice(pos+2,pos+3);var sBefore=/\s|^$/.test(before),sAfter=/\s|^$/.test(after);var pBefore=Punctuation.test(before),pAfter=Punctuation.test(after);return cx.addDelimiter(StrikethroughDelim,pos,pos+2,!sAfter&&(!pAfter||sBefore||pBefore),!sBefore&&(!pBefore||sAfter||pAfter));},after:"Emphasis"}]};function parseRow(cx,line){var startI=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var elts=arguments.length>3?arguments[3]:undefined;var offset=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;var count2=0,first=true,cellStart=-1,cellEnd=-1,esc=false;var parseCell=function parseCell(){elts.push(cx.elt("TableCell",offset+cellStart,offset+cellEnd,cx.parser.parseInline(line.slice(cellStart,cellEnd),offset+cellStart)));};for(var _i189=startI;_i189<line.length;_i189++){var next=line.charCodeAt(_i189);if(next==124&&!esc){if(!first||cellStart>-1)count2++;first=false;if(elts){if(cellStart>-1)parseCell();elts.push(cx.elt("TableDelimiter",_i189+offset,_i189+offset+1));}cellStart=cellEnd=-1;}else if(esc||next!=32&&next!=9){if(cellStart<0)cellStart=_i189;cellEnd=_i189+1;}esc=!esc&&next==92;}if(cellStart>-1){count2++;if(elts)parseCell();}return count2;}function hasPipe(str,start){for(var _i190=start;_i190<str.length;_i190++){var next=str.charCodeAt(_i190);if(next==124)return true;if(next==92)_i190++;}return false;}var delimiterLine=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;var TableParser=/*#__PURE__*/function(){function TableParser(){_classCallCheck(this,TableParser);this.rows=null;}_createClass(TableParser,[{key:"nextLine",value:function nextLine(cx,line,leaf){if(this.rows==null){this.rows=false;var lineText;if((line.next==45||line.next==58||line.next==124)&&delimiterLine.test(lineText=line.text.slice(line.pos))){var firstRow=[],firstCount=parseRow(cx,leaf.content,0,firstRow,leaf.start);if(firstCount==parseRow(cx,lineText,line.pos))this.rows=[cx.elt("TableHeader",leaf.start,leaf.start+leaf.content.length,firstRow),cx.elt("TableDelimiter",cx.lineStart+line.pos,cx.lineStart+line.text.length)];}}else if(this.rows){var content2=[];parseRow(cx,line.text,line.pos,content2,cx.lineStart);this.rows.push(cx.elt("TableRow",cx.lineStart+line.pos,cx.lineStart+line.text.length,content2));}return false;}},{key:"finish",value:function finish(cx,leaf){if(!this.rows)return false;cx.addLeafElement(leaf,cx.elt("Table",leaf.start,leaf.start+leaf.content.length,this.rows));return true;}}]);return TableParser;}();var Table={defineNodes:[{name:"Table",block:true},{name:"TableHeader",style:{"TableHeader/...":tags.heading}},"TableRow",{name:"TableCell",style:tags.content},{name:"TableDelimiter",style:tags.processingInstruction}],parseBlock:[{name:"Table",leaf:function leaf(_,_leaf){return hasPipe(_leaf.content,0)?new TableParser():null;},endLeaf:function endLeaf(cx,line,leaf){if(leaf.parsers.some(function(p){return p instanceof TableParser;})||!hasPipe(line.text,line.basePos))return false;var next=cx.scanLine(cx.absoluteLineEnd+1).text;return delimiterLine.test(next)&&parseRow(cx,line.text,line.basePos)==parseRow(cx,next,line.basePos);},before:"SetextHeading"}]};var TaskParser=/*#__PURE__*/function(){function TaskParser(){_classCallCheck(this,TaskParser);}_createClass(TaskParser,[{key:"nextLine",value:function nextLine(){return false;}},{key:"finish",value:function finish(cx,leaf){cx.addLeafElement(leaf,cx.elt("Task",leaf.start,leaf.start+leaf.content.length,[cx.elt("TaskMarker",leaf.start,leaf.start+3)].concat(_toConsumableArray(cx.parser.parseInline(leaf.content.slice(3),leaf.start+3)))));return true;}}]);return TaskParser;}();var TaskList={defineNodes:[{name:"Task",block:true,style:tags.list},{name:"TaskMarker",style:tags.atom}],parseBlock:[{name:"TaskList",leaf:function leaf(cx,_leaf2){return /^\[[ xX]\][ \t]/.test(_leaf2.content)&&cx.parentType().name=="ListItem"?new TaskParser():null;},after:"SetextHeading"}]};var autolinkRE=new RegExp("(www\\.)|(https?:\\/\\/)|([\\w.+-]+@)|(mailto:|xmpp:)","gy");var urlRE=new RegExp("[\\w-]+(\\.[\\w-]+)+(\\/[^\\s<]*)?","gy");var lastTwoDomainWords=/[\w-]+\.[\w-]+($|\/)/;var emailRE=new RegExp("[\\w.+-]+@[\\w-]+(\\.[\\w.-]+)+","gy");var xmppResourceRE=new RegExp("\\/[a-zA-Z\\d@.]+","gy");function count(str,from,to,ch){var result=0;for(var _i191=from;_i191<to;_i191++){if(str[_i191]==ch)result++;}return result;}function autolinkURLEnd(text,from){urlRE.lastIndex=from;var m=urlRE.exec(text);if(!m||lastTwoDomainWords.exec(m[0])[0].indexOf("_")>-1)return-1;var end=from+m[0].length;for(;;){var last=text[end-1],m2=void 0;if(/[?!.,:*_~]/.test(last)||last==")"&&count(text,from,end,")")>count(text,from,end,"("))end--;else if(last==";"&&(m2=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(text.slice(from,end))))end=from+m2.index;else break;}return end;}function autolinkEmailEnd(text,from){emailRE.lastIndex=from;var m=emailRE.exec(text);if(!m)return-1;var last=m[0][m[0].length-1];return last=="_"||last=="-"?-1:from+m[0].length-(last=="."?1:0);}var Autolink={parseInline:[{name:"Autolink",parse:function parse(cx,next,absPos){var pos=absPos-cx.offset;autolinkRE.lastIndex=pos;var m=autolinkRE.exec(cx.text),end=-1;if(!m)return-1;if(m[1]||m[2]){end=autolinkURLEnd(cx.text,pos+m[0].length);}else if(m[3]){end=autolinkEmailEnd(cx.text,pos);}else{end=autolinkEmailEnd(cx.text,pos+m[0].length);if(end>-1&&m[0]=="xmpp:"){xmppResourceRE.lastIndex=end;m=xmppResourceRE.exec(cx.text);if(m)end=m.index+m[0].length;}}if(end<0)return-1;cx.addElement(cx.elt("URL",absPos,end+cx.offset));return end+cx.offset;}}]};var GFM=[Table,TaskList,Strikethrough,Autolink];function parseSubSuper(ch,node,mark){return function(cx,next,pos){if(next!=ch||cx["char"](pos+1)==ch)return-1;var elts=[cx.elt(mark,pos,pos+1)];for(var _i192=pos+1;_i192<cx.end;_i192++){var next2=cx["char"](_i192);if(next2==ch)return cx.addElement(cx.elt(node,pos,_i192+1,elts.concat(cx.elt(mark,_i192,_i192+1))));if(next2==92)elts.push(cx.elt("Escape",_i192,_i192++ +2));if(space(next2))break;}return-1;};}var Superscript={defineNodes:[{name:"Superscript",style:tags.special(tags.content)},{name:"SuperscriptMark",style:tags.processingInstruction}],parseInline:[{name:"Superscript",parse:parseSubSuper(94,"Superscript","SuperscriptMark")}]};var Subscript={defineNodes:[{name:"Subscript",style:tags.special(tags.content)},{name:"SubscriptMark",style:tags.processingInstruction}],parseInline:[{name:"Subscript",parse:parseSubSuper(126,"Subscript","SubscriptMark")}]};var Emoji={defineNodes:[{name:"Emoji",style:tags.character}],parseInline:[{name:"Emoji",parse:function parse(cx,next,pos){var match;if(next!=58||!(match=/^[a-zA-Z_0-9]+:/.exec(cx.slice(pos+1,cx.end))))return-1;return cx.addElement(cx.elt("Emoji",pos,pos+1+match[0].length));}}]};// ../node_modules/@lezer/lr/dist/index.js
var Stack=/*#__PURE__*/function(){function Stack(p,stack,state,reducePos,pos,score2,buffer,bufferBase,curContext){var lookAhead=arguments.length>9&&arguments[9]!==undefined?arguments[9]:0;var parent=arguments.length>10?arguments[10]:undefined;_classCallCheck(this,Stack);this.p=p;this.stack=stack;this.state=state;this.reducePos=reducePos;this.pos=pos;this.score=score2;this.buffer=buffer;this.bufferBase=bufferBase;this.curContext=curContext;this.lookAhead=lookAhead;this.parent=parent;}_createClass(Stack,[{key:"toString",value:function toString(){return"[".concat(this.stack.filter(function(_,i){return i%3==0;}).concat(this.state),"]@").concat(this.pos).concat(this.score?"!"+this.score:"");}},{key:"context",get:function get(){return this.curContext?this.curContext.context:null;}},{key:"pushState",value:function pushState(state,start){this.stack.push(this.state,start,this.bufferBase+this.buffer.length);this.state=state;}},{key:"reduce",value:function reduce(action){var _a2;var depth=action>>19,type=action&65535;var parser5=this.p.parser;var dPrec=parser5.dynamicPrecedence(type);if(dPrec)this.score+=dPrec;if(depth==0){this.pushState(parser5.getGoto(this.state,type,true),this.reducePos);if(type<parser5.minRepeatTerm)this.storeNode(type,this.reducePos,this.reducePos,4,true);this.reduceContext(type,this.reducePos);return;}var base2=this.stack.length-(depth-1)*3-(action&262144?6:0);var start=base2?this.stack[base2-2]:this.p.ranges[0].from,size=this.reducePos-start;if(size>=2e3&&!((_a2=this.p.parser.nodeSet.types[type])===null||_a2===void 0?void 0:_a2.isAnonymous)){if(start==this.p.lastBigReductionStart){this.p.bigReductionCount++;this.p.lastBigReductionSize=size;}else if(this.p.lastBigReductionSize<size){this.p.bigReductionCount=1;this.p.lastBigReductionStart=start;this.p.lastBigReductionSize=size;}}var bufferBase=base2?this.stack[base2-1]:0,count2=this.bufferBase+this.buffer.length-bufferBase;if(type<parser5.minRepeatTerm||action&131072){var pos=parser5.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(type,start,pos,count2+4,true);}if(action&262144){this.state=this.stack[base2];}else{var baseStateID=this.stack[base2-3];this.state=parser5.getGoto(baseStateID,type,true);}while(this.stack.length>base2){this.stack.pop();}this.reduceContext(type,start);}},{key:"storeNode",value:function storeNode(term,start,end){var size=arguments.length>3&&arguments[3]!==undefined?arguments[3]:4;var isReduce=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;if(term==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){var cur2=this,top2=this.buffer.length;if(top2==0&&cur2.parent){top2=cur2.bufferBase-cur2.parent.bufferBase;cur2=cur2.parent;}if(top2>0&&cur2.buffer[top2-4]==0&&cur2.buffer[top2-1]>-1){if(start==end)return;if(cur2.buffer[top2-2]>=start){cur2.buffer[top2-2]=end;return;}}}if(!isReduce||this.pos==end){this.buffer.push(term,start,end,size);}else{var index=this.buffer.length;if(index>0&&this.buffer[index-4]!=0)while(index>0&&this.buffer[index-2]>end){this.buffer[index]=this.buffer[index-4];this.buffer[index+1]=this.buffer[index-3];this.buffer[index+2]=this.buffer[index-2];this.buffer[index+3]=this.buffer[index-1];index-=4;if(size>4)size-=4;}this.buffer[index]=term;this.buffer[index+1]=start;this.buffer[index+2]=end;this.buffer[index+3]=size;}}},{key:"shift",value:function shift(action,type,start,end){if(action&131072){this.pushState(action&65535,this.pos);}else if((action&262144)==0){var nextState=action,parser5=this.p.parser;if(end>this.pos||type<=parser5.maxNode){this.pos=end;if(!parser5.stateFlag(nextState,1))this.reducePos=end;}this.pushState(nextState,start);this.shiftContext(type,start);if(type<=parser5.maxNode)this.buffer.push(type,start,end,4);}else{this.pos=end;this.shiftContext(type,start);if(type<=this.p.parser.maxNode)this.buffer.push(type,start,end,4);}}},{key:"apply",value:function apply(action,next,nextStart,nextEnd){if(action&65536)this.reduce(action);else this.shift(action,next,nextStart,nextEnd);}},{key:"useNode",value:function useNode(value,next){var index=this.p.reused.length-1;if(index<0||this.p.reused[index]!=value){this.p.reused.push(value);index++;}var start=this.pos;this.reducePos=this.pos=start+value.length;this.pushState(next,start);this.buffer.push(index,start,this.reducePos,-1);if(this.curContext)this.updateContext(this.curContext.tracker.reuse(this.curContext.context,value,this,this.p.stream.reset(this.pos-value.length)));}},{key:"split",value:function split(){var parent=this;var off=parent.buffer.length;while(off>0&&parent.buffer[off-2]>parent.reducePos){off-=4;}var buffer=parent.buffer.slice(off),base2=parent.bufferBase+off;while(parent&&base2==parent.bufferBase){parent=parent.parent;}return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,buffer,base2,this.curContext,this.lookAhead,parent);}},{key:"recoverByDelete",value:function recoverByDelete(next,nextEnd){var isNode=next<=this.p.parser.maxNode;if(isNode)this.storeNode(next,this.pos,nextEnd,4);this.storeNode(0,this.pos,nextEnd,isNode?8:4);this.pos=this.reducePos=nextEnd;this.score-=190;}},{key:"canShift",value:function canShift(term){for(var sim=new SimulatedStack(this);;){var action=this.p.parser.stateSlot(sim.state,4)||this.p.parser.hasAction(sim.state,term);if(action==0)return false;if((action&65536)==0)return true;sim.reduce(action);}}},{key:"recoverByInsert",value:function recoverByInsert(next){if(this.stack.length>=300)return[];var nextStates=this.p.parser.nextStates(this.state);if(nextStates.length>4<<1||this.stack.length>=120){var best=[];for(var _i193=0,s;_i193<nextStates.length;_i193+=2){if((s=nextStates[_i193+1])!=this.state&&this.p.parser.hasAction(s,next))best.push(nextStates[_i193],s);}if(this.stack.length<120){var _loop19=function _loop19(_i194){var s=nextStates[_i194+1];if(!best.some(function(v,i2){return i2&1&&v==s;}))best.push(nextStates[_i194],s);};for(var _i194=0;best.length<4<<1&&_i194<nextStates.length;_i194+=2){_loop19(_i194);}}nextStates=best;}var result=[];for(var _i195=0;_i195<nextStates.length&&result.length<4;_i195+=2){var _s2=nextStates[_i195+1];if(_s2==this.state)continue;var stack=this.split();stack.pushState(_s2,this.pos);stack.storeNode(0,stack.pos,stack.pos,4,true);stack.shiftContext(nextStates[_i195],this.pos);stack.reducePos=this.pos;stack.score-=200;result.push(stack);}return result;}},{key:"forceReduce",value:function forceReduce(){var parser5=this.p.parser;var reduce=parser5.stateSlot(this.state,5);if((reduce&65536)==0)return false;if(!parser5.validAction(this.state,reduce)){var depth=reduce>>19,term=reduce&65535;var target=this.stack.length-depth*3;if(target<0||parser5.getGoto(this.stack[target],term,false)<0){var backup=this.findForcedReduction();if(backup==null)return false;reduce=backup;}this.storeNode(0,this.pos,this.pos,4,true);this.score-=100;}this.reducePos=this.pos;this.reduce(reduce);return true;}},{key:"findForcedReduction",value:function findForcedReduction(){var _this101=this;var parser5=this.p.parser,seen=[];var explore=function explore(state,depth){if(seen.includes(state))return;seen.push(state);return parser5.allActions(state,function(action){if(action&(262144|131072));else if(action&65536){var rDepth=(action>>19)-depth;if(rDepth>1){var term=action&65535,target=_this101.stack.length-rDepth*3;if(target>=0&&parser5.getGoto(_this101.stack[target],term,false)>=0)return rDepth<<19|65536|term;}}else{var found=explore(action,depth+1);if(found!=null)return found;}});};return explore(this.state,0);}},{key:"forceAll",value:function forceAll(){while(!this.p.parser.stateFlag(this.state,2)){if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,true);break;}}return this;}},{key:"deadEnd",get:function get(){if(this.stack.length!=3)return false;var parser5=this.p.parser;return parser5.data[parser5.stateSlot(this.state,1)]==65535&&!parser5.stateSlot(this.state,4);}},{key:"restart",value:function restart(){this.storeNode(0,this.pos,this.pos,4,true);this.state=this.stack[0];this.stack.length=0;}},{key:"sameState",value:function sameState(other){if(this.state!=other.state||this.stack.length!=other.stack.length)return false;for(var _i196=0;_i196<this.stack.length;_i196+=3){if(this.stack[_i196]!=other.stack[_i196])return false;}return true;}},{key:"parser",get:function get(){return this.p.parser;}},{key:"dialectEnabled",value:function dialectEnabled(dialectID){return this.p.parser.dialect.flags[dialectID];}},{key:"shiftContext",value:function shiftContext(term,start){if(this.curContext)this.updateContext(this.curContext.tracker.shift(this.curContext.context,term,this,this.p.stream.reset(start)));}},{key:"reduceContext",value:function reduceContext(term,start){if(this.curContext)this.updateContext(this.curContext.tracker.reduce(this.curContext.context,term,this,this.p.stream.reset(start)));}},{key:"emitContext",value:function emitContext(){var last=this.buffer.length-1;if(last<0||this.buffer[last]!=-3)this.buffer.push(this.curContext.hash,this.pos,this.pos,-3);}},{key:"emitLookAhead",value:function emitLookAhead(){var last=this.buffer.length-1;if(last<0||this.buffer[last]!=-4)this.buffer.push(this.lookAhead,this.pos,this.pos,-4);}},{key:"updateContext",value:function updateContext(context){if(context!=this.curContext.context){var newCx=new StackContext(this.curContext.tracker,context);if(newCx.hash!=this.curContext.hash)this.emitContext();this.curContext=newCx;}}},{key:"setLookAhead",value:function setLookAhead(lookAhead){if(lookAhead>this.lookAhead){this.emitLookAhead();this.lookAhead=lookAhead;}}},{key:"close",value:function close(){if(this.curContext&&this.curContext.tracker.strict)this.emitContext();if(this.lookAhead>0)this.emitLookAhead();}}],[{key:"start",value:function start(p,state){var pos=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var cx=p.parser.context;return new Stack(p,[],state,pos,pos,0,[],0,cx?new StackContext(cx,cx.start):null,0,null);}}]);return Stack;}();var StackContext=/*#__PURE__*/_createClass(function StackContext(tracker,context){_classCallCheck(this,StackContext);this.tracker=tracker;this.context=context;this.hash=tracker.strict?tracker.hash(context):0;});var SimulatedStack=/*#__PURE__*/function(){function SimulatedStack(start){_classCallCheck(this,SimulatedStack);this.start=start;this.state=start.state;this.stack=start.stack;this.base=this.stack.length;}_createClass(SimulatedStack,[{key:"reduce",value:function reduce(action){var term=action&65535,depth=action>>19;if(depth==0){if(this.stack==this.start.stack)this.stack=this.stack.slice();this.stack.push(this.state,0,0);this.base+=3;}else{this.base-=(depth-1)*3;}var _goto=this.start.p.parser.getGoto(this.stack[this.base-3],term,true);this.state=_goto;}}]);return SimulatedStack;}();var StackBufferCursor=/*#__PURE__*/function(){function StackBufferCursor(stack,pos,index){_classCallCheck(this,StackBufferCursor);this.stack=stack;this.pos=pos;this.index=index;this.buffer=stack.buffer;if(this.index==0)this.maybeNext();}_createClass(StackBufferCursor,[{key:"maybeNext",value:function maybeNext(){var next=this.stack.parent;if(next!=null){this.index=this.stack.bufferBase-next.bufferBase;this.stack=next;this.buffer=next.buffer;}}},{key:"id",get:function get(){return this.buffer[this.index-4];}},{key:"start",get:function get(){return this.buffer[this.index-3];}},{key:"end",get:function get(){return this.buffer[this.index-2];}},{key:"size",get:function get(){return this.buffer[this.index-1];}},{key:"next",value:function next(){this.index-=4;this.pos-=4;if(this.index==0)this.maybeNext();}},{key:"fork",value:function fork(){return new StackBufferCursor(this.stack,this.pos,this.index);}}],[{key:"create",value:function create(stack){var pos=arguments.length>1&&arguments[1]!==undefined?arguments[1]:stack.bufferBase+stack.buffer.length;return new StackBufferCursor(stack,pos,pos-stack.bufferBase);}}]);return StackBufferCursor;}();function decodeArray(input){var Type2=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Uint16Array;if(typeof input!="string")return input;var array=null;for(var pos=0,out=0;pos<input.length;){var value=0;for(;;){var next=input.charCodeAt(pos++),stop=false;if(next==126){value=65535;break;}if(next>=92)next--;if(next>=34)next--;var digit=next-32;if(digit>=46){digit-=46;stop=true;}value+=digit;if(stop)break;value*=46;}if(array)array[out++]=value;else array=new Type2(value);}return array;}var CachedToken=/*#__PURE__*/_createClass(function CachedToken(){_classCallCheck(this,CachedToken);this.start=-1;this.value=-1;this.end=-1;this.extended=-1;this.lookAhead=0;this.mask=0;this.context=0;});var nullToken=new CachedToken();var InputStream=/*#__PURE__*/function(){function InputStream(input,ranges){_classCallCheck(this,InputStream);this.input=input;this.ranges=ranges;this.chunk="";this.chunkOff=0;this.chunk2="";this.chunk2Pos=0;this.next=-1;this.token=nullToken;this.rangeIndex=0;this.pos=this.chunkPos=ranges[0].from;this.range=ranges[0];this.end=ranges[ranges.length-1].to;this.readNext();}_createClass(InputStream,[{key:"resolveOffset",value:function resolveOffset(offset,assoc){var range=this.range,index=this.rangeIndex;var pos=this.pos+offset;while(pos<range.from){if(!index)return null;var next=this.ranges[--index];pos-=range.from-next.to;range=next;}while(assoc<0?pos>range.to:pos>=range.to){if(index==this.ranges.length-1)return null;var _next5=this.ranges[++index];pos+=_next5.from-range.to;range=_next5;}return pos;}},{key:"clipPos",value:function clipPos(pos){if(pos>=this.range.from&&pos<this.range.to)return pos;var _iterator263=_createForOfIteratorHelper(this.ranges),_step263;try{for(_iterator263.s();!(_step263=_iterator263.n()).done;){var range=_step263.value;if(range.to>pos)return Math.max(pos,range.from);}}catch(err){_iterator263.e(err);}finally{_iterator263.f();}return this.end;}},{key:"peek",value:function peek(offset){var idx=this.chunkOff+offset,pos,result;if(idx>=0&&idx<this.chunk.length){pos=this.pos+offset;result=this.chunk.charCodeAt(idx);}else{var resolved=this.resolveOffset(offset,1);if(resolved==null)return-1;pos=resolved;if(pos>=this.chunk2Pos&&pos<this.chunk2Pos+this.chunk2.length){result=this.chunk2.charCodeAt(pos-this.chunk2Pos);}else{var _i197=this.rangeIndex,range=this.range;while(range.to<=pos){range=this.ranges[++_i197];}this.chunk2=this.input.chunk(this.chunk2Pos=pos);if(pos+this.chunk2.length>range.to)this.chunk2=this.chunk2.slice(0,range.to-pos);result=this.chunk2.charCodeAt(0);}}if(pos>=this.token.lookAhead)this.token.lookAhead=pos+1;return result;}},{key:"acceptToken",value:function acceptToken(token){var endOffset=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var end=endOffset?this.resolveOffset(endOffset,-1):this.pos;if(end==null||end<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=token;this.token.end=end;}},{key:"getChunk",value:function getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){var chunk=this.chunk,chunkPos=this.chunkPos;this.chunk=this.chunk2;this.chunkPos=this.chunk2Pos;this.chunk2=chunk;this.chunk2Pos=chunkPos;this.chunkOff=this.pos-this.chunkPos;}else{this.chunk2=this.chunk;this.chunk2Pos=this.chunkPos;var nextChunk=this.input.chunk(this.pos);var end=this.pos+nextChunk.length;this.chunk=end>this.range.to?nextChunk.slice(0,this.range.to-this.pos):nextChunk;this.chunkPos=this.pos;this.chunkOff=0;}}},{key:"readNext",value:function readNext(){if(this.chunkOff>=this.chunk.length){this.getChunk();if(this.chunkOff==this.chunk.length)return this.next=-1;}return this.next=this.chunk.charCodeAt(this.chunkOff);}},{key:"advance",value:function advance(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;this.chunkOff+=n;while(this.pos+n>=this.range.to){if(this.rangeIndex==this.ranges.length-1)return this.setDone();n-=this.range.to-this.pos;this.range=this.ranges[++this.rangeIndex];this.pos=this.range.from;}this.pos+=n;if(this.pos>=this.token.lookAhead)this.token.lookAhead=this.pos+1;return this.readNext();}},{key:"setDone",value:function setDone(){this.pos=this.chunkPos=this.end;this.range=this.ranges[this.rangeIndex=this.ranges.length-1];this.chunk="";return this.next=-1;}},{key:"reset",value:function reset(pos,token){if(token){this.token=token;token.start=pos;token.lookAhead=pos+1;token.value=token.extended=-1;}else{this.token=nullToken;}if(this.pos!=pos){this.pos=pos;if(pos==this.end){this.setDone();return this;}while(pos<this.range.from){this.range=this.ranges[--this.rangeIndex];}while(pos>=this.range.to){this.range=this.ranges[++this.rangeIndex];}if(pos>=this.chunkPos&&pos<this.chunkPos+this.chunk.length){this.chunkOff=pos-this.chunkPos;}else{this.chunk="";this.chunkOff=0;}this.readNext();}return this;}},{key:"read",value:function read(from,to){if(from>=this.chunkPos&&to<=this.chunkPos+this.chunk.length)return this.chunk.slice(from-this.chunkPos,to-this.chunkPos);if(from>=this.chunk2Pos&&to<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(from-this.chunk2Pos,to-this.chunk2Pos);if(from>=this.range.from&&to<=this.range.to)return this.input.read(from,to);var result="";var _iterator264=_createForOfIteratorHelper(this.ranges),_step264;try{for(_iterator264.s();!(_step264=_iterator264.n()).done;){var _r15=_step264.value;if(_r15.from>=to)break;if(_r15.to>from)result+=this.input.read(Math.max(_r15.from,from),Math.min(_r15.to,to));}}catch(err){_iterator264.e(err);}finally{_iterator264.f();}return result;}}]);return InputStream;}();var TokenGroup=/*#__PURE__*/function(){function TokenGroup(data2,id2){_classCallCheck(this,TokenGroup);this.data=data2;this.id=id2;}_createClass(TokenGroup,[{key:"token",value:function token(input,stack){var parser5=stack.p.parser;readToken2(this.data,input,stack,this.id,parser5.data,parser5.tokenPrecTable);}}]);return TokenGroup;}();TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=false;var LocalTokenGroup=/*#__PURE__*/function(){function LocalTokenGroup(data2,precTable,elseToken){_classCallCheck(this,LocalTokenGroup);this.precTable=precTable;this.elseToken=elseToken;this.data=typeof data2=="string"?decodeArray(data2):data2;}_createClass(LocalTokenGroup,[{key:"token",value:function token(input,stack){var start=input.pos,skipped=0;for(;;){var atEof=input.next<0,nextPos=input.resolveOffset(1,1);readToken2(this.data,input,stack,0,this.data,this.precTable);if(input.token.value>-1)break;if(this.elseToken==null)return;if(!atEof)skipped++;if(nextPos==null)break;input.reset(nextPos,input.token);}if(skipped){input.reset(start,input.token);input.acceptToken(this.elseToken,skipped);}}}]);return LocalTokenGroup;}();LocalTokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=false;var ExternalTokenizer=/*#__PURE__*/_createClass(function ExternalTokenizer(token){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,ExternalTokenizer);this.token=token;this.contextual=!!options.contextual;this.fallback=!!options.fallback;this.extend=!!options.extend;});function readToken2(data2,input,stack,group,precTable,precOffset){var state=0,groupMask=1<<group,dialect=stack.p.parser.dialect;scan:for(;;){if((groupMask&data2[state])==0)break;var accEnd=data2[state+1];for(var _i198=state+3;_i198<accEnd;_i198+=2){if((data2[_i198+1]&groupMask)>0){var term=data2[_i198];if(dialect.allows(term)&&(input.token.value==-1||input.token.value==term||overrides(term,input.token.value,precTable,precOffset))){input.acceptToken(term);break;}}}var next=input.next,low=0,high=data2[state+2];if(input.next<0&&high>low&&data2[accEnd+high*3-3]==65535){state=data2[accEnd+high*3-1];continue scan;}for(;low<high;){var mid=low+high>>1;var index=accEnd+mid+(mid<<1);var from=data2[index],to=data2[index+1]||65536;if(next<from)high=mid;else if(next>=to)low=mid+1;else{state=data2[index+2];input.advance();continue scan;}}break;}}function findOffset(data2,start,term){for(var _i199=start,next;(next=data2[_i199])!=65535;_i199++){if(next==term)return _i199-start;}return-1;}function overrides(token,prev,tableData,tableOffset){var iPrev=findOffset(tableData,tableOffset,prev);return iPrev<0||findOffset(tableData,tableOffset,token)<iPrev;}var verbose=typeof process!="undefined"&&process.env&&/\bparse\b/.test(process.env.LOG);var stackIDs=null;function cutAt(tree,pos,side){var cursor2=tree.cursor(IterMode.IncludeAnonymous);cursor2.moveTo(pos);for(;;){if(!(side<0?cursor2.childBefore(pos):cursor2.childAfter(pos)))for(;;){if((side<0?cursor2.to<pos:cursor2.from>pos)&&!cursor2.type.isError)return side<0?Math.max(0,Math.min(cursor2.to-1,pos-25)):Math.min(tree.length,Math.max(cursor2.from+1,pos+25));if(side<0?cursor2.prevSibling():cursor2.nextSibling())break;if(!cursor2.parent())return side<0?0:tree.length;}}}var FragmentCursor3=/*#__PURE__*/function(){function FragmentCursor3(fragments,nodeSet2){_classCallCheck(this,FragmentCursor3);this.fragments=fragments;this.nodeSet=nodeSet2;this.i=0;this.fragment=null;this.safeFrom=-1;this.safeTo=-1;this.trees=[];this.start=[];this.index=[];this.nextFragment();}_createClass(FragmentCursor3,[{key:"nextFragment",value:function nextFragment(){var fr=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(fr){this.safeFrom=fr.openStart?cutAt(fr.tree,fr.from+fr.offset,1)-fr.offset:fr.from;this.safeTo=fr.openEnd?cutAt(fr.tree,fr.to+fr.offset,-1)-fr.offset:fr.to;while(this.trees.length){this.trees.pop();this.start.pop();this.index.pop();}this.trees.push(fr.tree);this.start.push(-fr.offset);this.index.push(0);this.nextStart=this.safeFrom;}else{this.nextStart=1e9;}}},{key:"nodeAt",value:function nodeAt(pos){if(pos<this.nextStart)return null;while(this.fragment&&this.safeTo<=pos){this.nextFragment();}if(!this.fragment)return null;for(;;){var last=this.trees.length-1;if(last<0){this.nextFragment();return null;}var top2=this.trees[last],index=this.index[last];if(index==top2.children.length){this.trees.pop();this.start.pop();this.index.pop();continue;}var next=top2.children[index];var start=this.start[last]+top2.positions[index];if(start>pos){this.nextStart=start;return null;}if(next instanceof Tree){if(start==pos){if(start<this.safeFrom)return null;var end=start+next.length;if(end<=this.safeTo){var lookAhead=next.prop(NodeProp.lookAhead);if(!lookAhead||end+lookAhead<this.fragment.to)return next;}}this.index[last]++;if(start+next.length>=Math.max(this.safeFrom,pos)){this.trees.push(next);this.start.push(start);this.index.push(0);}}else{this.index[last]++;this.nextStart=start+next.length;}}}}]);return FragmentCursor3;}();var TokenCache=/*#__PURE__*/function(){function TokenCache(parser5,stream){_classCallCheck(this,TokenCache);this.stream=stream;this.tokens=[];this.mainToken=null;this.actions=[];this.tokens=parser5.tokenizers.map(function(_){return new CachedToken();});}_createClass(TokenCache,[{key:"getActions",value:function getActions(stack){var actionIndex=0;var main=null;var parser5=stack.p.parser,tokenizers=parser5.tokenizers;var mask=parser5.stateSlot(stack.state,3);var context=stack.curContext?stack.curContext.hash:0;var lookAhead=0;for(var _i200=0;_i200<tokenizers.length;_i200++){if((1<<_i200&mask)==0)continue;var tokenizer=tokenizers[_i200],token=this.tokens[_i200];if(main&&!tokenizer.fallback)continue;if(tokenizer.contextual||token.start!=stack.pos||token.mask!=mask||token.context!=context){this.updateCachedToken(token,tokenizer,stack);token.mask=mask;token.context=context;}if(token.lookAhead>token.end+25)lookAhead=Math.max(token.lookAhead,lookAhead);if(token.value!=0){var startIndex=actionIndex;if(token.extended>-1)actionIndex=this.addActions(stack,token.extended,token.end,actionIndex);actionIndex=this.addActions(stack,token.value,token.end,actionIndex);if(!tokenizer.extend){main=token;if(actionIndex>startIndex)break;}}}while(this.actions.length>actionIndex){this.actions.pop();}if(lookAhead)stack.setLookAhead(lookAhead);if(!main&&stack.pos==this.stream.end){main=new CachedToken();main.value=stack.p.parser.eofTerm;main.start=main.end=stack.pos;actionIndex=this.addActions(stack,main.value,main.end,actionIndex);}this.mainToken=main;return this.actions;}},{key:"getMainToken",value:function getMainToken(stack){if(this.mainToken)return this.mainToken;var main=new CachedToken(),pos=stack.pos,p=stack.p;main.start=pos;main.end=Math.min(pos+1,p.stream.end);main.value=pos==p.stream.end?p.parser.eofTerm:0;return main;}},{key:"updateCachedToken",value:function updateCachedToken(token,tokenizer,stack){var start=this.stream.clipPos(stack.pos);tokenizer.token(this.stream.reset(start,token),stack);if(token.value>-1){var parser5=stack.p.parser;for(var _i201=0;_i201<parser5.specialized.length;_i201++){if(parser5.specialized[_i201]==token.value){var result=parser5.specializers[_i201](this.stream.read(token.start,token.end),stack);if(result>=0&&stack.p.parser.dialect.allows(result>>1)){if((result&1)==0)token.value=result>>1;else token.extended=result>>1;break;}}}}else{token.value=0;token.end=this.stream.clipPos(start+1);}}},{key:"putAction",value:function putAction(action,token,end,index){for(var _i202=0;_i202<index;_i202+=3){if(this.actions[_i202]==action)return index;}this.actions[index++]=action;this.actions[index++]=token;this.actions[index++]=end;return index;}},{key:"addActions",value:function addActions(stack,token,end,index){var state=stack.state,parser5=stack.p.parser,data2=parser5.data;for(var set=0;set<2;set++){for(var _i203=parser5.stateSlot(state,set?2:1);;_i203+=3){if(data2[_i203]==65535){if(data2[_i203+1]==1){_i203=pair(data2,_i203+2);}else{if(index==0&&data2[_i203+1]==2)index=this.putAction(pair(data2,_i203+2),token,end,index);break;}}if(data2[_i203]==token)index=this.putAction(pair(data2,_i203+1),token,end,index);}}return index;}}]);return TokenCache;}();var Parse2=/*#__PURE__*/function(){function Parse2(parser5,input,fragments,ranges){_classCallCheck(this,Parse2);this.parser=parser5;this.input=input;this.ranges=ranges;this.recovering=0;this.nextStackID=9812;this.minStackPos=0;this.reused=[];this.stoppedAt=null;this.lastBigReductionStart=-1;this.lastBigReductionSize=0;this.bigReductionCount=0;this.stream=new InputStream(input,ranges);this.tokens=new TokenCache(parser5,this.stream);this.topTerm=parser5.top[1];var from=ranges[0].from;this.stacks=[Stack.start(this,parser5.top[0],from)];this.fragments=fragments.length&&this.stream.end-from>parser5.bufferLength*4?new FragmentCursor3(fragments,parser5.nodeSet):null;}_createClass(Parse2,[{key:"parsedPos",get:function get(){return this.minStackPos;}},{key:"advance",value:function advance(){var stacks=this.stacks,pos=this.minStackPos;var newStacks=this.stacks=[];var stopped,stoppedTokens;if(this.bigReductionCount>300&&stacks.length==1){var _stacks=_slicedToArray(stacks,1),s=_stacks[0];while(s.forceReduce()&&s.stack.length&&s.stack[s.stack.length-2]>=this.lastBigReductionStart){}this.bigReductionCount=this.lastBigReductionSize=0;}for(var _i204=0;_i204<stacks.length;_i204++){var stack=stacks[_i204];for(;;){this.tokens.mainToken=null;if(stack.pos>pos){newStacks.push(stack);}else if(this.advanceStack(stack,newStacks,stacks)){continue;}else{if(!stopped){stopped=[];stoppedTokens=[];}stopped.push(stack);var tok=this.tokens.getMainToken(stack);stoppedTokens.push(tok.value,tok.end);}break;}}if(!newStacks.length){var finished=stopped&&findFinished(stopped);if(finished){if(verbose)console.log("Finish with "+this.stackID(finished));return this.stackToTree(finished);}if(this.parser.strict){if(verbose&&stopped)console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none"));throw new SyntaxError("No parse at "+pos);}if(!this.recovering)this.recovering=5;}if(this.recovering&&stopped){var _finished=this.stoppedAt!=null&&stopped[0].pos>this.stoppedAt?stopped[0]:this.runRecovery(stopped,stoppedTokens,newStacks);if(_finished){if(verbose)console.log("Force-finish "+this.stackID(_finished));return this.stackToTree(_finished.forceAll());}}if(this.recovering){var maxRemaining=this.recovering==1?1:this.recovering*3;if(newStacks.length>maxRemaining){newStacks.sort(function(a,b){return b.score-a.score;});while(newStacks.length>maxRemaining){newStacks.pop();}}if(newStacks.some(function(s){return s.reducePos>pos;}))this.recovering--;}else if(newStacks.length>1){outer:for(var _i205=0;_i205<newStacks.length-1;_i205++){var _stack=newStacks[_i205];for(var j=_i205+1;j<newStacks.length;j++){var other=newStacks[j];if(_stack.sameState(other)||_stack.buffer.length>500&&other.buffer.length>500){if((_stack.score-other.score||_stack.buffer.length-other.buffer.length)>0){newStacks.splice(j--,1);}else{newStacks.splice(_i205--,1);continue outer;}}}}if(newStacks.length>12)newStacks.splice(12,newStacks.length-12);}this.minStackPos=newStacks[0].pos;for(var _i206=1;_i206<newStacks.length;_i206++){if(newStacks[_i206].pos<this.minStackPos)this.minStackPos=newStacks[_i206].pos;}return null;}},{key:"stopAt",value:function stopAt(pos){if(this.stoppedAt!=null&&this.stoppedAt<pos)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=pos;}},{key:"advanceStack",value:function advanceStack(stack,stacks,split){var start=stack.pos,parser5=this.parser;var base2=verbose?this.stackID(stack)+" -> ":"";if(this.stoppedAt!=null&&start>this.stoppedAt)return stack.forceReduce()?stack:null;if(this.fragments){var strictCx=stack.curContext&&stack.curContext.tracker.strict,cxHash=strictCx?stack.curContext.hash:0;for(var cached=this.fragments.nodeAt(start);cached;){var match=this.parser.nodeSet.types[cached.type.id]==cached.type?parser5.getGoto(stack.state,cached.type.id):-1;if(match>-1&&cached.length&&(!strictCx||(cached.prop(NodeProp.contextHash)||0)==cxHash)){stack.useNode(cached,match);if(verbose)console.log(base2+this.stackID(stack)+" (via reuse of ".concat(parser5.getName(cached.type.id),")"));return true;}if(!(cached instanceof Tree)||cached.children.length==0||cached.positions[0]>0)break;var inner=cached.children[0];if(inner instanceof Tree&&cached.positions[0]==0)cached=inner;else break;}}var defaultReduce=parser5.stateSlot(stack.state,4);if(defaultReduce>0){stack.reduce(defaultReduce);if(verbose)console.log(base2+this.stackID(stack)+" (via always-reduce ".concat(parser5.getName(defaultReduce&65535),")"));return true;}if(stack.stack.length>=8400){while(stack.stack.length>6e3&&stack.forceReduce()){}}var actions=this.tokens.getActions(stack);for(var _i207=0;_i207<actions.length;){var action=actions[_i207++],term=actions[_i207++],end=actions[_i207++];var last=_i207==actions.length||!split;var localStack=last?stack:stack.split();var main=this.tokens.mainToken;localStack.apply(action,term,main?main.start:localStack.pos,end);if(verbose)console.log(base2+this.stackID(localStack)+" (via ".concat((action&65536)==0?"shift":"reduce of ".concat(parser5.getName(action&65535))," for ").concat(parser5.getName(term)," @ ").concat(start).concat(localStack==stack?"":", split",")"));if(last)return true;else if(localStack.pos>start)stacks.push(localStack);else split.push(localStack);}return false;}},{key:"advanceFully",value:function advanceFully(stack,newStacks){var pos=stack.pos;for(;;){if(!this.advanceStack(stack,null,null))return false;if(stack.pos>pos){pushStackDedup(stack,newStacks);return true;}}}},{key:"runRecovery",value:function runRecovery(stacks,tokens,newStacks){var finished=null,restarted=false;for(var _i208=0;_i208<stacks.length;_i208++){var stack=stacks[_i208],token=tokens[_i208<<1],tokenEnd=tokens[(_i208<<1)+1];var base2=verbose?this.stackID(stack)+" -> ":"";if(stack.deadEnd){if(restarted)continue;restarted=true;stack.restart();if(verbose)console.log(base2+this.stackID(stack)+" (restarted)");var done=this.advanceFully(stack,newStacks);if(done)continue;}var force=stack.split(),forceBase=base2;for(var j=0;force.forceReduce()&&j<10;j++){if(verbose)console.log(forceBase+this.stackID(force)+" (via force-reduce)");var _done=this.advanceFully(force,newStacks);if(_done)break;if(verbose)forceBase=this.stackID(force)+" -> ";}var _iterator265=_createForOfIteratorHelper(stack.recoverByInsert(token)),_step265;try{for(_iterator265.s();!(_step265=_iterator265.n()).done;){var insert2=_step265.value;if(verbose)console.log(base2+this.stackID(insert2)+" (via recover-insert)");this.advanceFully(insert2,newStacks);}}catch(err){_iterator265.e(err);}finally{_iterator265.f();}if(this.stream.end>stack.pos){if(tokenEnd==stack.pos){tokenEnd++;token=0;}stack.recoverByDelete(token,tokenEnd);if(verbose)console.log(base2+this.stackID(stack)+" (via recover-delete ".concat(this.parser.getName(token),")"));pushStackDedup(stack,newStacks);}else if(!finished||finished.score<stack.score){finished=stack;}}return finished;}},{key:"stackToTree",value:function stackToTree(stack){stack.close();return Tree.build({buffer:StackBufferCursor.create(stack),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:stack.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm});}},{key:"stackID",value:function stackID(stack){var id2=(stackIDs||(stackIDs=/* @__PURE__ */new WeakMap())).get(stack);if(!id2)stackIDs.set(stack,id2=String.fromCodePoint(this.nextStackID++));return id2+stack;}}]);return Parse2;}();function pushStackDedup(stack,newStacks){for(var _i209=0;_i209<newStacks.length;_i209++){var other=newStacks[_i209];if(other.pos==stack.pos&&other.sameState(stack)){if(newStacks[_i209].score<stack.score)newStacks[_i209]=stack;return;}}newStacks.push(stack);}var Dialect=/*#__PURE__*/function(){function Dialect(source,flags,disabled){_classCallCheck(this,Dialect);this.source=source;this.flags=flags;this.disabled=disabled;}_createClass(Dialect,[{key:"allows",value:function allows(term){return!this.disabled||this.disabled[term]==0;}}]);return Dialect;}();var id=function id(x){return x;};var ContextTracker=/*#__PURE__*/_createClass(function ContextTracker(spec){_classCallCheck(this,ContextTracker);this.start=spec.start;this.shift=spec.shift||id;this.reduce=spec.reduce||id;this.reuse=spec.reuse||id;this.hash=spec.hash||function(){return 0;};this.strict=spec.strict!==false;});var LRParser=/*#__PURE__*/function(_Parser4){_inherits(LRParser,_Parser4);var _super45=_createSuper(LRParser);function LRParser(spec){var _this102$nodeSet;var _this102;_classCallCheck(this,LRParser);_this102=_super45.call(this);_this102.wrappers=[];if(spec.version!=14)throw new RangeError("Parser version (".concat(spec.version,") doesn't match runtime version (",14,")"));var nodeNames=spec.nodeNames.split(" ");_this102.minRepeatTerm=nodeNames.length;for(var _i210=0;_i210<spec.repeatNodeCount;_i210++){nodeNames.push("");}var topTerms=Object.keys(spec.topRules).map(function(r){return spec.topRules[r][1];});var nodeProps=[];for(var _i211=0;_i211<nodeNames.length;_i211++){nodeProps.push([]);}function setProp(nodeID,prop,value){nodeProps[nodeID].push([prop,prop.deserialize(String(value))]);}if(spec.nodeProps){var _iterator266=_createForOfIteratorHelper(spec.nodeProps),_step266;try{for(_iterator266.s();!(_step266=_iterator266.n()).done;){var propSpec=_step266.value;var prop=propSpec[0];if(typeof prop=="string")prop=NodeProp[prop];for(var _i212=1;_i212<propSpec.length;){var next=propSpec[_i212++];if(next>=0){setProp(next,prop,propSpec[_i212++]);}else{var value=propSpec[_i212+-next];for(var j=-next;j>0;j--){setProp(propSpec[_i212++],prop,value);}_i212++;}}}}catch(err){_iterator266.e(err);}finally{_iterator266.f();}}_this102.nodeSet=new NodeSet(nodeNames.map(function(name2,i){return NodeType.define({name:i>=_this102.minRepeatTerm?void 0:name2,id:i,props:nodeProps[i],top:topTerms.indexOf(i)>-1,error:i==0,skipped:spec.skippedNodes&&spec.skippedNodes.indexOf(i)>-1});}));if(spec.propSources)_this102.nodeSet=(_this102$nodeSet=_this102.nodeSet).extend.apply(_this102$nodeSet,_toConsumableArray(spec.propSources));_this102.strict=false;_this102.bufferLength=DefaultBufferLength;var tokenArray=decodeArray(spec.tokenData);_this102.context=spec.context;_this102.specializerSpecs=spec.specialized||[];_this102.specialized=new Uint16Array(_this102.specializerSpecs.length);for(var _i213=0;_i213<_this102.specializerSpecs.length;_i213++){_this102.specialized[_i213]=_this102.specializerSpecs[_i213].term;}_this102.specializers=_this102.specializerSpecs.map(getSpecializer);_this102.states=decodeArray(spec.states,Uint32Array);_this102.data=decodeArray(spec.stateData);_this102["goto"]=decodeArray(spec["goto"]);_this102.maxTerm=spec.maxTerm;_this102.tokenizers=spec.tokenizers.map(function(value){return typeof value=="number"?new TokenGroup(tokenArray,value):value;});_this102.topRules=spec.topRules;_this102.dialects=spec.dialects||{};_this102.dynamicPrecedences=spec.dynamicPrecedences||null;_this102.tokenPrecTable=spec.tokenPrec;_this102.termNames=spec.termNames||null;_this102.maxNode=_this102.nodeSet.types.length-1;_this102.dialect=_this102.parseDialect();_this102.top=_this102.topRules[Object.keys(_this102.topRules)[0]];return _this102;}_createClass(LRParser,[{key:"createParse",value:function createParse(input,fragments,ranges){var parse=new Parse2(this,input,fragments,ranges);var _iterator267=_createForOfIteratorHelper(this.wrappers),_step267;try{for(_iterator267.s();!(_step267=_iterator267.n()).done;){var w=_step267.value;parse=w(parse,input,fragments,ranges);}}catch(err){_iterator267.e(err);}finally{_iterator267.f();}return parse;}},{key:"getGoto",value:function getGoto(state,term){var loose=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var table=this["goto"];if(term>=table[0])return-1;for(var pos=table[term+1];;){var groupTag=table[pos++],last=groupTag&1;var target=table[pos++];if(last&&loose)return target;for(var end=pos+(groupTag>>1);pos<end;pos++){if(table[pos]==state)return target;}if(last)return-1;}}},{key:"hasAction",value:function hasAction(state,terminal){var data2=this.data;for(var set=0;set<2;set++){for(var _i214=this.stateSlot(state,set?2:1),next;;_i214+=3){if((next=data2[_i214])==65535){if(data2[_i214+1]==1)next=data2[_i214=pair(data2,_i214+2)];else if(data2[_i214+1]==2)return pair(data2,_i214+2);else break;}if(next==terminal||next==0)return pair(data2,_i214+1);}}return 0;}},{key:"stateSlot",value:function stateSlot(state,slot){return this.states[state*6+slot];}},{key:"stateFlag",value:function stateFlag(state,flag){return(this.stateSlot(state,0)&flag)>0;}},{key:"validAction",value:function validAction(state,action){return!!this.allActions(state,function(a){return a==action?true:null;});}},{key:"allActions",value:function allActions(state,action){var deflt=this.stateSlot(state,4);var result=deflt?action(deflt):void 0;for(var _i215=this.stateSlot(state,1);result==null;_i215+=3){if(this.data[_i215]==65535){if(this.data[_i215+1]==1)_i215=pair(this.data,_i215+2);else break;}result=action(pair(this.data,_i215+1));}return result;}},{key:"nextStates",value:function nextStates(state){var _this103=this;var result=[];for(var _i216=this.stateSlot(state,1);;_i216+=3){if(this.data[_i216]==65535){if(this.data[_i216+1]==1)_i216=pair(this.data,_i216+2);else break;}if((this.data[_i216+2]&65536>>16)==0){(function(){var value=_this103.data[_i216+1];if(!result.some(function(v,i2){return i2&1&&v==value;}))result.push(_this103.data[_i216],value);})();}}return result;}},{key:"configure",value:function configure(config2){var _this$nodeSet;var copy=Object.assign(Object.create(LRParser.prototype),this);if(config2.props)copy.nodeSet=(_this$nodeSet=this.nodeSet).extend.apply(_this$nodeSet,_toConsumableArray(config2.props));if(config2.top){var info=this.topRules[config2.top];if(!info)throw new RangeError("Invalid top rule name ".concat(config2.top));copy.top=info;}if(config2.tokenizers)copy.tokenizers=this.tokenizers.map(function(t2){var found=config2.tokenizers.find(function(r){return r.from==t2;});return found?found.to:t2;});if(config2.specializers){copy.specializers=this.specializers.slice();copy.specializerSpecs=this.specializerSpecs.map(function(s,i){var found=config2.specializers.find(function(r){return r.from==s.external;});if(!found)return s;var spec=Object.assign(Object.assign({},s),{external:found.to});copy.specializers[i]=getSpecializer(spec);return spec;});}if(config2.contextTracker)copy.context=config2.contextTracker;if(config2.dialect)copy.dialect=this.parseDialect(config2.dialect);if(config2.strict!=null)copy.strict=config2.strict;if(config2.wrap)copy.wrappers=copy.wrappers.concat(config2.wrap);if(config2.bufferLength!=null)copy.bufferLength=config2.bufferLength;return copy;}},{key:"hasWrappers",value:function hasWrappers(){return this.wrappers.length>0;}},{key:"getName",value:function getName(term){return this.termNames?this.termNames[term]:String(term<=this.maxNode&&this.nodeSet.types[term].name||term);}},{key:"eofTerm",get:function get(){return this.maxNode+1;}},{key:"topNode",get:function get(){return this.nodeSet.types[this.top[1]];}},{key:"dynamicPrecedence",value:function dynamicPrecedence(term){var prec2=this.dynamicPrecedences;return prec2==null?0:prec2[term]||0;}},{key:"parseDialect",value:function parseDialect(dialect){var values2=Object.keys(this.dialects),flags=values2.map(function(){return false;});if(dialect){var _iterator268=_createForOfIteratorHelper(dialect.split(" ")),_step268;try{for(_iterator268.s();!(_step268=_iterator268.n()).done;){var part=_step268.value;var id2=values2.indexOf(part);if(id2>=0)flags[id2]=true;}}catch(err){_iterator268.e(err);}finally{_iterator268.f();}}var disabled=null;for(var _i217=0;_i217<values2.length;_i217++){if(!flags[_i217]){for(var j=this.dialects[values2[_i217]],_id;(_id=this.data[j++])!=65535;){(disabled||(disabled=new Uint8Array(this.maxTerm+1)))[_id]=1;}}}return new Dialect(dialect,flags,disabled);}}],[{key:"deserialize",value:function deserialize(spec){return new LRParser(spec);}}]);return LRParser;}(Parser);function pair(data2,off){return data2[off]|data2[off+1]<<16;}function findFinished(stacks){var best=null;var _iterator269=_createForOfIteratorHelper(stacks),_step269;try{for(_iterator269.s();!(_step269=_iterator269.n()).done;){var stack=_step269.value;var stopped=stack.p.stoppedAt;if((stack.pos==stack.p.stream.end||stopped!=null&&stack.pos>stopped)&&stack.p.parser.stateFlag(stack.state,2)&&(!best||best.score<stack.score))best=stack;}}catch(err){_iterator269.e(err);}finally{_iterator269.f();}return best;}function getSpecializer(spec){if(spec.external){var mask=spec.extend?1:0;return function(value,stack){return spec.external(value,stack)<<1|mask;};}return spec.get;}// ../node_modules/@lezer/html/dist/index.js
var scriptText=54;var StartCloseScriptTag=1;var styleText=55;var StartCloseStyleTag=2;var textareaText=56;var StartCloseTextareaTag=3;var EndTag=4;var SelfClosingEndTag=5;var StartTag=6;var StartScriptTag=7;var StartStyleTag=8;var StartTextareaTag=9;var StartSelfClosingTag=10;var StartCloseTag=11;var NoMatchStartCloseTag=12;var MismatchedStartCloseTag=13;var missingCloseTag=57;var IncompleteCloseTag=14;var commentContent$1=58;var Element2=20;var TagName=22;var Attribute=23;var AttributeName=24;var AttributeValue=26;var UnquotedAttributeValue=27;var ScriptText=28;var StyleText=31;var TextareaText=34;var OpenTag=36;var CloseTag=37;var Dialect_noMatch=0;var Dialect_selfClosing=1;var selfClosers={area:true,base:true,br:true,col:true,command:true,embed:true,frame:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true,menuitem:true};var implicitlyClosed={dd:true,li:true,optgroup:true,option:true,p:true,rp:true,rt:true,tbody:true,td:true,tfoot:true,th:true,tr:true};var closeOnOpen={dd:{dd:true,dt:true},dt:{dd:true,dt:true},li:{li:true},option:{option:true,optgroup:true},optgroup:{optgroup:true},p:{address:true,article:true,aside:true,blockquote:true,dir:true,div:true,dl:true,fieldset:true,footer:true,form:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,header:true,hgroup:true,hr:true,menu:true,nav:true,ol:true,p:true,pre:true,section:true,table:true,ul:true},rp:{rp:true,rt:true},rt:{rp:true,rt:true},tbody:{tbody:true,tfoot:true},td:{td:true,th:true},tfoot:{tbody:true},th:{td:true,th:true},thead:{tbody:true,tfoot:true},tr:{tr:true}};function nameChar(ch){return ch==45||ch==46||ch==58||ch>=65&&ch<=90||ch==95||ch>=97&&ch<=122||ch>=161;}function isSpace(ch){return ch==9||ch==10||ch==13||ch==32;}var cachedName=null;var cachedInput=null;var cachedPos=0;function tagNameAfter(input,offset){var pos=input.pos+offset;if(cachedPos==pos&&cachedInput==input)return cachedName;var next=input.peek(offset);while(isSpace(next)){next=input.peek(++offset);}var name2="";for(;;){if(!nameChar(next))break;name2+=String.fromCharCode(next);next=input.peek(++offset);}cachedInput=input;cachedPos=pos;return cachedName=name2?name2.toLowerCase():next==question||next==bang?void 0:null;}var lessThan=60;var greaterThan=62;var slash=47;var question=63;var bang=33;var dash=45;function ElementContext(name2,parent){this.name=name2;this.parent=parent;this.hash=parent?parent.hash:0;for(var _i218=0;_i218<name2.length;_i218++){this.hash+=(this.hash<<4)+name2.charCodeAt(_i218)+(name2.charCodeAt(_i218)<<8);}}var startTagTerms=[StartTag,StartSelfClosingTag,StartScriptTag,StartStyleTag,StartTextareaTag];var elementContext=new ContextTracker({start:null,shift:function shift(context,term,stack,input){return startTagTerms.indexOf(term)>-1?new ElementContext(tagNameAfter(input,1)||"",context):context;},reduce:function reduce(context,term){return term==Element2&&context?context.parent:context;},reuse:function reuse(context,node,stack,input){var type=node.type.id;return type==StartTag||type==OpenTag?new ElementContext(tagNameAfter(input,1)||"",context):context;},hash:function hash(context){return context?context.hash:0;},strict:false});var tagStart=new ExternalTokenizer(function(input,stack){if(input.next!=lessThan){if(input.next<0&&stack.context)input.acceptToken(missingCloseTag);return;}input.advance();var close=input.next==slash;if(close)input.advance();var name2=tagNameAfter(input,0);if(name2===void 0)return;if(!name2)return input.acceptToken(close?IncompleteCloseTag:StartTag);var parent=stack.context?stack.context.name:null;if(close){if(name2==parent)return input.acceptToken(StartCloseTag);if(parent&&implicitlyClosed[parent])return input.acceptToken(missingCloseTag,-2);if(stack.dialectEnabled(Dialect_noMatch))return input.acceptToken(NoMatchStartCloseTag);for(var cx=stack.context;cx;cx=cx.parent){if(cx.name==name2)return;}input.acceptToken(MismatchedStartCloseTag);}else{if(name2=="script")return input.acceptToken(StartScriptTag);if(name2=="style")return input.acceptToken(StartStyleTag);if(name2=="textarea")return input.acceptToken(StartTextareaTag);if(selfClosers.hasOwnProperty(name2))return input.acceptToken(StartSelfClosingTag);if(parent&&closeOnOpen[parent]&&closeOnOpen[parent][name2])input.acceptToken(missingCloseTag,-1);else input.acceptToken(StartTag);}},{contextual:true});var commentContent=new ExternalTokenizer(function(input){for(var dashes=0,_i219=0;;_i219++){if(input.next<0){if(_i219)input.acceptToken(commentContent$1);break;}if(input.next==dash){dashes++;}else if(input.next==greaterThan&&dashes>=2){if(_i219>=3)input.acceptToken(commentContent$1,-2);break;}else{dashes=0;}input.advance();}});function inForeignElement(context){for(;context;context=context.parent){if(context.name=="svg"||context.name=="math")return true;}return false;}var endTag=new ExternalTokenizer(function(input,stack){if(input.next==slash&&input.peek(1)==greaterThan){var selfClosing=stack.dialectEnabled(Dialect_selfClosing)||inForeignElement(stack.context);input.acceptToken(selfClosing?SelfClosingEndTag:EndTag,2);}else if(input.next==greaterThan){input.acceptToken(EndTag,1);}});function contentTokenizer(tag,textToken,endToken){var lastState=2+tag.length;return new ExternalTokenizer(function(input){for(var state=0,matchedLen=0,_i220=0;;_i220++){if(input.next<0){if(_i220)input.acceptToken(textToken);break;}if(state==0&&input.next==lessThan||state==1&&input.next==slash||state>=2&&state<lastState&&input.next==tag.charCodeAt(state-2)){state++;matchedLen++;}else if((state==2||state==lastState)&&isSpace(input.next)){matchedLen++;}else if(state==lastState&&input.next==greaterThan){if(_i220>matchedLen)input.acceptToken(textToken,-matchedLen);else input.acceptToken(endToken,-(matchedLen-2));break;}else if((input.next==10||input.next==13)&&_i220){input.acceptToken(textToken,1);break;}else{state=matchedLen=0;}input.advance();}});}var scriptTokens=contentTokenizer("script",scriptText,StartCloseScriptTag);var styleTokens=contentTokenizer("style",styleText,StartCloseStyleTag);var textareaTokens=contentTokenizer("textarea",textareaText,StartCloseTextareaTag);var htmlHighlighting=styleTags({"Text RawText":tags.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":tags.angleBracket,TagName:tags.tagName,"MismatchedCloseTag/TagName":[tags.tagName,tags.invalid],AttributeName:tags.attributeName,"AttributeValue UnquotedAttributeValue":tags.attributeValue,Is:tags.definitionOperator,"EntityReference CharacterReference":tags.character,Comment:tags.blockComment,ProcessingInst:tags.processingInstruction,DoctypeDecl:tags.documentMeta});var parser2=LRParser.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%WQ&rO,59fO%`Q&rO,59iO%hQ&rO,59lO%sQ&rO,59nOOOa'#D^'#D^O%{OaO'#CxO&WOaO,59[OOOb'#D_'#D_O&`ObO'#C{O&kObO,59[OOOd'#D`'#D`O&sOdO'#DOO'OOdO,59[OOO`'#Da'#DaO'WO!rO,59[O'_Q#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'dO$fO,59oOOO`,59o,59oO'lQ#|O,59qO'qQ#|O,59rOOO`-E7W-E7WO'vQ&rO'#CsOOQW'#DZ'#DZO(UQ&rO1G.wOOOa1G.w1G.wO(^Q&rO1G/QOOOb1G/Q1G/QO(fQ&rO1G/TOOOd1G/T1G/TO(nQ&rO1G/WOOO`1G/W1G/WOOO`1G/Y1G/YO(yQ&rO1G/YOOOa-E7[-E7[O)RQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)WQ#tO'#C|OOOd-E7^-E7^O)]Q#tO'#DPOOO`-E7_-E7_O)bQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O)gQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rOOO`7+$t7+$tO)rQ#|O,59eO)wQ#|O,59hO)|Q#|O,59kOOO`1G/X1G/XO*RO7[O'#CvO*dOMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O*uO7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+WOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:"+s~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OhyO~OS!OOhyO~OS!QOhyO~OS!SOT!TOhyO~OS!TOhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXhgXTgX~OS!fOhyO~OS!gOhyO~OS!hOhyO~OS!iOT!jOhyO~OS!jOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~","goto":"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{}!P!R!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ}bQ!PcQ!RdQ!UeZ!e{}!P!R!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:"\u26A0 StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:elementContext,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"]],propSources:[htmlHighlighting],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebhSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXhSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vchS`P!a`!cpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WihSkWc!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zbkWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOa!R!R7tP;=`<%l7S!Z8OYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{ihSkWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbhSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QchSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXhSa!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TakWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOb!R!RAwP;=`<%lAY!ZBRYkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbhSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbhSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXhSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYlhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_khS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_X`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!a`!cpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!a`!cp!dPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!a`!cpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!a`!cpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!a`!cpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!a`!cpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!a`!cpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!a`!cpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!a`!cpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!cpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO{PP!-nP;=`<%l!-Sq!-xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!a`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!a`!cpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!a`!cpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!a`!cpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!a`!cpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!a`!cpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!a`!cpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!cpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOxPP!7TP;=`<%l!6Vq!7]V!cpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!a`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!a`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[scriptTokens,styleTokens,textareaTokens,endTag,tagStart,commentContent,0,1,2,3,4,5],topRules:{"Document":[0,15]},dialects:{noMatch:0,selfClosing:485},tokenPrec:487});function getAttrs2(openTag,input){var attrs=/* @__PURE__ */Object.create(null);var _iterator270=_createForOfIteratorHelper(openTag.getChildren(Attribute)),_step270;try{for(_iterator270.s();!(_step270=_iterator270.n()).done;){var att=_step270.value;var _name7=att.getChild(AttributeName),value=att.getChild(AttributeValue)||att.getChild(UnquotedAttributeValue);if(_name7)attrs[input.read(_name7.from,_name7.to)]=!value?"":value.type.id==AttributeValue?input.read(value.from+1,value.to-1):input.read(value.from,value.to);}}catch(err){_iterator270.e(err);}finally{_iterator270.f();}return attrs;}function findTagName(openTag,input){var tagNameNode=openTag.getChild(TagName);return tagNameNode?input.read(tagNameNode.from,tagNameNode.to):" ";}function maybeNest(node,input,tags3){var attrs;var _iterator271=_createForOfIteratorHelper(tags3),_step271;try{for(_iterator271.s();!(_step271=_iterator271.n()).done;){var tag=_step271.value;if(!tag.attrs||tag.attrs(attrs||(attrs=getAttrs2(node.node.parent.firstChild,input))))return{parser:tag.parser};}}catch(err){_iterator271.e(err);}finally{_iterator271.f();}return null;}function configureNesting(){var tags3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var attributes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var script=[],style=[],textarea=[],other=[];var _iterator272=_createForOfIteratorHelper(tags3),_step272;try{for(_iterator272.s();!(_step272=_iterator272.n()).done;){var tag=_step272.value;var array=tag.tag=="script"?script:tag.tag=="style"?style:tag.tag=="textarea"?textarea:other;array.push(tag);}}catch(err){_iterator272.e(err);}finally{_iterator272.f();}var attrs=attributes.length?/* @__PURE__ */Object.create(null):null;var _iterator273=_createForOfIteratorHelper(attributes),_step273;try{for(_iterator273.s();!(_step273=_iterator273.n()).done;){var attr=_step273.value;(attrs[attr.name]||(attrs[attr.name]=[])).push(attr);}}catch(err){_iterator273.e(err);}finally{_iterator273.f();}return parseMixed(function(node,input){var id2=node.type.id;if(id2==ScriptText)return maybeNest(node,input,script);if(id2==StyleText)return maybeNest(node,input,style);if(id2==TextareaText)return maybeNest(node,input,textarea);if(id2==Element2&&other.length){var n=node.node,open=n.firstChild,tagName=open&&findTagName(open,input),attrs2;if(tagName){var _iterator274=_createForOfIteratorHelper(other),_step274;try{for(_iterator274.s();!(_step274=_iterator274.n()).done;){var tag=_step274.value;if(tag.tag==tagName&&(!tag.attrs||tag.attrs(attrs2||(attrs2=getAttrs2(n,input))))){var close=n.lastChild;var to=close.type.id==CloseTag?close.from:n.to;if(to>open.to)return{parser:tag.parser,overlay:[{from:open.to,to:to}]};}}}catch(err){_iterator274.e(err);}finally{_iterator274.f();}}}if(attrs&&id2==Attribute){var _n2=node.node,nameNode;if(nameNode=_n2.firstChild){var matches=attrs[input.read(nameNode.from,nameNode.to)];if(matches){var _iterator275=_createForOfIteratorHelper(matches),_step275;try{for(_iterator275.s();!(_step275=_iterator275.n()).done;){var attr=_step275.value;if(attr.tagName&&attr.tagName!=findTagName(_n2.parent,input))continue;var value=_n2.lastChild;if(value.type.id==AttributeValue){var from=value.from+1;var last=value.lastChild,_to3=value.to-(last&&last.isError?0:1);if(_to3>from)return{parser:attr.parser,overlay:[{from:from,to:_to3}]};}else if(value.type.id==UnquotedAttributeValue){return{parser:attr.parser,overlay:[{from:value.from,to:value.to}]};}}}catch(err){_iterator275.e(err);}finally{_iterator275.f();}}}}return null;});}// ../node_modules/@lezer/css/dist/index.js
var descendantOp=96;var Unit=1;var callee=97;var identifier=98;var VariableName=2;var space2=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];var colon=58;var parenL=40;var underscore=95;var bracketL=91;var dash2=45;var period=46;var hash=35;var percent=37;var ampersand=38;var backslash=92;var newline=10;function isAlpha(ch){return ch>=65&&ch<=90||ch>=97&&ch<=122||ch>=161;}function isDigit(ch){return ch>=48&&ch<=57;}var identifiers=new ExternalTokenizer(function(input,stack){for(var inside2=false,dashes=0,_i221=0;;_i221++){var next=input.next;if(isAlpha(next)||next==dash2||next==underscore||inside2&&isDigit(next)){if(!inside2&&(next!=dash2||_i221>0))inside2=true;if(dashes===_i221&&next==dash2)dashes++;input.advance();}else if(next==backslash&&input.peek(1)!=newline){input.advance();if(input.next>-1)input.advance();inside2=true;}else{if(inside2)input.acceptToken(next==parenL?callee:dashes==2&&stack.canShift(VariableName)?VariableName:identifier);break;}}});var descendant=new ExternalTokenizer(function(input){if(space2.includes(input.peek(-1))){var next=input.next;if(isAlpha(next)||next==underscore||next==hash||next==period||next==bracketL||next==colon||next==dash2||next==ampersand)input.acceptToken(descendantOp);}});var unitToken=new ExternalTokenizer(function(input){if(!space2.includes(input.peek(-1))){var next=input.next;if(next==percent){input.advance();input.acceptToken(Unit);}if(isAlpha(next)){do{input.advance();}while(isAlpha(input.next));input.acceptToken(Unit);}}});var cssHighlighting=styleTags({"AtKeyword import charset namespace keyframes media supports":tags.definitionKeyword,"from to selector":tags.keyword,NamespaceName:tags.namespace,KeyframeName:tags.labelName,KeyframeRangeName:tags.operatorKeyword,TagName:tags.tagName,ClassName:tags.className,PseudoClassName:tags.constant(tags.className),IdName:tags.labelName,"FeatureName PropertyName":tags.propertyName,AttributeName:tags.attributeName,NumberLiteral:tags.number,KeywordQuery:tags.keyword,UnaryQueryOp:tags.operatorKeyword,"CallTag ValueName":tags.atom,VariableName:tags.variableName,Callee:tags.operatorKeyword,Unit:tags.unit,"UniversalSelector NestingSelector":tags.definitionOperator,MatchOp:tags.compareOperator,"ChildOp SiblingOp, LogicOp":tags.logicOperator,BinOp:tags.arithmeticOperator,Important:tags.modifier,Comment:tags.blockComment,ColorLiteral:tags.color,"ParenthesizedContent StringLiteral":tags.string,":":tags.punctuation,"PseudoOp #":tags.derefOperator,"; ,":tags.separator,"( )":tags.paren,"[ ]":tags.squareBracket,"{ }":tags.brace});var spec_callee={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,"nth-last-of-type":32,dir:32,"host-context":32,url:60,"url-prefix":60,domain:60,regexp:60,selector:134};var spec_AtKeyword={__proto__:null,"@import":114,"@media":138,"@charset":142,"@namespace":146,"@keyframes":152,"@supports":164};var spec_identifier={__proto__:null,not:128,only:128};var parser3=LRParser.deserialize({version:14,states:"9bQYQ[OOO#_Q[OOP#fOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#kQ[O'#CfO$_QXO'#CaO$fQ[O'#ChO$qQ[O'#DPO$vQ[O'#DTOOQP'#Ej'#EjO${QdO'#DeO%gQ[O'#DrO${QdO'#DtO%xQ[O'#DvO&TQ[O'#DyO&]Q[O'#EPO&kQ[O'#EROOQS'#Ei'#EiOOQS'#EU'#EUQYQ[OOO&rQXO'#CdO'gQWO'#DaO'lQWO'#EpO'wQ[O'#EpQOQWOOP(RO#tO'#C_POOO)C@X)C@XOOQP'#Cg'#CgOOQP,59Q,59QO#kQ[O,59QO(^Q[O'#EXO(xQWO,58{O)QQ[O,59SO$qQ[O,59kO$vQ[O,59oO(^Q[O,59sO(^Q[O,59uO(^Q[O,59vO)]Q[O'#D`OOQS,58{,58{OOQP'#Ck'#CkOOQO'#C}'#C}OOQP,59S,59SO)dQWO,59SO)iQWO,59SOOQP'#DR'#DROOQP,59k,59kOOQO'#DV'#DVO)nQ`O,59oOOQS'#Cp'#CpO${QdO'#CqO)vQvO'#CsO+TQtO,5:POOQO'#Cx'#CxO)iQWO'#CwO+iQWO'#CyOOQS'#Em'#EmOOQO'#Dh'#DhO+nQ[O'#DoO+|QWO'#EqO&]Q[O'#DmO,[QWO'#DpOOQO'#Er'#ErO({QWO,5:^O,aQpO,5:`OOQS'#Dx'#DxO,iQWO,5:bO,nQ[O,5:bOOQO'#D{'#D{O,vQWO,5:eO,{QWO,5:kO-TQWO,5:mOOQS-E8S-E8SO${QdO,59{O-]Q[O'#EZO-jQWO,5;[O-jQWO,5;[POOO'#ET'#ETP-uO#tO,58yPOOO,58y,58yOOQP1G.l1G.lO.lQXO,5:sOOQO-E8V-E8VOOQS1G.g1G.gOOQP1G.n1G.nO)dQWO1G.nO)iQWO1G.nOOQP1G/V1G/VO.yQ`O1G/ZO/dQXO1G/_O/zQXO1G/aO0bQXO1G/bO0xQWO,59zO0}Q[O'#DOO1UQdO'#CoOOQP1G/Z1G/ZO${QdO1G/ZO1]QpO,59]OOQS,59_,59_O${QdO,59aO1eQWO1G/kOOQS,59c,59cO1jQ!bO,59eO1rQWO'#DhO1}QWO,5:TO2SQWO,5:ZO&]Q[O,5:VO&]Q[O'#E[O2[QWO,5;]O2gQWO,5:XO(^Q[O,5:[OOQS1G/x1G/xOOQS1G/z1G/zOOQS1G/|1G/|O2xQWO1G/|O2}QdO'#D|OOQS1G0P1G0POOQS1G0V1G0VOOQS1G0X1G0XO3YQtO1G/gOOQO,5:u,5:uO3pQ[O,5:uOOQO-E8X-E8XO3}QWO1G0vPOOO-E8R-E8RPOOO1G.e1G.eOOQP7+$Y7+$YOOQP7+$u7+$uO${QdO7+$uOOQS1G/f1G/fO4YQXO'#EoO4aQWO,59jO4fQtO'#EVO5ZQdO'#ElO5eQWO,59ZO5jQpO7+$uOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%V7+%VO5rQWO1G/PO${QdO1G/oOOQO1G/u1G/uOOQO1G/q1G/qO5wQWO,5:vOOQO-E8Y-E8YO6VQXO1G/vOOQS7+%h7+%hO6^QYO'#CsOOQO'#EO'#EOO6iQ`O'#D}OOQO'#D}'#D}O6tQWO'#E]O6|QdO,5:hOOQS,5:h,5:hO7XQtO'#EYO${QdO'#EYO8VQdO7+%ROOQO7+%R7+%ROOQO1G0a1G0aO8jQpO<<HaO8rQWO,5;ZOOQP1G/U1G/UOOQS-E8T-E8TO${QdO'#EWO8zQWO,5;WOOQT1G.u1G.uOOQP<<Ha<<HaOOQS7+$k7+$kO9SQdO7+%ZOOQO7+%b7+%bOOQO,5:i,5:iO3QQdO'#E^O6tQWO,5:wOOQS,5:w,5:wOOQS-E8Z-E8ZOOQS1G0S1G0SO9ZQtO,5:tOOQS-E8W-E8WOOQO<<Hm<<HmOOQPAN={AN={O:XQdO,5:rOOQO-E8U-E8UOOQO<<Hu<<HuOOQO,5:x,5:xOOQO-E8[-E8[OOQS1G0c1G0c",stateData:":k~O#WOS#XQQ~OUYOXYO]VO^VOtWOxXO!YaO!ZZO!g[O!i]O!k^O!n_O!t`O#URO#_TO~OQfOUYOXYO]VO^VOtWOxXO!YaO!ZZO!g[O!i]O!k^O!n_O!t`O#UeO#_TO~O#R#dP~P!ZO#XjO~O#UlO~O]qO^qOpoOtrOxsO|tO!PvO#SuO#_nO~O!RwO~P#pO`}O#TzO#UyO~O#U!OO~O#U!QO~OQ!ZOb!TOf!ZOh!ZOn!YO#T!WO#U!SO#b!UO~Ob!]O!b!_O!e!`O#U![O!R#eP~Oh!eOn!YO#U!dO~Oh!gO#U!gO~Ob!]O!b!_O!e!`O#U![O~O!W#eP~P%gO]WX]!UX^WXpWXtWXxWX|WX!PWX!RWX#SWX#_WX~O]!lO~O!W!mO#R#dX!Q#dX~O#R#dX!Q#dX~P!ZO#Y!pO#Z!pO#[!rO~OUYOXYO]VO^VOtWOxXO#URO#_TO~OpoO!RwO~O`!yO#TzO#UyO~O!Q#dP~P!ZOb#QO~Ob#RO~Ov#SOz#TO~OP#VObgXjgX!WgX!bgX!egX#UgXagXQgXfgXhgXngXpgX!VgX#RgX#TgX#bgXvgX!QgX~Ob!]Oj#WO!b!_O!e!`O#U![O!W#eP~Ob#ZO~Ob!]O!b!_O!e!`O#U#[O~Op#`O!`#_O!R#eX!W#eX~Ob#cO~Oj#WO!W#eO~O!W#fO~Oh#gOn!YO~O!R#hO~O!RwO!`#_O~O!RwO!W#kO~O!W!}X#R!}X!Q!}X~P!ZO!W!mO#R#da!Q#da~O#Y!pO#Z!pO#[#rO~O]qO^qOtrOxsO|tO!PvO#SuO#_nO~Op!{a!R!{aa!{a~P.QOv#tOz#uO~O]qO^qOtrOxsO#_nO~Op{i|{i!P{i!R{i#S{ia{i~P/ROp}i|}i!P}i!R}i#S}ia}i~P/ROp!Oi|!Oi!P!Oi!R!Oi#S!Oia!Oi~P/RO!Q#vO~Oa#cP~P(^Oa#`P~P${Oa#}Oj#WO~O!W$PO~Oh$QOo$QO~O]!^Xa![X!`![X~O]$RO~Oa$SO!`#_O~Op#`O!R#ea!W#ea~O!`#_Op!aa!R!aa!W!aaa!aa~O!W$XO~O!Q$`O#U$ZO#b$YO~Oj#WOp$bO!V$dO!W!Ti#R!Ti!Q!Ti~P${O!W!}a#R!}a!Q!}a~P!ZO!W!mO#R#di!Q#di~Oa#cX~P#pOa$hO~Oj#WOQ!yXa!yXb!yXf!yXh!yXn!yXp!yX#T!yX#U!yX#b!yX~Op$jOa#`X~P${Oa$lO~Oj#WOv$mO~Oa$nO~O!`#_Op#Oa!R#Oa!W#Oa~Oa$pO~P.QOP#VOpgX!RgX~O#b$YOp!qX!R!qX~Op$rO!RwO~O!Q$vO#U$ZO#b$YO~Oj#WOQ!|Xb!|Xf!|Xh!|Xn!|Xp!|X!V!|X!W!|X#R!|X#T!|X#U!|X#b!|X!Q!|X~Op$bO!V$yO!W!Tq#R!Tq!Q!Tq~P${Oj#WOv$zO~OpoOa#ca~Op$jOa#`a~Oa$}O~P${Oj#WOQ!|ab!|af!|ah!|an!|ap!|a!V!|a!W!|a#R!|a#T!|a#U!|a#b!|a!Q!|a~Oa!zap!za~P${O#Wo#X#bj!P#b~","goto":"-Y#gPPP#hP#kP#t$TP#t$d#tPP$jPPP$p$y$yP%]P$yP$y%w&ZPPP&s&y#tP'PP#tP'VP#tP#t#tPPP']'r(PPP#kPP(W(W(b(WP(WP(W(WP#kP#kP#kP(e#kP(h(k(n(u#kP#kP(z)Q)a)o)u*P*V*a*g*mPPPPPPPPPP*s*|P+i+lP,b,e,k,tRkQ_bOPdhw!m#nkYOPdhotuvw!m#Q#c#nkSOPdhotuvw!m#Q#c#nQmTR!snQ{VR!wqQ!w}Q#Y!XR#s!yq!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${p!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${U$]#h$_$rR$q$[q!XZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${p!ZZ]!T!l#R#T#W#l#u#z$R$b$c$j$o${Q!e^R#g!fQ|VR!xqQ!w|R#s!xQ!PWR!zrQ!RXR!{sQxUQ!vpQ#d!bQ#j!iQ#k!jQ$t$^R%Q$sSgPwQ!ohQ#m!mR$e#nZfPhw!m#na!a[`a!V!]!_#_#`R#]!]R!f^R!h_R#i!hS$^#h$_R%O$rV$[#h$_$rQ!qjR#q!qQdOShPwU!kdh#nR#n!mQ#z#RU$i#z$o${Q$o$RR${$jQ$k#zR$|$kQpUS!up$gR$g#wQ$c#lR$x$cQ!ngS#o!n#pR#p!oQ#a!^R$V#aQ$_#hR$u$_Q$s$^R%P$s_cOPdhw!m#n^UOPdhw!m#nQ!toQ!|tQ!}uQ#OvQ#w#QR$W#cR#{#RQ!VZQ!c]Q#U!TQ#l!l[#y#R#z$R$j$o${Q#|#TQ$O#WS$a#l$cQ$f#uR$w$bR#x#QQiPR#PwQ!b[Q!jaR#X!VU!^[a!VQ!i`Q#^!]Q#b!_Q$T#_R$U#`",nodeNames:"\u26A0 Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent , PseudoClassName ArgList IdSelector # IdName ] AttributeSelector [ AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:114,nodeProps:[["openedBy",17,"(",48,"{"],["closedBy",18,")",49,"}"]],propSources:[cssHighlighting],skippedNodes:[0,3,85],repeatNodeCount:10,tokenData:"J^~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_$}!_!`Cj!`!aC{!a!b$}!b!cDw!c!}$}!}#OFa#O#P$}#P#QFr#Q#R6d#R#T$}#T#UGT#U#c$}#c#dHf#d#o$}#o#pH{#p#q6d#q#rI^#r#sIo#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`JW<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSo`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#W~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#W~o`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUo`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Uo`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUo`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Uo`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUo`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Uo`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUo`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Uo`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!V[o`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOh~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYtQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYo`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYo`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYf[o`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYf[o`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYo`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYf[o`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYo`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSf[o`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QSzSo`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSb^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOa~n9{UUQjWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWjW!PQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUo`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYo`#b[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYo`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUo`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUo`#b[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[o`#b[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSp^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWjWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VU#_QOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTjWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSo`#X~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#b[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^bBbU]QOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S^Qo`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!W^Oy%^z;'S%^;'S;=`%o<%lO%^dCoSzSOy%^z;'S%^;'S;=`%o<%lO%^bDQU|QOy%^z!`%^!`!aDd!a;'S%^;'S;=`%o<%lO%^bDkS|Qo`Oy%^z;'S%^;'S;=`%o<%lO%^bDzWOy%^z!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bEk[!YQo`Oy%^z}%^}!OEd!O!Q%^!Q![Ed![!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bFfSxQOy%^z;'S%^;'S;=`%o<%lO%^lFwSv[Oy%^z;'S%^;'S;=`%o<%lO%^bGWUOy%^z#b%^#b#cGj#c;'S%^;'S;=`%o<%lO%^bGoUo`Oy%^z#W%^#W#XHR#X;'S%^;'S;=`%o<%lO%^bHYS!`Qo`Oy%^z;'S%^;'S;=`%o<%lO%^bHiUOy%^z#f%^#f#gHR#g;'S%^;'S;=`%o<%lO%^fIQS!RUOy%^z;'S%^;'S;=`%o<%lO%^nIcS!Q^Oy%^z;'S%^;'S;=`%o<%lO%^fItU!PQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`JZP;=`<%l$}",tokenizers:[descendant,unitToken,identifiers,1,2,3,4,new LocalTokenGroup("m~RRYZ[z{a~~g~aO#Z~~dP!P!Qg~lO#[~~",28,102)],topRules:{"StyleSheet":[0,4],"Styles":[1,84]},specialized:[{term:97,get:function get(value){return spec_callee[value]||-1;}},{term:56,get:function get(value){return spec_AtKeyword[value]||-1;}},{term:98,get:function get(value){return spec_identifier[value]||-1;}}],tokenPrec:1169});// ../node_modules/@codemirror/lang-css/dist/index.js
var _properties=null;function properties(){if(!_properties&&(typeof document==="undefined"?"undefined":_typeof(document))=="object"&&document.body){var style=document.body.style,names=[],seen=/* @__PURE__ */new Set();for(var prop in style){if(prop!="cssText"&&prop!="cssFloat"){if(typeof style[prop]=="string"){if(/[A-Z]/.test(prop))prop=prop.replace(/[A-Z]/g,function(ch){return"-"+ch.toLowerCase();});if(!seen.has(prop)){names.push(prop);seen.add(prop);}}}}_properties=names.sort().map(function(name2){return{type:"property",label:name2};});}return _properties||[];}var pseudoClasses=/* @__PURE__ */["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map(function(name2){return{type:"class",label:name2};});var values=/* @__PURE__ */["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map(function(name2){return{type:"keyword",label:name2};}).concat(/* @__PURE__ */["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map(function(name2){return{type:"constant",label:name2};}));var tags2=/* @__PURE__ */["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map(function(name2){return{type:"type",label:name2};});var identifier2=/^(\w[\w-]*|-\w[\w-]*|)$/;var variable=/^-(-[\w-]*)?$/;function isVarArg(node,doc2){var _a2;if(node.name=="("||node.type.isError)node=node.parent||node;if(node.name!="ArgList")return false;var callee2=(_a2=node.parent)===null||_a2===void 0?void 0:_a2.firstChild;if((callee2===null||callee2===void 0?void 0:callee2.name)!="Callee")return false;return doc2.sliceString(callee2.from,callee2.to)=="var";}var VariablesByNode=/* @__PURE__ */new NodeWeakMap();var declSelector=["Declaration"];function astTop(node){for(var cur2=node;;){if(cur2.type.isTop)return cur2;if(!(cur2=cur2.parent))return node;}}function variableNames(doc2,node,isVariable){if(node.to-node.from>4096){var known=VariablesByNode.get(node);if(known)return known;var result=[],seen=/* @__PURE__ */new Set(),_cursor4=node.cursor(IterMode.IncludeAnonymous);if(_cursor4.firstChild())do{var _iterator276=_createForOfIteratorHelper(variableNames(doc2,_cursor4.node,isVariable)),_step276;try{for(_iterator276.s();!(_step276=_iterator276.n()).done;){var option=_step276.value;if(!seen.has(option.label)){seen.add(option.label);result.push(option);}}}catch(err){_iterator276.e(err);}finally{_iterator276.f();}}while(_cursor4.nextSibling());VariablesByNode.set(node,result);return result;}else{var _result2=[],_seen=/* @__PURE__ */new Set();node.cursor().iterate(function(node2){var _a2;if(isVariable(node2)&&node2.matchContext(declSelector)&&((_a2=node2.node.nextSibling)===null||_a2===void 0?void 0:_a2.name)==":"){var _name8=doc2.sliceString(node2.from,node2.to);if(!_seen.has(_name8)){_seen.add(_name8);_result2.push({label:_name8,type:"variable"});}}});return _result2;}}var defineCSSCompletionSource=function defineCSSCompletionSource(isVariable){return function(context){var state=context.state,pos=context.pos,node=_syntaxTree(state).resolveInner(pos,-1);var isDash=node.type.isError&&node.from==node.to-1&&state.doc.sliceString(node.from,node.to)=="-";if(node.name=="PropertyName"||(isDash||node.name=="TagName")&&/^(Block|Styles)$/.test(node.resolve(node.to).name))return{from:node.from,options:properties(),validFor:identifier2};if(node.name=="ValueName")return{from:node.from,options:values,validFor:identifier2};if(node.name=="PseudoClassName")return{from:node.from,options:pseudoClasses,validFor:identifier2};if(isVariable(node)||(context.explicit||isDash)&&isVarArg(node,state.doc))return{from:isVariable(node)||isDash?node.from:pos,options:variableNames(state.doc,astTop(node),isVariable),validFor:variable};if(node.name=="TagName"){for(var parent=node.parent;parent;parent=parent.parent){if(parent.name=="Block")return{from:node.from,options:properties(),validFor:identifier2};}return{from:node.from,options:tags2,validFor:identifier2};}if(!context.explicit)return null;var above=node.resolve(pos),before=above.childBefore(pos);if(before&&before.name==":"&&above.name=="PseudoClassSelector")return{from:pos,options:pseudoClasses,validFor:identifier2};if(before&&before.name==":"&&above.name=="Declaration"||above.name=="ArgList")return{from:pos,options:values,validFor:identifier2};if(above.name=="Block"||above.name=="Styles")return{from:pos,options:properties(),validFor:identifier2};return null;};};var cssCompletionSource=/* @__PURE__ */defineCSSCompletionSource(function(n){return n.name=="VariableName";});var cssLanguage=/* @__PURE__ */_LRLanguage.define({name:"css",parser:/* @__PURE__ */parser3.configure({props:[/* @__PURE__ */_indentNodeProp.add({Declaration:/* @__PURE__ */_continuedIndent()}),/* @__PURE__ */_foldNodeProp.add({"Block KeyframeList":_foldInside})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function css(){return new _LanguageSupport(cssLanguage,cssLanguage.data.of({autocomplete:cssCompletionSource}));}// ../node_modules/@lezer/javascript/dist/index.js
var noSemi=304;var incdec=1;var incdecPrefix=2;var insertSemi=305;var spaces=307;var newline2=308;var LineComment=3;var BlockComment=4;var space3=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288];var braceR=125;var semicolon=59;var slash2=47;var star=42;var plus=43;var minus=45;var trackNewline=new ContextTracker({start:false,shift:function shift(context,term){return term==LineComment||term==BlockComment||term==spaces?context:term==newline2;},strict:false});var insertSemicolon=new ExternalTokenizer(function(input,stack){var next=input.next;if(next==braceR||next==-1||stack.context)input.acceptToken(insertSemi);},{contextual:true,fallback:true});var noSemicolon=new ExternalTokenizer(function(input,stack){var next=input.next,after;if(space3.indexOf(next)>-1)return;if(next==slash2&&((after=input.peek(1))==slash2||after==star))return;if(next!=braceR&&next!=semicolon&&next!=-1&&!stack.context)input.acceptToken(noSemi);},{contextual:true});var incdecToken=new ExternalTokenizer(function(input,stack){var next=input.next;if(next==plus||next==minus){input.advance();if(next==input.next){input.advance();var mayPostfix=!stack.context&&stack.canShift(incdec);input.acceptToken(mayPostfix?incdec:incdecPrefix);}}},{contextual:true});var jsHighlight=styleTags({"get set async static":tags.modifier,"for while do if else switch try catch finally return throw break continue default case":tags.controlKeyword,"in of await yield void typeof delete instanceof":tags.operatorKeyword,"let var const using function class extends":tags.definitionKeyword,"import export from":tags.moduleKeyword,"with debugger as new":tags.keyword,TemplateString:tags.special(tags.string),"super":tags.atom,BooleanLiteral:tags.bool,"this":tags.self,"null":tags["null"],Star:tags.modifier,VariableName:tags.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":tags["function"](tags.variableName),VariableDefinition:tags.definition(tags.variableName),Label:tags.labelName,PropertyName:tags.propertyName,PrivatePropertyName:tags.special(tags.propertyName),"CallExpression/MemberExpression/PropertyName":tags["function"](tags.propertyName),"FunctionDeclaration/VariableDefinition":tags["function"](tags.definition(tags.variableName)),"ClassDeclaration/VariableDefinition":tags.definition(tags.className),PropertyDefinition:tags.definition(tags.propertyName),PrivatePropertyDefinition:tags.definition(tags.special(tags.propertyName)),UpdateOp:tags.updateOperator,"LineComment Hashbang":tags.lineComment,BlockComment:tags.blockComment,Number:tags.number,String:tags.string,Escape:tags.escape,ArithOp:tags.arithmeticOperator,LogicOp:tags.logicOperator,BitOp:tags.bitwiseOperator,CompareOp:tags.compareOperator,RegExp:tags.regexp,Equals:tags.definitionOperator,Arrow:tags["function"](tags.punctuation),": Spread":tags.punctuation,"( )":tags.paren,"[ ]":tags.squareBracket,"{ }":tags.brace,"InterpolationStart InterpolationEnd":tags.special(tags.brace),".":tags.derefOperator,", ;":tags.separator,"@":tags.meta,TypeName:tags.typeName,TypeDefinition:tags.definition(tags.typeName),"type enum interface implements namespace module declare":tags.definitionKeyword,"abstract global Privacy readonly override":tags.modifier,"is keyof unique infer":tags.operatorKeyword,JSXAttributeValue:tags.attributeValue,JSXText:tags.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":tags.angleBracket,"JSXIdentifier JSXNameSpacedName":tags.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":tags.attributeName,"JSXBuiltin/JSXIdentifier":tags.standard(tags.tagName)});var spec_identifier2={__proto__:null,"export":16,as:21,from:29,"default":32,async:37,"function":38,"extends":48,"this":52,"true":60,"false":60,"null":72,"void":76,"typeof":80,"super":98,"new":132,"delete":148,"yield":157,"await":161,"class":166,"public":223,"private":223,"protected":223,readonly:225,"instanceof":244,satisfies:247,"in":248,"const":250,"import":282,keyof:337,unique:341,infer:347,is:383,"abstract":403,"implements":405,type:407,"let":410,"var":412,using:415,"interface":421,"enum":425,namespace:431,module:433,declare:437,global:441,"for":460,of:469,"while":472,"with":476,"do":480,"if":484,"else":486,"switch":490,"case":496,"try":502,"catch":506,"finally":510,"return":514,"throw":518,"break":522,"continue":526,"debugger":530};var spec_word={__proto__:null,async:119,get:121,set:123,declare:183,"public":185,"private":185,"protected":185,"static":187,"abstract":189,override:191,readonly:197,accessor:199,"new":387};var spec_LessThan={__proto__:null,"<":139};var parser4=LRParser.deserialize({version:14,states:"$6zO%TQUOOO%[QUOOO'_QWOOP(lOSOOO*zQ(CjO'#CgO+ROpO'#ChO+aO!bO'#ChO+oO07`O'#D[O.QQUO'#DbO.bQUO'#DmO%[QUO'#DwO0fQUO'#EPOOQ(CY'#EX'#EXO1PQSO'#EUOOQO'#Ej'#EjOOQO'#Id'#IdO1XQSO'#GlO1dQSO'#EiO1iQSO'#EiO3kQ(CjO'#JeO6[Q(CjO'#JfO6xQSO'#FXO6}Q#tO'#FpOOQ(CY'#Fa'#FaO7YO&jO'#FaO7hQ,UO'#FwO9OQSO'#FvOOQ(CY'#Jf'#JfOOQ(CW'#Je'#JeO9TQSO'#GpOOQQ'#KQ'#KQO9`QSO'#IQO9eQ(C[O'#IROOQQ'#JR'#JROOQQ'#IV'#IVQ`QUOOO`QUOOO%[QUO'#DoO9mQUO'#D{O9tQUO'#D}O9ZQSO'#GlO9{Q,UO'#CmO:ZQSO'#EhO:fQSO'#EsO:kQ,UO'#F`O;YQSO'#GlOOQO'#KR'#KRO;_QSO'#KRO;mQSO'#GtO;mQSO'#GuO;mQSO'#GwO9ZQSO'#GzO<dQSO'#G}O={QSO'#CcO>]QSO'#HZO>eQSO'#HaO>eQSO'#HcO`QUO'#HeO>eQSO'#HgO>eQSO'#HjO>jQSO'#HpO>oQ(C]O'#HvO%[QUO'#HxO>zQ(C]O'#HzO?VQ(C]O'#H|O9eQ(C[O'#IOO?bQ(CjO'#CgO@dQWO'#DgQOQSOOO%[QUO'#D}O@zQSO'#EQO9{Q,UO'#EhOAVQSO'#EhOAbQ`O'#F`OOQQ'#Ce'#CeOOQ(CW'#Dl'#DlOOQ(CW'#Ji'#JiO%[QUO'#JiOOQO'#Jm'#JmOOQO'#Ia'#IaOBbQWO'#EaOOQ(CW'#E`'#E`OC^Q(C`O'#EaOChQWO'#ETOOQO'#Jl'#JlOC|QWO'#JmOEZQWO'#ETOChQWO'#EaPEhO?MpO'#C`POOO)CDp)CDpOOOO'#IW'#IWOEsOpO,59SOOQ(CY,59S,59SOOOO'#IX'#IXOFRO!bO,59SO%[QUO'#D^OOOO'#IZ'#IZOFaO07`O,59vOOQ(CY,59v,59vOFoQUO'#I[OGSQSO'#JgOIUQbO'#JgO+}QUO'#JgOI]QSO,59|OIsQSO'#EjOJQQSO'#JuOJ]QSO'#JtOJ]QSO'#JtOJeQSO,5;WOJjQSO'#JsOOQ(CY,5:X,5:XOJqQUO,5:XOLrQ(CjO,5:cOMcQSO,5:kOM|Q(C[O'#JrONTQSO'#JqO9TQSO'#JqONiQSO'#JqONqQSO,5;VONvQSO'#JqO!#OQbO'#JfOOQ(CY'#Cg'#CgO%[QUO'#EPO!#nQ`O,5:pOOQO'#Jn'#JnOOQO-E<b-E<bO9ZQSO,5=WO!$UQSO,5=WO!$ZQUO,5;TO!&^Q,UO'#EeO!'qQSO,5;TO!)ZQ,UO'#DqO!)bQUO'#DvO!)lQWO,5;^O!)tQWO,5;^O%[QUO,5;^OOQQ'#FP'#FPOOQQ'#FR'#FRO%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_O%[QUO,5;_OOQQ'#FV'#FVO!*SQUO,5;pOOQ(CY,5;u,5;uOOQ(CY,5;v,5;vO!,VQSO,5;vOOQ(CY,5;w,5;wO%[QUO'#IhO!,_Q(C[O,5<dO!&^Q,UO,5;_O!,|Q,UO,5;_O%[QUO,5;sO!-TQ#tO'#FfO!.QQ#tO'#JyO!-lQ#tO'#JyO!.XQ#tO'#JyOOQO'#Jy'#JyO!.mQ#tO,5<OOOOO,5<[,5<[O!/OQUO'#FrOOOO'#Ig'#IgO7YO&jO,5;{O!/VQ#tO'#FtOOQ(CY,5;{,5;{O!/vQ7[O'#CsOOQ(CY'#Cw'#CwO!0ZQSO'#CwO!0`O07`O'#C{O!0|Q,UO,5<aO!1TQSO,5<cO!2jQMhO'#GRO!2wQSO'#GSO!2|QSO'#GSO!3RQMhO'#GWO!4QQWO'#G[O!4sQ7[O'#J`OOQ(CY'#J`'#J`O!4}QSO'#J_O!5]QSO'#J^O!5eQSO'#CrOOQ(CY'#Cu'#CuOOQ(CY'#DP'#DPOOQ(CY'#DR'#DRO1SQSO'#DTO!'vQ,UO'#FyO!'vQ,UO'#F{O!5mQSO'#F}O!5rQSO'#GOO!2|QSO'#GUO!'vQ,UO'#GZO!5wQSO'#EkO!6fQSO,5<bOOQ(CW'#Cp'#CpO!6nQSO'#ElO!7hQWO'#EmOOQ(CW'#Js'#JsO!7oQ(C[O'#KSO9eQ(C[O,5=[O`QUO,5>lOOQQ'#JZ'#JZOOQQ,5>m,5>mOOQQ-E<T-E<TO!9qQ(CjO,5:ZO!<_Q(CjO,5:gO%[QUO,5:gO!>xQ(CjO,5:iOOQO,5@m,5@mO!?iQ,UO,5=WO!?wQ(C[O'#J[O9OQSO'#J[O!@YQ(C[O,59XO!@eQWO,59XO!@mQ,UO,59XO9{Q,UO,59XO!@xQSO,5;TO!AQQSO'#HYO!AfQSO'#KVO%[QUO,5;xO!7cQWO,5;zO!AnQSO,5=sO!AsQSO,5=sO!AxQSO,5=sO9eQ(C[O,5=sO;mQSO,5=cOOQO'#Cs'#CsO!BWQWO,5=`O!B`Q,UO,5=aO!BkQSO,5=cO!BpQ`O,5=fO!BxQSO'#KRO>jQSO'#HPO9ZQSO'#HRO!B}QSO'#HRO9{Q,UO'#HTO!CSQSO'#HTOOQQ,5=i,5=iO!CXQSO'#HUO!CjQSO'#CmO!CoQSO,58}O!CyQSO,58}O!FOQUO,58}OOQQ,58},58}O!F`Q(C[O,58}O%[QUO,58}O!HkQUO'#H]OOQQ'#H^'#H^OOQQ'#H_'#H_O`QUO,5=uO!IRQSO,5=uO`QUO,5={O`QUO,5=}O!IWQSO,5>PO`QUO,5>RO!I]QSO,5>UO!IbQUO,5>[OOQQ,5>b,5>bO%[QUO,5>bO9eQ(C[O,5>dOOQQ,5>f,5>fO!MlQSO,5>fOOQQ,5>h,5>hO!MlQSO,5>hOOQQ,5>j,5>jO!MqQWO'#DYO%[QUO'#JiO!N`QWO'#JiO!N}QWO'#DhO# `QWO'#DhO##qQUO'#DhO##xQSO'#JhO#$QQSO,5:RO#$VQSO'#EnO#$eQSO'#JvO#$mQSO,5;XO#$rQWO'#DhO#%PQWO'#ESOOQ(CY,5:l,5:lO%[QUO,5:lO#%WQSO,5:lO>jQSO,5;SO!@eQWO,5;SO!@mQ,UO,5;SO9{Q,UO,5;SO#%`QSO,5@TO#%eQ!LQO,5:pOOQO-E<_-E<_O#&kQ(C`O,5:{OChQWO,5:oO#&uQWO,5:oOChQWO,5:{O!@YQ(C[O,5:oOOQ(CW'#Ed'#EdOOQO,5:{,5:{O%[QUO,5:{O#'SQ(C[O,5:{O#'_Q(C[O,5:{O!@eQWO,5:oOOQO,5;R,5;RO#'mQ(C[O,5:{POOO'#IU'#IUP#(RO?MpO,58zPOOO,58z,58zOOOO-E<U-E<UOOQ(CY1G.n1G.nOOOO-E<V-E<VO#(^Q`O,59xOOOO-E<X-E<XOOQ(CY1G/b1G/bO#(cQbO,5>vO+}QUO,5>vOOQO,5>|,5>|O#(mQUO'#I[OOQO-E<Y-E<YO#(zQSO,5@RO#)SQbO,5@RO#)ZQSO,5@`OOQ(CY1G/h1G/hO%[QUO,5@aO#)cQSO'#IbOOQO-E<`-E<`O#)ZQSO,5@`OOQ(CW1G0r1G0rOOQ(CY1G/s1G/sOOQ(CY1G0V1G0VO%[QUO,5@^O#)wQ(C[O,5@^O#*YQ(C[O,5@^O#*aQSO,5@]O9TQSO,5@]O#*iQSO,5@]O#*wQSO'#IeO#*aQSO,5@]OOQ(CW1G0q1G0qO!)lQWO,5:rO!)wQWO,5:rOOQO,5:t,5:tO#+iQSO,5:tO#+qQ,UO1G2rO9ZQSO1G2rOOQ(CY1G0o1G0oO#,PQ(CjO1G0oO#-UQ(ChO,5;POOQ(CY'#GQ'#GQO#-rQ(CjO'#J`O!$ZQUO1G0oO#/zQ,UO'#JjO#0UQSO,5:]O#0ZQbO'#JkO%[QUO'#JkO#0eQSO,5:bOOQ(CY'#DY'#DYOOQ(CY1G0x1G0xO%[QUO1G0xOOQ(CY1G1b1G1bO#0jQSO1G0xO#3RQ(CjO1G0yO#3YQ(CjO1G0yO#5sQ(CjO1G0yO#5zQ(CjO1G0yO#8UQ(CjO1G0yO#8lQ(CjO1G0yO#;fQ(CjO1G0yO#;mQ(CjO1G0yO#>WQ(CjO1G0yO#>_Q(CjO1G0yO#@VQ(CjO1G0yO#CVQ$IUO'#CgO#ETQ$IUO1G1[O#E[Q$IUO'#JfO!,YQSO1G1bO#ElQ(CjO,5?SOOQ(CW-E<f-E<fO#F`Q(CjO1G0yOOQ(CY1G0y1G0yO#HkQ(CjO1G1_O#I_Q#tO,5<SO#IgQ#tO,5<TO#IoQ#tO'#FkO#JWQSO'#FjOOQO'#Jz'#JzOOQO'#If'#IfO#J]Q#tO1G1jOOQ(CY1G1j1G1jOOOO1G1u1G1uO#JnQ$IUO'#JeO#JxQSO,5<^O!*SQUO,5<^OOOO-E<e-E<eOOQ(CY1G1g1G1gO#J}QWO'#JyOOQ(CY,5<`,5<`O#KVQWO,5<`OOQ(CY,59c,59cO!&^Q,UO'#C}OOOO'#IY'#IYO#K[O07`O,59gOOQ(CY,59g,59gO%[QUO1G1{O!5rQSO'#IjO#KgQ,UO,5<tOOQ(CY,5<q,5<qOOQO'#Gg'#GgO!'vQ,UO,5=QOOQO'#Gi'#GiO!'vQ,UO,5=SO!&^Q,UO,5=UOOQO1G1}1G1}O#KnQ`O'#CpO#LRQ`O,5<mO#LYQSO'#J}O9ZQSO'#J}O#LhQSO,5<oO!'vQ,UO,5<nO#LmQSO'#GTO#LxQSO,5<nO#L}Q`O'#GQO#M[Q`O'#KOO#MfQSO'#KOO!&^Q,UO'#KOO#MkQSO,5<rO#MpQWO'#G]O!3{QWO'#G]O#NRQSO'#G_O#NWQSO'#GaO!2|QSO'#GdO#N]Q(C[O'#IlO#NhQWO,5<vOOQ(CY,5<v,5<vO#NoQWO'#G]O#N}QWO'#G^O$ VQWO'#G^OOQ(CY,5=V,5=VO!'vQ,UO,5?yO!'vQ,UO,5?yO$ [QSO'#ImO$ gQSO,5?xO$ oQSO,59^O$!`Q,UO,59oOOQ(CY,59o,59oO$#RQ,UO,5<eO$#tQ,UO,5<gO@[QSO,5<iOOQ(CY,5<j,5<jO$$OQSO,5<pO$$TQ,UO,5<uO$$eQSO'#JqO!$ZQUO1G1|O$$jQSO1G1|O9TQSO'#JtO9TQSO'#EnO%[QUO'#EnO9TQSO'#IoO$$oQ(C[O,5@nOOQQ1G2v1G2vOOQQ1G4W1G4WOOQ(CY1G/u1G/uO!,VQSO1G/uO$&tQ(CjO1G0ROOQQ1G2r1G2rO!&^Q,UO1G2rO%[QUO1G2rO$'eQSO1G2rO$'pQ,UO'#EeOOQ(CW,5?v,5?vO$'zQ(C[O,5?vOOQQ1G.s1G.sO!@YQ(C[O1G.sO!@eQWO1G.sO!@mQ,UO1G.sO$(]QSO1G0oO$(bQSO'#CgO$(mQSO'#KWO$(uQSO,5=tO$(zQSO'#KWO$)PQSO'#KWO$)_QSO'#IuO$)mQSO,5@qO$)uQbO1G1dOOQ(CY1G1f1G1fO9ZQSO1G3_O@[QSO1G3_O$)|QSO1G3_O$*RQSO1G3_OOQQ1G3_1G3_O!BkQSO1G2}O!&^Q,UO1G2zO$*WQSO1G2zOOQQ1G2{1G2{O!&^Q,UO1G2{O$*]QSO1G2{O$*eQWO'#GyOOQQ1G2}1G2}O!3{QWO'#IqO!BpQ`O1G3QOOQQ1G3Q1G3QOOQQ,5=k,5=kO$*mQ,UO,5=mO9ZQSO,5=mO#NWQSO,5=oO9OQSO,5=oO!@eQWO,5=oO!@mQ,UO,5=oO9{Q,UO,5=oO$*{QSO'#KUO$+WQSO,5=pOOQQ1G.i1G.iO$+]Q(C[O1G.iO@[QSO1G.iO$+hQSO1G.iO9eQ(C[O1G.iO$-mQbO,5@sO$-}QSO,5@sO9TQSO,5@sO$.YQUO,5=wO$.aQSO,5=wOOQQ1G3a1G3aO`QUO1G3aOOQQ1G3g1G3gOOQQ1G3i1G3iO>eQSO1G3kO$.fQUO1G3mO$2jQUO'#HlOOQQ1G3p1G3pO$2wQSO'#HrO>jQSO'#HtOOQQ1G3v1G3vO$3PQUO1G3vO9eQ(C[O1G3|OOQQ1G4O1G4OOOQ(CW'#GX'#GXO9eQ(C[O1G4QO9eQ(C[O1G4SO$7WQSO,5@TO!*SQUO,5;YO9TQSO,5;YO>jQSO,5:SO!*SQUO,5:SO!@eQWO,5:SO$7]Q$IUO,5:SOOQO,5;Y,5;YO$7gQWO'#I]O$7}QSO,5@SOOQ(CY1G/m1G/mO$8VQWO'#IcO$8aQSO,5@bOOQ(CW1G0s1G0sO# `QWO,5:SOOQO'#I`'#I`O$8iQWO,5:nOOQ(CY,5:n,5:nO#%ZQSO1G0WOOQ(CY1G0W1G0WO%[QUO1G0WOOQ(CY1G0n1G0nO>jQSO1G0nO!@eQWO1G0nO!@mQ,UO1G0nOOQ(CW1G5o1G5oO!@YQ(C[O1G0ZOOQO1G0g1G0gO%[QUO1G0gO$8pQ(C[O1G0gO$8{Q(C[O1G0gO!@eQWO1G0ZOChQWO1G0ZO$9ZQ(C[O1G0gOOQO1G0Z1G0ZO$9oQ(CjO1G0gPOOO-E<S-E<SPOOO1G.f1G.fOOOO1G/d1G/dO$9yQ`O,5<dO$:RQbO1G4bOOQO1G4h1G4hO%[QUO,5>vO$:]QSO1G5mO$:eQSO1G5zO$:mQbO1G5{O9TQSO,5>|O$:wQ(CjO1G5xO%[QUO1G5xO$;XQ(C[O1G5xO$;jQSO1G5wO$;jQSO1G5wO9TQSO1G5wO$;rQSO,5?PO9TQSO,5?POOQO,5?P,5?PO$<WQSO,5?PO$$eQSO,5?POOQO-E<c-E<cOOQO1G0^1G0^OOQO1G0`1G0`O!,YQSO1G0`OOQQ7+(^7+(^O!&^Q,UO7+(^O%[QUO7+(^O$<fQSO7+(^O$<qQ,UO7+(^O$=PQ(CjO,59oO$?XQ(CjO,5<eO$AdQ(CjO,5<gO$CoQ(CjO,5<uOOQ(CY7+&Z7+&ZO$FQQ(CjO7+&ZO$FtQ,UO'#I^O$GOQSO,5@UOOQ(CY1G/w1G/wO$GWQUO'#I_O$GeQSO,5@VO$GmQbO,5@VOOQ(CY1G/|1G/|O$GwQSO7+&dOOQ(CY7+&d7+&dO$G|Q$IUO,5:cO%[QUO7+&vO$HWQ$IUO,5:ZO$HeQ$IUO,5:gO$HoQ$IUO,5:iOOQ(CY7+&|7+&|OOQO1G1n1G1nOOQO1G1o1G1oO$HyQ#tO,5<VO!*SQUO,5<UOOQO-E<d-E<dOOQ(CY7+'U7+'UOOOO7+'a7+'aOOOO1G1x1G1xO$IUQSO1G1xOOQ(CY1G1z1G1zO$IZQ`O,59iOOOO-E<W-E<WOOQ(CY1G/R1G/RO$IbQ(CjO7+'gOOQ(CY,5?U,5?UO$JUQ`O,5?UOOQ(CY1G2`1G2`P!&^Q,UO'#IjPOQ(CY-E<h-E<hO$JtQ,UO1G2lO$KgQ,UO1G2nO$KqQ`O1G2pOOQ(CY1G2X1G2XO$KxQSO'#IiO$LWQSO,5@iO$LWQSO,5@iO$L`QSO,5@iO$LkQSO,5@iOOQO1G2Z1G2ZO$LyQ,UO1G2YO!'vQ,UO1G2YO$MZQMhO'#IkO$MkQSO,5@jO!&^Q,UO,5@jO$MsQ`O,5@jOOQ(CY1G2^1G2^OOQ(CW,5<w,5<wOOQ(CW,5<x,5<xO$$eQSO,5<xOCXQSO,5<xO!@eQWO,5<wOOQO'#G`'#G`O$M}QSO,5<yOOQ(CW,5<{,5<{O$$eQSO,5=OOOQO,5?W,5?WOOQO-E<j-E<jOOQ(CY1G2b1G2bO!3{QWO,5<wO$NVQSO,5<xO#NRQSO,5<yO!3{QWO,5<xO$NbQ,UO1G5eO$NlQ,UO1G5eOOQO,5?X,5?XOOQO-E<k-E<kOOQO1G.x1G.xO!7cQWO,59qO%[QUO,59qO$NyQSO1G2TO!'vQ,UO1G2[O% OQ(CjO7+'hOOQ(CY7+'h7+'hO!$ZQUO7+'hO% rQSO,5;YOOQ(CW,5?Z,5?ZOOQ(CW-E<m-E<mOOQ(CY7+%a7+%aO% wQ`O'#KPO#%ZQSO7+(^O%!RQbO7+(^O$<iQSO7+(^O%!YQ(ChO'#CgO%!mQ(ChO,5<|O%#_QSO,5<|OOQ(CW1G5b1G5bOOQQ7+$_7+$_O!@YQ(C[O7+$_O!@eQWO7+$_O!$ZQUO7+&ZO%#dQSO'#ItO%#{QSO,5@rOOQO1G3`1G3`O9ZQSO,5@rO%#{QSO,5@rO%$TQSO,5@rOOQO,5?a,5?aOOQO-E<s-E<sOOQ(CY7+'O7+'OO%$YQSO7+(yO9eQ(C[O7+(yO9ZQSO7+(yO@[QSO7+(yOOQQ7+(i7+(iO%$_Q(ChO7+(fO!&^Q,UO7+(fO%$iQ`O7+(gOOQQ7+(g7+(gO!&^Q,UO7+(gO%$pQSO'#KTO%${QSO,5=eOOQO,5?],5?]OOQO-E<o-E<oOOQQ7+(l7+(lO%&[QWO'#HSOOQQ1G3X1G3XO!&^Q,UO1G3XO%[QUO1G3XO%&cQSO1G3XO%&nQ,UO1G3XO9eQ(C[O1G3ZO#NWQSO1G3ZO9OQSO1G3ZO!@eQWO1G3ZO!@mQ,UO1G3ZO%&|QSO'#IsO%'bQSO,5@pO%'jQWO,5@pOOQ(CW1G3[1G3[OOQQ7+$T7+$TO@[QSO7+$TO9eQ(C[O7+$TO%'uQSO7+$TO%[QUO1G6_O%[QUO1G6`O%'zQ(C[O1G6_O%(UQUO1G3cO%(]QSO1G3cO%(bQUO1G3cOOQQ7+({7+({O9eQ(C[O7+)VO`QUO7+)XOOQQ'#KZ'#KZOOQQ'#Iv'#IvO%(iQUO,5>WOOQQ,5>W,5>WO%[QUO'#HmO%(vQSO'#HoOOQQ,5>^,5>^O9TQSO,5>^OOQQ,5>`,5>`OOQQ7+)b7+)bOOQQ7+)h7+)hOOQQ7+)l7+)lOOQQ7+)n7+)nO%({QWO1G5oO%)aQ$IUO1G0tO%)kQSO1G0tOOQO1G/n1G/nO%)vQ$IUO1G/nO>jQSO1G/nO!*SQUO'#DhOOQO,5>w,5>wOOQO-E<Z-E<ZOOQO,5>},5>}OOQO-E<a-E<aO!@eQWO1G/nOOQO-E<^-E<^OOQ(CY1G0Y1G0YOOQ(CY7+%r7+%rO#%ZQSO7+%rOOQ(CY7+&Y7+&YO>jQSO7+&YO!@eQWO7+&YOOQO7+%u7+%uO$9oQ(CjO7+&ROOQO7+&R7+&RO%[QUO7+&RO%*QQ(C[O7+&RO!@YQ(C[O7+%uO!@eQWO7+%uO%*]Q(C[O7+&RO%*kQ(CjO7++dO%[QUO7++dO%*{QSO7++cO%*{QSO7++cOOQO1G4k1G4kO9TQSO1G4kO%+TQSO1G4kOOQO7+%z7+%zO#%ZQSO<<KxO%!RQbO<<KxO%+cQSO<<KxOOQQ<<Kx<<KxO!&^Q,UO<<KxO%[QUO<<KxO%+kQSO<<KxO%+vQ(CjO1G2lO%.RQ(CjO1G2nO%0^Q(CjO1G2YO%2oQ,UO,5>xOOQO-E<[-E<[O%2yQbO,5>yO%[QUO,5>yOOQO-E<]-E<]O%3TQSO1G5qOOQ(CY<<JO<<JOO%3]Q$IUO1G0oO%5gQ$IUO1G0yO%5nQ$IUO1G0yO%7rQ$IUO1G0yO%7yQ$IUO1G0yO%9nQ$IUO1G0yO%:UQ$IUO1G0yO%<iQ$IUO1G0yO%<pQ$IUO1G0yO%>tQ$IUO1G0yO%>{Q$IUO1G0yO%@sQ$IUO1G0yO%AWQ(CjO<<JbO%B]Q$IUO1G0yO%DRQ$IUO'#J`O%FUQ$IUO1G1_O%FcQ$IUO1G0RO!*SQUO'#FmOOQO'#J{'#J{OOQO1G1q1G1qO%FmQSO1G1pO%FrQ$IUO,5?SOOOO7+'d7+'dOOOO1G/T1G/TOOQ(CY1G4p1G4pO!'vQ,UO7+([O%F|QSO,5?TO9ZQSO,5?TOOQO-E<g-E<gO%G[QSO1G6TO%G[QSO1G6TO%GdQSO1G6TO%GoQ,UO7+'tO%HPQ`O,5?VO%HZQSO,5?VO!&^Q,UO,5?VOOQO-E<i-E<iO%H`Q`O1G6UO%HjQSO1G6UOOQ(CW1G2d1G2dO$$eQSO1G2dOOQ(CW1G2c1G2cO%HrQSO1G2eO!&^Q,UO1G2eOOQ(CW1G2j1G2jO!@eQWO1G2cOCXQSO1G2dO%HwQSO1G2eO%IPQSO1G2dO!'vQ,UO7++POOQ(CY1G/]1G/]O%I[QSO1G/]OOQ(CY7+'o7+'oO%IaQ,UO7+'vO%IqQ(CjO<<KSOOQ(CY<<KS<<KSO%JeQSO1G0tO!&^Q,UO'#InO%JjQSO,5@kO!&^Q,UO1G2hOOQQ<<Gy<<GyO!@YQ(C[O<<GyO%JrQ(CjO<<IuOOQ(CY<<Iu<<IuOOQO,5?`,5?`O%KfQSO,5?`O%KkQSO,5?`OOQO-E<r-E<rO%KyQSO1G6^O%KyQSO1G6^O9ZQSO1G6^O@[QSO<<LeOOQQ<<Le<<LeO%LRQSO<<LeO9eQ(C[O<<LeOOQQ<<LQ<<LQO%$_Q(ChO<<LQOOQQ<<LR<<LRO%$iQ`O<<LRO%LWQWO'#IpO%LcQSO,5@oO!*SQUO,5@oOOQQ1G3P1G3PO%LkQUO'#JiOOQO'#Ir'#IrO9eQ(C[O'#IrO%LuQWO,5=nOOQQ,5=n,5=nO%L|QWO'#EaO%MbQSO7+(sO%MgQSO7+(sOOQQ7+(s7+(sO!&^Q,UO7+(sO%[QUO7+(sO%MoQSO7+(sOOQQ7+(u7+(uO9eQ(C[O7+(uO#NWQSO7+(uO9OQSO7+(uO!@eQWO7+(uO%MzQSO,5?_OOQO-E<q-E<qOOQO'#HV'#HVO%NVQSO1G6[O9eQ(C[O<<GoOOQQ<<Go<<GoO@[QSO<<GoO%N_QSO7++yO%NdQSO7++zO%[QUO7++yO%[QUO7++zOOQQ7+(}7+(}O%NiQSO7+(}O%NnQUO7+(}O%NuQSO7+(}OOQQ<<Lq<<LqOOQQ<<Ls<<LsOOQQ-E<t-E<tOOQQ1G3r1G3rO%NzQSO,5>XOOQQ,5>Z,5>ZO& PQSO1G3xO9TQSO7+&`O!*SQUO7+&`OOQO7+%Y7+%YO& UQ$IUO1G5{O>jQSO7+%YOOQ(CY<<I^<<I^OOQ(CY<<It<<ItO>jQSO<<ItOOQO<<Im<<ImO$9oQ(CjO<<ImO%[QUO<<ImOOQO<<Ia<<IaO!@YQ(C[O<<IaO& `Q(C[O<<ImO& kQ(CjO<= OO& {QSO<<N}OOQO7+*V7+*VO9TQSO7+*VOOQQANAdANAdO&!TQSOANAdO!&^Q,UOANAdO#%ZQSOANAdO%!RQbOANAdO%[QUOANAdO&!]Q(CjO7+'tO&$nQ(CjO7+'vO&'PQbO1G4eO&'ZQ$IUO7+&ZO&'hQ$IUO,59oO&)kQ$IUO,5<eO&+nQ$IUO,5<gO&-qQ$IUO,5<uO&/gQ$IUO7+'gO&/tQ$IUO7+'hO&0RQSO,5<XOOQO7+'[7+'[O&0WQ,UO<<KvOOQO1G4o1G4oO&0_QSO1G4oO&0jQSO1G4oO&0xQSO7++oO&0xQSO7++oO!&^Q,UO1G4qO&1QQ`O1G4qO&1[QSO7++pOOQ(CW7+(O7+(OO$$eQSO7+(PO&1dQ`O7+(POOQ(CW7+'}7+'}O$$eQSO7+(OO&1kQSO7+(PO!&^Q,UO7+(POCXQSO7+(OO&1pQ,UO<<NkOOQ(CY7+$w7+$wO&1zQ`O,5?YOOQO-E<l-E<lO&2UQ(ChO7+(SOOQQAN=eAN=eO9ZQSO1G4zOOQO1G4z1G4zO&2fQSO1G4zO&2kQSO7++xO&2kQSO7++xO9eQ(C[OANBPO@[QSOANBPOOQQANBPANBPOOQQANAlANAlOOQQANAmANAmO&2sQSO,5?[OOQO-E<n-E<nO&3OQ$IUO1G6ZO&5`QbO'#CgOOQO,5?^,5?^OOQO-E<p-E<pOOQQ1G3Y1G3YO%LkQUO,5<yOOQQ<<L_<<L_O!&^Q,UO<<L_O%MbQSO<<L_O&5jQSO<<L_O%[QUO<<L_OOQQ<<La<<LaO9eQ(C[O<<LaO#NWQSO<<LaO9OQSO<<LaO&5rQWO1G4yO&5}QSO7++vOOQQAN=ZAN=ZO9eQ(C[OAN=ZOOQQ<= e<= eOOQQ<= f<= fO&6VQSO<= eO&6[QSO<= fOOQQ<<Li<<LiO&6aQSO<<LiO&6fQUO<<LiOOQQ1G3s1G3sO>jQSO7+)dO&6mQSO<<IzO&6xQ$IUO<<IzOOQO<<Ht<<HtOOQ(CYAN?`AN?`OOQOAN?XAN?XO$9oQ(CjOAN?XOOQOAN>{AN>{O%[QUOAN?XOOQO<<Mq<<MqOOQQG27OG27OO!&^Q,UOG27OO#%ZQSOG27OO&7SQSOG27OO%!RQbOG27OO&7[Q$IUO<<JbO&7iQ$IUO1G2YO&9_Q$IUO1G2lO&;bQ$IUO1G2nO&=eQ$IUO<<KSO&=rQ$IUO<<IuOOQO1G1s1G1sO!'vQ,UOANAbOOQO7+*Z7+*ZO&>PQSO7+*ZO&>[QSO<= ZO&>dQ`O7+*]OOQ(CW<<Kk<<KkO$$eQSO<<KkOOQ(CW<<Kj<<KjO&>nQ`O<<KkO$$eQSO<<KjOOQO7+*f7+*fO9ZQSO7+*fO&>uQSO<= dOOQQG27kG27kO9eQ(C[OG27kO!*SQUO1G4vO&>}QSO7++uO%MbQSOANAyOOQQANAyANAyO!&^Q,UOANAyO&?VQSOANAyOOQQANA{ANA{O9eQ(C[OANA{O#NWQSOANA{OOQO'#HW'#HWOOQO7+*e7+*eOOQQG22uG22uOOQQANEPANEPOOQQANEQANEQOOQQANBTANBTO&?_QSOANBTOOQQ<<MO<<MOO!*SQUOAN?fOOQOG24sG24sO$9oQ(CjOG24sO#%ZQSOLD,jOOQQLD,jLD,jO!&^Q,UOLD,jO&?dQSOLD,jO&?lQ$IUO7+'tO&AbQ$IUO7+'vO&CWQ,UOG26|OOQO<<Mu<<MuOOQ(CWANAVANAVO$$eQSOANAVOOQ(CWANAUANAUOOQO<<NQ<<NQOOQQLD-VLD-VO&ChQ$IUO7+*bOOQQG27eG27eO%MbQSOG27eO!&^Q,UOG27eOOQQG27gG27gO9eQ(C[OG27gOOQQG27oG27oO&CrQ$IUOG25QOOQOLD*_LD*_OOQQ!$(!U!$(!UO#%ZQSO!$(!UO!&^Q,UO!$(!UO&C|Q(CjOG26|OOQ(CWG26qG26qOOQQLD-PLD-PO%MbQSOLD-POOQQLD-RLD-ROOQQ!)9Ep!)9EpO#%ZQSO!)9EpOOQQ!$(!k!$(!kOOQQ!.K;[!.K;[O&F_Q$IUOG26|O!*SQUO'#DwO1PQSO'#EUO&HTQbO'#JeO!*SQUO'#DoO&H[QUO'#D{O&HcQbO'#CgO&JyQbO'#CgO!*SQUO'#D}O&KZQUO,5;TO!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO,5;_O!*SQUO'#IhO&M^QSO,5<dO&MfQ,UO,5;_O&NyQ,UO,5;_O!*SQUO,5;sO1SQSO'#DTO1SQSO'#DTO!&^Q,UO'#FyO&MfQ,UO'#FyO!&^Q,UO'#F{O&MfQ,UO'#F{O!&^Q,UO'#GZO&MfQ,UO'#GZO!*SQUO,5:gO!*SQUO,5@aO&KZQUO1G0oO' QQ$IUO'#CgO!*SQUO1G1{O!&^Q,UO,5=QO&MfQ,UO,5=QO!&^Q,UO,5=SO&MfQ,UO,5=SO!&^Q,UO,5<nO&MfQ,UO,5<nO&KZQUO1G1|O!*SQUO7+&vO!&^Q,UO1G2YO&MfQ,UO1G2YO!&^Q,UO1G2[O&MfQ,UO1G2[O&KZQUO7+'hO&KZQUO7+&ZO!&^Q,UOANAbO&MfQ,UOANAbO' [QSO'#EiO' aQSO'#EiO' iQSO'#FXO' nQSO'#EsO' sQSO'#JuO'!OQSO'#JsO'!ZQSO,5;TO'!`Q,UO,5<aO'!gQSO'#GSO'!lQSO'#GSO'!qQSO,5<bO'!yQSO,5;TO'#RQ$IUO1G1[O'#YQSO,5<nO'#_QSO,5<nO'#dQSO,5<pO'#iQSO,5<pO'#nQSO1G1|O'#sQSO1G0oO'#xQ,UO<<KvO'$PQ,UO<<KvO7hQ,UO'#FwO9OQSO'#FvOAVQSO'#EhO!*SQUO,5;pO!2|QSO'#GSO!2|QSO'#GSO!2|QSO'#GUO!2|QSO'#GUO!'vQ,UO7+([O!'vQ,UO7+([O$KqQ`O1G2pO$KqQ`O1G2pO!&^Q,UO,5=UO!&^Q,UO,5=U",stateData:"'%Y~O'oOS'pOSROS'qRQ~OPYOQYOW!VO_qObzOcyOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!YXO!duO!iZO!lYO!mYO!nYO!pvO!rwO!uxO!y]O#q!PO$R|O$VfO%a}O%c!QO%e!OO%f!OO%g!OO%j!RO%l!SO%o!TO%p!TO%r!UO&O!WO&U!XO&W!YO&Y!ZO&[![O&_!]O&e!^O&k!_O&m!`O&o!aO&q!bO&s!cO'vSO'xTO'{UO(TVO(c[O(piO~OUtO~P`OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'v!dO'xTO'{UO(TVO(c[O(piO~O_!vOm!nO}!oO!]!xO!^!uO!_!uO!y9rO!}!pO#O!pO#P!wO#Q!pO#R!pO#U!yO#V!yO'w!lO'xTO'{UO(W!mO(c!sO~O'q!zO~OPZXYZX_ZXlZXzZX{ZX}ZX!WZX!fZX!gZX!iZX!mZX#YZX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX'mZX(TZX(dZX(kZX(lZX~O!b${X~P(qO]!|O'x#OO'y!|O'z#OO~O]#PO'z#OO'{#OO'|#PO~Or#RO!P#SO(U#SO(V#UO~OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'v9vO'xTO'{UO(TVO(c[O(piO~O!V#YO!W#VO!T(ZP!T(hP~P+}O!X#bO~P`OPYOQYOb!jOc!iOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'xTO'{UO(TVO(c[O(piO~Oj#lO!V#hO!y]O#c#kO#d#hO'v9wO!h(eP~P.iO!i#nO'v#mO~O!u#rO!y]O%a#sO~O#e#tO~O!b#uO#e#tO~OP$]OY$dOl$QOz#yO{#zO}#{O!W$aO!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO#w$YO(TVO(d$ZO(k#|O(l#}O~O_(XX'm(XX'k(XX!h(XX!T(XX!Y(XX%b(XX!b(XX~P1qO#Y$eO#|$eOP(YXY(YXl(YXz(YX{(YX}(YX!W(YX!f(YX!i(YX!m(YX#h(YX#i(YX#j(YX#k(YX#l(YX#m(YX#n(YX#o(YX#p(YX#r(YX#t(YX#v(YX#w(YX(T(YX(d(YX(k(YX(l(YX!Y(YX%b(YX~O_(YX!g(YX'm(YX'k(YX!T(YX!h(YXp(YX!b(YX~P4XO#Y$eO~O$X$gO$Z$fO$b$lO~O!Y$mO$VfO$e$nO$g$pO~Oj%SOl$tOm$sOn$sOt%TOv%UOx%VO}${O!Y$|O!d%[O!i$xO#d%]O$R%YO$n%WO$p%XO$s%ZO'v$rO'xTO'{UO(P%RO(T$uOe(QP~O!i%^O~O}%aO!Y%bO'v%`O~O!b%fO~O_%gO'm%gO~O'w!lO~P%[O%g%nO~P%[O!i%^O'v%`O'w!lO(P%RO~Oc%uO!i%^O'v%`O~O#p$SO~Oz%zO!Y%wO!i%yO%c%}O'v%`O'w!lO'xTO'{UO^(yP~O!u#rO~O%l&PO}(uX!Y(uX'v(uX~O'v&QO~O!r&VO#q!PO%c!QO%e!OO%f!OO%g!OO%j!RO%l!SO%o!TO%p!TO~Ob&[Oc&ZO!u&XO%a&YO%t&WO~P;rOb&_OcyO!Y&^O!r&VO!uxO!y]O#q!PO%a}O%e!OO%f!OO%g!OO%j!RO%l!SO%o!TO%p!TO%r!UO~O`&bO#Y&eO%c&`O'w!lO~P<wO!i&fO!r&jO~O!i#nO~O!YXO~O_%gO'l&rO'm%gO~O_%gO'l&uO'm%gO~O_%gO'l&wO'm%gO~O'kZX!TZXpZX!hZX&SZX!YZX%bZX!bZX~P(qO!]'UO!^&}O!_&}O'w!lO'xTO'{UO~Om&{O}&zO!V'OO(W&yO!X([P!X(jP~P@OOh'XO!Y'VO'v%`O~Oc'^O!i%^O'v%`O~Oz%zO!i%yO~Om!nO}!oO!y9rO!}!pO#O!pO#Q!pO#R!pO'w!lO'xTO'{UO(W!mO(c!sO~O!]'dO!^'cO!_'cO#P!pO#U'eO#V'eO~PAjO_%gO!b#uO!i%^O'm%gO(P%RO(d'gO~O!m'kO#Y'iO~PBxOm!nO}!oO'xTO'{UO(W!mO(c!sO~O!YXOm(aX}(aX!](aX!^(aX!_(aX!y(aX!}(aX#O(aX#P(aX#Q(aX#R(aX#U(aX#V(aX'w(aX'x(aX'{(aX(W(aX(c(aX~O!^'cO!_'cO'w!lO~PChO'r'oO's'oO't'qO~O]!|O'x'sO'y!|O'z'sO~O]#PO'z'sO'{'sO'|#PO~Or#RO!P#SO(U#SO(V'wO~O!V'yO!T'OX!T'UX!W'OX!W'UX~P+}O!W'{O!T(ZX~OP$]OY$dOl$QOz#yO{#zO}#{O!W'{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO#w$YO(TVO(d$ZO(k#|O(l#}O~O!T(ZX~PG[O!T(QO~O!T(gX!W(gX!b(gX!h(gX(d(gX~O#Y(gX#e#^X!X(gX~PIbO#Y(RO!T(iX!W(iX~O!W(SO!T(hX~O!T(VO~O#Y$eO~PIbO!X(WO~P`Oz#yO{#zO}#{O!g#wO!i#xO(TVOP!kaY!kal!ka!W!ka!f!ka!m!ka#h!ka#i!ka#j!ka#k!ka#l!ka#m!ka#n!ka#o!ka#p!ka#r!ka#t!ka#v!ka#w!ka(d!ka(k!ka(l!ka~O_!ka'm!ka'k!ka!T!ka!h!kap!ka!Y!ka%b!ka!b!ka~PJxO!h(XO~O!b#uO#Y(YO(d'gO!W(fX_(fX'm(fX~O!h(fX~PMhO}%aO!Y%bO!y]O#c(_O#d(^O'v%`O~O!W(`O!h(eX~O!h(bO~O}%aO!Y%bO#d(^O'v%`O~OP(YXY(YXl(YXz(YX{(YX}(YX!W(YX!f(YX!g(YX!i(YX!m(YX#h(YX#i(YX#j(YX#k(YX#l(YX#m(YX#n(YX#o(YX#p(YX#r(YX#t(YX#v(YX#w(YX(T(YX(d(YX(k(YX(l(YX~O!b#uO!h(YX~P! UOz(cO{(dO!g#wO!i#xO!y!xa}!xa~O!u!xa%a!xa!Y!xa#c!xa#d!xa'v!xa~P!#YO!u(hO~OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!YXO!duO!iZO!lYO!mYO!nYO!pvO!r!gO!u!hO$R!kO$VfO'v!dO'xTO'{UO(TVO(c[O(piO~Oj%SOl$tOm$sOn$sOt%TOv%UOx:[O}${O!Y$|O!d;fO!i$xO#d:bO$R%YO$n:^O$p:`O$s%ZO'v(lO'xTO'{UO(P%RO(T$uO~O#e(nO~Oj%SOl$tOm$sOn$sOt%TOv%UOx%VO}${O!Y$|O!d%[O!i$xO#d%]O$R%YO$n%WO$p%XO$s%ZO'v(lO'xTO'{UO(P%RO(T$uO~Oe(^P~P!'vO!V(rO!h(_P~P%[O(W(tO(c[O~O}(vO!i#xO(W(tO(c[O~OP9qOQ9qOb;bOc!iOjkOl9qOmkOnkOtkOv9qOx9qO}WO!RkO!SkO!Y!eO!d9tO!iZO!l9qO!m9qO!n9qO!p9uO!r9xO!u!hO$R!kO$VfO'v)UO'xTO'{UO(TVO(c[O(p;`O~O{)XO!i#xO~O!W$aO_$la'm$la'k$la!h$la!T$la!Y$la%b$la!b$la~O#q)]O~P!&^Oz)`O!b)_O!Y$YX$U$YX$X$YX$Z$YX$b$YX~O!b)_O!Y(mX$U(mX$X(mX$Z(mX$b(mX~Oz)`O~P!-lOz)`O!Y(mX$U(mX$X(mX$Z(mX$b(mX~O!Y)bO$U)fO$X)aO$Z)aO$b)gO~O!V)jO~P!*SO$X$gO$Z$fO$b)nO~Oh$tXz$tX}$tX!g$tX(k$tX(l$tX~OegXe$tXhgX!WgX#YgX~P!/bOm)pO~Or)qO(U)rO(V)tO~Oh)}Oz)vO})wO(k)yO(l){O~Oe)uO~P!0kOe*OO~Oj%SOl$tOm$sOn$sOt%TOv%UOx:[O}${O!Y$|O!d;fO!i$xO#d:bO$R%YO$n:^O$p:`O$s%ZO'xTO'{UO(P%RO(T$uO~O!V*SO'v*PO!h(qP~P!1YO#e*UO~O!i*VO~O!V*[O'v*XO!T(rP~P!1YOl*hO}*`O!]*fO!^*_O!_*_O!i*VO#U*gO%X*bO'w!lO(W!mO~O!X*eO~P!3`O!g#wOh(SXz(SX}(SX(k(SX(l(SX!W(SX#Y(SX~Oe(SX#z(SX~P!4XOh*kO#Y*jOe(RX!W(RX~O!W*lOe(QX~O'v&QOe(QP~O!i*sO~O'v(lO~Oj*wO}%aO!V#hO!Y%bO!y]O#c#kO#d#hO'v%`O!h(eP~O!b#uO#e*xO~O}%aO!V*zO!W(SO!Y%bO'v%`O!T(hP~Om'RO}*|O!V*{O'xTO'{UO(W(tO~O!X(jP~P!7SO!W*}O_(vX'm(vX~OP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO#w$YO(TVO(d$ZO(k#|O(l#}O~O_!ca!W!ca'm!ca'k!ca!T!ca!h!cap!ca!Y!ca%b!ca!b!ca~P!7zOz#yO{#zO}#{O!g#wO!i#xO(TVOP!oaY!oal!oa!W!oa!f!oa!m!oa#h!oa#i!oa#j!oa#k!oa#l!oa#m!oa#n!oa#o!oa#p!oa#r!oa#t!oa#v!oa#w!oa(d!oa(k!oa(l!oa~O_!oa'm!oa'k!oa!T!oa!h!oap!oa!Y!oa%b!oa!b!oa~P!:eOz#yO{#zO}#{O!g#wO!i#xO(TVOP!qaY!qal!qa!W!qa!f!qa!m!qa#h!qa#i!qa#j!qa#k!qa#l!qa#m!qa#n!qa#o!qa#p!qa#r!qa#t!qa#v!qa#w!qa(d!qa(k!qa(l!qa~O_!qa'm!qa'k!qa!T!qa!h!qap!qa!Y!qa%b!qa!b!qa~P!=OOh+WO!Y'VO%b+VO(P%RO~O!b+YO_(OX!Y(OX'm(OX!W(OX~O_%gO!YXO'm%gO~O!i%^O(P%RO~O!i%^O'v%`O(P%RO~O!b#uO#e(nO~O`+eO%c+fO'v+bO'xTO'{UO!X(zP~O!W+gO^(yX~OY+kO~O^+lO~O!Y%wO'v%`O'w!lO^(yP~O#Y+qO(P%RO~Oh+tO!Y$|O(P%RO~O!Y+vO~Oz+xO!YXO~O%g%nO~O!u+}O~Oc,SO~O`,TO'v#mO'xTO'{UO!X(xP~Oc%uO~O%c!QO'v&QO~P<wOY,YO^,XO~OPYOQYObzOcyOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!duO!iZO!lYO!mYO!nYO!pvO!uxO!y]O$VfO%a}O'xTO'{UO(TVO(c[O(piO~O!Y!eO!r!gO$R!kO'v!dO~P!DRO^,XO_%gO'm%gO~OPYOQYOb!jOc!iOjkOlYOmkOnkOtkOvYOxYO}WO!RkO!SkO!Y!eO!duO!iZO!lYO!mYO!nYO!pvO!u!hO$R!kO$VfO'v!dO'xTO'{UO(TVO(c[O(piO~O_,_O!rwO#q!OO%e!OO%f!OO%g!OO~P!FkO!i&fO~O&U,eO~O!Y,gO~O&g,iO&i,jOP&daQ&daW&da_&dab&dac&daj&dal&dam&dan&dat&dav&dax&da}&da!R&da!S&da!Y&da!d&da!i&da!l&da!m&da!n&da!p&da!r&da!u&da!y&da#q&da$R&da$V&da%a&da%c&da%e&da%f&da%g&da%j&da%l&da%o&da%p&da%r&da&O&da&U&da&W&da&Y&da&[&da&_&da&e&da&k&da&m&da&o&da&q&da&s&da'k&da'v&da'x&da'{&da(T&da(c&da(p&da!X&da&]&da`&da&b&da~O'v,oO~O!W|X!W!`X!X|X!X!`X!b|X!b!`X!i!`X#Y|X(P!`X~O!b,tO#Y,sO!W#bX!W(]X!X#bX!X(]X!b(]X!i(]X(P(]X~O!b,vO!i%^O(P%RO!W![X!X![X~Om!nO}!oO'xTO'{UO(W!mO~OP9qOQ9qOb;bOc!iOjkOl9qOmkOnkOtkOv9qOx9qO}WO!RkO!SkO!Y!eO!d9tO!iZO!l9qO!m9qO!n9qO!p9uO!r9xO!u!hO$R!kO$VfO'xTO'{UO(TVO(c[O(p;`O~O'v:gO~P# qO!W,zO!X([X~O!X,|O~O!b,tO#Y,sO!W#bX!X#bX~O!W,}O!X(jX~O!X-PO~O!^-QO!_-QO'w!lO~P# `O!X-TO~P'_Oh-WO!Y'VO~O!T-]O~Om!xa!]!xa!^!xa!_!xa!}!xa#O!xa#P!xa#Q!xa#R!xa#U!xa#V!xa'w!xa'x!xa'{!xa(W!xa(c!xa~P!#YO!m-bO#Y-`O~PBxO!^-dO!_-dO'w!lO~PChO_%gO#Y-`O'm%gO~O_%gO!b#uO#Y-`O'm%gO~O_%gO!b#uO!m-bO#Y-`O'm%gO(d'gO~O'r'oO's'oO't-iO~Op-jO~O!T'Oa!W'Oa~P!7zO!V-nO!T'OX!W'OX~P%[O!W'{O!T(Za~O!T(Za~PG[O!W(SO!T(ha~O}%aO!V-rO!Y%bO'v%`O!T'UX!W'UX~O#Y-tO!W(fa!h(fa_(fa'm(fa~O!b#uO~P#)wO!W(`O!h(ea~O}%aO!Y%bO#d-xO'v%`O~Oj-}O}%aO!V-zO!Y%bO!y]O#c-|O#d-zO'v%`O!W'XX!h'XX~O{.RO!i#xO~Oh.UO!Y'VO%b.TO(P%RO~O_#]i!W#]i'm#]i'k#]i!T#]i!h#]ip#]i!Y#]i%b#]i!b#]i~P!7zOh;lOz)vO})wO(k)yO(l){O~O#e#Xa_#Xa#Y#Xa'm#Xa!W#Xa!h#Xa!Y#Xa!T#Xa~P#,sO#e(SXP(SXY(SX_(SXl(SX{(SX!f(SX!i(SX!m(SX#h(SX#i(SX#j(SX#k(SX#l(SX#m(SX#n(SX#o(SX#p(SX#r(SX#t(SX#v(SX#w(SX'm(SX(T(SX(d(SX!h(SX!T(SX'k(SXp(SX!Y(SX%b(SX!b(SX~P!4XO!W._Oe(^X~P!0kOe.aO~O!W.bO!h(_X~P!7zO!h.eO~O!T.gO~OP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O(TVOY#gi_#gil#gi!W#gi!f#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi'm#gi(d#gi(k#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~O#h#gi~P#0oO#h$OO~P#0oOP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO(TVOY#gi_#gi!W#gi!f#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi'm#gi(d#gi(k#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~Ol#gi~P#3aOl$QO~P#3aOP$]Ol$QOz#yO{#zO}#{O!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO(TVO_#gi!W#gi#r#gi#t#gi#v#gi#w#gi'm#gi(d#gi(k#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~OY#gi!f#gi#m#gi#n#gi#o#gi#p#gi~P#6ROY$dO!f$SO#m$SO#n$SO#o$cO#p$SO~P#6ROP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO(TVO_#gi!W#gi#t#gi#v#gi#w#gi'm#gi(d#gi(l#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~O(k#gi~P#9SO(k#|O~P#9SOP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO(TVO(k#|O_#gi!W#gi#v#gi#w#gi'm#gi(d#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~O(l#gi~P#;tO(l#}O~P#;tOP$]OY$dOl$QOz#yO{#zO}#{O!f$SO!g#wO!i#xO!m$]O#h$OO#i$PO#j$PO#k$PO#l$RO#m$SO#n$SO#o$cO#p$SO#r$TO#t$VO#v$XO(TVO(k#|O(l#}O~O_#gi!W#gi#w#gi'm#gi(d#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~P#>fOPZXYZXlZXzZX{ZX}ZX!fZX!gZX!iZX!mZX#YZX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX(TZX(dZX(kZX(lZX!WZX!XZX~O#zZX~P#APOP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO#t:RO#v:TO#w:UO(TVO(d$ZO(k#|O(l#}O~O#z.iO~P#C^O#Y:ZO#|:ZO#z(YX!X(YX~P! UO_'[a!W'[a'm'[a'k'[a!h'[a!T'[ap'[a!Y'[a%b'[a!b'[a~P!7zOP#giY#gi_#gil#gi{#gi!W#gi!f#gi!g#gi!i#gi!m#gi#h#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi'm#gi(T#gi(d#gi'k#gi!T#gi!h#gip#gi!Y#gi%b#gi!b#gi~P#,sO_#{i!W#{i'm#{i'k#{i!T#{i!h#{ip#{i!Y#{i%b#{i!b#{i~P!7zO$X.nO$Z.nO~O$X.oO$Z.oO~O!b)_O#Y.pO!Y$_X$U$_X$X$_X$Z$_X$b$_X~O!V.qO~O!Y)bO$U.sO$X)aO$Z)aO$b.tO~O!W:VO!X(XX~P#C^O!X.uO~O!b)_O$b(mX~O$b.wO~Or)qO(U)rO(V.zO~O!T/OO~P!&^O!WdX!bdX!hdX!h$tX(ddX~P!/bO!h/UO~P#,sO!W/VO!b#uO(d'gO!h(qX~O!h/[O~O!V*SO'v%`O!h(qP~O#e/^O~O!T$tX!W$tX!b${X~P!/bO!W/_O!T(rX~P#,sO!b/aO~O!T/cO~Ol/gO!b#uO!i%^O(P%RO(d'gO~O'v/iO~O!b+YO~O_%gO!W/mO'm%gO~O!X/oO~P!3`O!^/pO!_/pO'w!lO(W!mO~O}/rO(W!mO~O#U/sO~O'v&QOe'aX!W'aX~O!W*lOe(Qa~Oe/xO~Oz/yO{/yO}/zOhwa(kwa(lwa!Wwa#Ywa~Oewa#zwa~P$ tOz)vO})wOh$ma(k$ma(l$ma!W$ma#Y$ma~Oe$ma#z$ma~P$!jOz)vO})wOh$oa(k$oa(l$oa!W$oa#Y$oa~Oe$oa#z$oa~P$#]O#e/|O~Oe$}a!W$}a#Y$}a#z$}a~P!0kO!b#uO~O#e0PO~O!W*}O_(va'm(va~Oz#yO{#zO}#{O!g#wO!i#xO(TVOP!oiY!oil!oi!W!oi!f!oi!m!oi#h!oi#i!oi#j!oi#k!oi#l!oi#m!oi#n!oi#o!oi#p!oi#r!oi#t!oi#v!oi#w!oi(d!oi(k!oi(l!oi~O_!oi'm!oi'k!oi!T!oi!h!oip!oi!Y!oi%b!oi!b!oi~P$$zOh.UO!Y'VO%b.TO~Oj0ZO'v0YO~P!1]O!b+YO_(Oa!Y(Oa'm(Oa!W(Oa~O#e0aO~OYZX!WdX!XdX~O!W0bO!X(zX~O!X0dO~OY0eO~O`0gO'v+bO'xTO'{UO~O!Y%wO'v%`O^'iX!W'iX~O!W+gO^(ya~O!h0jO~P!7zOY0mO~O^0nO~O#Y0qO~Oh0tO!Y$|O~O(W(tO!X(wP~Oh0}O!Y0zO%b0|O(P%RO~OY1XO!W1VO!X(xX~O!X1YO~O^1[O_%gO'm%gO~O'v#mO'xTO'{UO~O#Y$eO#|$eOP(YXY(YXl(YXz(YX{(YX}(YX!W(YX!f(YX!i(YX!m(YX#h(YX#i(YX#j(YX#k(YX#l(YX#m(YX#n(YX#o(YX#r(YX#t(YX#v(YX#w(YX(T(YX(d(YX(k(YX(l(YX~O#p1_O&S1`O_(YX!g(YX~P$+sO#Y$eO#p1_O&S1`O~O_1bO~P%[O_1dO~O&]1gOP&ZiQ&ZiW&Zi_&Zib&Zic&Zij&Zil&Zim&Zin&Zit&Ziv&Zix&Zi}&Zi!R&Zi!S&Zi!Y&Zi!d&Zi!i&Zi!l&Zi!m&Zi!n&Zi!p&Zi!r&Zi!u&Zi!y&Zi#q&Zi$R&Zi$V&Zi%a&Zi%c&Zi%e&Zi%f&Zi%g&Zi%j&Zi%l&Zi%o&Zi%p&Zi%r&Zi&O&Zi&U&Zi&W&Zi&Y&Zi&[&Zi&_&Zi&e&Zi&k&Zi&m&Zi&o&Zi&q&Zi&s&Zi'k&Zi'v&Zi'x&Zi'{&Zi(T&Zi(c&Zi(p&Zi!X&Zi`&Zi&b&Zi~O`1mO!X1kO&b1lO~P`O!YXO!i1oO~O&i,jOP&diQ&diW&di_&dib&dic&dij&dil&dim&din&dit&div&dix&di}&di!R&di!S&di!Y&di!d&di!i&di!l&di!m&di!n&di!p&di!r&di!u&di!y&di#q&di$R&di$V&di%a&di%c&di%e&di%f&di%g&di%j&di%l&di%o&di%p&di%r&di&O&di&U&di&W&di&Y&di&[&di&_&di&e&di&k&di&m&di&o&di&q&di&s&di'k&di'v&di'x&di'{&di(T&di(c&di(p&di!X&di&]&di`&di&b&di~O!T1uO~O!W![a!X![a~P#C^Om!nO}!oO!V1{O(W!mO!W'PX!X'PX~P@OO!W,zO!X([a~O!W'VX!X'VX~P!7SO!W,}O!X(ja~O!X2SO~P'_O_%gO#Y2]O'm%gO~O_%gO!b#uO#Y2]O'm%gO~O_%gO!b#uO!m2aO#Y2]O'm%gO(d'gO~O_%gO'm%gO~P!7zO!W$aOp$la~O!T'Oi!W'Oi~P!7zO!W'{O!T(Zi~O!W(SO!T(hi~O!T(ii!W(ii~P!7zO!W(fi!h(fi_(fi'm(fi~P!7zO#Y2cO!W(fi!h(fi_(fi'm(fi~O!W(`O!h(ei~O}%aO!Y%bO!y]O#c2hO#d2gO'v%`O~O}%aO!Y%bO#d2gO'v%`O~Oh2oO!Y'VO%b2nO~Oh2oO!Y'VO%b2nO(P%RO~O#ewaPwaYwa_walwa!fwa!gwa!iwa!mwa#hwa#iwa#jwa#kwa#lwa#mwa#nwa#owa#pwa#rwa#twa#vwa#wwa'mwa(Twa(dwa!hwa!Twa'kwapwa!Ywa%bwa!bwa~P$ tO#e$maP$maY$ma_$mal$ma{$ma!f$ma!g$ma!i$ma!m$ma#h$ma#i$ma#j$ma#k$ma#l$ma#m$ma#n$ma#o$ma#p$ma#r$ma#t$ma#v$ma#w$ma'm$ma(T$ma(d$ma!h$ma!T$ma'k$map$ma!Y$ma%b$ma!b$ma~P$!jO#e$oaP$oaY$oa_$oal$oa{$oa!f$oa!g$oa!i$oa!m$oa#h$oa#i$oa#j$oa#k$oa#l$oa#m$oa#n$oa#o$oa#p$oa#r$oa#t$oa#v$oa#w$oa'm$oa(T$oa(d$oa!h$oa!T$oa'k$oap$oa!Y$oa%b$oa!b$oa~P$#]O#e$}aP$}aY$}a_$}al$}a{$}a!W$}a!f$}a!g$}a!i$}a!m$}a#h$}a#i$}a#j$}a#k$}a#l$}a#m$}a#n$}a#o$}a#p$}a#r$}a#t$}a#v$}a#w$}a'm$}a(T$}a(d$}a!h$}a!T$}a'k$}a#Y$}ap$}a!Y$}a%b$}a!b$}a~P#,sO_#]q!W#]q'm#]q'k#]q!T#]q!h#]qp#]q!Y#]q%b#]q!b#]q~P!7zOe'QX!W'QX~P!'vO!W._Oe(^a~O!V2wO!W'RX!h'RX~P%[O!W.bO!h(_a~O!W.bO!h(_a~P!7zO!T2zO~O#z!ka!X!ka~PJxO#z!ca!W!ca!X!ca~P#C^O#z!oa!X!oa~P!:eO#z!qa!X!qa~P!=OO!Y3^O$VfO$`3_O~O!X3cO~Op3dO~P#,sO_$iq!W$iq'm$iq'k$iq!T$iq!h$iqp$iq!Y$iq%b$iq!b$iq~P!7zO!T3eO~P#,sOz)vO})wO(l){Oh%Yi(k%Yi!W%Yi#Y%Yi~Oe%Yi#z%Yi~P$J]Oz)vO})wOh%[i(k%[i(l%[i!W%[i#Y%[i~Oe%[i#z%[i~P$KOO(d$ZO~P#,sO!V3hO'v%`O!W']X!h']X~O!W/VO!h(qa~O!W/VO!b#uO!h(qa~O!W/VO!b#uO(d'gO!h(qa~Oe$vi!W$vi#Y$vi#z$vi~P!0kO!V3pO'v*XO!T'_X!W'_X~P!1YO!W/_O!T(ra~O!W/_O!T(ra~P#,sO!b#uO#p3xO~Ol3{O!b#uO(d'gO~Oe(Ri!W(Ri~P!0kO#Y4OOe(Ri!W(Ri~P!0kO!h4RO~O_$jq!W$jq'm$jq'k$jq!T$jq!h$jqp$jq!Y$jq%b$jq!b$jq~P!7zO!T4VO~O!W4WO!Y(sX~P#,sO!g#wO~P4XO_$tX!Y$tX%VZX'm$tX!W$tX~P!/bO%V4YO_iXhiXziX}iX!YiX'miX(kiX(liX!WiX~O%V4YO~O`4`O%c4aO'v+bO'xTO'{UO!W'hX!X'hX~O!W0bO!X(za~OY4eO~O^4fO~O_%gO'm%gO~P#,sO!Y$|O~P#,sO!W4nO#Y4pO!X(wX~O!X4qO~Om!nO}4rO!]!xO!^!uO!_!uO!y9rO!}!pO#O!pO#P!pO#Q!pO#R!pO#U4wO#V!yO'w!lO'xTO'{UO(W!mO(c!sO~O!X4vO~P%%QOh4|O!Y0zO%b4{O~Oh4|O!Y0zO%b4{O(P%RO~O`5TO'v#mO'xTO'{UO!W'gX!X'gX~O!W1VO!X(xa~O'xTO'{UO(W5VO~O^5ZO~O#p5^O&S5_O~PMhO!h5`O~P%[O_5bO~O_5bO~P%[O`1mO!X5gO&b1lO~P`O!b5iO~O!b5kO!W(]i!X(]i!b(]i!i(]i(P(]i~O!W#bi!X#bi~P#C^O#Y5lO!W#bi!X#bi~O!W![i!X![i~P#C^O_%gO#Y5uO'm%gO~O_%gO!b#uO#Y5uO'm%gO~O!W(fq!h(fq_(fq'm(fq~P!7zO!W(`O!h(eq~O}%aO!Y%bO#d5|O'v%`O~O!Y'VO%b6PO~Oh6SO!Y'VO%b6PO~O#e%YiP%YiY%Yi_%Yil%Yi{%Yi!f%Yi!g%Yi!i%Yi!m%Yi#h%Yi#i%Yi#j%Yi#k%Yi#l%Yi#m%Yi#n%Yi#o%Yi#p%Yi#r%Yi#t%Yi#v%Yi#w%Yi'm%Yi(T%Yi(d%Yi!h%Yi!T%Yi'k%Yip%Yi!Y%Yi%b%Yi!b%Yi~P$J]O#e%[iP%[iY%[i_%[il%[i{%[i!f%[i!g%[i!i%[i!m%[i#h%[i#i%[i#j%[i#k%[i#l%[i#m%[i#n%[i#o%[i#p%[i#r%[i#t%[i#v%[i#w%[i'm%[i(T%[i(d%[i!h%[i!T%[i'k%[ip%[i!Y%[i%b%[i!b%[i~P$KOO#e$viP$viY$vi_$vil$vi{$vi!W$vi!f$vi!g$vi!i$vi!m$vi#h$vi#i$vi#j$vi#k$vi#l$vi#m$vi#n$vi#o$vi#p$vi#r$vi#t$vi#v$vi#w$vi'm$vi(T$vi(d$vi!h$vi!T$vi'k$vi#Y$vip$vi!Y$vi%b$vi!b$vi~P#,sOe'Qa!W'Qa~P!0kO!W'Ra!h'Ra~P!7zO!W.bO!h(_i~O#z#]i!W#]i!X#]i~P#C^OP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O(TVOY#gil#gi!f#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi#z#gi(d#gi(k#gi(l#gi!W#gi!X#gi~O#h#gi~P%3jO#h9zO~P%3jOP$]Oz#yO{#zO}#{O!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O(TVOY#gi!f#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi#z#gi(d#gi(k#gi(l#gi!W#gi!X#gi~Ol#gi~P%5uOl9|O~P%5uOP$]Ol9|Oz#yO{#zO}#{O!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O(TVO#r#gi#t#gi#v#gi#w#gi#z#gi(d#gi(k#gi(l#gi!W#gi!X#gi~OY#gi!f#gi#m#gi#n#gi#o#gi#p#gi~P%8QOY:YO!f:OO#m:OO#n:OO#o:XO#p:OO~P%8QOP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO(TVO#t#gi#v#gi#w#gi#z#gi(d#gi(l#gi!W#gi!X#gi~O(k#gi~P%:lO(k#|O~P%:lOP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO#t:RO(TVO(k#|O#v#gi#w#gi#z#gi(d#gi!W#gi!X#gi~O(l#gi~P%<wO(l#}O~P%<wOP$]OY:YOl9|Oz#yO{#zO}#{O!f:OO!g#wO!i#xO!m$]O#h9zO#i9{O#j9{O#k9{O#l9}O#m:OO#n:OO#o:XO#p:OO#r:PO#t:RO#v:TO(TVO(k#|O(l#}O~O#w#gi#z#gi(d#gi!W#gi!X#gi~P%?SO_#xy!W#xy'm#xy'k#xy!T#xy!h#xyp#xy!Y#xy%b#xy!b#xy~P!7zOh;mOz)vO})wO(k)yO(l){O~OP#giY#gil#gi{#gi!f#gi!g#gi!i#gi!m#gi#h#gi#i#gi#j#gi#k#gi#l#gi#m#gi#n#gi#o#gi#p#gi#r#gi#t#gi#v#gi#w#gi#z#gi(T#gi(d#gi!W#gi!X#gi~P%AzO!g#wOP(SXY(SXh(SXl(SXz(SX{(SX}(SX!f(SX!i(SX!m(SX#h(SX#i(SX#j(SX#k(SX#l(SX#m(SX#n(SX#o(SX#p(SX#r(SX#t(SX#v(SX#w(SX#z(SX(T(SX(d(SX(k(SX(l(SX!W(SX!X(SX~O#z#{i!W#{i!X#{i~P#C^O#z!oi!X!oi~P$$zO!X6`O~O!W'[a!X'[a~P#C^O!b#uO(d'gO!W']a!h']a~O!W/VO!h(qi~O!W/VO!b#uO!h(qi~Oe$vq!W$vq#Y$vq#z$vq~P!0kO!T'_a!W'_a~P#,sO!b6gO~O!W/_O!T(ri~P#,sO!W/_O!T(ri~O!T6kO~O!b#uO#p6pO~Ol6qO!b#uO(d'gO~O!T6sO~Oe$xq!W$xq#Y$xq#z$xq~P!0kO_$jy!W$jy'm$jy'k$jy!T$jy!h$jyp$jy!Y$jy%b$jy!b$jy~P!7zO!b5kO~O!W4WO!Y(sa~O_#]y!W#]y'm#]y'k#]y!T#]y!h#]yp#]y!Y#]y%b#]y!b#]y~P!7zOY6xO~O`6zO'v+bO'xTO'{UO~O!W0bO!X(zi~O^7OO~O(W(tO!W'dX!X'dX~O!W4nO!X(wa~OjkO'v7VO~P.iO!X7YO~P%%QOm!nO}7ZO'xTO'{UO(W!mO(c!sO~O!Y0zO~O!Y0zO%b7]O~Oh7`O!Y0zO%b7]O~OY7eO!W'ga!X'ga~O!W1VO!X(xi~O!h7iO~O!h7jO~O!h7mO~O!h7mO~P%[O_7oO~O!b7pO~O!h7qO~O!W(ii!X(ii~P#C^O_%gO#Y7yO'm%gO~O!W(fy!h(fy_(fy'm(fy~P!7zO!W(`O!h(ey~O!Y'VO%b7|O~O#e$vqP$vqY$vq_$vql$vq{$vq!W$vq!f$vq!g$vq!i$vq!m$vq#h$vq#i$vq#j$vq#k$vq#l$vq#m$vq#n$vq#o$vq#p$vq#r$vq#t$vq#v$vq#w$vq'm$vq(T$vq(d$vq!h$vq!T$vq'k$vq#Y$vqp$vq!Y$vq%b$vq!b$vq~P#,sO#e$xqP$xqY$xq_$xql$xq{$xq!W$xq!f$xq!g$xq!i$xq!m$xq#h$xq#i$xq#j$xq#k$xq#l$xq#m$xq#n$xq#o$xq#p$xq#r$xq#t$xq#v$xq#w$xq'm$xq(T$xq(d$xq!h$xq!T$xq'k$xq#Y$xqp$xq!Y$xq%b$xq!b$xq~P#,sO!W'Ri!h'Ri~P!7zO#z#]q!W#]q!X#]q~P#C^Oz/yO{/yO}/zOPwaYwahwalwa!fwa!gwa!iwa!mwa#hwa#iwa#jwa#kwa#lwa#mwa#nwa#owa#pwa#rwa#twa#vwa#wwa#zwa(Twa(dwa(kwa(lwa!Wwa!Xwa~Oz)vO})wOP$maY$mah$mal$ma{$ma!f$ma!g$ma!i$ma!m$ma#h$ma#i$ma#j$ma#k$ma#l$ma#m$ma#n$ma#o$ma#p$ma#r$ma#t$ma#v$ma#w$ma#z$ma(T$ma(d$ma(k$ma(l$ma!W$ma!X$ma~Oz)vO})wOP$oaY$oah$oal$oa{$oa!f$oa!g$oa!i$oa!m$oa#h$oa#i$oa#j$oa#k$oa#l$oa#m$oa#n$oa#o$oa#p$oa#r$oa#t$oa#v$oa#w$oa#z$oa(T$oa(d$oa(k$oa(l$oa!W$oa!X$oa~OP$}aY$}al$}a{$}a!f$}a!g$}a!i$}a!m$}a#h$}a#i$}a#j$}a#k$}a#l$}a#m$}a#n$}a#o$}a#p$}a#r$}a#t$}a#v$}a#w$}a#z$}a(T$}a(d$}a!W$}a!X$}a~P%AzO#z$iq!W$iq!X$iq~P#C^O#z$jq!W$jq!X$jq~P#C^O!X8WO~O#z8XO~P!0kO!b#uO!W']i!h']i~O!b#uO(d'gO!W']i!h']i~O!W/VO!h(qq~O!T'_i!W'_i~P#,sO!W/_O!T(rq~O!T8_O~P#,sO!T8_O~Oe(Ry!W(Ry~P!0kO!W'ba!Y'ba~P#,sO_%Uq!Y%Uq'm%Uq!W%Uq~P#,sOY8dO~O!W0bO!X(zq~O#Y8hO!W'da!X'da~O!W4nO!X(wi~P#C^OPZXYZXlZXzZX{ZX}ZX!TZX!WZX!fZX!gZX!iZX!mZX#YZX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX(TZX(dZX(kZX(lZX~O!b%SX#p%SX~P&3YO!Y0zO%b8lO~O'xTO'{UO(W8qO~O!W1VO!X(xq~O!h8tO~O!h8uO~O!h8vO~O!h8vO~P%[O#Y8yO!W#by!X#by~O!W#by!X#by~P#C^O!Y'VO%b9OO~O#z#xy!W#xy!X#xy~P#C^OP$viY$vil$vi{$vi!f$vi!g$vi!i$vi!m$vi#h$vi#i$vi#j$vi#k$vi#l$vi#m$vi#n$vi#o$vi#p$vi#r$vi#t$vi#v$vi#w$vi#z$vi(T$vi(d$vi!W$vi!X$vi~P%AzOz)vO})wO(l){OP%YiY%Yih%Yil%Yi{%Yi!f%Yi!g%Yi!i%Yi!m%Yi#h%Yi#i%Yi#j%Yi#k%Yi#l%Yi#m%Yi#n%Yi#o%Yi#p%Yi#r%Yi#t%Yi#v%Yi#w%Yi#z%Yi(T%Yi(d%Yi(k%Yi!W%Yi!X%Yi~Oz)vO})wOP%[iY%[ih%[il%[i{%[i!f%[i!g%[i!i%[i!m%[i#h%[i#i%[i#j%[i#k%[i#l%[i#m%[i#n%[i#o%[i#p%[i#r%[i#t%[i#v%[i#w%[i#z%[i(T%[i(d%[i(k%[i(l%[i!W%[i!X%[i~O#z$jy!W$jy!X$jy~P#C^O#z#]y!W#]y!X#]y~P#C^O!b#uO!W']q!h']q~O!W/VO!h(qy~O!T'_q!W'_q~P#,sO!T9VO~P#,sO!W0bO!X(zy~O!W4nO!X(wq~O!Y0zO%b9^O~O!h9aO~O!Y'VO%b9fO~OP$vqY$vql$vq{$vq!f$vq!g$vq!i$vq!m$vq#h$vq#i$vq#j$vq#k$vq#l$vq#m$vq#n$vq#o$vq#p$vq#r$vq#t$vq#v$vq#w$vq#z$vq(T$vq(d$vq!W$vq!X$vq~P%AzOP$xqY$xql$xq{$xq!f$xq!g$xq!i$xq!m$xq#h$xq#i$xq#j$xq#k$xq#l$xq#m$xq#n$xq#o$xq#p$xq#r$xq#t$xq#v$xq#w$xq#z$xq(T$xq(d$xq!W$xq!X$xq~P%AzOe%^!Z!W%^!Z#Y%^!Z#z%^!Z~P!0kO!W'dq!X'dq~P#C^O!W#b!Z!X#b!Z~P#C^O#e%^!ZP%^!ZY%^!Z_%^!Zl%^!Z{%^!Z!W%^!Z!f%^!Z!g%^!Z!i%^!Z!m%^!Z#h%^!Z#i%^!Z#j%^!Z#k%^!Z#l%^!Z#m%^!Z#n%^!Z#o%^!Z#p%^!Z#r%^!Z#t%^!Z#v%^!Z#w%^!Z'm%^!Z(T%^!Z(d%^!Z!h%^!Z!T%^!Z'k%^!Z#Y%^!Zp%^!Z!Y%^!Z%b%^!Z!b%^!Z~P#,sOP%^!ZY%^!Zl%^!Z{%^!Z!f%^!Z!g%^!Z!i%^!Z!m%^!Z#h%^!Z#i%^!Z#j%^!Z#k%^!Z#l%^!Z#m%^!Z#n%^!Z#o%^!Z#p%^!Z#r%^!Z#t%^!Z#v%^!Z#w%^!Z#z%^!Z(T%^!Z(d%^!Z!W%^!Z!X%^!Z~P%AzOp(XX~P1qO'w!lO~P!*SO!TdX!WdX#YdX~P&3YOPZXYZXlZXzZX{ZX}ZX!WZX!WdX!fZX!gZX!iZX!mZX#YZX#YdX#edX#hZX#iZX#jZX#kZX#lZX#mZX#nZX#oZX#pZX#rZX#tZX#vZX#wZX#|ZX(TZX(dZX(kZX(lZX~O!bdX!hZX!hdX(ddX~P&HpOP9qOQ9qOb;bOc!iOjkOl9qOmkOnkOtkOv9qOx9qO}WO!RkO!SkO!YXO!d9tO!iZO!l9qO!m9qO!n9qO!p9uO!r9xO!u!hO$R!kO$VfO'v)UO'xTO'{UO(TVO(c[O(p;`O~O!W:VO!X$la~Oj%SOl$tOm$sOn$sOt%TOv%UOx:]O}${O!Y$|O!d;gO!i$xO#d:cO$R%YO$n:_O$p:aO$s%ZO'v(lO'xTO'{UO(P%RO(T$uO~O#q)]O~P&MfO!XZX!XdX~P&HpO#e9yO~O!b#uO#e9yO~O#Y:ZO~O#p:OO~O#Y:eO!W(iX!X(iX~O#Y:ZO!W(gX!X(gX~O#e:fO~Oe:hO~P!0kO#e:mO~O#e:nO~O!b#uO#e:oO~O!b#uO#e:fO~O#z:pO~P#C^O#e:qO~O#e:rO~O#e:sO~O#e:tO~O#e:uO~O#e:vO~O#z:wO~P!0kO#z:xO~P!0kO$V~!g!}#O#Q#R#U#c#d#o(p$n$p$s%V%a%b%c%j%l%o%p%r%t~'qR$V(p#i!S'o'w#jm#h#klz'p(W'p'v$X$Z$X~","goto":"$'X)OPPPP)PPP)SP)eP*t.xPPPP5`PP5vP;r>yP?^P?^PPP?^PAOP?^P?^P?^PASPPAXPArPFjPPPFnPPPPFnIoPPPIuJpPFnPMOPPPP! ^FnPPPFnPFnP!#lFnP!'Q!(S!(]P!)P!)T!)PPPPPP!,`!(SPP!,|!-vP!0jFnFn!0o!3y!8`!8`!<UPPP!<]FnPPPPPPPPPPP!?jP!@{PPFn!BYPFnPFnFnFnFnPFn!ClPP!FtP!IxP!I|!JW!J[!J[P!FqP!J`!J`P!MdP!MhFnFn!Mn#!q?^P?^P?^?^P##|?^?^#%x?^#(X?^#)}?^?^#*l#,j#,j#,n#,v#,j#-OP#,jP?^#-h?^#.q?^?^5`PPP#/}PPP#0h#0hP#0hP#1O#0hPP#1UP#0{P#0{#1i#0{#2T#2Z5])S#2^)SP#2e#2e#2eP)SP)SP)SP)SPP)SP#2k#2nP#2n)SP#2rP#2uP)SP)SP)SP)SP)SP)S)SPP#2{#3R#3^#3d#3j#3p#3v#4U#4[#4b#4l#4r#4|#5]#5c#6T#6g#6m#6s#7R#7h#8y#9X#9_#9e#9k#9q#9{#:R#:X#:c#:u#:{PPPPPPPPPP#;RPPPPPPP#;v#>}P#@^#@e#@mPPPP#D{#Gr#NZ#N^#Na$ Y$ ]$ `$ g$ oPP$ u$ y$!q$#p$#t$$YPP$$^$$d$$hP$$k$$o$$r$%h$&P$&h$&l$&o$&r$&x$&{$'P$'TR!{RoqOXst!Z#c%f&i&k&l&n,b,g1g1jY!uQ'V-S0z4uQ%lvQ%tyQ%{|Q&a!VS&}!e,zQ']!iS'c!r!xS*_$|*dQ+`%uQ+m%}Q,R&ZQ-Q'UQ-['^Q-d'dQ/p*fQ1U,SR:d9u%OdOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|,_,b,g-W-`-n-t.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2w4r4|5^5_5b5u7Z7`7o7yS#p]9r!r)W$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ*o%VQ+e%wQ,T&^Q,[&fQ.X:[Q0W+WQ0[+YQ0g+fQ1^,YQ2k.UQ4`0bQ5T1VQ6R2oQ6X:]Q6z4aR8P6S&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;ct!nQ!r!u!x!y&}'U'V'c'd'e,z-Q-S-d0z4u4w$^$si#u#w$c$d$x${%W%X%])q)w)z)|)}*U*[*j*k+V+Y+q+t.T._/P/^/_/a/|0q0t0|2n3f3p3x4O4W4Y4{6P6g6p7]7|8X8l9O9^9f:X:Y:^:_:`:a:b:c:i:j:k:l:m:n:q:r:s:t:w:x;`;h;i;l;mQ&O|Q&{!eS'R%b,}Q+e%wQ,T&^Q/{*sQ0g+fQ0l+lQ1],XQ1^,YQ4`0bQ4i0nQ5T1VQ5W1XQ5X1[Q6z4aQ6}4fQ7h5ZQ8g7OR8r7ernOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jR,V&b&v^OPXYstuvwz!Z!`!g!j!o#R#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'X'i'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;b;c[#[WZ#V#Y'O'y!S%cm#g#h#k%^%a(S(^(_(`*z*{*},^,t-r-x-y-z-|1o2g2h5k5|Q%oxQ%syS%x|%}Q&U!TQ'Y!hQ'[!iQ(g#rS*R$x*VS+_%t%uQ+c%wQ+|&XQ,Q&ZS-Z']'^Q.W(hQ/Z*SQ0`+`Q0f+fQ0h+gQ0k+kQ1P+}S1T,R,SQ2X-[Q3g/VQ4_0bQ4c0eQ4h0mQ5S1UQ6d3hQ6y4aQ6|4eQ8c6xR9X8dv$zi#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;i!S%qy!i!t%s%t%u&|'[']'^'b'l*^+_+`,w-Z-[-c/h0`2Q2X2`3zQ+X%oQ+r&RQ+u&SQ,P&ZQ.V(gQ1O+|U1S,Q,R,SQ2p.WQ4}1PS5R1T1UQ7d5S#O;d#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mg;e:X:Y:_:a:c:j:l:n:r:t:xW%Pi%R*l;`S&R!Q&`Q&S!RQ&T!SR+p&P$_%Oi#u#w$c$d$x${%W%X%])q)w)z)|)}*U*[*j*k+V+Y+q+t.T._/P/^/_/a/|0q0t0|2n3f3p3x4O4W4Y4{6P6g6p7]7|8X8l9O9^9f:X:Y:^:_:`:a:b:c:i:j:k:l:m:n:q:r:s:t:w:x;`;h;i;l;mT)r$u)sV*p%V:[:]U'R!e%b,}S(u#y#zQ+j%zS.P(c(dQ0u+vQ4P/yR7S4n&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;c$i$`c#X#d%j%k%m'x(O(j(q(y(z({(|(})O)P)Q)R)S)T)V)Y)^)h+T+i,x-g-l-q-s.^.d.h.j.k.l.{/}1v1y2Z2b2v2{2|2}3O3P3Q3R3S3T3U3V3W3X3[3]3b4T4]5n5t5y6V6W6]6^7U7s7w8Q8U8V8{9Z9b9s;VT#SV#T&}kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ'P!eR1|,zv!nQ!e!r!u!x!y&}'U'V'c'd'e,z-Q-S-d0z4u4wS*^$|*dS/h*_*fQ/q*gQ0w+xQ3z/pR3}/snqOXst!Z#c%f&i&k&l&n,b,g1g1jQ&p!^Q'm!wS(i#t9yQ+]%rQ+z&UQ+{&WQ-X'ZQ-f'fS.](n:fS0O*x:oQ0^+^Q0y+yQ1n,iQ1p,jQ1x,uQ2V-YQ2Y-^S4U0P:uQ4Z0_S4^0a:vQ5m1zQ5q2WQ5v2_Q6w4[Q7t5oQ7u5rQ7x5wR8x7q$d$_c#X#d%k%m'x(O(j(q(y(z({(|(})O)P)Q)R)S)T)V)Y)^)h+T+i,x-g-l-q-s.^.d.h.k.l.{/}1v1y2Z2b2v2{2|2}3O3P3Q3R3S3T3U3V3W3X3[3]3b4T4]5n5t5y6V6W6]6^7U7s7w8Q8U8V8{9Z9b9s;VS(f#o'`U*i$}(m3ZS+S%j.jQ2l0WQ6O2kQ8O6RR9P8P$d$^c#X#d%k%m'x(O(j(q(y(z({(|(})O)P)Q)R)S)T)V)Y)^)h+T+i,x-g-l-q-s.^.d.h.k.l.{/}1v1y2Z2b2v2{2|2}3O3P3Q3R3S3T3U3V3W3X3[3]3b4T4]5n5t5y6V6W6]6^7U7s7w8Q8U8V8{9Z9b9s;VS(e#o'`S(w#z$_S+R%j.jS.Q(d(fQ.m)XQ0T+SR2i.R&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cS#p]9rQ&k!XQ&l!YQ&n![Q&o!]R1f,eQ'W!hQ+U%oQ-V'YS.S(g+XQ2T-UW2m.V.W0V0XQ5p2UU5}2j2l2pS7{6O6QS8}7}8OS9d8|9PQ9l9eR9o9mU!vQ'V-ST4s0z4u!Q_OXZ`st!V!Z#c#g%^%f&`&b&i&k&l&n(`,b,g-y1g1j]!pQ!r'V-S0z4uT#p]9r%Y{OPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yS(u#y#zS.P(c(d!s:|$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cY!tQ'V-S0z4uQ'b!rS'l!u!xS'n!y4wS-c'c'dQ-e'eR2`-dQ'k!tS([#f1aS-b'b'nQ/Y*RQ/f*^Q2a-eQ3l/ZS3u/g/qQ6c3gS6n3{3}Q8Z6dR8b6qQ#vbQ'j!tS(Z#f1aS(]#l*wQ*y%_Q+Z%pQ+a%vU-a'b'k'nQ-u([Q/X*RQ/e*^Q/k*aQ0]+[Q1Q,OS2^-b-eQ2f-}S3k/Y/ZS3t/f/qQ3w/jQ3y/lQ5P1RQ5x2aQ6b3gQ6f3lS6j3u3}Q6o3|Q7b5QS8Y6c6dQ8^6kQ8`6nQ8o7cQ9T8ZQ9U8_Q9W8bQ9`8pQ9h9VQ;P:zQ;[;TR;];UV!vQ'V-S%YaOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yS#vz!j!r:y$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cR;P;b%YbOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yQ%_j!S%py!i!t%s%t%u&|'[']'^'b'l*^+_+`,w-Z-[-c/h0`2Q2X2`3zS%vz!jQ+[%qQ,O&ZW1R,P,Q,R,SU5Q1S1T1US7c5R5SQ8p7d!r:z$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ;T;aR;U;b$|eOPXYstuvw!Z!`!g!o#R#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&i&k&l&n&r&z'X'i'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7yY#aWZ#V#Y'y!S%cm#g#h#k%^%a(S(^(_(`*z*{*},^,t-r-x-y-z-|1o2g2h5k5|Q,]&f!p:{$[$m)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cR;O'OS'S!e%bR2O,}%OdOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|,_,b,g-W-`-n-t.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2w4r4|5^5_5b5u7Z7`7o7y!r)W$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cQ,[&fQ0W+WQ2k.UQ6R2oR8P6S!f$Uc#X%j'x(O(j(q)Q)R)S)T)Y)^+i-g-l-q-s.^.d.{/}2Z2b2v3X4T4]5t5y6V7w8{9s!T:Q)V)h,x.j1v1y2{3T3U3V3W3[3b5n6W6]6^7U7s8Q8U8V9Z9b;V!b$Wc#X%j'x(O(j(q)S)T)Y)^+i-g-l-q-s.^.d.{/}2Z2b2v3X4T4]5t5y6V7w8{9s!P:S)V)h,x.j1v1y2{3V3W3[3b5n6W6]6^7U7s8Q8U8V9Z9b;V!^$[c#X%j'x(O(j(q)Y)^+i-g-l-q-s.^.d.{/}2Z2b2v3X4T4]5t5y6V7w8{9sQ3f/Tz;c)V)h,x.j1v1y2{3[3b5n6W6]6^7U7s8Q8U8V9Z9b;VQ;h;jR;i;k&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cS$nh$oR3_.p'TgOPWXYZhstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m$o%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.p.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cT$jf$pQ$hfS)a$k)eR)m$pT$if$pT)c$k)e'ThOPWXYZhstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m$o%f%l%y&b&e&f&i&k&l&n&r&z'O'X'i'y'{(R(Y(n(r(v)j)u*x*|+W,_,b,g,s,v-W-`-n-t.U.b.i.p.q/z0P0a0}1_1`1b1d1g1j1l1{2]2c2o2w3^4p4r4|5^5_5b5l5u6S7Z7`7o7y8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;cT$nh$oQ$qhR)l$o%YjOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%f%l%y&b&e&f&i&k&l&n&r&z'X'i'y'{(R(Y(n(r(v)u*x*|+W,_,b,g-W-`-n-t.U.b.i/z0P0a0}1_1`1b1d1g1j1l2]2c2o2w4r4|5^5_5b5u6S7Z7`7o7y!s;a$[$m'O)j,s,v.q1{3^4p5l8h8y9q9t9u9x9y9z9{9|9}:O:P:Q:R:S:T:U:V:Z:d:e:f:h:o:p:u:v;c#clOPXZst!Z!`!o#R#c#n#{$m%f&b&e&f&i&k&l&n&r&z'X(v)j*|+W,_,b,g-W.U.q/z0}1_1`1b1d1g1j1l2o3^4r4|5^5_5b6S7Z7`7ov$}i#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;i#O(m#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mQ*t%ZQ.|)vg3Z:X:Y:_:a:c:j:l:n:r:t:xv$yi#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;iQ*W$zS*a$|*dQ*u%[Q/l*b#O;R#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mf;S:X:Y:_:a:c:j:l:n:r:t:xQ;W;dQ;X;eQ;Y;fR;Z;gv$}i#w%W%X%])z)|*U*j*k._/^/|3f4O8X;`;h;i#O(m#u$c$d$x${)q)w)}*[+V+Y+q+t.T/P/_/a0q0t0|2n3p3x4W4Y4{6P6g6p7]7|8l9O9^9f:^:`:b:i:k:m:q:s:w;l;mg3Z:X:Y:_:a:c:j:l:n:r:t:xnoOXst!Z#c%f&i&k&l&n,b,g1g1jQ*Z${Q,p&uQ,q&wR3o/_$^%Oi#u#w$c$d$x${%W%X%])q)w)z)|)}*U*[*j*k+V+Y+q+t.T._/P/^/_/a/|0q0t0|2n3f3p3x4O4W4Y4{6P6g6p7]7|8X8l9O9^9f:X:Y:^:_:`:a:b:c:i:j:k:l:m:n:q:r:s:t:w:x;`;h;i;l;mQ+s&SQ0s+uQ4l0rR7R4mT*c$|*dS*c$|*dT4t0z4uS/j*`4rT3|/r7ZQ+Z%pQ/k*aQ0]+[Q1Q,OQ5P1RQ7b5QQ8o7cR9`8pn)z$v(o*v/]/t/u2t3m4S6a6r9S;Q;^;_!Y:i(k)[*Q*Y.[.x.}/T/b0U0p0r2s3n3r4k4m6T6U6h6l6t6v8]8a9g;j;k]:j3Y6[8R9Q9R9pp)|$v(o*v/R/]/t/u2t3m4S6a6r9S;Q;^;_![:k(k)[*Q*Y.[.x.}/T/b0U0p0r2q2s3n3r4k4m6T6U6h6l6t6v8]8a9g;j;k_:l3Y6[8R8S9Q9R9prnOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jQ&]!UR,_&frnOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jR&]!UQ+w&TR0o+psnOXst!V!Z#c%f&`&i&k&l&n,b,g1g1jQ0{+|S4z1O1PU7[4x4y4}S8k7^7_S9[8j8mQ9i9]R9n9jQ&d!VR,W&`R5W1XS%x|%}R0h+gQ&i!WR,b&jR,h&oT1h,g1jR,l&pQ,k&pR1q,lQ'p!zR-h'pSsOtQ#cXT%is#cQ!}TR'r!}Q#QUR't#QQ)s$uR.y)sQ#TVR'v#TQ#WWU'|#W'}-oQ'}#XR-o(OQ,{'PR1},{Q.`(oR2u.`Q.c(qS2x.c2yR2y.dQ-S'VR2R-SY!rQ'V-S0z4uR'a!rS#^W%aU(T#^(U-pQ(U#_R-p(PQ-O'SR2P-Ot`OXst!V!Z#c%f&`&b&i&k&l&n,b,g1g1jS#gZ%^U#q`#g-yR-y(`Q(a#iQ-v(]W.O(a-v2d5zQ2d-wR5z2eQ)e$kR.r)eQ$ohR)k$oQ$bcU)Z$b-k:WQ-k9sR:W)hQ/W*RW3i/W3j6e8[U3j/X/Y/ZS6e3k3lR8[6f#o)x$v(k(o)[*Q*Y*q*r*v.Y.Z.[.x.}/R/S/T/]/b/t/u0U0p0r2q2r2s2t3Y3m3n3r4S4k4m6T6U6Y6Z6[6a6h6l6r6t6v8R8S8T8]8a9Q9R9S9g9p;Q;^;_;j;kQ/`*YU3q/`3s6iQ3s/bR6i3rQ*d$|R/n*dQ*m%QR/w*mQ4X0UR6u4XQ+O%dR0S+OQ4o0uS7T4o8iR8i7UQ+y&UR0x+yQ4u0zR7X4uQ1W,TS5U1W7fR7f5WQ0c+cW4b0c4d6{8eQ4d0fQ6{4cR8e6|Q+h%xR0i+hQ1j,gR5f1jYrOXst#cQ&m!ZQ+Q%fQ,a&iQ,c&kQ,d&lQ,f&nQ1e,bS1h,g1jR5e1gQ%hpQ&q!_Q&t!aQ&v!bQ&x!cQ'h!tQ+P%eQ+]%rQ+o&OQ,V&dQ,n&sW-_'b'j'k'nQ-f'fQ/m*cQ0^+^S1Z,W,ZQ1r,mQ1s,pQ1t,qQ2Y-^W2[-a-b-e-gQ4Z0_Q4g0lQ4j0pQ5O1QQ5Y1]Q5d1fU5s2Z2^2aQ5v2_Q6w4[Q7P4iQ7Q4kQ7W4tQ7a5PQ7g5XS7v5t5xQ7x5wQ8f6}Q8n7bQ8s7hQ8z7wQ9Y8gQ9_8oQ9c8{R9k9`Q%ryQ'Z!iQ'f!tU+^%s%t%uQ,u&|U-Y'[']'^S-^'b'lQ/d*^S0_+_+`Q1z,wS2W-Z-[Q2_-cQ3v/hQ4[0`Q5o2QQ5r2XQ5w2`R6m3zS$wi;`R*n%RU%Qi%R;`R/v*lQ$viS(k#u+YQ(o#wS)[$c$dQ*Q$xQ*Y${Q*q%WQ*r%XQ*v%]Q.Y:^Q.Z:`Q.[:bQ.x)qS.})w/PQ/R)zQ/S)|Q/T)}Q/]*UQ/b*[Q/t*jQ/u*kh0U+V.T0|2n4{6P7]7|8l9O9^9fQ0p+qQ0r+tQ2q:iQ2r:kQ2s:mQ2t._S3Y:X:YQ3m/^Q3n/_Q3r/aQ4S/|Q4k0qQ4m0tQ6T:qQ6U:sQ6Y:_Q6Z:aQ6[:cQ6a3fQ6h3pQ6l3xQ6r4OQ6t4WQ6v4YQ8R:nQ8S:jQ8T:lQ8]6gQ8a6pQ9Q:rQ9R:tQ9S8XQ9g:wQ9p:xQ;Q;`Q;^;hQ;_;iQ;j;lR;k;mnpOXst!Z#c%f&i&k&l&n,b,g1g1jQ!fPS#eZ#nQ&s!`U'_!o4r7ZQ'u#RQ(x#{Q)i$mS,Z&b&eQ,`&fQ,m&rQ,r&zQ-U'XQ.f(vQ.v)jQ0Q*|Q0X+WQ1c,_Q2U-WQ2l.UQ3a.qQ4Q/zQ4y0}Q5[1_Q5]1`Q5a1bQ5c1dQ5h1lQ6O2oQ6_3^Q7_4|Q7k5^Q7l5_Q7n5bQ8O6SQ8m7`R8w7o#WcOPXZst!Z!`!o#c#n#{%f&b&e&f&i&k&l&n&r&z'X(v*|+W,_,b,g-W.U/z0}1_1`1b1d1g1j1l2o4r4|5^5_5b6S7Z7`7oQ#XWQ#dYQ%juQ%kvS%mw!gS'x#V'{Q(O#YQ(j#tQ(q#xQ(y$OQ(z$PQ({$QQ(|$RQ(}$SQ)O$TQ)P$UQ)Q$VQ)R$WQ)S$XQ)T$YQ)V$[Q)Y$aQ)^$eW)h$m)j.q3^Q+T%lQ+i%yS,x'O1{Q-g'iS-l'y-nQ-q(RQ-s(YQ.^(nQ.d(rQ.h9qQ.j9tQ.k9uQ.l9xQ.{)uQ/}*xQ1v,sQ1y,vQ2Z-`Q2b-tQ2v.bQ2{9yQ2|9zQ2}9{Q3O9|Q3P9}Q3Q:OQ3R:PQ3S:QQ3T:RQ3U:SQ3V:TQ3W:UQ3X.iQ3[:ZQ3]:dQ3b:VQ4T0PQ4]0aQ5n:eQ5t2]Q5y2cQ6V2wQ6W:fQ6]:hQ6^:oQ7U4pQ7s5lQ7w5uQ8Q:pQ8U:uQ8V:vQ8{7yQ9Z8hQ9b8yQ9s#RR;V;cR#ZWR'Q!eY!tQ'V-S0z4uS&|!e,zQ'b!rS'l!u!xS'n!y4wS,w&}'US-c'c'dQ-e'eQ2Q-QR2`-dR(p#wR(s#xQ!fQT-R'V-S]!qQ!r'V-S0z4uQ#o]R'`9rT#jZ%^S#iZ%^S%dm,^U(]#g#h#kS-w(^(_Q-{(`Q0R*}Q2e-xU2f-y-z-|S5{2g2hR7z5|`#]W#V#Y%a'y(S*z-rr#fZm#g#h#k%^(^(_(`*}-x-y-z-|2g2h5|Q1a,^Q1w,tQ5j1oQ7r5kT:}'O*{T#`W%aS#_W%aS'z#V(SS(P#Y*zS,y'O*{T-m'y-rT'T!e%bQ$kfR)o$pT)d$k)eR3`.pT*T$x*VR*]${Q0V+VQ2j.TQ4x0|Q6Q2nQ7^4{Q7}6PQ8j7]Q8|7|Q9]8lQ9e9OQ9j9^R9m9fnqOXst!Z#c%f&i&k&l&n,b,g1g1jQ&c!VR,V&`tmOXst!U!V!Z#c%f&`&i&k&l&n,b,g1g1jR,^&fT%em,^R0v+vR,U&^Q%||R+n%}R+d%wT&g!W&jT&h!W&jT1i,g1j",nodeNames:"\u26A0 ArithOp ArithOp LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > TypeParamList TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXStartTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:367,context:trackNewline,nodeProps:[["group",-26,7,15,17,63,200,204,208,209,211,214,217,227,229,235,237,239,241,244,250,256,258,260,262,264,266,267,"Statement",-32,11,12,26,29,30,36,46,49,50,52,57,65,73,77,79,81,82,104,105,114,115,132,135,137,138,139,140,142,143,163,164,166,"Expression",-23,25,27,31,35,37,39,167,169,171,172,174,175,176,178,179,180,182,183,184,194,196,198,199,"Type",-3,85,97,103,"ClassItem"],["openedBy",32,"InterpolationStart",51,"[",55,"{",70,"(",144,"JSXStartTag",156,"JSXStartTag JSXStartCloseTag"],["closedBy",34,"InterpolationEnd",45,"]",56,"}",71,")",145,"JSXSelfCloseEndTag JSXEndTag",161,"JSXEndTag"]],propSources:[jsHighlight],skippedNodes:[0,3,4,270],repeatNodeCount:33,tokenData:"$Fl(CSR!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#8g!R![#:v![!]#Gv!]!^#IS!^!_#J^!_!`#Nu!`!a$#a!a!b$(n!b!c$,m!c!}Er!}#O$-w#O#P$/R#P#Q$4j#Q#R$5t#R#SEr#S#T$7R#T#o$8]#o#p$<m#p#q$=c#q#r$>s#r#s$@P#s$f%Z$f$g+g$g#BYEr#BY#BZ$AZ#BZ$ISEr$IS$I_$AZ$I_$I|Er$I|$I}$Df$I}$JO$Df$JO$JTEr$JT$JU$AZ$JU$KVEr$KV$KW$AZ$KW&FUEr&FU&FV$AZ&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$AZ?HUOEr(n%d_$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$e&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$e&j'|!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU'|!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$e&j'ypOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU'ypOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z(CS+rq$e&j'yp'|!b'o(;dOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z(CS.ST'z#S$e&j'p(;dO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c(CS.n_$e&j'yp'|!b'p(;dOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`/x`$e&j!m$Ip'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S1V`#r$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S2d_#r$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2b3l_'x$(n$e&j'|!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k*r4r_$e&j'|!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k)`5vX$e&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q)`6jT$`#t$e&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#t6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y#t7bO$`#t#t7eP;=`<%l6y)`7kP;=`<%l5q*r7w]$`#t$e&j'|!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}%W8uZ'|!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p%W9oU$`#t'|!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}%W:UP;=`<%l8p*r:[P;=`<%l4k#%|:hh$e&j'yp'|!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__US$e&j'yp'|!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]US$e&j'|!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXUS$e&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSUSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWUS'|!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]US$e&j'ypOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWUS'ypOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYUS'yp'|!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S#%|C}i$e&j(c!L^'yp'|!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr#%|EoP;=`<%lCr(CSFRk$e&j'yp'|!b(W!LY'v&;d$X#tOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$e&j'yp'|!b$X#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv(CSJPP;=`<%lEr%#SJ_`$e&j'yp'|!b#j$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SKl_$e&j#|$Id'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%DfLva(l%<v$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SNW`$e&j#v$Id'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$2b! c_'{$)`$e&j'ypOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b*Q!!i_$e&j'ypOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b)`!#mX$e&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h#t!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y#t!$oP;=`<%l!$Y)`!$uP;=`<%l!#h*Q!%R]$`#t$e&j'ypOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r$f!&PZ'ypOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z$f!&yU$`#t'ypOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r$f!'`P;=`<%l!%z*Q!'fP;=`<%l!!b(*Q!'t_!i(!b$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'l!)O_!hM|$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h!*[b$e&j'yp'|!b'w#)d#k$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S!+o`$e&j'yp'|!b#h$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&-O!,|`$e&j'yp'|!bl&%`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&C[!.Z_!W&;l$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!/ec$e&j'yp'|!bz'<nOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!0ya$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!2Z_!VMt$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!3eg$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!5Vg$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!6wc$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!8_c$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!9uf$e&j'yp'|!b#i$IdOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpxz!;Zz{#,f{!P!;Z!P!Q#-{!Q!^!;Z!^!_#'Z!_!`#5k!`!a#7Q!a!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(r!;fb$e&j'yp'|!b!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(Q!<w`$e&j'|!b!SSOY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eb!Q!^!<n!^!_!GY!_!}!<n!}#O!Ja#O#P!Dj#P#o!<n#o#p!GY#p;'S!<n;'S;=`!Kj<%lO!<n&n!>Q^$e&j!SSOY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@Y!_!}!=y!}#O!Bw#O#P!Dj#P#o!=y#o#p!@Y#p;'S!=y;'S;=`!E[<%lO!=y&n!?Ta$e&j!SSO!^&c!_#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&cS!@_X!SSOY!@YZ!P!@Y!P!Q!@z!Q!}!@Y!}#O!Ac#O#P!Bb#P;'S!@Y;'S;=`!Bq<%lO!@YS!APU!SS#Z#[!@z#]#^!@z#a#b!@z#g#h!@z#i#j!@z#m#n!@zS!AfVOY!AcZ#O!Ac#O#P!A{#P#Q!@Y#Q;'S!Ac;'S;=`!B[<%lO!AcS!BOSOY!AcZ;'S!Ac;'S;=`!B[<%lO!AcS!B_P;=`<%l!AcS!BeSOY!@YZ;'S!@Y;'S;=`!Bq<%lO!@YS!BtP;=`<%l!@Y&n!B|[$e&jOY!BwYZ&cZ!^!Bw!^!_!Ac!_#O!Bw#O#P!Cr#P#Q!=y#Q#o!Bw#o#p!Ac#p;'S!Bw;'S;=`!Dd<%lO!Bw&n!CwX$e&jOY!BwYZ&cZ!^!Bw!^!_!Ac!_#o!Bw#o#p!Ac#p;'S!Bw;'S;=`!Dd<%lO!Bw&n!DgP;=`<%l!Bw&n!DoX$e&jOY!=yYZ&cZ!^!=y!^!_!@Y!_#o!=y#o#p!@Y#p;'S!=y;'S;=`!E[<%lO!=y&n!E_P;=`<%l!=y(Q!Eki$e&j'|!b!SSOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#Z&}#Z#[!Eb#[#]&}#]#^!Eb#^#a&}#a#b!Eb#b#g&}#g#h!Eb#h#i&}#i#j!Eb#j#m&}#m#n!Eb#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!f!GaZ'|!b!SSOY!GYZw!GYwx!@Yx!P!GY!P!Q!HS!Q!}!GY!}#O!Ic#O#P!Bb#P;'S!GY;'S;=`!JZ<%lO!GY!f!HZb'|!b!SSOY'}Zw'}x#O'}#P#Z'}#Z#[!HS#[#]'}#]#^!HS#^#a'}#a#b!HS#b#g'}#g#h!HS#h#i'}#i#j!HS#j#m'}#m#n!HS#n;'S'};'S;=`(f<%lO'}!f!IhX'|!bOY!IcZw!Icwx!Acx#O!Ic#O#P!A{#P#Q!GY#Q;'S!Ic;'S;=`!JT<%lO!Ic!f!JWP;=`<%l!Ic!f!J^P;=`<%l!GY(Q!Jh^$e&j'|!bOY!JaYZ&cZw!Jawx!Bwx!^!Ja!^!_!Ic!_#O!Ja#O#P!Cr#P#Q!<n#Q#o!Ja#o#p!Ic#p;'S!Ja;'S;=`!Kd<%lO!Ja(Q!KgP;=`<%l!Ja(Q!KmP;=`<%l!<n'`!Ky`$e&j'yp!SSOY!KpYZ&cZr!Kprs!=ys!P!Kp!P!Q!L{!Q!^!Kp!^!_!Ns!_!}!Kp!}#O##z#O#P!Dj#P#o!Kp#o#p!Ns#p;'S!Kp;'S;=`#%T<%lO!Kp'`!MUi$e&j'yp!SSOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#Z(r#Z#[!L{#[#](r#]#^!L{#^#a(r#a#b!L{#b#g(r#g#h!L{#h#i(r#i#j!L{#j#m(r#m#n!L{#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rt!NzZ'yp!SSOY!NsZr!Nsrs!@Ys!P!Ns!P!Q# m!Q!}!Ns!}#O#!|#O#P!Bb#P;'S!Ns;'S;=`##t<%lO!Nst# tb'yp!SSOY)rZr)rs#O)r#P#Z)r#Z#[# m#[#])r#]#^# m#^#a)r#a#b# m#b#g)r#g#h# m#h#i)r#i#j# m#j#m)r#m#n# m#n;'S)r;'S;=`*Z<%lO)rt##RX'ypOY#!|Zr#!|rs!Acs#O#!|#O#P!A{#P#Q!Ns#Q;'S#!|;'S;=`##n<%lO#!|t##qP;=`<%l#!|t##wP;=`<%l!Ns'`#$R^$e&j'ypOY##zYZ&cZr##zrs!Bws!^##z!^!_#!|!_#O##z#O#P!Cr#P#Q!Kp#Q#o##z#o#p#!|#p;'S##z;'S;=`#$}<%lO##z'`#%QP;=`<%l##z'`#%WP;=`<%l!Kp(r#%fk$e&j'yp'|!b!SSOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#Z%Z#Z#[#%Z#[#]%Z#]#^#%Z#^#a%Z#a#b#%Z#b#g%Z#g#h#%Z#h#i%Z#i#j#%Z#j#m%Z#m#n#%Z#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#W#'d]'yp'|!b!SSOY#'ZZr#'Zrs!GYsw#'Zwx!Nsx!P#'Z!P!Q#(]!Q!}#'Z!}#O#)w#O#P!Bb#P;'S#'Z;'S;=`#*w<%lO#'Z#W#(fe'yp'|!b!SSOY*gZr*grs'}sw*gwx)rx#O*g#P#Z*g#Z#[#(]#[#]*g#]#^#(]#^#a*g#a#b#(]#b#g*g#g#h#(]#h#i*g#i#j#(]#j#m*g#m#n#(]#n;'S*g;'S;=`+Z<%lO*g#W#*OZ'yp'|!bOY#)wZr#)wrs!Icsw#)wwx#!|x#O#)w#O#P!A{#P#Q#'Z#Q;'S#)w;'S;=`#*q<%lO#)w#W#*tP;=`<%l#)w#W#*zP;=`<%l#'Z(r#+W`$e&j'yp'|!bOY#*}YZ&cZr#*}rs!Jasw#*}wx##zx!^#*}!^!_#)w!_#O#*}#O#P!Cr#P#Q!;Z#Q#o#*}#o#p#)w#p;'S#*};'S;=`#,Y<%lO#*}(r#,]P;=`<%l#*}(r#,cP;=`<%l!;Z(CS#,sb$e&j'yp'|!b'q(;d!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(CS#.W_$e&j'yp'|!bR(;dOY#-{YZ&cZr#-{rs#/Vsw#-{wx#2gx!^#-{!^!_#4f!_#O#-{#O#P#0X#P#o#-{#o#p#4f#p;'S#-{;'S;=`#5e<%lO#-{(Bb#/`]$e&j'|!bR(;dOY#/VYZ&cZw#/Vwx#0Xx!^#/V!^!_#1j!_#O#/V#O#P#0X#P#o#/V#o#p#1j#p;'S#/V;'S;=`#2a<%lO#/V(AO#0`X$e&jR(;dOY#0XYZ&cZ!^#0X!^!_#0{!_#o#0X#o#p#0{#p;'S#0X;'S;=`#1d<%lO#0X(;d#1QSR(;dOY#0{Z;'S#0{;'S;=`#1^<%lO#0{(;d#1aP;=`<%l#0{(AO#1gP;=`<%l#0X(<v#1qW'|!bR(;dOY#1jZw#1jwx#0{x#O#1j#O#P#0{#P;'S#1j;'S;=`#2Z<%lO#1j(<v#2^P;=`<%l#1j(Bb#2dP;=`<%l#/V(Ap#2p]$e&j'ypR(;dOY#2gYZ&cZr#2grs#0Xs!^#2g!^!_#3i!_#O#2g#O#P#0X#P#o#2g#o#p#3i#p;'S#2g;'S;=`#4`<%lO#2g(<U#3pW'ypR(;dOY#3iZr#3irs#0{s#O#3i#O#P#0{#P;'S#3i;'S;=`#4Y<%lO#3i(<U#4]P;=`<%l#3i(Ap#4cP;=`<%l#2g(=h#4oY'yp'|!bR(;dOY#4fZr#4frs#1jsw#4fwx#3ix#O#4f#O#P#0{#P;'S#4f;'S;=`#5_<%lO#4f(=h#5bP;=`<%l#4f(CS#5hP;=`<%l#-{%#W#5xb$e&j#|$Id'yp'|!b!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z+h#7_b$U#t$e&j'yp'|!b!SSOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z$/l#8rp$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#:v![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#:v#S#U%Z#U#V#>Q#V#X%Z#X#Y!4|#Y#b%Z#b#c#<v#c#d#AY#d#l%Z#l#m#D[#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#;Rk$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#:v![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#:v#S#X%Z#X#Y!4|#Y#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#=R_$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#>Zd$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#?i!R!S#?i!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#?i#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#?tf$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#?i!R!S#?i!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#?i#S#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Acc$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#Bn!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#Bn#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Bye$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#Bn!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#Bn#S#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Deg$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#E|![!^%Z!^!_*g!_!c%Z!c!i#E|!i#O%Z#O#P&c#P#R%Z#R#S#E|#S#T%Z#T#Z#E|#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#FXi$e&j'yp'|!bm$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#E|![!^%Z!^!_*g!_!c%Z!c!i#E|!i#O%Z#O#P&c#P#R%Z#R#S#E|#S#T%Z#T#Z#E|#Z#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#HT_!b$b$e&j#z%<f'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#I___l$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS#Jm^(P!*v!f'.r'yp'|!b$V)d(pSOY*gZr*grs'}sw*gwx)rx!P*g!P!Q#Ki!Q!^*g!^!_#L_!_!`#NP!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#KrX$g&j'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#LhZ#l$Id'yp'|!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#MZ!`#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#MdX#|$Id'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#NYX#m$Id'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Gh$ Qa#Y%?x$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$!V!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#W$!b_#e$Ih$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh$#paeBf#m$Id$b#|$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$$u!`!a$&P!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$%Q_#m$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$&[a#l$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$'a!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$'l`#l$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h$(yc(d$Ip$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P$*U!P!^%Z!^!_*g!_!a%Z!a!b$+`!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+`$*a_{'#p$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$+k`$e&j#w$Id'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&^$,x_!y!Ln$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^$.S_}(8n$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/WZ$e&jO!^$/y!^!_$0a!_#i$/y#i#j$0f#j#l$/y#l#m$2X#m#o$/y#o#p$0a#p;'S$/y;'S;=`$4d<%lO$/y(n$0QT]#S$e&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0fO]#S(n$0k[$e&jO!Q&c!Q![$1a![!^&c!_!c&c!c!i$1a!i#T&c#T#Z$1a#Z#o&c#o#p$3w#p;'S&c;'S;=`&w<%lO&c(n$1fZ$e&jO!Q&c!Q![$2X![!^&c!_!c&c!c!i$2X!i#T&c#T#Z$2X#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2^Z$e&jO!Q&c!Q![$3P![!^&c!_!c&c!c!i$3P!i#T&c#T#Z$3P#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3UZ$e&jO!Q&c!Q![$/y![!^&c!_!c&c!c!i$/y!i#T&c#T#Z$/y#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$3zR!Q![$4T!c!i$4T#T#Z$4T#S$4WS!Q![$4T!c!i$4T#T#Z$4T#q#r$0a(n$4gP;=`<%l$/y!2r$4u_!T!+S$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$6P`#t$Id$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&,v$7^_$e&j'yp'|!b(T&%WOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$8lk$e&j'yp'|!b(W!LY'v&;d$Z#tOY%ZYZ&cZr%Zrs&}st%Ztu$8]uw%Zwx(rx}%Z}!O$:a!O!Q%Z!Q![$8]![!^%Z!^!_*g!_!c%Z!c!}$8]!}#O%Z#O#P&c#P#R%Z#R#S$8]#S#T%Z#T#o$8]#o#p*g#p$g%Z$g;'S$8];'S;=`$<g<%lO$8]+d$:lk$e&j'yp'|!b$Z#tOY%ZYZ&cZr%Zrs&}st%Ztu$:auw%Zwx(rx}%Z}!O$:a!O!Q%Z!Q![$:a![!^%Z!^!_*g!_!c%Z!c!}$:a!}#O%Z#O#P&c#P#R%Z#R#S$:a#S#T%Z#T#o$:a#o#p*g#p$g%Z$g;'S$:a;'S;=`$<a<%lO$:a+d$<dP;=`<%l$:a(CS$<jP;=`<%l$8]!5p$<vX!Y!3l'yp'|!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Df$=na(k%<v$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+`#q;'S%Z;'S;=`+a<%lO%Z%#`$?Q_!X$I`p`$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(r$@[_!nS$e&j'yp'|!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$Al|$e&j'yp'|!b'o(;d(W!LY'v&;d$X#tOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$AZ#BZ$ISEr$IS$I_$AZ$I_$JTEr$JT$JU$AZ$JU$KVEr$KV$KW$AZ$KW&FUEr&FU&FV$AZ&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$AZ?HUOEr(CS$Dwk$e&j'yp'|!b'p(;d(W!LY'v&;d$X#tOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[noSemicolon,incdecToken,2,3,4,5,6,7,8,9,10,11,12,13,insertSemicolon,new LocalTokenGroup("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOr~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!P~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(V~~",141,328),new LocalTokenGroup("j~RQYZXz{^~^O's~~aP!P!Qd~iO't~~",25,310)],topRules:{"Script":[0,5],"SingleExpression":[1,268],"SingleClassItem":[2,269]},dialects:{jsx:12842,ts:12844},dynamicPrecedences:{"67":1,"77":1,"79":1,"164":1,"192":1},specialized:[{term:314,get:function get(value){return spec_identifier2[value]||-1;}},{term:330,get:function get(value){return spec_word[value]||-1;}},{term:68,get:function get(value){return spec_LessThan[value]||-1;}}],tokenPrec:12868});// ../node_modules/@codemirror/lang-javascript/dist/index.js
var snippets=[/* @__PURE__ */_snippetCompletion("function ${name}(${params}) {\n	${}\n}",{label:"function",detail:"definition",type:"keyword"}),/* @__PURE__ */_snippetCompletion("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n	${}\n}",{label:"for",detail:"loop",type:"keyword"}),/* @__PURE__ */_snippetCompletion("for (let ${name} of ${collection}) {\n	${}\n}",{label:"for",detail:"of loop",type:"keyword"}),/* @__PURE__ */_snippetCompletion("do {\n	${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),/* @__PURE__ */_snippetCompletion("while (${}) {\n	${}\n}",{label:"while",detail:"loop",type:"keyword"}),/* @__PURE__ */_snippetCompletion("try {\n	${}\n} catch (${error}) {\n	${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),/* @__PURE__ */_snippetCompletion("if (${}) {\n	${}\n}",{label:"if",detail:"block",type:"keyword"}),/* @__PURE__ */_snippetCompletion("if (${}) {\n	${}\n} else {\n	${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),/* @__PURE__ */_snippetCompletion("class ${name} {\n	constructor(${params}) {\n		${}\n	}\n}",{label:"class",detail:"definition",type:"keyword"}),/* @__PURE__ */_snippetCompletion('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),/* @__PURE__ */_snippetCompletion('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})];var typescriptSnippets=/* @__PURE__ */snippets.concat([/* @__PURE__ */_snippetCompletion("interface ${name} {\n	${}\n}",{label:"interface",detail:"definition",type:"keyword"}),/* @__PURE__ */_snippetCompletion("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),/* @__PURE__ */_snippetCompletion("enum ${name} {\n	${}\n}",{label:"enum",detail:"definition",type:"keyword"})]);var cache=/* @__PURE__ */new NodeWeakMap();var ScopeNodes=/* @__PURE__ */new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function defID(type){return function(node,def){var id2=node.node.getChild("VariableDefinition");if(id2)def(id2,type);return true;};}var functionContext=["FunctionDeclaration"];var gatherCompletions={FunctionDeclaration:/* @__PURE__ */defID("function"),ClassDeclaration:/* @__PURE__ */defID("class"),ClassExpression:function ClassExpression(){return true;},EnumDeclaration:/* @__PURE__ */defID("constant"),TypeAliasDeclaration:/* @__PURE__ */defID("type"),NamespaceDeclaration:/* @__PURE__ */defID("namespace"),VariableDefinition:function VariableDefinition(node,def){if(!node.matchContext(functionContext))def(node,"variable");},TypeDefinition:function TypeDefinition(node,def){def(node,"type");},__proto__:null};function getScope(doc2,node){var cached=cache.get(node);if(cached)return cached;var completions=[],top2=true;function def(node2,type){var name2=doc2.sliceString(node2.from,node2.to);completions.push({label:name2,type:type});}node.cursor(IterMode.IncludeAnonymous).iterate(function(node2){if(top2){top2=false;}else if(node2.name){var gather=gatherCompletions[node2.name];if(gather&&gather(node2,def)||ScopeNodes.has(node2.name))return false;}else if(node2.to-node2.from>8192){var _iterator277=_createForOfIteratorHelper(getScope(doc2,node2.node)),_step277;try{for(_iterator277.s();!(_step277=_iterator277.n()).done;){var c=_step277.value;completions.push(c);}}catch(err){_iterator277.e(err);}finally{_iterator277.f();}return false;}});cache.set(node,completions);return completions;}var Identifier=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/;var dontComplete=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function localCompletionSource(context){var inner=_syntaxTree(context.state).resolveInner(context.pos,-1);if(dontComplete.indexOf(inner.name)>-1)return null;var isWord=inner.name=="VariableName"||inner.to-inner.from<20&&Identifier.test(context.state.sliceDoc(inner.from,inner.to));if(!isWord&&!context.explicit)return null;var options=[];for(var pos=inner;pos;pos=pos.parent){if(ScopeNodes.has(pos.name))options=options.concat(getScope(context.state.doc,pos));}return{options:options,from:isWord?inner.from:context.pos,validFor:Identifier};}var javascriptLanguage=/* @__PURE__ */_LRLanguage.define({name:"javascript",parser:/* @__PURE__ */parser4.configure({props:[/* @__PURE__ */_indentNodeProp.add({IfStatement:/* @__PURE__ */_continuedIndent({except:/^\s*({|else\b)/}),TryStatement:/* @__PURE__ */_continuedIndent({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:_flatIndent,SwitchBody:function SwitchBody(context){var after=context.textAfter,closed=/^\s*\}/.test(after),isCase=/^\s*(case|default)\b/.test(after);return context.baseIndent+(closed?0:isCase?1:2)*context.unit;},Block:/* @__PURE__ */_delimitedIndent({closing:"}"}),ArrowFunction:function ArrowFunction(cx){return cx.baseIndent+cx.unit;},"TemplateString BlockComment":function TemplateStringBlockComment(){return null;},"Statement Property":/* @__PURE__ */_continuedIndent({except:/^{/}),JSXElement:function JSXElement(context){var closed=/^\s*<\//.test(context.textAfter);return context.lineIndent(context.node.from)+(closed?0:context.unit);},JSXEscape:function JSXEscape(context){var closed=/\s*\}/.test(context.textAfter);return context.lineIndent(context.node.from)+(closed?0:context.unit);},"JSXOpenTag JSXSelfClosingTag":function JSXOpenTagJSXSelfClosingTag(context){return context.column(context.node.from)+context.unit;}}),/* @__PURE__ */_foldNodeProp.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":_foldInside,BlockComment:function BlockComment(tree){return{from:tree.from+2,to:tree.to-2};}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}});var jsxSublanguage={test:function test(node){return /^JSX/.test(node.name);},facet:/* @__PURE__ */_defineLanguageFacet({commentTokens:{block:{open:"{/*",close:"*/}"}}})};var typescriptLanguage=/* @__PURE__ */javascriptLanguage.configure({dialect:"ts"},"typescript");var jsxLanguage=/* @__PURE__ */javascriptLanguage.configure({dialect:"jsx",props:[/* @__PURE__ */_sublanguageProp.add(function(n){return n.isTop?[jsxSublanguage]:void 0;})]});var tsxLanguage=/* @__PURE__ */javascriptLanguage.configure({dialect:"jsx ts",props:[/* @__PURE__ */_sublanguageProp.add(function(n){return n.isTop?[jsxSublanguage]:void 0;})]},"typescript");var kwCompletion=function kwCompletion(name2){return{label:name2,type:"keyword"};};var keywords=/* @__PURE__ */"break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(kwCompletion);var typescriptKeywords=/* @__PURE__ */keywords.concat(/* @__PURE__ */["declare","implements","private","protected","public"].map(kwCompletion));function javascript(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var lang=config2.jsx?config2.typescript?tsxLanguage:jsxLanguage:config2.typescript?typescriptLanguage:javascriptLanguage;var completions=config2.typescript?typescriptSnippets.concat(typescriptKeywords):snippets.concat(keywords);return new _LanguageSupport(lang,[javascriptLanguage.data.of({autocomplete:_ifNotIn(dontComplete,_completeFromList(completions))}),javascriptLanguage.data.of({autocomplete:localCompletionSource}),config2.jsx?autoCloseTags:[]]);}function findOpenTag(node){for(;;){if(node.name=="JSXOpenTag"||node.name=="JSXSelfClosingTag"||node.name=="JSXFragmentTag")return node;if(node.name=="JSXEscape"||!node.parent)return null;node=node.parent;}}function elementName(doc2,tree){var max=arguments.length>2&&arguments[2]!==undefined?arguments[2]:doc2.length;for(var ch=tree===null||tree===void 0?void 0:tree.firstChild;ch;ch=ch.nextSibling){if(ch.name=="JSXIdentifier"||ch.name=="JSXBuiltin"||ch.name=="JSXNamespacedName"||ch.name=="JSXMemberExpression")return doc2.sliceString(ch.from,Math.min(ch.to,max));}return"";}var android2=(typeof navigator==="undefined"?"undefined":_typeof(navigator))=="object"&&/* @__PURE__ */ /Android\b/.test(navigator.userAgent);var autoCloseTags=/* @__PURE__ */EditorView.inputHandler.of(function(view,from,to,text,defaultInsert){if((android2?view.composing:view.compositionStarted)||view.state.readOnly||from!=to||text!=">"&&text!="/"||!javascriptLanguage.isActiveAt(view.state,from,-1))return false;var base2=defaultInsert(),state=base2.state;var closeTags=state.changeByRange(function(range){var _a2;var head=range.head,around=_syntaxTree(state).resolveInner(head-1,-1),name2;if(around.name=="JSXStartTag")around=around.parent;if(state.doc.sliceString(head-1,head)!=text||around.name=="JSXAttributeValue"&&around.to>head);else if(text==">"&&around.name=="JSXFragmentTag"){return{range:range,changes:{from:head,insert:"</>"}};}else if(text=="/"&&around.name=="JSXStartCloseTag"){var empty2=around.parent,base3=empty2.parent;if(base3&&empty2.from==head-2&&((name2=elementName(state.doc,base3.firstChild,head))||((_a2=base3.firstChild)===null||_a2===void 0?void 0:_a2.name)=="JSXFragmentTag")){var insert2="".concat(name2,">");return{range:EditorSelection.cursor(head+insert2.length,-1),changes:{from:head,insert:insert2}};}}else if(text==">"){var openTag=findOpenTag(around);if(openTag&&!/^\/?>|^<\//.test(state.doc.sliceString(head,head+2))&&(name2=elementName(state.doc,openTag,head)))return{range:range,changes:{from:head,insert:"</".concat(name2,">")}};}return{range:range};});if(closeTags.changes.empty)return false;view.dispatch([base2,state.update(closeTags,{userEvent:"input.complete",scrollIntoView:true})]);return true;});// ../node_modules/@codemirror/lang-html/dist/index.js
var Targets=["_blank","_self","_top","_parent"];var Charsets=["ascii","utf-8","utf-16","latin1","latin1"];var Methods=["get","post","put","delete"];var Encs=["application/x-www-form-urlencoded","multipart/form-data","text/plain"];var Bool=["true","false"];var S={};var Tags={a:{attrs:{href:null,ping:null,type:null,media:null,target:Targets,hreflang:null}},abbr:S,address:S,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:S,aside:S,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:S,base:{attrs:{href:null,target:Targets}},bdi:S,bdo:S,blockquote:{attrs:{cite:null}},body:S,br:S,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:Encs,formmethod:Methods,formnovalidate:["novalidate"],formtarget:Targets,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:S,center:S,cite:S,code:S,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:S,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:S,div:S,dl:S,dt:S,em:S,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:S,figure:S,footer:S,form:{attrs:{action:null,name:null,"accept-charset":Charsets,autocomplete:["on","off"],enctype:Encs,method:Methods,novalidate:["novalidate"],target:Targets}},h1:S,h2:S,h3:S,h4:S,h5:S,h6:S,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:S,hgroup:S,hr:S,html:{attrs:{manifest:null}},i:S,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:Encs,formmethod:Methods,formnovalidate:["novalidate"],formtarget:Targets,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:S,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{"for":null,form:null}},legend:S,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:S,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:Charsets,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:S,noscript:S,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{"for":null,form:null,name:null}},p:S,param:{attrs:{name:null,value:null}},pre:S,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:S,rt:S,ruby:S,samp:S,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:Charsets}},section:S,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:S,source:{attrs:{src:null,type:null,media:null}},span:S,strong:S,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:S,summary:S,sup:S,table:S,tbody:S,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:S,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:S,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:S,time:{attrs:{datetime:null}},title:S,tr:S,track:{attrs:{src:null,label:null,"default":null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},"var":S,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:S};var GlobalAttrs={accesskey:null,"class":null,contenteditable:Bool,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Bool,autocorrect:Bool,autocapitalize:Bool,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:/* @__PURE__ */"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Bool,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Bool,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Bool,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Bool,"aria-hidden":Bool,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Bool,"aria-multiselectable":Bool,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Bool,"aria-relevant":null,"aria-required":Bool,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null};var eventAttributes=/* @__PURE__ */"beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map(function(n){return"on"+n;});var _iterator278=_createForOfIteratorHelper(eventAttributes),_step278;try{for(_iterator278.s();!(_step278=_iterator278.n()).done;){var a=_step278.value;GlobalAttrs[a]=null;}}catch(err){_iterator278.e(err);}finally{_iterator278.f();}var Schema=/*#__PURE__*/_createClass(function Schema(extraTags,extraAttrs){_classCallCheck(this,Schema);this.tags=Object.assign(Object.assign({},Tags),extraTags);this.globalAttrs=Object.assign(Object.assign({},GlobalAttrs),extraAttrs);this.allTags=Object.keys(this.tags);this.globalAttrNames=Object.keys(this.globalAttrs);});Schema["default"]=/* @__PURE__ */new Schema();function elementName2(doc2,tree){var max=arguments.length>2&&arguments[2]!==undefined?arguments[2]:doc2.length;if(!tree)return"";var tag=tree.firstChild;var name2=tag&&tag.getChild("TagName");return name2?doc2.sliceString(name2.from,Math.min(name2.to,max)):"";}function findParentElement(tree){var skip=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;for(;tree;tree=tree.parent){if(tree.name=="Element"){if(skip)skip=false;else return tree;}}return null;}function allowedChildren(doc2,tree,schema){var parentInfo=schema.tags[elementName2(doc2,findParentElement(tree))];return(parentInfo===null||parentInfo===void 0?void 0:parentInfo.children)||schema.allTags;}function openTags(doc2,tree){var open=[];for(var parent=findParentElement(tree);parent&&!parent.type.isTop;parent=findParentElement(parent.parent)){var tagName=elementName2(doc2,parent);if(tagName&&parent.lastChild.name=="CloseTag")break;if(tagName&&open.indexOf(tagName)<0&&(tree.name=="EndTag"||tree.from>=parent.firstChild.to))open.push(tagName);}return open;}var identifier3=/^[:\-\.\w\u00b7-\uffff]*$/;function completeTag(state,schema,tree,from,to){var end=/\s*>/.test(state.sliceDoc(to,to+5))?"":">";var parent=findParentElement(tree,true);return{from:from,to:to,options:allowedChildren(state.doc,parent,schema).map(function(tagName){return{label:tagName,type:"type"};}).concat(openTags(state.doc,tree).map(function(tag,i){return{label:"/"+tag,apply:"/"+tag+end,type:"type",boost:99-i};})),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/};}function completeCloseTag(state,tree,from,to){var end=/\s*>/.test(state.sliceDoc(to,to+5))?"":">";return{from:from,to:to,options:openTags(state.doc,tree).map(function(tag,i){return{label:tag,apply:tag+end,type:"type",boost:99-i};}),validFor:identifier3};}function completeStartTag(state,schema,tree,pos){var options=[],level=0;var _iterator279=_createForOfIteratorHelper(allowedChildren(state.doc,tree,schema)),_step279;try{for(_iterator279.s();!(_step279=_iterator279.n()).done;){var tagName=_step279.value;options.push({label:"<"+tagName,type:"type"});}}catch(err){_iterator279.e(err);}finally{_iterator279.f();}var _iterator280=_createForOfIteratorHelper(openTags(state.doc,tree)),_step280;try{for(_iterator280.s();!(_step280=_iterator280.n()).done;){var open=_step280.value;options.push({label:"</"+open+">",type:"type",boost:99-level++});}}catch(err){_iterator280.e(err);}finally{_iterator280.f();}return{from:pos,to:pos,options:options,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/};}function completeAttrName(state,schema,tree,from,to){var elt2=findParentElement(tree),info=elt2?schema.tags[elementName2(state.doc,elt2)]:null;var localAttrs=info&&info.attrs?Object.keys(info.attrs):[];var names=info&&info.globalAttrs===false?localAttrs:localAttrs.length?localAttrs.concat(schema.globalAttrNames):schema.globalAttrNames;return{from:from,to:to,options:names.map(function(attrName){return{label:attrName,type:"property"};}),validFor:identifier3};}function completeAttrValue(state,schema,tree,from,to){var _a2;var nameNode=(_a2=tree.parent)===null||_a2===void 0?void 0:_a2.getChild("AttributeName");var options=[],token=void 0;if(nameNode){var attrName=state.sliceDoc(nameNode.from,nameNode.to);var attrs=schema.globalAttrs[attrName];if(!attrs){var elt2=findParentElement(tree),info=elt2?schema.tags[elementName2(state.doc,elt2)]:null;attrs=(info===null||info===void 0?void 0:info.attrs)&&info.attrs[attrName];}if(attrs){var base2=state.sliceDoc(from,to).toLowerCase(),quoteStart='"',quoteEnd='"';if(/^['"]/.test(base2)){token=base2[0]=='"'?/^[^"]*$/:/^[^']*$/;quoteStart="";quoteEnd=state.sliceDoc(to,to+1)==base2[0]?"":base2[0];base2=base2.slice(1);from++;}else{token=/^[^\s<>='"]*$/;}var _iterator281=_createForOfIteratorHelper(attrs),_step281;try{for(_iterator281.s();!(_step281=_iterator281.n()).done;){var value=_step281.value;options.push({label:value,apply:quoteStart+value+quoteEnd,type:"constant"});}}catch(err){_iterator281.e(err);}finally{_iterator281.f();}}}return{from:from,to:to,options:options,validFor:token};}function htmlCompletionFor(schema,context){var state=context.state,pos=context.pos,tree=_syntaxTree(state).resolveInner(pos,-1),around=tree.resolve(pos);for(var scan=pos,before;around==tree&&(before=tree.childBefore(scan));){var last=before.lastChild;if(!last||!last.type.isError||last.from<last.to)break;around=tree=before;scan=last.from;}if(tree.name=="TagName"){return tree.parent&&/CloseTag$/.test(tree.parent.name)?completeCloseTag(state,tree,tree.from,pos):completeTag(state,schema,tree,tree.from,pos);}else if(tree.name=="StartTag"){return completeTag(state,schema,tree,pos,pos);}else if(tree.name=="StartCloseTag"||tree.name=="IncompleteCloseTag"){return completeCloseTag(state,tree,pos,pos);}else if(context.explicit&&(tree.name=="OpenTag"||tree.name=="SelfClosingTag")||tree.name=="AttributeName"){return completeAttrName(state,schema,tree,tree.name=="AttributeName"?tree.from:pos,pos);}else if(tree.name=="Is"||tree.name=="AttributeValue"||tree.name=="UnquotedAttributeValue"){return completeAttrValue(state,schema,tree,tree.name=="Is"?pos:tree.from,pos);}else if(context.explicit&&(around.name=="Element"||around.name=="Text"||around.name=="Document")){return completeStartTag(state,schema,tree,pos);}else{return null;}}function htmlCompletionSource(context){return htmlCompletionFor(Schema["default"],context);}function htmlCompletionSourceWith(config2){var extraTags=config2.extraTags,extraAttrs=config2.extraGlobalAttributes;var schema=extraAttrs||extraTags?new Schema(extraTags,extraAttrs):Schema["default"];return function(context){return htmlCompletionFor(schema,context);};}var jsonParser=/* @__PURE__ */javascriptLanguage.parser.configure({top:"SingleExpression"});var defaultNesting=[{tag:"script",attrs:function attrs(_attrs){return _attrs.type=="text/typescript"||_attrs.lang=="ts";},parser:typescriptLanguage.parser},{tag:"script",attrs:function attrs(_attrs2){return _attrs2.type=="text/babel"||_attrs2.type=="text/jsx";},parser:jsxLanguage.parser},{tag:"script",attrs:function attrs(_attrs3){return _attrs3.type=="text/typescript-jsx";},parser:tsxLanguage.parser},{tag:"script",attrs:function attrs(_attrs4){return _attrs4.type=="importmap"||_attrs4.type=="speculationrules";},parser:jsonParser},{tag:"script",attrs:function attrs(_attrs5){return!_attrs5.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(_attrs5.type);},parser:javascriptLanguage.parser},{tag:"style",attrs:function attrs(_attrs6){return(!_attrs6.lang||_attrs6.lang=="css")&&(!_attrs6.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(_attrs6.type));},parser:cssLanguage.parser}];var defaultAttrs=/* @__PURE__ */[{name:"style",parser:/* @__PURE__ */cssLanguage.parser.configure({top:"Styles"})}].concat(/* @__PURE__ */eventAttributes.map(function(name2){return{name:name2,parser:javascriptLanguage.parser};}));var htmlPlain=/* @__PURE__ */_LRLanguage.define({name:"html",parser:/* @__PURE__ */parser2.configure({props:[/* @__PURE__ */_indentNodeProp.add({Element:function Element(context){var after=/^(\s*)(<\/)?/.exec(context.textAfter);if(context.node.to<=context.pos+after[0].length)return context["continue"]();return context.lineIndent(context.node.from)+(after[2]?0:context.unit);},"OpenTag CloseTag SelfClosingTag":function OpenTagCloseTagSelfClosingTag(context){return context.column(context.node.from)+context.unit;},Document:function Document(context){if(context.pos+/\s*/.exec(context.textAfter)[0].length<context.node.to)return context["continue"]();var endElt=null,close;for(var cur2=context.node;;){var last=cur2.lastChild;if(!last||last.name!="Element"||last.to!=cur2.to)break;endElt=cur2=last;}if(endElt&&!((close=endElt.lastChild)&&(close.name=="CloseTag"||close.name=="SelfClosingTag")))return context.lineIndent(endElt.from)+context.unit;return null;}}),/* @__PURE__ */_foldNodeProp.add({Element:function Element(node){var first=node.firstChild,last=node.lastChild;if(!first||first.name!="OpenTag")return null;return{from:first.to,to:last.name=="CloseTag"?last.from:node.to};}}),/* @__PURE__ */_bracketMatchingHandle.add({"OpenTag CloseTag":function OpenTagCloseTag(node){return node.getChild("TagName");}})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}});var htmlLanguage=/* @__PURE__ */htmlPlain.configure({wrap:/* @__PURE__ */configureNesting(defaultNesting,defaultAttrs)});function html(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var dialect="",wrap;if(config2.matchClosingTags===false)dialect="noMatch";if(config2.selfClosingTags===true)dialect=(dialect?dialect+" ":"")+"selfClosing";if(config2.nestedLanguages&&config2.nestedLanguages.length||config2.nestedAttributes&&config2.nestedAttributes.length)wrap=configureNesting((config2.nestedLanguages||[]).concat(defaultNesting),(config2.nestedAttributes||[]).concat(defaultAttrs));var lang=wrap?htmlPlain.configure({wrap:wrap,dialect:dialect}):dialect?htmlLanguage.configure({dialect:dialect}):htmlLanguage;return new _LanguageSupport(lang,[htmlLanguage.data.of({autocomplete:htmlCompletionSourceWith(config2)}),config2.autoCloseTags!==false?autoCloseTags2:[],javascript().support,css().support]);}var selfClosers2=/* @__PURE__ */new Set(/* @__PURE__ */"area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" "));var autoCloseTags2=/* @__PURE__ */EditorView.inputHandler.of(function(view,from,to,text,insertTransaction){if(view.composing||view.state.readOnly||from!=to||text!=">"&&text!="/"||!htmlLanguage.isActiveAt(view.state,from,-1))return false;var base2=insertTransaction(),state=base2.state;var closeTags=state.changeByRange(function(range){var _a2,_b,_c;var didType=state.doc.sliceString(range.from-1,range.to)==text;var head=range.head,around=_syntaxTree(state).resolveInner(head-1,-1),name2;if(around.name=="TagName"||around.name=="StartTag")around=around.parent;if(didType&&text==">"&&around.name=="OpenTag"){if(((_b=(_a2=around.parent)===null||_a2===void 0?void 0:_a2.lastChild)===null||_b===void 0?void 0:_b.name)!="CloseTag"&&(name2=elementName2(state.doc,around.parent,head))&&!selfClosers2.has(name2)){var to2=head+(state.doc.sliceString(head,head+1)===">"?1:0);var insert2="</".concat(name2,">");return{range:range,changes:{from:head,to:to2,insert:insert2}};}}else if(didType&&text=="/"&&around.name=="IncompleteCloseTag"){var base3=around.parent;if(around.from==head-2&&((_c=base3.lastChild)===null||_c===void 0?void 0:_c.name)!="CloseTag"&&(name2=elementName2(state.doc,base3,head))&&!selfClosers2.has(name2)){var _to4=head+(state.doc.sliceString(head,head+1)===">"?1:0);var _insert="".concat(name2,">");return{range:EditorSelection.cursor(head+_insert.length,-1),changes:{from:head,to:_to4,insert:_insert}};}}return{range:range};});if(closeTags.changes.empty)return false;view.dispatch([base2,state.update(closeTags,{userEvent:"input.complete",scrollIntoView:true})]);return true;});// ../node_modules/@codemirror/lang-markdown/dist/index.js
var data=/* @__PURE__ */_defineLanguageFacet({commentTokens:{block:{open:"<!--",close:"-->"}}});var headingProp=/* @__PURE__ */new NodeProp();var commonmark=/* @__PURE__ */parser.configure({props:[/* @__PURE__ */_foldNodeProp.add(function(type){return!type.is("Block")||type.is("Document")||isHeading(type)!=null?void 0:function(tree,state){return{from:state.doc.lineAt(tree.from).to,to:tree.to};};}),/* @__PURE__ */headingProp.add(isHeading),/* @__PURE__ */_indentNodeProp.add({Document:function Document(){return null;}}),/* @__PURE__ */_languageDataProp.add({Document:data})]});function isHeading(type){var match=/^(?:ATX|Setext)Heading(\d)$/.exec(type.name);return match?+match[1]:void 0;}function findSectionEnd(headerNode,level){var last=headerNode;for(;;){var next=last.nextSibling,heading2=void 0;if(!next||(heading2=isHeading(next.type))!=null&&heading2<=level)break;last=next;}return last.to;}var headerIndent=/* @__PURE__ */_foldService.of(function(state,start,end){for(var node=_syntaxTree(state).resolveInner(end,-1);node;node=node.parent){if(node.from<start)break;var heading2=node.type.prop(headingProp);if(heading2==null)continue;var upto=findSectionEnd(node,heading2);if(upto>end)return{from:end,to:upto};}return null;});function mkLang(parser5){return new _Language(data,parser5,[headerIndent],"markdown");}var commonmarkLanguage=/* @__PURE__ */mkLang(commonmark);var extended=/* @__PURE__ */commonmark.configure([GFM,Subscript,Superscript,Emoji]);var markdownLanguage=/* @__PURE__ */mkLang(extended);function getCodeParser(languages,defaultLanguage){return function(info){if(info&&languages){var found=null;info=/\S*/.exec(info)[0];if(typeof languages=="function")found=languages(info);else found=_LanguageDescription.matchLanguageName(languages,info,true);if(found instanceof _LanguageDescription)return found.support?found.support.language.parser:_ParseContext.getSkippingParser(found.load());else if(found)return found.parser;}return defaultLanguage?defaultLanguage.parser:null;};}var Context=/*#__PURE__*/function(){function Context(node,from,to,spaceBefore,spaceAfter,type,item){_classCallCheck(this,Context);this.node=node;this.from=from;this.to=to;this.spaceBefore=spaceBefore;this.spaceAfter=spaceAfter;this.type=type;this.item=item;}_createClass(Context,[{key:"blank",value:function blank(maxWidth){var trailing=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var result=this.spaceBefore+(this.node.name=="Blockquote"?">":"");if(maxWidth!=null){while(result.length<maxWidth){result+=" ";}return result;}else{for(var _i222=this.to-this.from-result.length-this.spaceAfter.length;_i222>0;_i222--){result+=" ";}return result+(trailing?this.spaceAfter:"");}}},{key:"marker",value:function marker(doc2,add2){var number2=this.node.name=="OrderedList"?String(+itemNumber(this.item,doc2)[2]+add2):"";return this.spaceBefore+number2+this.type+this.spaceAfter;}}]);return Context;}();function getContext(node,doc2){var nodes=[];for(var cur2=node;cur2&&cur2.name!="Document";cur2=cur2.parent){if(cur2.name=="ListItem"||cur2.name=="Blockquote"||cur2.name=="FencedCode")nodes.push(cur2);}var context=[];for(var _i223=nodes.length-1;_i223>=0;_i223--){var node2=nodes[_i223],match=void 0;var line=doc2.lineAt(node2.from),startPos=node2.from-line.from;if(node2.name=="FencedCode"){context.push(new Context(node2,startPos,startPos,"","","",null));}else if(node2.name=="Blockquote"&&(match=/^ *>( ?)/.exec(line.text.slice(startPos)))){context.push(new Context(node2,startPos,startPos+match[0].length,"",match[1],">",null));}else if(node2.name=="ListItem"&&node2.parent.name=="OrderedList"&&(match=/^( *)\d+([.)])( *)/.exec(line.text.slice(startPos)))){var after=match[3],len=match[0].length;if(after.length>=4){after=after.slice(0,after.length-4);len-=4;}context.push(new Context(node2.parent,startPos,startPos+len,match[1],after,match[2],node2));}else if(node2.name=="ListItem"&&node2.parent.name=="BulletList"&&(match=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(line.text.slice(startPos)))){var _after=match[4],_len8=match[0].length;if(_after.length>4){_after=_after.slice(0,_after.length-4);_len8-=4;}var type=match[2];if(match[3])type+=match[3].replace(/[xX]/," ");context.push(new Context(node2.parent,startPos,startPos+_len8,match[1],_after,type,node2));}}return context;}function itemNumber(item,doc2){return /^(\s*)(\d+)(?=[.)])/.exec(doc2.sliceString(item.from,item.from+10));}function renumberList(after,doc2,changes){var offset=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;for(var prev=-1,node=after;;){if(node.name=="ListItem"){var m=itemNumber(node,doc2);var number2=+m[2];if(prev>=0){if(number2!=prev+1)return;changes.push({from:node.from+m[1].length,to:node.from+m[0].length,insert:String(prev+2+offset)});}prev=number2;}var next=node.nextSibling;if(!next)break;node=next;}}function normalizeIndent(content2,state){var blank=/^[ \t]*/.exec(content2)[0].length;if(!blank||state.facet(_indentUnit)!="	")return content2;var col=_countColumn(content2,4,blank);var space4="";for(var _i224=col;_i224>0;){if(_i224>=4){space4+="	";_i224-=4;}else{space4+=" ";_i224--;}}return space4+content2.slice(blank);}var insertNewlineContinueMarkup=function insertNewlineContinueMarkup(_ref65){var state=_ref65.state,dispatch=_ref65.dispatch;var tree=_syntaxTree(state),doc2=state.doc;var dont=null,changes=state.changeByRange(function(range){if(!range.empty||!markdownLanguage.isActiveAt(state,range.from))return dont={range:range};var pos=range.from,line=doc2.lineAt(pos);var context=getContext(tree.resolveInner(pos,-1),doc2);while(context.length&&context[context.length-1].from>pos-line.from){context.pop();}if(!context.length)return dont={range:range};var inner=context[context.length-1];if(inner.to-inner.spaceAfter.length>pos-line.from)return dont={range:range};var emptyLine=pos>=inner.to-inner.spaceAfter.length&&!/\S/.test(line.text.slice(inner.to));if(inner.item&&emptyLine){if(inner.node.firstChild.to>=pos||line.from>0&&!/[^\s>]/.test(doc2.lineAt(line.from-1).text)){var next=context.length>1?context[context.length-2]:null;var delTo,insert3="";if(next&&next.item){delTo=line.from+next.from;insert3=next.marker(doc2,1);}else{delTo=line.from+(next?next.to:0);}var changes3=[{from:delTo,to:pos,insert:insert3}];if(inner.node.name=="OrderedList")renumberList(inner.item,doc2,changes3,-2);if(next&&next.node.name=="OrderedList")renumberList(next.item,doc2,changes3);return{range:EditorSelection.cursor(delTo+insert3.length),changes:changes3};}else{var _insert2="";for(var _i225=0,e=context.length-2;_i225<=e;_i225++){_insert2+=context[_i225].blank(_i225<e?_countColumn(line.text,4,context[_i225+1].from)-_insert2.length:null,_i225<e);}_insert2=normalizeIndent(_insert2,state);return{range:EditorSelection.cursor(pos+_insert2.length+1),changes:{from:line.from,insert:_insert2+state.lineBreak}};}}if(inner.node.name=="Blockquote"&&emptyLine&&line.from){var prevLine=doc2.lineAt(line.from-1),quoted=/>\s*$/.exec(prevLine.text);if(quoted&&quoted.index==inner.from){var _changes3=state.changes([{from:prevLine.from+quoted.index,to:prevLine.to},{from:line.from+inner.from,to:line.to}]);return{range:range.map(_changes3),changes:_changes3};}}var changes2=[];if(inner.node.name=="OrderedList")renumberList(inner.item,doc2,changes2);var continued=inner.item&&inner.item.from<line.from;var insert2="";if(!continued||/^[\s\d.)\-+*>]*/.exec(line.text)[0].length>=inner.to){for(var _i226=0,_e3=context.length-1;_i226<=_e3;_i226++){insert2+=_i226==_e3&&!continued?context[_i226].marker(doc2,1):context[_i226].blank(_i226<_e3?_countColumn(line.text,4,context[_i226+1].from)-insert2.length:null);}}var from=pos;while(from>line.from&&/\s/.test(line.text.charAt(from-line.from-1))){from--;}insert2=normalizeIndent(insert2,state);changes2.push({from:from,to:pos,insert:state.lineBreak+insert2});return{range:EditorSelection.cursor(from+insert2.length+1),changes:changes2};});if(dont)return false;dispatch(state.update(changes,{scrollIntoView:true,userEvent:"input"}));return true;};function isMark(node){return node.name=="QuoteMark"||node.name=="ListMark";}function contextNodeForDelete(tree,pos){var node=tree.resolveInner(pos,-1),scan=pos;if(isMark(node)){scan=node.from;node=node.parent;}for(var prev;prev=node.childBefore(scan);){if(isMark(prev)){scan=prev.from;}else if(prev.name=="OrderedList"||prev.name=="BulletList"){node=prev.lastChild;scan=node.to;}else{break;}}return node;}var deleteMarkupBackward=function deleteMarkupBackward(_ref66){var state=_ref66.state,dispatch=_ref66.dispatch;var tree=_syntaxTree(state);var dont=null,changes=state.changeByRange(function(range){var pos=range.from,doc2=state.doc;if(range.empty&&markdownLanguage.isActiveAt(state,range.from)){var line=doc2.lineAt(pos);var context=getContext(contextNodeForDelete(tree,pos),doc2);if(context.length){var inner=context[context.length-1];var spaceEnd=inner.to-inner.spaceAfter.length+(inner.spaceAfter?1:0);if(pos-line.from>spaceEnd&&!/\S/.test(line.text.slice(spaceEnd,pos-line.from)))return{range:EditorSelection.cursor(line.from+spaceEnd),changes:{from:line.from+spaceEnd,to:pos}};if(pos-line.from==spaceEnd&&(!inner.item||line.from<=inner.item.from||!/\S/.test(line.text.slice(0,inner.to)))){var start=line.from+inner.from;if(inner.item&&inner.node.from<inner.item.from&&/\S/.test(line.text.slice(inner.from,inner.to))){var insert2=inner.blank(_countColumn(line.text,4,inner.to)-_countColumn(line.text,4,inner.from));if(start==line.from)insert2=normalizeIndent(insert2,state);return{range:EditorSelection.cursor(start+insert2.length),changes:{from:start,to:line.from+inner.to,insert:insert2}};}if(start<pos)return{range:EditorSelection.cursor(start),changes:{from:start,to:pos}};}}}return dont={range:range};});if(dont)return false;dispatch(state.update(changes,{scrollIntoView:true,userEvent:"delete"}));return true;};var markdownKeymap=[{key:"Enter",run:insertNewlineContinueMarkup},{key:"Backspace",run:deleteMarkupBackward}];var htmlNoMatch=/* @__PURE__ */html({matchClosingTags:false});function markdown(){var config2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var codeLanguages=config2.codeLanguages,defaultCodeLanguage=config2.defaultCodeLanguage,_config2$addKeymap=config2.addKeymap,addKeymap=_config2$addKeymap===void 0?true:_config2$addKeymap,_config2$base=config2.base;_config2$base=_config2$base===void 0?commonmarkLanguage:_config2$base;var parser5=_config2$base.parser,_config2$completeHTML=config2.completeHTMLTags,completeHTMLTags=_config2$completeHTML===void 0?true:_config2$completeHTML;if(!(parser5 instanceof MarkdownParser))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");var extensions=config2.extensions?[config2.extensions]:[];var support=[htmlNoMatch.support],defaultCode;if(defaultCodeLanguage instanceof _LanguageSupport){support.push(defaultCodeLanguage.support);defaultCode=defaultCodeLanguage.language;}else if(defaultCodeLanguage){defaultCode=defaultCodeLanguage;}var codeParser=codeLanguages||defaultCode?getCodeParser(codeLanguages,defaultCode):void 0;extensions.push(parseCode({codeParser:codeParser,htmlParser:htmlNoMatch.language.parser}));if(addKeymap)support.push(Prec.high(keymap.of(markdownKeymap)));var lang=mkLang(parser5.configure(extensions));if(completeHTMLTags)support.push(lang.data.of({autocomplete:htmlTagCompletion}));return new _LanguageSupport(lang,support);}function htmlTagCompletion(context){var state=context.state,pos=context.pos,m=/<[:\-\.\w\u00b7-\uffff]*$/.exec(state.sliceDoc(pos-25,pos));if(!m)return null;var tree=_syntaxTree(state).resolveInner(pos,-1);while(tree&&!tree.type.isTop){if(tree.name=="CodeBlock"||tree.name=="FencedCode"||tree.name=="ProcessingInstructionBlock"||tree.name=="CommentBlock"||tree.name=="Link"||tree.name=="Image")return null;tree=tree.parent;}return{from:pos-m[0].length,to:pos,options:htmlTagCompletions(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/};}var _tagCompletions=null;function htmlTagCompletions(){if(_tagCompletions)return _tagCompletions;var result=htmlCompletionSource(new _CompletionContext(EditorState.create({extensions:htmlNoMatch}),0,true));return _tagCompletions=result?result.options:[];}// ../node_modules/@codemirror/theme-one-dark/dist/index.js
var dist_exports4={};__export(dist_exports4,{oneDark:function oneDark(){return _oneDark;},oneDarkHighlightStyle:function oneDarkHighlightStyle(){return _oneDarkHighlightStyle;},oneDarkTheme:function oneDarkTheme(){return _oneDarkTheme;}});var chalky="#e5c07b";var coral="#e06c75";var cyan="#56b6c2";var invalid="#ffffff";var ivory="#abb2bf";var stone="#7d8799";var malibu="#61afef";var sage="#98c379";var whiskey="#d19a66";var violet="#c678dd";var darkBackground="#21252b";var highlightBackground="#2c313a";var background="#282c34";var tooltipBackground="#353a42";var selection="#3E4451";var cursor="#528bff";var _oneDarkTheme=/* @__PURE__ */EditorView.theme({"&":{color:ivory,backgroundColor:background},".cm-content":{caretColor:cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:cursor},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:selection},".cm-panels":{backgroundColor:darkBackground,color:ivory},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:highlightBackground},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{backgroundColor:background,color:stone,border:"none"},".cm-activeLineGutter":{backgroundColor:highlightBackground},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:tooltipBackground,borderBottomColor:tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:highlightBackground,color:ivory}}},{dark:true});var _oneDarkHighlightStyle=/* @__PURE__ */_HighlightStyle.define([{tag:tags.keyword,color:violet},{tag:[tags.name,tags.deleted,tags.character,tags.propertyName,tags.macroName],color:coral},{tag:[/* @__PURE__ */tags["function"](tags.variableName),tags.labelName],color:malibu},{tag:[tags.color,/* @__PURE__ */tags.constant(tags.name),/* @__PURE__ */tags.standard(tags.name)],color:whiskey},{tag:[/* @__PURE__ */tags.definition(tags.name),tags.separator],color:ivory},{tag:[tags.typeName,tags.className,tags.number,tags.changed,tags.annotation,tags.modifier,tags.self,tags.namespace],color:chalky},{tag:[tags.operator,tags.operatorKeyword,tags.url,tags.escape,tags.regexp,tags.link,/* @__PURE__ */tags.special(tags.string)],color:cyan},{tag:[tags.meta,tags.comment],color:stone},{tag:tags.strong,fontWeight:"bold"},{tag:tags.emphasis,fontStyle:"italic"},{tag:tags.strikethrough,textDecoration:"line-through"},{tag:tags.link,color:stone,textDecoration:"underline"},{tag:tags.heading,fontWeight:"bold",color:coral},{tag:[tags.atom,tags.bool,/* @__PURE__ */tags.special(tags.variableName)],color:whiskey},{tag:[tags.processingInstruction,tags.string,tags.inserted],color:sage},{tag:tags.invalid,color:invalid}]);var _oneDark=[_oneDarkTheme,/* @__PURE__ */_syntaxHighlighting(_oneDarkHighlightStyle)];// ../node_modules/@codemirror/legacy-modes/mode/mllike.js
function mlLike(parserConfig){var words={"as":"keyword","do":"keyword","else":"keyword","end":"keyword","exception":"keyword","fun":"keyword","functor":"keyword","if":"keyword","in":"keyword","include":"keyword","let":"keyword","of":"keyword","open":"keyword","rec":"keyword","struct":"keyword","then":"keyword","type":"keyword","val":"keyword","while":"keyword","with":"keyword"};var extraWords=parserConfig.extraWords||{};for(var prop in extraWords){if(extraWords.hasOwnProperty(prop)){words[prop]=parserConfig.extraWords[prop];}}var hintWords=[];for(var k in words){hintWords.push(k);}function tokenBase(stream,state){var ch=stream.next();if(ch==='"'){state.tokenize=tokenString;return state.tokenize(stream,state);}if(ch==="{"){if(stream.eat("|")){state.longString=true;state.tokenize=tokenLongString;return state.tokenize(stream,state);}}if(ch==="("){if(stream.match(/^\*(?!\))/)){state.commentLevel++;state.tokenize=tokenComment;return state.tokenize(stream,state);}}if(ch==="~"||ch==="?"){stream.eatWhile(/\w/);return"variableName.special";}if(ch==="`"){stream.eatWhile(/\w/);return"quote";}if(ch==="/"&&parserConfig.slashComments&&stream.eat("/")){stream.skipToEnd();return"comment";}if(/\d/.test(ch)){if(ch==="0"&&stream.eat(/[bB]/)){stream.eatWhile(/[01]/);}if(ch==="0"&&stream.eat(/[xX]/)){stream.eatWhile(/[0-9a-fA-F]/);}if(ch==="0"&&stream.eat(/[oO]/)){stream.eatWhile(/[0-7]/);}else{stream.eatWhile(/[\d_]/);if(stream.eat(".")){stream.eatWhile(/[\d]/);}if(stream.eat(/[eE]/)){stream.eatWhile(/[\d\-+]/);}}return"number";}if(/[+\-*&%=<>!?|@\.~:]/.test(ch)){return"operator";}if(/[\w\xa1-\uffff]/.test(ch)){stream.eatWhile(/[\w\xa1-\uffff]/);var cur2=stream.current();return words.hasOwnProperty(cur2)?words[cur2]:"variable";}return null;}function tokenString(stream,state){var next,end=false,escaped=false;while((next=stream.next())!=null){if(next==='"'&&!escaped){end=true;break;}escaped=!escaped&&next==="\\";}if(end&&!escaped){state.tokenize=tokenBase;}return"string";};function tokenComment(stream,state){var prev,next;while(state.commentLevel>0&&(next=stream.next())!=null){if(prev==="("&&next==="*")state.commentLevel++;if(prev==="*"&&next===")")state.commentLevel--;prev=next;}if(state.commentLevel<=0){state.tokenize=tokenBase;}return"comment";}function tokenLongString(stream,state){var prev,next;while(state.longString&&(next=stream.next())!=null){if(prev==="|"&&next==="}")state.longString=false;prev=next;}if(!state.longString){state.tokenize=tokenBase;}return"string";}return{startState:function startState(){return{tokenize:tokenBase,commentLevel:0,longString:false};},token:function token(stream,state){if(stream.eatSpace())return null;return state.tokenize(stream,state);},languageData:{autocomplete:hintWords,commentTokens:{line:parserConfig.slashComments?"//":void 0,block:{open:"(*",close:"*)"}}}};}var oCaml=mlLike({extraWords:{"and":"keyword","assert":"keyword","begin":"keyword","class":"keyword","constraint":"keyword","done":"keyword","downto":"keyword","external":"keyword","function":"keyword","initializer":"keyword","lazy":"keyword","match":"keyword","method":"keyword","module":"keyword","mutable":"keyword","new":"keyword","nonrec":"keyword","object":"keyword","private":"keyword","sig":"keyword","to":"keyword","try":"keyword","value":"keyword","virtual":"keyword","when":"keyword","raise":"builtin","failwith":"builtin","true":"builtin","false":"builtin","asr":"builtin","land":"builtin","lor":"builtin","lsl":"builtin","lsr":"builtin","lxor":"builtin","mod":"builtin","or":"builtin","raise_notrace":"builtin","trace":"builtin","exit":"builtin","print_string":"builtin","print_endline":"builtin","int":"type","float":"type","bool":"type","char":"type","string":"type","unit":"type","List":"builtin"}});var fSharp=mlLike({extraWords:{"abstract":"keyword","assert":"keyword","base":"keyword","begin":"keyword","class":"keyword","default":"keyword","delegate":"keyword","do!":"keyword","done":"keyword","downcast":"keyword","downto":"keyword","elif":"keyword","extern":"keyword","finally":"keyword","for":"keyword","function":"keyword","global":"keyword","inherit":"keyword","inline":"keyword","interface":"keyword","internal":"keyword","lazy":"keyword","let!":"keyword","match":"keyword","member":"keyword","module":"keyword","mutable":"keyword","namespace":"keyword","new":"keyword","null":"keyword","override":"keyword","private":"keyword","public":"keyword","return!":"keyword","return":"keyword","select":"keyword","static":"keyword","to":"keyword","try":"keyword","upcast":"keyword","use!":"keyword","use":"keyword","void":"keyword","when":"keyword","yield!":"keyword","yield":"keyword","atomic":"keyword","break":"keyword","checked":"keyword","component":"keyword","const":"keyword","constraint":"keyword","constructor":"keyword","continue":"keyword","eager":"keyword","event":"keyword","external":"keyword","fixed":"keyword","method":"keyword","mixin":"keyword","object":"keyword","parallel":"keyword","process":"keyword","protected":"keyword","pure":"keyword","sealed":"keyword","tailcall":"keyword","trait":"keyword","virtual":"keyword","volatile":"keyword","List":"builtin","Seq":"builtin","Map":"builtin","Set":"builtin","Option":"builtin","int":"builtin","string":"builtin","not":"builtin","true":"builtin","false":"builtin","raise":"builtin","failwith":"builtin"},slashComments:true});var sml=mlLike({extraWords:{"abstype":"keyword","and":"keyword","andalso":"keyword","case":"keyword","datatype":"keyword","fn":"keyword","handle":"keyword","infix":"keyword","infixr":"keyword","local":"keyword","nonfix":"keyword","op":"keyword","orelse":"keyword","raise":"keyword","withtype":"keyword","eqtype":"keyword","sharing":"keyword","sig":"keyword","signature":"keyword","structure":"keyword","where":"keyword","true":"keyword","false":"keyword","int":"builtin","real":"builtin","string":"builtin","char":"builtin","bool":"builtin"},slashComments:true});// includes.js
joo_global_object.__CM__view=EditorView;joo_global_object.__CM__collab=collab;joo_global_object.__CM__receiveUpdates=receiveUpdates;joo_global_object.__CM__sendableUpdates=sendableUpdates;joo_global_object.__CM__getSyncedVersion=getSyncedVersion;joo_global_object.__CM__viewPlugin=ViewPlugin;joo_global_object.__CM__markdown=markdown;joo_global_object.__CM__changeSet=ChangeSet;joo_global_object.__CM__state=EditorState;joo_global_object.__CM__lint=dist_exports3;joo_global_object.__CM__autocomplete=dist_exports2;joo_global_object.__CM__hoverTooltip=hoverTooltip;joo_global_object.__CM__basic_setup=basicSetup;joo_global_object.__CM__dark=dist_exports4;joo_global_object.__CM__stream_parser=dist_exports;joo_global_object.__CM__mllike=oCaml;})();
