====================
Include Tikz figures
====================

The best way to include TikZ figures is to compile them with LaTeX, and import the resulting file in a presentation.

We need to use the ``standalone`` class as we are only interested in the TikZ figure, not a full page. See `this resource <https://tex.stackexchange.com/questions/51757/how-can-i-use-tikz-to-make-standalone-svg-graphics>`_ for details. A minimal ``.tex`` file containing a standalone TikZ figure looks like:

.. code-block:: latex

   \documentclass[tikz]{standalone}
   % \usetikzlibrary{...} % tikz package already loaded by 'tikz' option
   \begin{document}
   \begin{tikzpicture}
     % Your TikZ code here
   \end{tikzpicture}
   \end{document}

If the image is static and we don't need to execute actions on some of its
elements, then the easiest is to compile the file in ``.pdf`` format.

.. code-block:: bash

   $ pdflatex file.tex

Integrating it in your slipshow presentation is then just a matter of including the pdf, which syntax is:

.. code-block::

   ![](file.pdf)

Reveal a TikZ figure bit by bit
===============================

If you want to have specific part of your figure to be the target of actions
(for instance, to reveal part of it, bit by bits), you'll need two things:

- First, you'll need to be able to assign ids to parts of your image
- Then, you'll need to compile in a format under which Slipshow is able to access the identifiers. We will use the svg format.

In order to assign ids, one can define the following environment at the beginning of the file:

.. code-block::

   \newenvironment{svggroup}[1]
     {\special{dvisvgm:raw <g id="#1">}}
     {\special{dvisvgm:raw </g>}}

Then, consider the following simple picture of a triangle:

.. code-block:: latex

   \begin{tikzpicture}

     \node[dot] (A) at (0,1) {};
     \node[dot] (B) at (1,0) {};
     \node[dot] (C) at (2,1) {};

     \draw (A) -- (B);
     \draw (B) -- (C);
     \draw (C) -- (A);

   \end{tikzpicture}

And suppose you want the node ``C`` to appear at a later step. Enclose the node and the edges in groups with an id. Here is the final complete file:

.. code-block:: latex

   \documentclass[tikz]{standalone}
   \newenvironment{svggroup}[1]
     {\special{dvisvgm:raw <g id="#1">}}
     {\special{dvisvgm:raw </g>}}
   \begin{document}
   \begin{tikzpicture}[dot/.style={circle, fill=black, inner sep=2pt}]

     \node[dot] (A) at (0,1) {};
     \node[dot] (B) at (1,0) {};
     \begin{svggroup}{c}
       \node[dot] (C) at (2,1) {};
     \end{svggroup}

     \draw (A) -- (B);
     \begin{svggroup}{c-edges}
       \draw (B) -- (C);
       \draw (C) -- (A);
     \end{svggroup}

   \end{tikzpicture}
   \end{document}


Then, we need to compile the file with svg output. Here we use ``latex`` and
``dvisvgm``. The ``--no-fonts`` improve the precision of text layouts, and
``--exact-bbox`` improves the precision of the bounding box.

.. code-block:: latex

   $ latex triangle.tex
   $ divsvgm --no-fonts --exact-bbox triangle.dvi

We now just need to include the svg file in a slipshow input, and write the
dynamics with actions:

.. code-block::

   ---
   toplevel-attributes: slip enter=~duration:0 unreveal="c c-edges"
   ---

   ![](triangle.svg){style="width:75%"}

   {reveal=c}

   {reveal=c-edges}

Here is the final result!

.. slipshow-example::
   :visible: presentation
   :dimension: 4:3

   ---
   toplevel-attributes: slip enter=~duration:0 unreveal="c c-edges"
   ---

   <!-- inlining the svg for simplicity -->
   <span class="slipshow-svg-container" style="width:75%;margin:20px">
   <!--?xml version='1.0' encoding='UTF-8'?-->
   <!-- This file was generated by dvisvgm 3.6 -->
   <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="63.138351pt" height="35.48008pt" viewBox="-40.01424 -40.658849 63.138351 35.48008">
   <defs>
   <path id="g0-65" d="M3.965131-6.933998C3.915318-7.063512 3.895392-7.13325 3.73599-7.13325S3.5467-7.073474 3.496887-6.933998L1.43462-.976339C1.255293-.468244 .856787-.318804 .318804-.308842V0C.547945-.009963 .976339-.029888 1.334994-.029888C1.643836-.029888 2.161893-.009963 2.480697 0V-.308842C1.982565-.308842 1.733499-.557908 1.733499-.816936C1.733499-.846824 1.743462-.946451 1.753425-.966376L2.211706-2.271482H4.672478L5.200498-.747198C5.210461-.707347 5.230386-.647572 5.230386-.607721C5.230386-.308842 4.672478-.308842 4.403487-.308842V0C4.762142-.029888 5.459527-.029888 5.838107-.029888C6.266501-.029888 6.724782-.019925 7.143213 0V-.308842H6.963885C6.366127-.308842 6.22665-.37858 6.117061-.707347L3.965131-6.933998ZM3.437111-5.818182L4.562889-2.580324H2.321295L3.437111-5.818182Z"></path>
   <path id="g0-66" d="M2.211706-3.646326V-6.097136C2.211706-6.425903 2.231631-6.495641 2.699875-6.495641H3.935243C4.901619-6.495641 5.250311-5.648817 5.250311-5.120797C5.250311-4.483188 4.762142-3.646326 3.656289-3.646326H2.211706ZM4.562889-3.556663C5.529265-3.745953 6.216687-4.383562 6.216687-5.120797C6.216687-5.987547 5.300125-6.804483 4.004981-6.804483H.358655V-6.495641H.597758C1.364882-6.495641 1.384807-6.386052 1.384807-6.027397V-.777086C1.384807-.418431 1.364882-.308842 .597758-.308842H.358655V0H4.26401C5.589041 0 6.485679-.886675 6.485679-1.823163C6.485679-2.689913 5.668742-3.437111 4.562889-3.556663ZM3.945205-.308842H2.699875C2.231631-.308842 2.211706-.37858 2.211706-.707347V-3.427148H4.084682C5.070984-3.427148 5.489415-2.500623 5.489415-1.833126C5.489415-1.125778 4.971357-.308842 3.945205-.308842Z"></path>
   <path id="g0-67" d="M.557908-3.407223C.557908-1.344956 2.171856 .219178 4.024907 .219178C5.648817 .219178 6.625156-1.165629 6.625156-2.321295C6.625156-2.420922 6.625156-2.49066 6.495641-2.49066C6.386052-2.49066 6.386052-2.430884 6.37609-2.331258C6.296389-.9066 5.230386-.089664 4.144458-.089664C3.536737-.089664 1.58406-.428394 1.58406-3.39726C1.58406-6.37609 3.526775-6.714819 4.134496-6.714819C5.220423-6.714819 6.107098-5.808219 6.306351-4.353674C6.326276-4.214197 6.326276-4.184309 6.465753-4.184309C6.625156-4.184309 6.625156-4.214197 6.625156-4.423412V-6.784558C6.625156-6.953923 6.625156-7.023661 6.515567-7.023661C6.475716-7.023661 6.435866-7.023661 6.356164-6.90411L5.858032-6.166874C5.489415-6.525529 4.98132-7.023661 4.024907-7.023661C2.161893-7.023661 .557908-5.439601 .557908-3.407223Z"></path>
   </defs>
   <g id="page1">
   <g transform="matrix(1 0 0 1 -3.736 -24.9429)">
   <use x="-36.597045" y="-8.582698" xlink:href="#g0-65"></use>
   </g>
   <g transform="matrix(1 0 0 1 24.8183 3.40393)">
   <use x="-36.597045" y="-8.582698" xlink:href="#g0-66"></use>
   </g>
   <g id="c">
   <g transform="matrix(1 0 0 1 53.096 -24.9429)">
   <use x="-36.597045" y="-8.582698" xlink:href="#g0-67"></use>
   </g>
   </g>
   <path d="M-29.67578-30.0039L-15.1719-15.50781" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
   <g id="c-edges">
   <path d="M-1.3281-15.50781L13.1758-30.0039" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
   <path d="M12.9805-36.9297H-29.33984" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
   </g>
   </g>
   </svg></span>

   {reveal=c}

   {reveal=c-edges}
