{"version":3,"file":"slipshow.cdn.js","sources":["../src/modules/util.mjs","../src/modules/controller.mjs","../src/modules/slip.mjs","../src/modules/engine.mjs","../src/slip-lib.js"],"sourcesContent":["export let myQueryAll = (root, selector, avoid) => {\n    avoid = avoid || \".slip\";\n    if (!root.id)\n\troot.id = '_' + Math.random().toString(36).substr(2, 15);;\n    let allElem = Array.from(root.querySelectorAll(selector));\n    let separatedSelector = selector.split(\",\").map(selec => \"#\"+root.id+\" \" + avoid + \" \" + selec).join();\n    // console.log(\"debug myQueryAll\", selector, \"VS\",  separatedSelector);\n    let other = Array.from(root.querySelectorAll(separatedSelector));\n    // let other = Array.from(root.querySelectorAll(\"#\"+root.id+\" \" + avoid + \" \" + separatedSelector));\n    return allElem.filter(value => !other.includes(value));\n};\nwindow.myQueryAll = myQueryAll;\n\nexport function cloneNoSubslip (elem) {\n    let newElem = elem.cloneNode(false);\n    elem.childNodes.forEach((child) => {\n\tif(child.classList && child.classList.contains(\"slip\")){\n\t    let placeholder = document.createElement(child.tagName);\n\t    placeholder.classList.add(\"toReplace\");\n\t    newElem.appendChild(placeholder);\n\t}\n\telse\n\t    newElem.appendChild(cloneNoSubslip(child));\n    });\n    return newElem;\n}\nexport function replaceSubslips(clone, subslips) {\n    let placeholders = myQueryAll(clone, \".toReplace\");\n    subslips.forEach((subslip, index) => {\n\tplaceholders[index].replaceWith(subslip);\n    });\n}\n","export default function (ng) {\n    let engine = ng;\n    this.getEngine = () => this.engine;\n    this.setEngine = (ng) => this.engine = ng;\n\n    // let mainSlip = mainS;\n    // this.getMainSlip = () => mainSlip;\n    // this.setMainSlip = (slip) => mainSlip = slip;\n\n    let speedMove=1;\n    document.addEventListener(\"keypress\", (ev) => {\n\tif(ev.key == \"f\") { speedMove = (speedMove + 4)%30+1; }    \n\tif(ev.key == \"r\") { engine.getCurrentSlip().refresh(); }    \n\tif(ev.key == \"#\") {\n\t    document.querySelectorAll(\".slip\").forEach((slip) => {slip.style.zIndex = \"-1\";});\n\t    document.querySelectorAll(\".background-canvas\").forEach((canvas) => {canvas.style.zIndex = \"1\";});\n\t}    \n    });\n    document.addEventListener(\"keydown\", (ev) => {\n\tlet openWindowHeight = engine.getOpenWindowHeight();\n\tlet openWindowWidth = engine.getOpenWindowWidth();\n\tif(ev.key == \"l\") { engine.moveWindowRelative( 0                          ,  (speedMove)/openWindowHeight, 0, 0, 0.1); }   // Bas\n\tif(ev.key == \"o\") { engine.moveWindowRelative( 0                          , -(speedMove)/openWindowHeight, 0, 0, 0.1); }  // Haut\n\tif(ev.key == \"k\") { engine.moveWindowRelative(-(speedMove)/openWindowWidth,  0                           , 0, 0, 0.1); }   // Gauche\n\tif(ev.key == \"m\") { engine.moveWindowRelative( (speedMove)/openWindowWidth,  0                           , 0, 0, 0.1); }   // Droite\n\tif(ev.key == \"i\") { engine.moveWindowRelative(0, 0,  0   ,  1, 0.1); }                             // Rotate \n\tif(ev.key == \"p\") { engine.moveWindowRelative(0, 0,  0   , -1, 0.1); }                             // Unrotate\n\tif(ev.key == \"z\") { engine.moveWindowRelative(0, 0,  0.01,  0, 0.1); }                          // Zoom\n\tif(ev.key == \"Z\") { engine.moveWindowRelative(0, 0, -0.01,  0, 0.1); }                          // Unzoom\n\tif(ev.key == \"T\") {\n\t    engine.showToC();\n\t    // document.querySelector(\".toc-slip\").style.display = document.querySelector(\".toc-slip\").style.display == \"none\" ? \"block\" : \"none\"; \n\t}   \n\tif(ev.key == \"t\") {\n\t    // engine.showToC();\n\t    document.querySelector(\".toc-slip\").style.display = document.querySelector(\".toc-slip\").style.display == \"none\" ? \"block\" : \"none\"; \n\t}   \n\tif(ev.key == \"ArrowRight\") {\n\t    console.log(ev);\n\t    if(ev.shiftKey)\n\t\tengine.nextSlip();\n\t    else    \n\t\tengine.next();\n\t}\n\telse if (ev.key == \"ArrowLeft\") {\n\t    if(ev.shiftKey)\n\t\tengine.previousSlip();\n\t    else    \n\t\tengine.previous();\n\t}\n\telse if (ev.key == \"ArrowUp\") {\n\t    engine.pop();\n\t}\n    });  \n    \n};\n","import { cloneNoSubslip, myQueryAll, replaceSubslips } from './util'\n\nexport default function Slip(name, fullName, actionL, ng, options) {\n\n    // ******************************\n    // Action List\n    // ******************************\n\n    this.generateActionList = function() {\n\tconsole.log(\"debug generateactionlist\", this.name);\n\tlet newActionList = [];\n\tthis.queryAll(\".slip[enter-at]\").forEach((slip) => {\n\t    console.log(\"new slip with \", slip, null, null, ng, {});\n\t    newActionList[slip.getAttribute(\"enter-at\")] = new Slip(slip, \"\", [], ng, {});\n\t});\n\treturn newActionList;\n    };\n    this.addSubSlips = function() {\n\tconsole.log(\"debug generateactionlist\", this.name);\n\tlet newActionList = [];\n\tthis.queryAll(\".slip[enter-at]\").forEach((slip) => {\n\t    console.log(\"new slip with \", slip, null, null, ng, {});\n\t    this.setNthAction(slip.getAttribute(\"enter-at\"), new Slip(slip, \"\", [], ng, {}));\n\t});\n\treturn newActionList;\n    };\n    let actionList = actionL;// || this.generateActionList();\n    this.setAction = (actionL) => {actionList = actionL;};\n    this.getActionList = () => {\n\tlet ret = [];\n\tfor(let i = 0;i <= this.getMaxNext(); i++) {\n\t    if(this.pauseSlipList[i] instanceof Slip)\n\t\tret[i] = this.pauseSlipList[i];\n\t    else if(typeof actionList[i] == \"function\" || actionList[i] instanceof Slip)\n\t\tret[i] = actionList[i];\n\t    else\n\t\tret[i] = () => {};\n\t}\n\treturn ret;\n    };\n    this.setNthAction = (n,action) => {actionList[n] = action;};\n    this.getCurrentSubSlip = () => {\n\tif(actionList[this.getActionIndex()] instanceof Slip)\n\t    return actionList[this.getActionIndex()];\n\tif(this.pauseSlipList[this.getActionIndex()] instanceof Slip)\n\t    return this.pauseSlipList[this.getActionIndex()];\n\treturn false;\n    };\n    this.nextStageNeedGoto = () => {\n\tif(actionList[this.getActionIndex()+1] instanceof Slip)\n\t    return false;\n\tif(this.pauseSlipList[this.getActionIndex()+1] instanceof Slip)\n\t    return false;\n\tif(this.getActionIndex() >= this.getMaxNext())\n\t    return false;\n\treturn true;\n    };\n    this.getSubSlipList = function () {\n\treturn actionList.filter((action) => action instanceof Slip);\n    };\n\n    // ******************************\n    // Action Index\n    // ******************************\n    let actionIndex = -1;\n    this.setActionIndex = (actionI) => actionIndex = actionI;\n    this.getActionIndex = () => actionIndex;\n    this.getMaxNext = () => {\n\tif(this.maxNext)\n\t    return this.maxNext;\n\tlet maxTemp = actionList.length;\n\t[\"mk-visible-at\",\n\t \"mk-hidden-at\",\n\t \"mk-emphasize-at\",\n\t \"mk-unemphasize-at\",\n\t \"emphasize-at\",\n\t \"chg-visib-at\",\n\t \"up-at\",\n\t \"down-at\",\n\t \"center-at\",\n\t \"static-at\",\n\t \"exec-at\",\n\t \"enter-at\",\n\t].forEach((attr) => {\n\t     this.queryAll(\"*[\"+attr+\"]\").forEach((elem) => {\n\t\t elem.getAttribute(attr).split(\" \").forEach((strMax) => {\n\t\t     maxTemp = Math.max(Math.abs(parseInt(strMax)),maxTemp);\n\t\t });\n\t     });\n\t});\n\tlet sumArray = this.queryAll(\"[pause], [step], [auto-enter], [immediate-enter]\").map((elem) => {\n\t    if(elem.hasAttribute(\"pause\") && elem.getAttribute(\"pause\") != \"\")\n\t\treturn parseInt(elem.getAttribute(\"pause\"));\n\t    if(elem.hasAttribute(\"step\") && elem.getAttribute(\"step\") != \"\")\n\t\treturn parseInt(elem.getAttribute(\"step\"));\n\t    return 1; });\n\tmaxTemp = Math.max(maxTemp, sumArray.reduce((a,b) => a+b, 0));\n\tthis.maxNext = maxTemp;\n\treturn maxTemp;\t\n    };\n    \n    // ******************************\n    // Queries\n    // ******************************\n    this.queryAll = (quer) => {\n\treturn myQueryAll(this.element, quer);\n\t// let allElem = Array.from(this.element.querySelectorAll(quer));\n\t// let other = Array.from(this.element.querySelectorAll(\"#\"+this.name+\" .slip \"+quer));\n\t// return allElem.filter(value => !other.includes(value));\n    };\n    this.query = (quer) => {\n\tif(typeof quer != \"string\") return quer;\n\treturn this.queryAll(quer)[0];\n    };\n    this.findSubslipByID = (id) => {\n\tlet goodSubslip = this.getSubSlipList().find((subslip) => {\n\t    if(subslip.name == id)\n\t\treturn 1;\n\t    return subslip.findSubslipByID(id);\n\t});\n\tif(!goodSubslip)\n\t    return false;\n\tif (goodSubslip.name == id) \n\t    return goodSubslip;\n\treturn goodSubslip.findSubslipByID(id);\n    };\n    \n    // ******************************\n    // Coordinates\n    // ******************************\n    this.findSlipCoordinate = () => { // rename to getCoordInUniverse\n\tlet coord = engine.getCoordinateInUniverse(this.element);\n\tconsole.log(\"debug findslipcoordinate\", coord);\n\tcoord.scale *= this.scale;\n\tcoord.y = coord.y + 0.5*coord.scale;\n\tcoord.x = coord.centerX;\n\tconsole.log(\"debug findslipcoordinate\", coord);\n\treturn coord;\n    };\n\n\n    // ******************************\n    // Pause functions\n    // ******************************\n    this.updatePauseAncestors = () => {\n\tthis.queryAll(\".pauseAncestor\").forEach((elem) => {elem.classList.remove(\"pauseAncestor\");});\n\tlet pause = this.query(\"[pause]\");\n\twhile(pause && !pause.classList.contains(\"slip\")) {\n\t    pause.classList.add(\"pauseAncestor\");\n\t    pause = pause.parentElement;\n\t};\n    };\n    this.unpause = (pause) => {\n\tif(pause.hasAttribute(\"down-at-unpause\")) {\n\t    if(pause.getAttribute(\"down-at-unpause\") == \"\")\n\t\tthis.moveDownTo(pause, 1);\n\t    else\n\t\tthis.moveDownTo(\"#\"+pause.getAttribute(\"down-at-unpause\"), 1);\t\t\t\n\t}\n\tif(pause.hasAttribute(\"up-at-unpause\")) {\n\t    if(pause.getAttribute(\"up-at-unpause\") == \"\")\n\t\tthis.moveUpTo(pause, 1);\n\t    else\n\t\tthis.moveUpTo(\"#\"+pause.getAttribute(\"up-at-unpause\"), 1);\n\t}\n\tif(pause.hasAttribute(\"center-at-unpause\"))\n\t    if(pause.getAttribute(\"center-at-unpause\") == \"\")\n\t\tthis.moveCenterTo(pause, 1);\n\telse\n\t    this.moveCenterTo(\"#\"+pause.getAttribute(\"center-at-unpause\"), 1);\n\tif(pause.hasAttribute(\"exec-at-unpause\"))\n\t    if(pause.getAttribute(\"exec-at-unpause\") == \"\")\n\t\tthis.executeScript(pause);\n\telse\n\t    this.executeScript(\"#\"+pause.getAttribute(\"exec-at-unpause\"));\t\n\tif(pause.hasAttribute(\"reveal-at-unpause\"))\n\t    if(pause.getAttribute(\"reveal-at-unpause\") == \"\")\n\t\tthis.reveal(pause);\n\telse\n\t    this.reveal(\"#\"+pause.getAttribute(\"reveal-at-unpause\"));\n    };\n    this.incrPause = () => {\n\tlet pause = this.query(\"[pause], [auto-enter]:not([auto-enter=\\\"0\\\"]), [immediate-enter]:not([immediate-enter=\\\"0\\\"]), [step]\");\n\t// let pause = this.query(\"[pause]\");\n\tif(pause) {\n\t    console.log(\"pause is\", this.name, pause);\n\t    if(pause.hasAttribute(\"step\")) {\n\t\tif(!pause.getAttribute(\"step\")) \n\t\t    pause.setAttribute(\"step\", 1);\n\t\tlet d = pause.getAttribute(\"step\");\n\t\tif (d <= 1){\n\t\t    pause.removeAttribute(\"step\");\n\t\t    this.unpause(pause);\n\t\t} else\n\t\t    pause.setAttribute(\"step\", d-1);\n\t    }\n\t    if(pause.hasAttribute(\"auto-enter\")) {\n\t\tpause.setAttribute(\"auto-enter\", 0);\n\t\tthis.unpause(pause);\n\t    }\n\t    if(pause.hasAttribute(\"immediate-enter\")) {\n\t\tpause.setAttribute(\"immediate-enter\", 0);\n\t\tthis.unpause(pause);\n\t    }\n\t    if(pause.hasAttribute(\"pause\")) {\n\t\tif(!pause.getAttribute(\"pause\")) \n\t\t    pause.setAttribute(\"pause\", 1);\n\t\tlet d = pause.getAttribute(\"pause\");\n\t\tif (d <= 1){\n\t\t    pause.removeAttribute(\"pause\");\n\t\t    this.unpause(pause);\n\t\t} else\n\t\t    pause.setAttribute(\"pause\", d-1);\n\t\tthis.updatePauseAncestors();\n\t    }\n\t}\n    };\n\n    // ******************************\n    // Next functions\n    // ******************************\n    this.doAttributes = () => {\n\tthis.queryAll(\"*[mk-hidden-at]\").forEach((elem) => {\n\t    let hiddenAt = elem.getAttribute(\"mk-hidden-at\").split(\" \").map((str) => parseInt(str));\n\t    if(hiddenAt.includes(actionIndex))\n\t\telem.style.opacity = \"0\";});\t\n\tthis.queryAll(\"*[mk-visible-at]\").forEach((elem) => {\n\t    let visibleAt = elem.getAttribute(\"mk-visible-at\").split(\" \").map((str) => parseInt(str));\n\t    if(visibleAt.includes(actionIndex))\n\t\telem.style.opacity = \"1\";});\t\n\tthis.queryAll(\"*[mk-emphasize-at]\").forEach((elem) => {\n\t    let emphAt = elem.getAttribute(\"mk-emphasize-at\").split(\" \").map((str) => parseInt(str));\n\t    if(emphAt.includes(actionIndex))\n\t\telem.classList.add(\"emphasize\");});\t\n\tthis.queryAll(\"*[mk-unemphasize-at]\").forEach((elem) => {\n\t    let unemphAt = elem.getAttribute(\"mk-unemphasize-at\").split(\" \").map((str) => parseInt(str));\n\t    if(unemphAt.includes(actionIndex))\n\t\telem.classList.remove(\"emphasize\");});\t\n\tthis.queryAll(\"*[emphasize-at]\").forEach((elem) => {\n\t    let emphAt = elem.getAttribute(\"emphasize-at\").split(\" \").map((str) => parseInt(str));\n\t    if(emphAt.includes(actionIndex))\n\t\telem.classList.add(\"emphasize\");\n\t    else\n\t\telem.classList.remove(\"emphasize\");\n\t});\t\n\tthis.queryAll(\"*[chg-visib-at]\").forEach((elem) => {\n\t    let visibAt = elem.getAttribute(\"chg-visib-at\").split(\" \").map((str) => parseInt(str));\n\t    if(visibAt.includes(actionIndex))\n\t\telem.style.opacity = \"1\";\n\t    if(visibAt.includes(-actionIndex))\n\t\telem.style.opacity = \"0\";\n\t});\t\n\tthis.queryAll(\"*[static-at]\").forEach((elem) => {\n\t    let staticAt = elem.getAttribute(\"static-at\").split(\" \").map((str) => parseInt(str));\n\t    if(staticAt.includes(-actionIndex)){\n\t\tthis.makeUnStatic(elem);\n\t\t// elem.style.position = \"absolute\";\n\t\t// elem.style.visibility = \"hidden\";\n\t    }\n\t    if(staticAt.includes(actionIndex)) {\n\t\tthis.makeStatic(elem);\n\t\t// elem.style.position = \"static\";\n\t\t// elem.style.visibility = \"visible\";\n\t    }\n\t});\t    \n\tthis.queryAll(\"*[down-at]\").forEach((elem) => {\n\t    let goDownTo = elem.getAttribute(\"down-at\").split(\" \").map((str) => parseInt(str));\n\t    if(goDownTo.includes(actionIndex))\n\t\tthis.moveDownTo(elem, 1);\n\t});\n\tthis.queryAll(\"*[up-at]\").forEach((elem) => {\n\t    let goTo = elem.getAttribute(\"up-at\").split(\" \").map((str) => parseInt(str));\n\t    if(goTo.includes(actionIndex))\n\t\tthis.moveUpTo(elem, 1);});\n\tthis.queryAll(\"*[center-at]\").forEach((elem) => {\n\t    let goDownTo = elem.getAttribute(\"center-at\").split(\" \").map((str) => parseInt(str));\n\t    if(goDownTo.includes(actionIndex))\n\t\tthis.moveCenterTo(elem, 1);});\t\n\tthis.queryAll(\"*[exec-at]\").forEach((elem) => {\n\t    let toExec = elem.getAttribute(\"exec-at\").split(\" \").map((str) => parseInt(str));\n\t    if(toExec.includes(actionIndex))\n\t\tthis.executeScript(elem);});\t\n    };\n    this.incrIndex = () => {\n\tconsole.log(\"incrIndex\", this.name);\n\tactionIndex = actionIndex+1;\n\tthis.doAttributes();\n\tif(actionIndex>0)\n\t    this.incrPause();\n\tthis.updateToC();\n    };\n    this.next = function () {\n\tif(actionIndex >= this.getMaxNext())\n\t    return false;\n\tthis.incrIndex();\n\tif(typeof actionList[actionIndex] == \"function\") {\n\t    actionList[actionIndex](this);\n\t}\n\tif(actionList[actionIndex] instanceof Slip){\n\t    return actionList[actionIndex];\n\t}\n\tif(this.pauseSlipList[actionIndex] instanceof Slip)\n\t    return this.pauseSlipList[actionIndex];\n\t// let nextSlip = this.query(\"[pause], [auto-enter]\");\n\t// if(nextSlip.hasAttribute(\"auto-enter\"))\n\t//     return \n\treturn true;\n    };\n    this.previous = () => {\n\tlet savedActionIndex = this.getActionIndex();\n\tlet savedDelay = this.currentDelay;\n\tthis.getEngine().setDoNotMove(true);\n\tconsole.log(\"gotoslip: we call doRefresh\",this.doRefresh());\n\tif(savedActionIndex == -1)\n\t    return false;\n \tlet toReturn;\n\twhile(this.getActionIndex()<savedActionIndex-1){\n\t    console.log(\"previous is ca we do next\", this.getEngine().getDoNotMove());\n\t    toReturn = this.next();\n\t}\n\t// if(!this.nextStageNeedGoto())\n\t//     this.getEngine().setDoNotMove(false);\n\t// while(this.getActionIndex()<savedActionIndex-1)\n\t//     toReturn = this.next();\n\tsetTimeout(() => {this.getEngine().setDoNotMove(false);},0);\n\tthis.getEngine().gotoSlip(this, {delay:savedDelay});\n\treturn toReturn;\n\n\t// return this.next;\n    };\n\n    // ******************************\n    // ToC functions\n    // ******************************\n    this.setTocElem = (tocElem) => {this.tocElem = tocElem;};\n    this.updateToC = () => {\n\tif(!this.tocElem)\n\t    return;\n\tif(!this.ToCList)\n\t    this.ToCList = myQueryAll(this.tocElem, \"li\", \"li\");\n\tlet i;\n\tfor(i=0;i<this.getActionIndex(); i++) {\n\t    this.ToCList[i].classList.remove(\"before\", \"after\", \"current\");\n\t    this.ToCList[i].classList.add(\"before\");\t    \n\t}\n\tif(i<=this.getActionIndex()) {\n\t    this.ToCList[i].classList.remove(\"before\", \"after\", \"current\");\n\t    this.ToCList[i].classList.add(\"current\");\n\t    i++;\n\t}\n\tfor(i;i<=this.getMaxNext(); i++) {\n\t    this.ToCList[i].classList.remove(\"before\", \"after\", \"current\");\n\t    this.ToCList[i].classList.add(\"after\");\n\t}\t\n    };\n    this.firstVisit = () => {\n\tthis.updateToC();\n\tif(options.firstVisit)\n\t    options.firstVisit(this);\n    };\n    this.init = () => {\n\tthis.queryAll(\"*[chg-visib-at]\").forEach((elem) => {\n\t    elem.style.opacity = \"0\";\n\t});\t\n\t// this.queryAll(\"*[static-at]\").forEach((elem) => {\n\t//     elem.style.position = \"absolute\";\n\t//     elem.style.visibility = \"hidden\";\n\t// });\t\n\tthis.doAttributes();\n\tthis.updatePauseAncestors();\n\tif(options.init)\n\t    options.init(this);\n    };\n\n    // ******************************\n    // Refreshes\n    // ******************************\n    this.refresh = () => {\n\tif(actionList[actionIndex] instanceof Slip)\n\t    actionList[actionIndex].refresh();\n\telse\n\t    this.doRefresh();\n    };\n    this.refreshAll = () => {\n\tactionList.filter((elem) => elem instanceof Slip).forEach((subslip) => { subslip.refreshAll();});\n\tthis.pauseSlipList.filter((elem) => elem instanceof Slip).forEach((subslip) => { subslip.refreshAll();});\n\tthis.doRefresh();\n    };\n    this.doRefresh = () => {\n\tconsole.log(\"gotoslip: doRefresh has been called\");\n\tthis.setActionIndex(-1);\n\tlet subSlipList = myQueryAll(this.element, \".slip\");\n\tconsole.log(\"mmdebug\", clonedElement);\n\tlet clone = clonedElement.cloneNode(true);\n\treplaceSubslips(clone, subSlipList);\n\tthis.element.replaceWith(clone);\n\tthis.element = clone;\n\tthis.init();\n\tthis.firstVisit();\n\tdelete(this.currentX);\n\tdelete(this.currentY);\n\tdelete(this.currentDelay);\n\tconsole.log(\"previous is ca GOTOSLIP FROM 3\", options, this.getEngine().getDoNotMove());\n\tthis.getEngine().gotoSlip(this);\n    };\n\n    // ******************************\n    // Movement, execution and hide/show\n    // ******************************\n    this.makeUnStatic = (selector, delay, opacity) => {\n\tlet elem = this.query(selector);\n\tsetTimeout(() => {\n\t    elem.style.overflow = \"hidden\"; \n\t    setTimeout(() => {\n\t\telem.style.transition = \"height \"+ (typeof(delay) == \"undefined\" ? \"1s\" : (delay+\"s\"));\n\t\tif(opacity)\n\t\t    elem.style.transition += \", opacity \"+ (typeof(delay) == \"undefined\" ? \"1s\" : (delay+\"s\"));\n\t\telem.style.height = (elem.offsetHeight+\"px\");\n\t\tif(opacity)\n\t\t    elem.style.opacity = \"1\";\n\t\tsetTimeout(() => {\n\t\t    if(opacity)\n\t\t    \telem.style.opacity = \"0\"; \n\t\t    elem.style.height = (\"0px\");}, 10);\n\t    }, 0);\n\t},0);\t// elem.style.position = \"absolute\";\n    };\n    this.makeStatic = (selector) => {\n\tlet elem = this.query(selector);\n\telem.style.position = \"static\";\n\telem.style.visibility = \"visible\";\n    };\n    this.executeScript = (selector) => {\n\tlet elem;\n\tif(typeof selector == \"string\") elem = this.query(selector);\n\telse elem = selector;\n\t(new Function(\"slip\",elem.innerHTML))(this);\n    };\n    this.moveUpTo = (selector, delay,  offset) => {\n\tsetTimeout(() => {\n\t    let elem;\n\t    if(typeof selector == \"string\") elem = this.query(selector);\n\t    else elem = selector;\n\t    if (typeof offset == \"undefined\") offset = 0.0125;\n\t    let coord = this.findSlipCoordinate();\n\t    let d = ((elem.offsetTop)/1080-offset)*coord.scale;\n\t    this.moveWindow(coord.x, coord.y+d, coord.scale, this.rotate, delay);\n\t    // this.currentX = coord.x;\n\t    // this.currentY = coord.y+d;\n\t    // this.currentDelay = delay;\n\t    // engine.moveWindow(coord.x, coord.y+d, coord.scale, this.rotate, delay);\n\t},0);\n    };\n    this.moveDownTo = (selector, delay, offset) => {\n\tsetTimeout(() => {\n\t    let elem;\n\t    if(typeof selector == \"string\") elem = this.query(selector);\n\t    else elem = selector;\n\t    if (typeof offset == \"undefined\") offset = 0.0125;\n\t    let coord = this.findSlipCoordinate();\n\t    let d = ((elem.offsetTop+elem.offsetHeight)/1080 - 1 + offset)*coord.scale;\n\t    this.moveWindow(coord.x, coord.y+d, coord.scale, this.rotate, delay);\n\t    // this.currentX = coord.x;\n\t    // this.currentY = coord.y+d;\n\t    // this.currentDelay = delay;\n\t    // engine.moveWindow(coord.x, coord.y+d, coord.scale, this.rotate, delay);\n\t},0);\n    };\n    this.moveCenterTo = (selector, delay, offset) => {\n\tsetTimeout(() => {\n\t    let elem;\n\t    if(typeof selector == \"string\") elem = this.query(selector);\n\t    else elem = selector;\n\t    if (typeof offset == \"undefined\") offset = 0;\n\t    let coord = this.findSlipCoordinate();\n\t    let d = ((elem.offsetTop+elem.offsetHeight/2)/1080-1/2+offset)*coord.scale;\n\t    this.moveWindow(coord.x, coord.y+d, coord.scale, this.rotate, delay);\n\t    // this.currentX = coord.x;\n\t    // this.currentY = coord.y+d;\n\t    // this.currentDelay = delay;\n\t    // engine.moveWindow(coord.x, coord.y+d, coord.scale, this.rotate, delay);\n\t},0);\n    };\n    this.moveWindow = (x,y,scale,rotate, delay) => {\n\tthis.currentX = x;\n\tthis.currentY = y;\n\tthis.currentDelay = delay;\n\tconsole.log(\"previous is ca we try to move win\", this.getEngine().getDoNotMove());\n\tconsole.log(\"previous is ca ORIGIN 3\", x, y, this.getEngine().getDoNotMove());\n//\tsetTimeout(() => {\n\t    this.getEngine().moveWindow(x, y, scale, rotate, delay);\n//\t}, 0);\n    };\n    this.reveal = (selector) => {\n\tlet elem;\n\tif(typeof selector == \"string\") elem = this.query(selector);\n\telse elem = selector;\n\telem.style.opacity = \"1\";\n    };\n    this.revealAll = (selector) => {\n\tthis.queryAll(selector).forEach((elem) => { elem.style.opacity = \"1\";});\n    };\n    this.hide = (selector) => {\n\tthis.query(selector).style.opacity = \"0\";\n    };\n    this.hideAll = (selector) => {\n\tthis.queryAll(selector).forEach((elem) => { elem.style.opacity = \"0\";});\n    };\n\n    // ******************************\n    // Initialisation of the object\n    // ******************************\n    // names    \n    this.fullName = fullName;\n    this.name =\n\ttypeof name == \"string\" ?\n\tname:\n\tname.id;\n    console.log(\"this name is \", this.name);\n    // engine\n    let engine = ng;\n    this.getEngine = () => engine;\n    this.setEngine = (ng) => engine = ng;\n    // element\n    this.element =\n\ttypeof name == \"string\" ?\n\tdocument.querySelector(\"#\"+name):\n\tname;\n    // clonedElement\n    let clonedElement;\n    if(typeof MathJax != \"undefined\")\n\tMathJax.startup.promise.then(() => {\n\t    setTimeout(() => {clonedElement = cloneNoSubslip(this.element);},0);\n\t});\n    else\n\tsetTimeout(() => {clonedElement = cloneNoSubslip(this.element);},0);\n    this.getCloned = () => clonedElement;\n    this.setCloned = (c) => clonedElement = c;\n    // scale, rotate, delay\n    this.scale = parseFloat(this.element.getAttribute(\"scale\"));\n    if(typeof this.scale == \"undefined\" || isNaN(this.scale)) this.scale = 1;\n    this.rotate = parseFloat(this.element.getAttribute(\"rotate\")) || 0;\n    this.delay = isNaN(parseFloat(this.element.getAttribute(\"delay\"))) ? 0 : (parseFloat(this.element.getAttribute(\"delay\")));\n    // coord\n    let coord = this.findSlipCoordinate();\n    console.log(coord);\n    this.x = coord.x;\n    this.y = coord.y;\n    // Preparing the slip\n    this.init(this, engine);\n    // Adding \"enter-at\" subslips\n    this.addSubSlips();\n    // Adding \"paused-flow\" subslips\n    this.generatePauseFlowSlipList = function () {\n\tlet slipList = [];\n\tlet bla = this.queryAll(\"[pause], [step], [auto-enter], [immediate-enter]\");\n\tlet step = 1;\n\tbla.forEach((elem) => {\n\t    console.log(\"debug generatePauseFlowsliplist\", elem, step);\n\t    if(elem.hasAttribute(\"auto-enter\")){\n\t\tslipList[step] = new Slip(elem, elem.getAttribute(\"toc-title\") || \"\", [], ng, {});\n\t\tstep++;\n\t    }\n\t    if(elem.hasAttribute(\"immediate-enter\")){\n\t\t// the slip is entered before the pause\n\t\tslipList[step-1] = new Slip(elem, elem.getAttribute(\"toc-title\") || \"\", [], ng, {});\n\t\tstep++;\n\t    }\n\t    if(elem.hasAttribute(\"step\")){\n\t\tconsole.log(\"debug generatePauseFlowsliplist1\", elem, step);\n\t\tstep += parseInt(elem.getAttribute(\"step\")) || 1 ;\n\t\tconsole.log(\"debug generatePauseFlowsliplist2\", elem, step);\n\t    }\n\t    if(elem.hasAttribute(\"pause\")){\n\t\tconsole.log(\"debug generatePauseFlowsliplist1\", elem, step);\n\t\tstep += parseInt(elem.getAttribute(\"pause\")) || 1 ;\n\t\tconsole.log(\"debug generatePauseFlowsliplist1\", elem, step);\n\t    }\n\t});\n\treturn slipList;\n    };\n    this.pauseSlipList = this.generatePauseFlowSlipList();\n    // this.pauseSlipList = this.queryAll(\"[pause], [step], [auto-enter]\").map((elem) => {\n    // \tif(elem.hasAttribute(\"auto-enter\"))\n    // \t    return new Slip(elem, elem.getAttribute(\"toc-title\") || \"\", [], ng, {});\n    // \treturn null;\n    // });\n}\n","import { myQueryAll } from './util';\nimport Controller from './controller';\nimport Slip from './slip';\n\nexport default function (root) {\n    function prepareRoot (rootElem) {\n\tlet container = document.createElement(\"div\");\n\tcontainer.innerHTML = \n\t    '\t\\\n\t<div class=\"toc-slip\" style=\"display:none;\"></div>\\\n        <div id=\"open-window\">\\\n\t  <div class=\"cpt-slip\">0</div>\\\n\t  <div class=\"format-container\">\\\n\t    <div class=\"rotate-container\">\\\n\t\t<div class=\"scale-container\">\\\n\t\t    <div class=\"universe movable\" id=\"universe\">\\\n\t\t\t<div width=\"10000\" height=\"10000\" class=\"fog\"></div>\\\n                        <div class=\"placeHolder\"></div>\\\n\t\t    </div>\\\n\t\t</div>\\\n              </div>\\\n\t    </div>\\\n\t</div>';\n\trootElem.replaceWith(container);\n\tcontainer.querySelector(\".placeHolder\").replaceWith(rootElem);\n\trootElem.querySelectorAll(\".slip\").forEach((slipElem) => {\n\t    setTimeout(() => {\n\t\tvar scaleContainer = document.createElement('div');\n\t\tvar slipContainer = document.createElement('div');\n\t\tscaleContainer.classList.add(\"slip-scale-container\");\n\t\tslipContainer.classList.add(\"slip-container\");\n\t\tlet fChild;\n\t\twhile((fChild = slipElem.firstChild)) {\n\t\t    slipContainer.appendChild(fChild);\n\t\t}\n\t\tscaleContainer.appendChild(slipContainer);\n\t\tslipElem.appendChild(scaleContainer);\n\t    },0);\n\t});\n\trootElem.style.width = \"unset\";\n\trootElem.style.height = \"unset\";\n\tdocument.querySelectorAll(\".background-canvas\").forEach((elem)=> {elem.addEventListener(\"click\", (ev) => { console.log(\"vous avez cliquez aux coordonnÃ©es : \", ev.layerX, ev.layerY); });});\t\n    }\n    prepareRoot(root);\n\n    // Constants\n    document.body.style.cursor = \"auto\";\n    let timeOutIds = [];\n    document.body.addEventListener(\"mousemove\", (ev) => {\n\ttimeOutIds.forEach((id) => { clearTimeout(id); });\n\tdocument.body.style.cursor = \"auto\";\n\ttimeOutIds.push(setTimeout(() => { document.body.style.cursor = \"none\";}, 5000));\n    });\n    let openWindow = document.querySelector(\"#open-window\");\n    let universe = document.querySelector(\"#universe\");\n    let slips = universe.querySelectorAll(\".slip:not(.root)\");\n    let browserHeight, openWindowWidth;\n    let browserWidth, openWindowHeight;\n    this.getOpenWindowHeight = () => openWindowHeight;\n    this.getOpenWindowWidth = () => openWindowWidth;\n\n    let winX, winY;\n    let currentScale, currentRotate;\n    this.getCoord = () => { return {x: winX, y: winY, scale: currentScale};};\n    let doNotMove = false;\n    this.setDoNotMove = m => doNotMove = m;\n    this.getDoNotMove = m => doNotMove;\n    this.moveWindow = function (x, y, scale, rotate, delay) {\n\tif(this.getDoNotMove()) {\n\t    console.log(\"we cannot move\");\n\t    console.log(\"previous is ca we cannot move !\");\n\t    return;\n\t}\n\tconsole.log(\"previous is ca getDoNotMove !\", x,y,scale, rotate, delay, this.getDoNotMove());\n\tconsole.log(\"move to\", x, y, \"with scale, rotate, delay\", scale, rotate, delay);\n\tcurrentScale = scale;\n\tcurrentRotate = rotate;\n\twinX = x ;\n\twinY = y;\n\tconsole.log(x,y);\n\tsetTimeout(() => {\n\t    document.querySelector(\".scale-container\").style.transitionDuration = delay+\"s\";\n\t    document.querySelector(\".rotate-container\").style.transitionDuration = delay+\"s\";\n\t    universe.style.transitionDuration = delay+\"s, \"+delay+ \"s\"; \n\t    setTimeout(() => {\n\t\tuniverse.style.left = -(x*1440 - 1440/2)+\"px\";\n\t\tuniverse.style.top = -(y*1080 - 1080/2)+\"px\";\n\t\tdocument.querySelector(\".scale-container\").style.transform = \"scale(\"+(1/scale)+\")\";\n\t\tdocument.querySelector(\".rotate-container\").style.transform = \"rotate(\"+(rotate)+\"deg)\";\n\t    },0);\n\t},0);\n\treturn;\n    };\n    this.moveWindowRelative = function(dx, dy, dscale, drotate, delay) {\n\tthis.moveWindow(winX+dx, winY+dy, currentScale+dscale, currentRotate+drotate, delay);\n    };\n    this.placeSlip = function(slip) {\n\t// console.log(\"debug Previous (slip)\", slip);\n\t// let posX = 0.5;\n\t// let posY = 0.5;\n\t// let x=parseFloat(slip.getAttribute(\"pos-x\")), y=parseFloat(slip.getAttribute(\"pos-y\"));\n\tlet scale = parseFloat(slip.getAttribute(\"scale\"));\n\t// // console.log(slip);\n\tlet slipScaleContainer = slip.querySelector(\".slip-scale-container\");\n\t// let rotate = 0;\n\tscale = isNaN(scale) ? 1 : scale ;\n\t// x = (isNaN(x) ? posX : x);\n\t// y = (isNaN(y) ? posY : y);\n\t// slip.setAttribute(\"pos-x\", x);\n\t// slip.setAttribute(\"pos-y\", y);\n\t// slip.setAttribute(\"scale\", scale);\n\t// slip.setAttribute(\"rotate\", rotate);\n\t// posX = x + 1;\n\t// posY = y;\n\t// slip.style.top = (y*1080 - 1080/2)+\"px\";\n\t// slip.style.left = (x*1440 - 1440/2)+\"px\";\n\t// if(!slip.classList.contains(\"permanent\"))\n\t// \tslip.style.zIndex = \"-1\";\n\t// slip.style.transformOrigin = \"50% 50%\";\n\tslipScaleContainer.style.transform = \"scale(\"+scale+\")\";\n\tslip.style.width = (Math.max(slipScaleContainer.offsetWidth, 1440))*scale+\"px\";\n\tslip.style.height = (Math.max(slipScaleContainer.offsetHeight, 1080))*scale+\"px\";\t\n    };\n    this.placeSlips = function () {\n\t// let posX = 0.5;\n\t// let posY = 0.5;\n\tlet depth = function (elem) {\n\t    console.log(\"debug depth (elem)\", elem);\n\t    let subslips = myQueryAll(elem, \".slip\");\n\t    console.log(\"debug depth (subslips)\", elem);\n\t    return 1+subslips.map(depth).reduce((a,b) => Math.max(a,b),0);\n\t};\n\tlet rootDepth = depth(document.body);\n\tconsole.log(\"debug\", rootDepth);\n\tfor(let i= 0; i<rootDepth; i++)\n\t    slips.forEach(this.placeSlip);\t\n    };\n    setTimeout(() => {\n\tthis.placeSlips();\n    },0);\n    this.placeOpenWindow = function () {\n\tbrowserHeight = window.innerHeight;\n\tbrowserWidth = window.innerWidth;\n\tif(browserHeight/3 < browserWidth/4) {\n\t    openWindowWidth = Math.floor((browserHeight*4)/3);\n\t    openWindowHeight = browserHeight;\n\t    openWindow.style.left = ((window.innerWidth - openWindowWidth) /2)+\"px\";\n\t    openWindow.style.right = ((window.innerWidth - openWindowWidth) /2)+\"px\";\n\t    openWindow.style.width = (openWindowWidth)+\"px\";\n\t    openWindow.style.top = \"0\";\n\t    openWindow.style.bottom = \"0\";\n\t    openWindow.style.height = (openWindowHeight)+\"px\";\n\t}\n\telse {\n\t    openWindowHeight = Math.floor((browserWidth*3)/4);\n\t    openWindowWidth = browserWidth;\n\t    openWindow.style.top = ((window.innerHeight - openWindowHeight) /2)+\"px\";\n\t    openWindow.style.bottom = ((window.innerHeight - openWindowHeight) /2)+\"px\";\n\t    openWindow.style.height = (openWindowHeight)+\"px\";\n\t    openWindow.style.right = \"0\";\n\t    openWindow.style.left = \"0\";\n\t    openWindow.style.width = openWindowWidth+\"px\";\n\t}\n\tdocument.querySelector(\".scale-container\").style.transformOrigin = (1440/2)+\"px \"+(1080/2)+\"px\";\n\tdocument.querySelector(\".rotate-container\").style.transformOrigin = (1440/2)+\"px \"+(1080/2)+\"px\";\n\tdocument.querySelector(\".format-container\").style.transform = \"scale(\"+(openWindowWidth/1440)+\")\";\n\tdocument.querySelector(\".cpt-slip\").style.right =  (parseInt(openWindow.style.left)) + \"px\";\n\tdocument.querySelector(\".cpt-slip\").style.bottom =  \"0\";\n\tdocument.querySelector(\".cpt-slip\").style.zIndex =  \"10\";\n    };\n    this.placeOpenWindow();\n    window.addEventListener(\"resize\", (ev) => {\n\tthis.placeOpenWindow();\n\tthis.moveWindow(winX, winY, currentScale, currentRotate, 0);\n    });\n\n    // Taken from https://selftaughtjs.com/algorithm-sundays-converting-roman-numerals\n    // Use in showing roman numbers for slip number\n    function counterToString(num, depth) {\n\tif(depth == 1 || depth > 3)\n\t    return num.toString();\n\tlet result = '';\n\tlet decimal = [1000, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1];\n\tlet roman;\n\tif(depth == 0)\n\t    roman = [\"M\", \"CM\",\"D\",\"CD\",\"C\", \"XC\", \"L\", \"XL\", \"X\",\"IX\",\"V\",\"IV\",\"I\"];\n\telse\n\t    roman = [\"m\", \"cm\",\"d\",\"cd\",\"c\", \"xc\", \"l\", \"xl\", \"x\",\"ix\",\"v\",\"iv\",\"i\"];\n\tfor (var i = 0;i<=decimal.length;i++) {\n\t    while (num%decimal[i] < num) {     \n\t\tresult += roman[i];\n\t\tnum -= decimal[i];\n\t    }\n\t}\n\treturn result;\n    }\n    this.countersToString = (counterList) => {\n\tlet res = '';\n\tres += counterToString(counterList[0]+1, 0);\n\tfor(let i = 1; i < counterList.length; i++)\n\t    res += \".\" + counterToString(counterList[i]+1, i);\n\treturn res;\t\n    };\n    this.updateCounter = function () {\n\tlet counters = stack.map((slip) => slip.getActionIndex());\n\tdocument.querySelector(\".cpt-slip\").innerHTML = this.countersToString(counters);\t\n    };\n    this.next = () => {\n\tif(document.querySelector(\".toc-slip\").innerHTML == \"\")\n\t    this.showToC();\n\t// return true if and only if the stack changed\n\tlet currentSlide = this.getCurrentSlip();\n\tlet n = currentSlide.next();\n\tthis.updateCounter();\n\tif(n instanceof Slip) {\n\t    this.gotoSlip(n);\n\t    this.push(n);\n\t    this.next();\n\t    // this.showToC();\n\t    return true;\n\t}\n\telse if(!n) {\n\t    this.pop();\n\t    let newCurrentSlip = this.getCurrentSlip();\n\t    if(newCurrentSlip.nextStageNeedGoto())\n\t\tthis.gotoSlip(newCurrentSlip);\n\t    // newCurrentSlip.incrIndex();\n\t    if(stack.length > 1 || newCurrentSlip.getActionIndex() < newCurrentSlip.getMaxNext())\n\t\tthis.next();\n\t    else\n\t\tthis.gotoSlip(newCurrentSlip);\n\t    // this.showToC();\n\t    return true;\n\t    // console.log(stack);\n\t}\n\t// this.showToC();\n\treturn false;\n    };\n    this.nextSlip = function () {\n\t// Do this.next() untill the stack change\n\twhile(!this.next()) {}\n    };\n    this.previous = (options) => {\n\tconsole.log(\"previous is called with option\", options);\n\tlet currentSlip = this.getCurrentSlip();\n\t// setDoNotMove(true);\n\t// let stage = currentSlip.previous2();\n\t// setDoNotMove(false);\n\tlet n = currentSlip.previous();\n\t// if(stage == \"\")\n\tconsole.log(\"debug previous (currentSlip, n)\", currentSlip, n);\n\tif(n instanceof Slip) {\n\t    while(n.getCurrentSubSlip() instanceof Slip) {\n\t\tthis.push(n);\n\t\tn = n.getCurrentSubSlip();\n\t    }\n\t    this.push(n);\n\t    console.log(\"previous is ca GOTOSLIP FROM 1\", options);\n\t    \n\t    this.gotoSlip(n, options);\n\t    // this.gotoSlip(n, {delay: currentSlip.delay});\n\t\t\n\t    // this.showToC();\n\t    this.updateCounter();\n\t    return true;\n\t}\n\telse if(!n) {\n\t    this.pop();\n\t    let newCurrentSlide = this.getCurrentSlip();\n\t    // newCurrentSlide.incrIndex();\n\t    console.log(\"previous is ca currentDelay, delay\", currentSlip.currentDelay , currentSlip.delay);\n\t    \n\t    if(stack.length > 1 || newCurrentSlide.getActionIndex() > -1)\n\t\tthis.previous({delay: (currentSlip.currentDelay ? currentSlip.currentDelay : currentSlip.delay )});\n\t    else {\n\t\tthis.gotoSlip(newCurrentSlide, options);\n\t\tconsole.log(\"previous is ca GOTOSLIP FROM 2\", options);\n\t    }\n\t\t// this.gotoSlip(newCurrentSlide, {delay: currentSlip.delay});\n\t    // console.log(stack);\n\t    // this.showToC();\n\t    this.updateCounter();\n\t    return true;\n\t} else if(options){\n\t    setTimeout(() => {\n\t\tthis.gotoSlip(currentSlip, options);\n\t    },0);\n\t}\n\t// this.showToC();\n\tthis.updateCounter();\n\treturn false;\n\t// console.log(\"returned\", n);\n    };\n    this.previousSlip = function () {\n\t// Do this.previous() untill the stack change\n\twhile(!this.previous()) {}\n    };\n\n    this.getCoordinateInUniverse = function (elem) {\n\tconsole.log(\"debug getcoord elem\", elem);\n\tlet getCoordInParen = (elem) => {\n\t    return {x: elem.offsetLeft, y:elem.offsetTop};\t    \n\t};\n\tlet globalScale = 1;\n\tlet parseScale = function(transform) {\n\t    if (transform == \"none\")\n\t\treturn 1;\n\t    return parseFloat(transform.split(\"(\")[1].split(\",\")[0]);\n\t};\n\tlet getCoordIter = (elem) => {\n\t    console.log(\"debug getcoorditer elem\", elem);\n\t    let cInParent = getCoordInParen(elem);\n\t    if(!elem.offsetParent)\n\t\treturn { x: 0,\n\t\t\t y: 0,\n\t\t\t centerX: 0,\n\t\t\t centerY: 0,\n\t\t\t width: 0,\n\t\t\t height: 0,\n\t\t\t scale: 0 };\n\t    if(elem.offsetParent.classList.contains(\"universe\"))\n\t    {\n\t\tconsole.log(\"universe\", cInParent);\n\t\treturn cInParent;\n\t    }\n\t    let cParent = getCoordIter(elem.offsetParent);\n\t    let style = window.getComputedStyle(elem.offsetParent);\n\t    // console.log(style);\n\t    let scale;\n\t    // console.log(\"style\", style.transform);\n\t    // if (style.transform == \"none\")\n\t    // \tscale = 1;\n\t    // else\n\t    // \tscale = parseFloat(style.transform.split(\"(\")[1].split(\",\")[0]);\n\t    scale = parseScale(style.transform);\n\t    // console.log(style.transform);\n\t    // console.log(\"scale\", scale);\n\t    // console.log(\"globalScale\", globalScale);\n\t    globalScale *= scale;\n\t    // let scale = 1 ; // Has to parse/compute the scale, for now always 1\n\t    // console.log(\"at step\",  \"cParent.x\", cParent.x, \"cInParen.x\", cInParent.x, \"scale\", scale);\n\t    return {x:cParent.x+cInParent.x*globalScale, y:cParent.y+cInParent.y*globalScale };\n\t};\n\tlet c = getCoordIter(elem);\n\tlet style = window.getComputedStyle(elem);\n\tlet scale = parseScale(style.transform);\n\tglobalScale *= scale;\n\tconsole.log(\"getCoord\", {x:c.x/1440+0.5, y:c.y/1080+0.5}, \"globalScale\", globalScale, style.transform, scale);\n\tlet ret = { x: c.x/1440,\n\t\t    y: c.y/1080,\n\t\t    centerX:c.x/1440+0.5*elem.offsetWidth/1440*globalScale,\n\t\t    centerY:c.y/1080+0.5*elem.offsetHeight/1080*globalScale,\n\t\t    width: elem.offsetWidth/1440*globalScale,\n\t\t    height: elem.offsetHeight/1080*globalScale,\n\t\t    scale: globalScale };\n\tconsole.log(ret);\n\treturn ret;\n\t// return {x:c.x/1440+elem*globalScale*scale, y:c.y/1080+0.5*globalScale*scale, scale: globalScale*scale};\n\t// return {x: this.element.offsetLeft/1440+0.5, y:this.element.offsetTop/1080+0.5};\n    };\n    this.moveToElement = function(element, options) {\n\tlet coord = this.getCoordinateInUniverse(element);\n\tlet actualSize = {width: element.offsetWidth*coord.scale, height: element.offsetHeight*coord.scale};\n\tif(options)\n\t    this.moveWindow(coord.centerX, coord.centerY, Math.max(coord.width, coord.height)// coord.scale\n\t\t\t    , 0, options.delay ? options.delay : 1);\n    };\n    this.gotoSlip = function(slip, options) {\n\tconsole.log(\"previous is ca goto slip\", options, slip.element, this.getDoNotMove());\n\tconsole.log(\"we goto slip\", slip.element, this.getDoNotMove());\n\toptions = options ? options : {};\n\tconsole.log(\"options is \", options);\n\tif(slip.element.classList.contains(\"slip\"))\n\t{\n\t     setTimeout(() => {\n\t\tlet coord = slip.findSlipCoordinate();\n\t\tif(typeof slip.currentX != \"undefined\" && typeof slip.currentY != \"undefined\") {\n\t\t    console.log(\"previous is ca ORIGIN 1\", slip.currentX, slip.currentY, this.getDoNotMove(), options);\n\t\t    this.moveWindow(slip.currentX, slip.currentY, coord.scale, slip.rotate, typeof(options.delay)!=\"undefined\" ? options.delay : (typeof(slip.currentDelay)!=\"undefined\" ? slip.currentDelay : slip.delay));\n\t\t} else {\n\t\t    slip.currentX = coord.x; slip.currentY = coord.y; slip.currentDelay = slip.delay;\n\t\t    console.log(\"previous is ca ORIGIN 2\", coord.x, coord.y, this.getDoNotMove());\n\t\t    this.moveWindow(coord.x, coord.y, coord.scale, slip.rotate, typeof(options.delay)!=\"undefined\" ? options.delay : (typeof(slip.currentDelay)!=\"undefined\" ? slip.currentDelay : slip.delay));\n\t\t}\n\t     },0);\n\t}\n\telse {\n\t     setTimeout(() => {\n\t\tconsole.log(\"debug slip element\", slip.element);\n\t\tlet coord = this.getCoordinateInUniverse(slip.element);\n\t\t this.moveWindow(coord.centerX, coord.centerY, Math.max(coord.width, coord.height), 0, typeof(options.delay)!=\"undefined\" ? options.delay : slip.delay);\n\t     },0);\n\t}\n    };\n    let rootSlip = new Slip(root.id, \"Presentation\", [], this, {});\n    let stack = [rootSlip];\n\n    // Stack Management:\n    this.push = function (n) {\n\tstack.push(n);\n\treturn ;\n    };\n    this.pop = function () {\n\tlet n = stack.pop();\n\tif(stack.length == 0)\n\t    stack.push(n);\n\treturn n;\n    };\n    this.getCurrentSlip = function () {\n\treturn stack[stack.length -1];\n    };\n    this.getSlipTree = function (slip) {\n\tslip = slip || rootSlip;\n\tif(slip instanceof Slip) \n\t    return {name: slip.name, slip: slip, subslips: slip.getActionList().map((e) => this.getSlipTree(e))};\n\treturn {function: true};\n    };\n\n    this.goToState = function(state) {\n\tlet iter = (state) => {\n\t    if(state.length == 0)\n\t\treturn;\n\t    iter(state[0]);\n\t    while(state[1].getActionIndex()<state[2])\n\t\tthis.next();\n\t};\n\tstack = [rootSlip];\n\trootSlip.refreshAll();\n\titer(state);\n\tthis.gotoSlip(state[1]);\n    };\n\n    this.showToC = function () {\n\tconsole.log(\"debug showtoc\");\n\tlet toc = document.querySelector(\".toc-slip\");\n\t// let innerHTML = \"\";\n\tlet globalElem = document.createElement(\"div\");\n\tlet tree = this.getSlipTree();\n\t// let before = true;\n\tlet displayTree = (tree, stackWithNumbers) => {\n\t    console.log(\"debug treee\", tree);\n\t    let containerElement = document.createElement(\"div\");\n\t    let nameElement = document.createElement(\"div\");\n\t    // if(before)\n\t    // \tnameElement.style.color = \"blue\";\n\t    // else\n\t    // \tnameElement.style.color = \"yellow\";\n\t    // if(tree.slip == this.getCurrentSlip()) {\n\t    // \tnameElement.style.color = \"red\";\n\t    // \tbefore = false;\n\t    // }\n\t\t\n\t    nameElement.innerText = tree.slip.fullName ? tree.slip.fullName : tree.slip.name ; //+ \" (\" + (tree.slip.getActionIndex()+1) + \"/\" + (tree.slip.getMaxNext()+1) + \")\";\n\t    containerElement.appendChild(nameElement);\n\t    // innerHTML += \"<div>\"+tree.name+\"</div>\";\n\t    if(tree.subslips.length > 0) {\n\t\tlet ulElement = document.createElement(\"ul\");\n\t\t// innerHTML += \"<ul>\";\n\t\ttree.subslips.forEach((subtree, index) => {\n\t\t    let newStackWithNumbers = [stackWithNumbers, tree.slip, index];\n\t\t    let liElement = document.createElement(\"li\");\n\t\t    // innerHTML += \"<li>\";\n\t\t    if(subtree.function) {\n\t\t\tlet toCounter = (c) => {\n\t\t\t    if(c.length == 0)\n\t\t\t\treturn [];\n\t\t\t    return toCounter(c[0]).concat([c[2]]);\n\t\t\t};\n\t\t\tliElement.innerText = this.countersToString(toCounter(newStackWithNumbers));\n\t\t\t//\t\t\tliElement.innerText = \"\"+(index+1);\n\t\t\tliElement.classList.add(\"toc-function\");\n\t\t    } else\n\t\t\tliElement.appendChild(displayTree(subtree, newStackWithNumbers));\n\t\t    liElement.addEventListener(\"click\", (ev) => {\n\t\t    \tif(ev.target == liElement) {\n\t\t    \t    this.goToState(newStackWithNumbers);\n\t\t    \t    console.log(\"newstack\", newStackWithNumbers);\n\t\t    \t}\n\t\t    });\n\t\t    ulElement.appendChild(liElement);\n\t\t    \n\t\t    // innerHTML += \"</li>\";\n\t\t});\n\t\tcontainerElement.appendChild(ulElement);\n\t\ttree.slip.setTocElem(containerElement);\n\t\t// innerHTML += \"</ul>\";\n\t    }\n\t    console.log(\"debug tree, will return\", containerElement);\n\t    // containerElement.addEventListener(\"click\", () => { console.log(stackWithNumbers);});\n\t    return containerElement;\n\t};\n\ttoc.innerHTML = \"\";\n\t// toc.innerHTML = innerHTML;\n\ttoc.appendChild(displayTree(tree, []));\n    };\n    \n    // this.getRootSlip = () => rootSlip;\n    this.setRootSlip = (root) => {\n\trootSlip = root;\n\tstack = [rootSlip];\n    };\n    this.getRootSlip = () => rootSlip;\n    this.start = () => {\n\tstack = [rootSlip];\n\tthis.next();\n\treturn this;\n    };\n    this.restart = () => {\n\tstack = [rootSlip];\n\trootSlip.refreshAll();\n\tthis.next();\n    };\n    let controller = new Controller(this);\n    this.getController = () => controller;\n};\n","import IEngine from './modules/engine'\nimport IController from './modules/controller.mjs'\nimport ISlip from './modules/slip'\nimport * as IUtil from './modules/util'\n\n// import \"./css/slip.css\";\n// import \"./css/theorem.css\";\n\n/**\n * Allows slip-js to be used as a module\n */\nexport const Engine = IEngine;\nexport const Controller = IController;\nexport const Slip = ISlip;\nexport const Util = IUtil;\n\nexport let startSlipshow = () => {\n    let engine;\n    if(typeof MathJax != \"undefined\")\n\tMathJax.startup.promise.then(() => {\n\t    engine = new Engine(document.querySelector(\"#rootSlip\")).start();\n\t});\n    else\n\tengine = new Engine(document.querySelector(\"#rootSlip\")).start();\n    return engine;\n};\n\n/**\n * Allows slip-js to be used as simple CDN-included file\n */\n// window.Engine = IEngine;\n// window.Controller = IController;\n// window.Slip = ISlip;\n// window.Util = IUtil;\n"],"names":["myQueryAll","root","selector","avoid","id","Math","random","toString","substr","allElem","Array","from","querySelectorAll","separatedSelector","split","map","selec","join","other","filter","value","includes","window","cloneNoSubslip","elem","newElem","cloneNode","childNodes","forEach","child","classList","contains","placeholder","document","createElement","tagName","add","appendChild","replaceSubslips","clone","subslips","placeholders","subslip","index","replaceWith","ng","engine","getEngine","setEngine","speedMove","addEventListener","ev","key","getCurrentSlip","refresh","slip","style","zIndex","canvas","openWindowHeight","getOpenWindowHeight","openWindowWidth","getOpenWindowWidth","moveWindowRelative","showToC","querySelector","display","console","log","shiftKey","nextSlip","next","previousSlip","previous","pop","Slip","name","fullName","actionL","options","generateActionList","newActionList","queryAll","getAttribute","addSubSlips","setNthAction","actionList","setAction","getActionList","ret","i","getMaxNext","pauseSlipList","n","action","getCurrentSubSlip","getActionIndex","nextStageNeedGoto","getSubSlipList","actionIndex","setActionIndex","actionI","maxNext","maxTemp","length","attr","strMax","max","abs","parseInt","sumArray","hasAttribute","reduce","a","b","quer","element","query","findSubslipByID","goodSubslip","find","findSlipCoordinate","coord","getCoordinateInUniverse","scale","y","x","centerX","updatePauseAncestors","remove","pause","parentElement","unpause","moveDownTo","moveUpTo","moveCenterTo","executeScript","reveal","incrPause","setAttribute","d","removeAttribute","doAttributes","hiddenAt","str","opacity","visibleAt","emphAt","unemphAt","visibAt","staticAt","makeUnStatic","makeStatic","goDownTo","goTo","toExec","incrIndex","updateToC","savedActionIndex","savedDelay","currentDelay","setDoNotMove","doRefresh","toReturn","getDoNotMove","setTimeout","gotoSlip","delay","setTocElem","tocElem","ToCList","firstVisit","init","refreshAll","subSlipList","clonedElement","currentX","currentY","overflow","transition","height","offsetHeight","position","visibility","Function","innerHTML","offset","offsetTop","moveWindow","rotate","revealAll","hide","hideAll","MathJax","startup","promise","then","getCloned","setCloned","c","parseFloat","isNaN","generatePauseFlowSlipList","slipList","bla","step","prepareRoot","rootElem","container","slipElem","scaleContainer","slipContainer","fChild","firstChild","width","layerX","layerY","body","cursor","timeOutIds","clearTimeout","push","openWindow","universe","slips","browserHeight","browserWidth","winX","winY","currentScale","currentRotate","getCoord","doNotMove","m","transitionDuration","left","top","transform","dx","dy","dscale","drotate","placeSlip","slipScaleContainer","offsetWidth","placeSlips","depth","rootDepth","placeOpenWindow","innerHeight","innerWidth","floor","right","bottom","transformOrigin","counterToString","num","result","decimal","roman","countersToString","counterList","res","updateCounter","counters","stack","currentSlide","newCurrentSlip","currentSlip","newCurrentSlide","getCoordInParen","offsetLeft","globalScale","parseScale","getCoordIter","cInParent","offsetParent","centerY","cParent","getComputedStyle","moveToElement","actualSize","rootSlip","getSlipTree","e","function","goToState","state","iter","toc","globalElem","tree","displayTree","stackWithNumbers","containerElement","nameElement","innerText","ulElement","subtree","newStackWithNumbers","liElement","toCounter","concat","target","setRootSlip","getRootSlip","start","restart","controller","Controller","getController","Engine","IEngine","IController","ISlip","Util","IUtil","startSlipshow"],"mappings":"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"}